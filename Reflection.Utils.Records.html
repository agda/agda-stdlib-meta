<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.Utils.Records</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/agda/agda-stdlib-meta/tree/upstream/hs-type-additions///Reflection/Utils/Records.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Keyword">module</a> <a id="43" href="Reflection.Utils.Records.html" class="Module">Reflection.Utils.Records</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Meta.Init.html" class="Module">Meta.Init</a>

<a id="123" class="Keyword">open</a> <a id="128" class="Keyword">import</a> <a id="135" href="Data.List.html" class="Module">Data.List</a> <a id="145" class="Keyword">using</a> <a id="151" class="Symbol">(</a><a id="152" href="Data.List.Base.html#1634" class="Function">map</a><a id="155" class="Symbol">)</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="196" class="Keyword">using</a> <a id="202" class="Symbol">(</a><a id="203" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌊_⌋</a><a id="206" class="Symbol">)</a>

<a id="209" class="Keyword">import</a> <a id="216" href="Reflection.AST.Name.html" class="Module">Reflection.AST.Name</a> <a id="236" class="Symbol">as</a> <a id="239" class="Module">Name</a>

<a id="mkRecord"></a><a id="245" href="Reflection.Utils.Records.html#245" class="Function">mkRecord</a> <a id="254" class="Symbol">:</a> <a id="256" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="261" class="Symbol">(</a><a id="262" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="267" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="269" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="273" class="Symbol">)</a> <a id="275" class="Symbol">→</a> <a id="277" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="282" href="Reflection.Utils.Records.html#245" class="Function">mkRecord</a> <a id="291" href="Reflection.Utils.Records.html#291" class="Bound">fs</a> <a id="294" class="Symbol">=</a> <a id="296" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="304" class="Symbol">(</a><a id="305" href="Data.List.Base.html#1634" class="Function">map</a> <a id="309" class="Symbol">(λ</a> <a id="312" class="Keyword">where</a> <a id="318" class="Symbol">(</a><a id="319" href="Reflection.Utils.Records.html#319" class="Bound">fn</a> <a id="322" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="324" href="Reflection.Utils.Records.html#324" class="Bound">e</a><a id="325" class="Symbol">)</a> <a id="327" class="Symbol">→</a> <a id="329" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="336" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="339" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="341" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="346" class="Symbol">(</a><a id="347" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="352" href="Reflection.Utils.Records.html#319" class="Bound">fn</a><a id="354" class="Symbol">)</a> <a id="356" href="Data.List.Base.html#5205" class="Function Operator">]</a> <a id="358" href="Reflection.Utils.Records.html#324" class="Bound">e</a><a id="359" class="Symbol">)</a> <a id="361" href="Reflection.Utils.Records.html#291" class="Bound">fs</a><a id="363" class="Symbol">)</a> <a id="365" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="updateField"></a><a id="369" href="Reflection.Utils.Records.html#369" class="Function">updateField</a> <a id="381" class="Symbol">:</a> <a id="383" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="388" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="393" class="Symbol">→</a> <a id="395" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="400" class="Symbol">→</a> <a id="402" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="407" class="Symbol">→</a> <a id="409" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="414" class="Symbol">→</a> <a id="416" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="421" href="Reflection.Utils.Records.html#369" class="Function">updateField</a> <a id="433" href="Reflection.Utils.Records.html#433" class="Bound">fs</a> <a id="436" href="Reflection.Utils.Records.html#436" class="Bound">rexp</a> <a id="441" href="Reflection.Utils.Records.html#441" class="Bound">fn</a> <a id="444" href="Reflection.Utils.Records.html#444" class="Bound">fexp</a> <a id="449" class="Symbol">=</a>
  <a id="453" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="461" class="Symbol">(</a><a id="462" href="Function.Base.html#1638" class="Function">flip</a> <a id="467" href="Data.List.Base.html#1634" class="Function">map</a> <a id="471" href="Reflection.Utils.Records.html#433" class="Bound">fs</a> <a id="474" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="476" class="Symbol">λ</a> <a id="478" href="Reflection.Utils.Records.html#478" class="Bound">f</a> <a id="480" class="Symbol">→</a>
    <a id="486" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="489" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌊</a> <a id="491" href="Reflection.Utils.Records.html#478" class="Bound">f</a> <a id="493" href="Reflection.AST.Name.html#1747" class="Function Operator">Name.≟</a> <a id="500" href="Reflection.Utils.Records.html#441" class="Bound">fn</a> <a id="503" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌋</a> <a id="505" href="Data.Bool.Base.html#1505" class="Function Operator">then</a>
      <a id="516" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="523" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="526" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="528" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="533" class="Symbol">(</a><a id="534" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="539" href="Reflection.Utils.Records.html#441" class="Bound">fn</a><a id="541" class="Symbol">)</a> <a id="543" href="Data.List.Base.html#5205" class="Function Operator">]</a> <a id="545" href="Reflection.Utils.Records.html#444" class="Bound">fexp</a>
    <a id="554" href="Data.Bool.Base.html#1505" class="Function Operator">else</a>
      <a id="565" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="572" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="575" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="577" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="582" class="Symbol">(</a><a id="583" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="588" href="Reflection.Utils.Records.html#478" class="Bound">f</a><a id="589" class="Symbol">)</a> <a id="591" href="Data.List.Base.html#5205" class="Function Operator">]</a> <a id="593" class="Symbol">(</a><a id="594" href="Reflection.Utils.Records.html#478" class="Bound">f</a> <a id="596" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="599" href="Reflection.Utils.Records.html#436" class="Bound">rexp</a> <a id="604" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="605" class="Symbol">)</a>
    <a id="611" class="Symbol">)</a> <a id="613" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
</pre></body></html>