<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.Show</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactic/Derive/Show.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Deriving show.</a>

<a id="20" class="Symbol">{-#</a> <a id="24" class="Keyword">OPTIONS</a> <a id="32" class="Pragma">-v</a> <a id="35" class="Pragma">allTactics:100</a> <a id="50" class="Symbol">#-}</a>
<a id="54" class="Symbol">{-#</a> <a id="58" class="Keyword">OPTIONS</a> <a id="66" class="Pragma">--safe</a> <a id="73" class="Symbol">#-}</a>
<a id="77" class="Keyword">module</a> <a id="84" href="Tactic.Derive.Show.html" class="Module">Tactic.Derive.Show</a> <a id="103" class="Keyword">where</a>

<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Prelude.html" class="Module">Prelude</a>
<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Meta.html" class="Module">Meta</a>

<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="184" class="Keyword">using</a> <a id="190" class="Symbol">(</a><a id="191" href="Agda.Builtin.Reflection.html#604" class="Primitive">primShowQName</a><a id="204" class="Symbol">)</a>

<a id="207" class="Keyword">import</a> <a id="214" href="Data.List.html" class="Module">Data.List</a> <a id="224" class="Symbol">as</a> <a id="227" class="Module">L</a>
<a id="229" class="Keyword">import</a> <a id="236" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="255" class="Symbol">as</a> <a id="258" class="Module">NE</a>
<a id="261" class="Keyword">import</a> <a id="268" href="Reflection.html" class="Module">Reflection</a> <a id="279" class="Symbol">as</a> <a id="282" class="Module">R</a>
<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="Data.String.html" class="Module">Data.String</a> <a id="308" class="Keyword">using</a> <a id="314" class="Symbol">(</a><a id="315" href="Data.String.Base.html#1535" class="Primitive">fromList</a><a id="323" class="Symbol">;</a> <a id="325" href="Data.String.Base.html#1502" class="Primitive">toList</a><a id="331" class="Symbol">)</a> <a id="333" class="Keyword">renaming</a> <a id="342" class="Symbol">(</a><a id="343" href="Data.String.Base.html#2375" class="Function Operator">_++_</a> <a id="348" class="Symbol">to</a> <a id="351" class="Function Operator">_++S_</a><a id="356" class="Symbol">)</a>
<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="388" class="Keyword">open</a> <a id="393" class="Keyword">import</a> <a id="400" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a>

<a id="427" class="Keyword">open</a> <a id="432" class="Keyword">import</a> <a id="439" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="477" class="Keyword">open</a> <a id="482" class="Keyword">import</a> <a id="489" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Class.Show.Core.html" class="Module">Class.Show.Core</a>
<a id="541" class="Keyword">open</a> <a id="546" class="Keyword">import</a> <a id="553" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="605" class="Keyword">open</a> <a id="610" class="Keyword">import</a> <a id="617" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="631" class="Symbol">(</a><a id="632" class="Keyword">quote</a> <a id="638" href="Class.Show.Core.html#113" class="Record">Show</a><a id="642" class="Symbol">)</a> <a id="644" class="Symbol">(</a><a id="645" class="Keyword">quote</a> <a id="651" href="Class.Show.Core.html#177" class="Field">show</a><a id="655" class="Symbol">)</a>

<a id="658" class="Keyword">instance</a>
  <a id="669" href="Tactic.Derive.Show.html#669" class="Function">_</a> <a id="671" class="Symbol">=</a> <a id="673" href="Tactic.ClauseBuilder.html#10741" class="Function">ContextMonad-MonadTC</a>

<a id="695" class="Keyword">open</a> <a id="700" href="Tactic.ClauseBuilder.html#10971" class="Module">ClauseExprM</a>

<a id="sLit"></a><a id="713" href="Tactic.Derive.Show.html#713" class="Function">sLit</a> <a id="718" class="Symbol">=</a> <a id="720" href="Agda.Builtin.Reflection.html#5186" class="InductiveConstructor">Term.lit</a> <a id="729" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="731" href="Agda.Builtin.Reflection.html#4232" class="InductiveConstructor">Agda.Builtin.Reflection.Literal.string</a>

<a id="showName"></a><a id="771" href="Tactic.Derive.Show.html#771" class="Function">showName</a> <a id="780" class="Symbol">:</a> <a id="782" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="787" class="Symbol">→</a> <a id="789" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="796" href="Tactic.Derive.Show.html#771" class="Function">showName</a> <a id="805" href="Tactic.Derive.Show.html#805" class="Bound">n</a> <a id="807" class="Symbol">=</a> <a id="809" class="Keyword">let</a> <a id="813" href="Tactic.Derive.Show.html#813" class="Bound">n&#39;</a> <a id="816" class="Symbol">=</a> <a id="818" href="Agda.Builtin.Reflection.html#604" class="Primitive">R.showName</a> <a id="829" href="Tactic.Derive.Show.html#805" class="Bound">n</a> <a id="831" class="Keyword">in</a> <a id="834" href="Tactic.Derive.Show.html#866" class="Function">dropModulePrefix</a> <a id="851" href="Tactic.Derive.Show.html#813" class="Bound">n&#39;</a>
  <a id="856" class="Keyword">where</a>
    <a id="866" href="Tactic.Derive.Show.html#866" class="Function">dropModulePrefix</a> <a id="883" class="Symbol">:</a> <a id="885" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="892" class="Symbol">→</a> <a id="894" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
    <a id="905" href="Tactic.Derive.Show.html#866" class="Function">dropModulePrefix</a> <a id="922" href="Tactic.Derive.Show.html#922" class="Bound">s</a> <a id="924" class="Symbol">=</a> <a id="926" href="Data.String.Base.html#1535" class="Primitive">fromList</a> <a id="935" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="937" href="Data.List.Base.html#9826" class="Function">reverse</a> <a id="945" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="947" href="Data.List.Base.html#7743" class="Function">takeWhile</a> <a id="957" class="Symbol">(</a><a id="958" href="Relation.Nullary.Negation.Core.html#1364" class="Function">¬?</a> <a id="961" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="963" class="Symbol">(</a><a id="964" class="String">&#39;.&#39;</a> <a id="968" href="Class.DecEq.Core.html#519" class="Field Operator">≟_</a><a id="970" class="Symbol">))</a> <a id="973" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="975" href="Data.List.Base.html#9826" class="Function">reverse</a> <a id="983" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="985" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="992" href="Tactic.Derive.Show.html#922" class="Bound">s</a>

<a id="wrapWithPars"></a><a id="995" href="Tactic.Derive.Show.html#995" class="Function">wrapWithPars</a> <a id="1008" class="Symbol">:</a> <a id="1010" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1017" class="Symbol">→</a> <a id="1019" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1026" href="Tactic.Derive.Show.html#995" class="Function">wrapWithPars</a> <a id="1039" href="Tactic.Derive.Show.html#1039" class="Bound">s</a> <a id="1041" class="Symbol">=</a> <a id="1043" class="String">&quot;(&quot;</a> <a id="1047" href="Tactic.Derive.Show.html#351" class="Function Operator">++S</a> <a id="1051" href="Tactic.Derive.Show.html#1039" class="Bound">s</a> <a id="1053" href="Tactic.Derive.Show.html#351" class="Function Operator">++S</a> <a id="1057" class="String">&quot;)&quot;</a>

<a id="genPars"></a><a id="1062" href="Tactic.Derive.Show.html#1062" class="Function">genPars</a> <a id="1070" class="Symbol">:</a> <a id="1072" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1077" class="Symbol">→</a> <a id="1079" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="1084" href="Tactic.Derive.Show.html#1062" class="Function">genPars</a> <a id="1092" href="Tactic.Derive.Show.html#1092" class="Bound">t</a> <a id="1094" class="Symbol">=</a> <a id="1096" class="Keyword">quote</a> <a id="1102" href="Tactic.Derive.Show.html#995" class="Function">wrapWithPars</a> <a id="1115" href="Reflection.Syntax.html#2556" class="InductiveConstructor Operator">∙⟦</a> <a id="1118" href="Tactic.Derive.Show.html#1092" class="Bound">t</a> <a id="1120" href="Reflection.Syntax.html#2556" class="InductiveConstructor Operator">⟧</a>

<a id="1123" class="Keyword">module</a> <a id="1130" href="Tactic.Derive.Show.html#1130" class="Module">_</a> <a id="1132" class="Symbol">(</a><a id="1133" href="Tactic.Derive.Show.html#1133" class="Bound">transName</a> <a id="1143" class="Symbol">:</a> <a id="1145" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1150" class="Symbol">→</a> <a id="1152" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1158" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="1162" class="Symbol">)</a> <a id="1164" class="Keyword">where</a>
  <a id="1172" href="Tactic.Derive.Show.html#1172" class="Function">showFromTerm</a> <a id="1185" class="Symbol">:</a> <a id="1187" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1192" class="Symbol">→</a> <a id="1194" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1199" class="Symbol">→</a> <a id="1201" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="1208" href="Tactic.Derive.Show.html#1172" class="Function">showFromTerm</a> <a id="1221" class="Symbol">(</a><a id="1222" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="1226" href="Tactic.Derive.Show.html#1226" class="Bound">n</a> <a id="1228" class="Symbol">_)</a> <a id="1231" href="Tactic.Derive.Show.html#1231" class="Bound">t</a> <a id="1233" class="Keyword">with</a> <a id="1238" href="Tactic.Derive.Show.html#1133" class="Bound">transName</a> <a id="1248" href="Tactic.Derive.Show.html#1226" class="Bound">n</a>
  <a id="1252" class="Symbol">...</a> <a id="1256" class="Symbol">|</a> <a id="1258" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1263" href="Tactic.Derive.Show.html#1263" class="Bound">n&#39;</a>    <a id="1269" class="Symbol">=</a> <a id="1271" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="1275" class="Symbol">(</a><a id="1276" class="Keyword">quote</a> <a id="1282" href="Class.Show.Core.html#177" class="Field">show</a><a id="1286" class="Symbol">)</a> <a id="1288" class="Symbol">(</a><a id="1289" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="1294" class="Symbol">(</a><a id="1295" href="Tactic.Derive.Show.html#1263" class="Bound">n&#39;</a> <a id="1298" href="Reflection.Syntax.html#2532" class="InductiveConstructor Operator">∙</a><a id="1299" class="Symbol">)</a> <a id="1301" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1303" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="1308" class="Bound">t</a> <a id="1310" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1312" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1314" class="Symbol">)</a>
  <a id="1318" class="Symbol">...</a> <a id="1322" class="Symbol">|</a> <a id="1324" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>    <a id="1335" class="Symbol">=</a> <a id="1337" class="Keyword">quote</a> <a id="1343" href="Class.Show.Core.html#177" class="Field">show</a> <a id="1348" href="Reflection.Syntax.html#2556" class="InductiveConstructor Operator">∙⟦</a> <a id="1351" class="Bound">t</a> <a id="1353" href="Reflection.Syntax.html#2556" class="InductiveConstructor Operator">⟧</a>
  <a id="1357" href="Tactic.Derive.Show.html#1172" class="CatchallClause Function">showFromTerm</a><a id="1369" class="CatchallClause"> </a><a id="1370" class="CatchallClause Symbol">_</a><a id="1371" class="CatchallClause"> </a><a id="1372" href="Tactic.Derive.Show.html#1372" class="CatchallClause Bound">t</a> <a id="1374" class="Symbol">=</a> <a id="1376" class="Keyword">quote</a> <a id="1382" href="Class.Show.Core.html#177" class="Field">show</a> <a id="1387" href="Reflection.Syntax.html#2556" class="InductiveConstructor Operator">∙⟦</a> <a id="1390" href="Tactic.Derive.Show.html#1372" class="Bound">t</a> <a id="1392" href="Reflection.Syntax.html#2556" class="InductiveConstructor Operator">⟧</a>

  <a id="1397" href="Tactic.Derive.Show.html#1397" class="Function">genShow</a> <a id="1405" class="Symbol">:</a> <a id="1407" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1412" class="Symbol">→</a> <a id="1414" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1419" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1424" class="Symbol">→</a> <a id="1426" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="1433" href="Tactic.Derive.Show.html#1397" class="Function">genShow</a> <a id="1441" href="Tactic.Derive.Show.html#1441" class="Bound">n</a> <a id="1443" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1446" class="Symbol">=</a> <a id="1448" href="Tactic.Derive.Show.html#713" class="Function">sLit</a> <a id="1453" class="Symbol">(</a><a id="1454" href="Tactic.Derive.Show.html#771" class="Function">showName</a> <a id="1463" href="Tactic.Derive.Show.html#1441" class="Bound">n</a><a id="1464" class="Symbol">)</a>
  <a id="1468" href="Tactic.Derive.Show.html#1397" class="Function">genShow</a> <a id="1476" href="Tactic.Derive.Show.html#1476" class="Bound">n</a> <a id="1478" class="Symbol">(</a><a id="1479" href="Tactic.Derive.Show.html#1479" class="Bound">x</a> <a id="1481" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1483" href="Tactic.Derive.Show.html#1483" class="Bound">l</a><a id="1484" class="Symbol">)</a> <a id="1486" class="Symbol">=</a> <a id="1488" class="Keyword">quote</a> <a id="1494" href="Data.String.Base.html#3008" class="Function Operator">_&lt;+&gt;_</a> <a id="1500" href="Reflection.Syntax.html#2596" class="InductiveConstructor Operator">∙⟦</a> <a id="1503" href="Tactic.Derive.Show.html#1397" class="Function">genShow</a> <a id="1511" href="Tactic.Derive.Show.html#1476" class="Bound">n</a> <a id="1513" href="Tactic.Derive.Show.html#1483" class="Bound">l</a> <a id="1515" href="Reflection.Syntax.html#2596" class="InductiveConstructor Operator">∣</a> <a id="1517" href="Tactic.Derive.Show.html#1062" class="Function">genPars</a> <a id="1525" href="Tactic.Derive.Show.html#1479" class="Bound">x</a> <a id="1527" href="Reflection.Syntax.html#2596" class="InductiveConstructor Operator">⟧</a>

  <a id="1532" href="Tactic.Derive.Show.html#1532" class="Function">patternToClause</a> <a id="1548" class="Symbol">:</a> <a id="1550" href="Tactic.ClauseBuilder.html#1322" class="Function">SinglePattern</a> <a id="1564" class="Symbol">→</a> <a id="1566" href="Data.List.NonEmpty.Base.html#1088" class="Record">NE.List⁺</a> <a id="1575" href="Tactic.ClauseBuilder.html#1322" class="Function">SinglePattern</a> <a id="1589" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1591" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1594" class="Symbol">(</a><a id="1595" href="Tactic.ClauseBuilder.html#5826" class="Datatype">ClauseExpr</a> <a id="1606" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="1608" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1614" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="1618" class="Symbol">)</a>
  <a id="1622" href="Tactic.Derive.Show.html#1532" class="Function">patternToClause</a> <a id="1638" href="Tactic.Derive.Show.html#1638" class="Bound">p</a><a id="1639" class="Symbol">@(</a><a id="1641" href="Tactic.Derive.Show.html#1641" class="Bound">l</a> <a id="1643" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1645" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1649" class="Symbol">_</a> <a id="1651" class="Symbol">(</a><a id="1652" href="Agda.Builtin.Reflection.html#5491" class="InductiveConstructor">Pattern.con</a> <a id="1664" href="Tactic.Derive.Show.html#1664" class="Bound">n</a> <a id="1666" class="Symbol">_))</a> <a id="1670" class="Symbol">=</a> <a id="1672" href="Data.List.NonEmpty.Base.html#1277" class="Function Operator">NE.[</a> <a id="1677" href="Tactic.Derive.Show.html#1638" class="Bound">p</a> <a id="1679" href="Data.List.NonEmpty.Base.html#1277" class="Function Operator">]</a> <a id="1681" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1683" href="Tactic.ClauseBuilder.html#12911" class="Function">finishMatch</a> <a id="1695" class="Keyword">do</a>
    <a id="1702" href="Tactic.Derive.Show.html#1702" class="Bound">typeList</a> <a id="1711" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1713" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="1722" class="Symbol">⦃</a> <a id="1724" href="Class.Functor.Instances.html#783" class="Function">Functor-List</a> <a id="1737" class="Symbol">⦄</a> <a id="1739" class="Symbol">(λ</a> <a id="1742" href="Tactic.Derive.Show.html#1742" class="Bound">t</a> <a id="1744" class="Symbol">→</a> <a id="1746" class="Keyword">do</a> <a id="1749" href="Tactic.Derive.Show.html#1749" class="Bound">T</a> <a id="1751" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1753" href="Class.MonadTC.html#1753" class="Field">inferType</a> <a id="1763" href="Tactic.Derive.Show.html#1742" class="Bound">t</a><a id="1764" class="Symbol">;</a> <a id="1766" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1773" class="Symbol">(</a><a id="1774" href="Tactic.Derive.Show.html#1749" class="Bound">T</a> <a id="1776" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1778" href="Tactic.Derive.Show.html#1742" class="Bound">t</a><a id="1779" class="Symbol">))</a> <a id="1782" class="Symbol">(</a><a id="1783" href="Data.List.Base.html#5874" class="Function">applyDownFrom</a> <a id="1797" href="Reflection.Syntax.html#1085" class="InductiveConstructor">♯</a> <a id="1799" class="Symbol">(</a><a id="1800" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1807" href="Tactic.Derive.Show.html#1641" class="Bound">l</a><a id="1808" class="Symbol">))</a>
    <a id="1815" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1822" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1824" href="Tactic.Derive.Show.html#1397" class="Function">genShow</a> <a id="1832" href="Tactic.Derive.Show.html#1664" class="Bound">n</a> <a id="1834" class="Symbol">(</a><a id="1835" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1841" class="Symbol">(</a><a id="1842" href="Data.Product.html#3431" class="Function">uncurry</a> <a id="1850" href="Tactic.Derive.Show.html#1172" class="Function">showFromTerm</a><a id="1862" class="Symbol">)</a> <a id="1864" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1866" href="Data.List.Base.html#9826" class="Function">reverse</a> <a id="1874" href="Tactic.Derive.Show.html#1702" class="Bound">typeList</a><a id="1882" class="Symbol">)</a>
  <a id="1886" href="Tactic.Derive.Show.html#1532" class="CatchallClause Function">patternToClause</a><a id="1901" class="CatchallClause"> </a><a id="1902" href="Tactic.Derive.Show.html#1902" class="CatchallClause Bound">p</a> <a id="1904" class="Symbol">=</a> <a id="1906" href="Data.List.NonEmpty.Base.html#1277" class="Function Operator">NE.[</a> <a id="1911" href="Tactic.Derive.Show.html#1902" class="Bound">p</a> <a id="1913" href="Data.List.NonEmpty.Base.html#1277" class="Function Operator">]</a> <a id="1915" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1917" href="Class.MonadTC.html#8719" class="Function">error1</a> <a id="1924" class="String">&quot;Error: not a con!&quot;</a>

<a id="1945" class="Keyword">module</a> <a id="1952" href="Tactic.Derive.Show.html#1952" class="Module">_</a> <a id="1954" class="Symbol">⦃</a> <a id="1956" href="Tactic.Derive.Show.html#1956" class="Bound">_</a> <a id="1958" class="Symbol">:</a> <a id="1960" href="Class.MonadTC.html#621" class="Record">TCOptions</a> <a id="1970" class="Symbol">⦄</a> <a id="1972" class="Keyword">where</a>
  <a id="1980" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a> <a id="1992" class="Symbol">:</a> <a id="1994" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1999" class="Symbol">(</a><a id="2000" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2005" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2007" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="2011" class="Symbol">)</a> <a id="2013" class="Symbol">→</a> <a id="2015" href="Reflection.Tactic.html#508" class="Function">UnquoteDecl</a>
  <a id="2029" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a> <a id="2041" class="Symbol">=</a> <a id="2043" href="Tactic.Derive.html#4940" class="Function">derive-Class</a> <a id="2056" class="Number">0</a> <a id="2058" class="Symbol">(λ</a> <a id="2061" href="Tactic.Derive.Show.html#2061" class="Bound">transName</a> <a id="2071" class="Symbol">→</a> <a id="2073" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="2079" class="Symbol">(</a><a id="2080" href="Tactic.Derive.Show.html#1532" class="Function">patternToClause</a> <a id="2096" href="Tactic.Derive.Show.html#2061" class="Bound">transName</a><a id="2105" class="Symbol">))</a>

<a id="2109" class="Keyword">private</a>
  <a id="2119" class="Keyword">open</a> <a id="2124" class="Keyword">import</a> <a id="2131" href="Tactic.Derive.TestTypes.html" class="Module">Tactic.Derive.TestTypes</a>
  <a id="2157" class="Keyword">import</a> <a id="2164" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
  <a id="2180" class="Keyword">open</a> <a id="2185" class="Keyword">import</a> <a id="2192" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

  <a id="2211" class="Keyword">unquoteDecl</a> <a id="Show-Bool"></a><a id="2223" href="Tactic.Derive.Show.html#2223" class="Function">Show-Bool</a> <a id="Show-ℤ"></a><a id="2233" href="Tactic.Derive.Show.html#2233" class="Function">Show-ℤ</a> <a id="Show-List"></a><a id="2240" href="Tactic.Derive.Show.html#2240" class="Function">Show-List</a> <a id="Show-Maybe"></a><a id="2250" href="Tactic.Derive.Show.html#2250" class="Function">Show-Maybe</a> <a id="Show-ℕ"></a><a id="2261" href="Tactic.Derive.Show.html#2261" class="Function">Show-ℕ</a> <a id="Show-Sign"></a><a id="2268" href="Tactic.Derive.Show.html#2268" class="Function">Show-Sign</a> <a id="Show-⊤"></a><a id="2278" href="Tactic.Derive.Show.html#2278" class="Function">Show-⊤</a> <a id="2285" class="Symbol">=</a> <a id="2287" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a> <a id="2299" class="Symbol">((</a><a id="2301" class="Keyword">quote</a> <a id="2307" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a> <a id="2312" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2314" href="Tactic.Derive.Show.html#2223" class="Function">Show-Bool</a><a id="2323" class="Symbol">)</a> <a id="2325" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2327" class="Symbol">(</a><a id="2328" class="Keyword">quote</a> <a id="2334" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="2336" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2338" href="Tactic.Derive.Show.html#2233" class="Function">Show-ℤ</a><a id="2344" class="Symbol">)</a> <a id="2346" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2348" class="Symbol">(</a><a id="2349" class="Keyword">quote</a> <a id="2355" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2360" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2362" href="Tactic.Derive.Show.html#2240" class="Function">Show-List</a><a id="2371" class="Symbol">)</a> <a id="2373" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2375" class="Symbol">(</a><a id="2376" class="Keyword">quote</a> <a id="2382" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2388" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2390" href="Tactic.Derive.Show.html#2250" class="Function">Show-Maybe</a><a id="2400" class="Symbol">)</a> <a id="2402" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2404" class="Symbol">(</a><a id="2405" class="Keyword">quote</a> <a id="2411" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2413" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2415" href="Tactic.Derive.Show.html#2261" class="Function">Show-ℕ</a><a id="2421" class="Symbol">)</a> <a id="2423" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2425" class="Symbol">(</a><a id="2426" class="Keyword">quote</a> <a id="2432" href="Data.Sign.Base.html#516" class="Datatype">Sign</a> <a id="2437" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2439" href="Tactic.Derive.Show.html#2268" class="Function">Show-Sign</a><a id="2448" class="Symbol">)</a> <a id="2450" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2452" class="Symbol">(</a><a id="2453" class="Keyword">quote</a> <a id="2459" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a> <a id="2461" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2463" href="Tactic.Derive.Show.html#2278" class="Function">Show-⊤</a><a id="2469" class="Symbol">)</a> <a id="2471" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2473" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2475" class="Symbol">)</a>

  <a id="2480" class="Keyword">unquoteDecl</a> <a id="Show-Fin"></a><a id="2492" href="Tactic.Derive.Show.html#2492" class="Function">Show-Fin</a> <a id="2501" class="Symbol">=</a> <a id="2503" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a> <a id="2515" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2517" class="Symbol">(</a><a id="2518" class="Keyword">quote</a> <a id="2524" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="2528" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2530" href="Tactic.Derive.Show.html#2492" class="Function">Show-Fin</a><a id="2538" class="Symbol">)</a> <a id="2540" href="Data.List.Base.html#5034" class="Function Operator">]</a>
  <a id="2544" class="Keyword">unquoteDecl</a> <a id="Show-Vec"></a><a id="2556" href="Tactic.Derive.Show.html#2556" class="Function">Show-Vec</a> <a id="2565" class="Symbol">=</a> <a id="2567" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a> <a id="2579" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2581" class="Symbol">(</a><a id="2582" class="Keyword">quote</a> <a id="2588" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="2592" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2594" href="Tactic.Derive.Show.html#2556" class="Function">Show-Vec</a><a id="2602" class="Symbol">)</a> <a id="2604" href="Data.List.Base.html#5034" class="Function Operator">]</a>

  <a id="2609" class="Keyword">unquoteDecl</a> <a id="Show-These"></a><a id="2621" href="Tactic.Derive.Show.html#2621" class="Function">Show-These</a> <a id="2632" class="Symbol">=</a> <a id="2634" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a> <a id="2646" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2648" class="Symbol">(</a><a id="2649" class="Keyword">quote</a> <a id="2655" href="Data.These.Base.html#537" class="Datatype">These</a> <a id="2661" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2663" href="Tactic.Derive.Show.html#2621" class="Function">Show-These</a><a id="2673" class="Symbol">)</a> <a id="2675" href="Data.List.Base.html#5034" class="Function Operator">]</a>
  <a id="2679" class="Keyword">unquoteDecl</a> <a id="Show-⊎"></a><a id="2691" href="Tactic.Derive.Show.html#2691" class="Function">Show-⊎</a> <a id="2698" class="Symbol">=</a> <a id="2700" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a> <a id="2712" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2714" class="Symbol">(</a><a id="2715" class="Keyword">quote</a> <a id="2721" href="Data.Sum.Base.html#743" class="Datatype Operator">_⊎_</a> <a id="2725" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2727" href="Tactic.Derive.Show.html#2691" class="Function">Show-⊎</a><a id="2733" class="Symbol">)</a> <a id="2735" href="Data.List.Base.html#5034" class="Function Operator">]</a>

  <a id="2740" class="Keyword">unquoteDecl</a> <a id="Show-E1"></a><a id="2752" href="Tactic.Derive.Show.html#2752" class="Function">Show-E1</a> <a id="Show-E2"></a><a id="2760" href="Tactic.Derive.Show.html#2760" class="Function">Show-E2</a> <a id="Show-E3"></a><a id="2768" href="Tactic.Derive.Show.html#2768" class="Function">Show-E3</a> <a id="2776" class="Symbol">=</a> <a id="2778" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a>
    <a id="2794" class="Symbol">((</a><a id="2796" class="Keyword">quote</a> <a id="2802" href="Tactic.Derive.TestTypes.html#193" class="Datatype">E1</a> <a id="2805" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2807" href="Tactic.Derive.Show.html#2752" class="Function">Show-E1</a><a id="2814" class="Symbol">)</a> <a id="2816" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2818" class="Symbol">(</a><a id="2819" class="Keyword">quote</a> <a id="2825" href="Tactic.Derive.TestTypes.html#298" class="Datatype">E2</a> <a id="2828" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2830" href="Tactic.Derive.Show.html#2760" class="Function">Show-E2</a><a id="2837" class="Symbol">)</a> <a id="2839" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2841" class="Symbol">(</a><a id="2842" class="Keyword">quote</a> <a id="2848" href="Tactic.Derive.TestTypes.html#376" class="Datatype">E3</a> <a id="2851" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2853" href="Tactic.Derive.Show.html#2768" class="Function">Show-E3</a><a id="2860" class="Symbol">)</a> <a id="2862" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2864" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2866" class="Symbol">)</a>

  <a id="2871" class="Comment">-- unquoteDecl Show-E4 = derive-Show [ (quote E4 , Show-E4) ]</a>

  <a id="2936" class="Keyword">unquoteDecl</a> <a id="Show-R1"></a><a id="2948" href="Tactic.Derive.Show.html#2948" class="Function">Show-R1</a> <a id="Show-R2"></a><a id="2956" href="Tactic.Derive.Show.html#2956" class="Function">Show-R2</a> <a id="2964" class="Symbol">=</a> <a id="2966" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a>
    <a id="2982" class="Symbol">((</a><a id="2984" class="Keyword">quote</a> <a id="2990" href="Tactic.Derive.TestTypes.html#586" class="Record">R1</a> <a id="2993" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2995" href="Tactic.Derive.Show.html#2948" class="Function">Show-R1</a><a id="3002" class="Symbol">)</a> <a id="3004" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3006" class="Symbol">(</a><a id="3007" class="Keyword">quote</a> <a id="3013" href="Tactic.Derive.TestTypes.html#647" class="Record">R2</a> <a id="3016" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3018" href="Tactic.Derive.Show.html#2956" class="Function">Show-R2</a><a id="3025" class="Symbol">)</a> <a id="3027" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3029" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="3031" class="Symbol">)</a>

  <a id="3036" class="Keyword">unquoteDecl</a> <a id="Show-M₁"></a><a id="3048" href="Tactic.Derive.Show.html#3048" class="Function">Show-M₁</a> <a id="Show-M₂"></a><a id="3056" href="Tactic.Derive.Show.html#3056" class="Function">Show-M₂</a> <a id="3064" class="Symbol">=</a> <a id="3066" href="Tactic.Derive.Show.html#1980" class="Function">derive-Show</a> <a id="3078" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3080" class="Symbol">(</a><a id="3081" class="Keyword">quote</a> <a id="3087" href="Tactic.Derive.TestTypes.html#794" class="Datatype">M₁</a> <a id="3090" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3092" href="Tactic.Derive.Show.html#3048" class="Function">Show-M₁</a><a id="3099" class="Symbol">)</a> <a id="3101" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3103" class="Symbol">(</a><a id="3104" class="Keyword">quote</a> <a id="3110" href="Tactic.Derive.TestTypes.html#808" class="Datatype">M₂</a> <a id="3113" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3115" href="Tactic.Derive.Show.html#3056" class="Function">Show-M₂</a><a id="3122" class="Symbol">)</a> <a id="3124" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3126" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

  <a id="3132" class="Comment">-- Expected: Show-Product Show-Term</a>
</pre></body></html>