<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactics.Eta</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactics/Eta.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">-v</a> <a id="16" class="Pragma">eta:100</a> <a id="24" class="Symbol">#-}</a>
<a id="28" class="Keyword">module</a> <a id="35" href="Tactics.Eta.html" class="Module">Tactics.Eta</a> <a id="47" class="Keyword">where</a>

<a id="54" class="Keyword">open</a> <a id="59" class="Keyword">import</a> <a id="66" href="Prelude.html" class="Module">Prelude</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Data.List.html" class="Module">Data.List</a>
<a id="97" class="Keyword">open</a> <a id="102" class="Keyword">import</a> <a id="109" href="Data.Fin.html" class="Module">Data.Fin</a>

<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="143" class="Keyword">open</a> <a id="148" class="Keyword">import</a> <a id="155" href="Class.Semigroup.html" class="Module">Class.Semigroup</a>
<a id="171" class="Keyword">open</a> <a id="176" class="Keyword">import</a> <a id="183" href="Class.Show.html" class="Module">Class.Show</a>
<a id="194" class="Keyword">open</a> <a id="199" class="Keyword">import</a> <a id="206" href="Reflection.html" class="Module">Reflection</a> <a id="217" class="Keyword">hiding</a> <a id="224" class="Symbol">(</a><a id="225" href="Agda.Builtin.Reflection.html#8322" class="Postulate">return</a><a id="231" class="Symbol">;</a> <a id="233" href="Reflection.TypeChecking.Monad.Syntax.html#691" class="Function Operator">_&gt;&gt;=_</a><a id="238" class="Symbol">;</a> <a id="240" href="Reflection.TypeChecking.Monad.Syntax.html#761" class="Function Operator">_&gt;&gt;_</a><a id="244" class="Symbol">)</a>
<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Reflection.Syntax.html" class="Module">Reflection.Syntax</a> <a id="276" class="Keyword">hiding</a> <a id="283" class="Symbol">(</a><a id="284" href="Reflection.Meta.html#617" class="Primitive">toℕ</a><a id="287" class="Symbol">)</a>
<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Reflection.Utils.Debug.html" class="Module">Reflection.Utils.Debug</a>

<a id="354" class="Keyword">open</a> <a id="359" href="Reflection.Utils.Debug.html#1035" class="Module">Debug</a> <a id="365" class="Symbol">(</a><a id="366" class="String">&quot;eta&quot;</a> <a id="372" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="374" class="Number">100</a><a id="377" class="Symbol">)</a>

<a id="saturate"></a><a id="380" href="Tactics.Eta.html#380" class="Function">saturate</a> <a id="389" class="Symbol">:</a> <a id="391" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="396" class="Symbol">→</a> <a id="398" href="Reflection.Argument.html#1493" class="Function">Args</a> <a id="403" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="408" class="Symbol">→</a> <a id="410" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="413" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="418" href="Tactics.Eta.html#380" class="Function">saturate</a> <a id="427" href="Tactics.Eta.html#427" class="Bound">f</a> <a id="429" href="Tactics.Eta.html#429" class="Bound">as</a> <a id="432" class="Symbol">=</a> <a id="434" href="Function.Base.html#4130" class="Function Operator">case</a> <a id="439" href="Tactics.Eta.html#427" class="Bound">f</a> <a id="441" href="Function.Base.html#4130" class="Function Operator">of</a> <a id="444" class="Symbol">λ</a> <a id="446" class="Keyword">where</a>
  <a id="454" class="Symbol">(</a><a id="455" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="459" href="Tactics.Eta.html#459" class="Bound">c</a> <a id="461" href="Tactics.Eta.html#461" class="Bound">as′</a><a id="464" class="Symbol">)</a> <a id="466" class="Symbol">→</a> <a id="468" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="475" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="477" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="481" href="Tactics.Eta.html#459" class="Bound">c</a> <a id="483" class="Symbol">(</a><a id="484" href="Tactics.Eta.html#461" class="Bound">as′</a> <a id="488" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="491" href="Tactics.Eta.html#429" class="Bound">as</a><a id="493" class="Symbol">)</a>
  <a id="497" class="CatchallClause Symbol">_</a>           <a id="509" class="Symbol">→</a> <a id="511" href="Reflection.Utils.Debug.html#818" class="Function">error</a> <a id="517" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="519" class="String">&quot;cannot saturate arbitrary expressions, only definitions&quot;</a>

<a id="578" class="Keyword">macro</a>
  <a id="η"></a><a id="586" href="Tactics.Eta.html#586" class="Function">η</a> <a id="588" class="Symbol">:</a> <a id="590" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="595" class="Symbol">→</a> <a id="597" href="Reflection.Syntax.html#3150" class="Function">Hole</a> <a id="602" class="Symbol">→</a> <a id="604" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="607" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
  <a id="611" href="Tactics.Eta.html#586" class="Function">η</a> <a id="613" href="Tactics.Eta.html#613" class="Bound">f</a> <a id="615" href="Tactics.Eta.html#615" class="Bound">hole</a> <a id="620" class="Symbol">=</a> <a id="622" class="Keyword">do</a>
    <a id="629" href="Reflection.Utils.Debug.html#1155" class="Function">print</a> <a id="635" class="String">&quot;*****************************&quot;</a>
    <a id="671" href="Reflection.Utils.Debug.html#1155" class="Function">print</a> <a id="677" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="679" class="String">&quot;f: &quot;</a> <a id="685" href="Class.Semigroup.Core.html#413" class="Field Operator">◇</a> <a id="687" href="Class.Show.Core.html#177" class="Field">show</a> <a id="692" href="Tactics.Eta.html#613" class="Bound">f</a>
    <a id="698" href="Tactics.Eta.html#698" class="Bound">ty</a> <a id="701" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="703" href="Agda.Builtin.Reflection.html#8555" class="Postulate">inferType</a> <a id="713" href="Tactics.Eta.html#613" class="Bound">f</a> <a id="715" class="Comment">-- =&lt;&lt; reduce f</a>
    <a id="735" href="Reflection.Utils.Debug.html#1155" class="Function">print</a> <a id="741" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="743" class="String">&quot;ty: &quot;</a> <a id="750" href="Class.Semigroup.Core.html#413" class="Field Operator">◇</a> <a id="752" href="Class.Show.Core.html#177" class="Field">show</a> <a id="757" href="Tactics.Eta.html#698" class="Bound">ty</a>
    <a id="764" class="Keyword">let</a> <a id="768" href="Tactics.Eta.html#768" class="Bound">as</a> <a id="771" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="773" class="Symbol">_</a> <a id="775" class="Symbol">=</a> <a id="777" href="Reflection.Utils.html#2892" class="Function">viewTy′</a> <a id="785" href="Tactics.Eta.html#698" class="Bound">ty</a>
    <a id="792" href="Reflection.Utils.Debug.html#1155" class="Function">print</a> <a id="798" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="800" class="String">&quot;as: &quot;</a> <a id="807" href="Class.Semigroup.Core.html#413" class="Field Operator">◇</a> <a id="809" href="Class.Show.Core.html#177" class="Field">show</a> <a id="814" href="Tactics.Eta.html#768" class="Bound">as</a>
    <a id="821" href="Tactics.Eta.html#821" class="Bound">f′</a> <a id="824" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="826" href="Tactics.Eta.html#380" class="Function">saturate</a> <a id="835" href="Tactics.Eta.html#613" class="Bound">f</a> <a id="837" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="839" href="Function.Base.html#1563" class="Function">flip</a> <a id="844" href="Data.List.Base.html#1553" class="Function">map</a> <a id="848" class="Symbol">(</a><a id="849" href="Reflection.Utils.Debug.html#929" class="Function">enumerate</a> <a id="859" href="Tactics.Eta.html#768" class="Bound">as</a><a id="861" class="Symbol">)</a> <a id="863" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="865" class="Symbol">λ</a> <a id="867" class="Keyword">where</a>
      <a id="879" class="Symbol">(</a><a id="880" href="Tactics.Eta.html#880" class="Bound">n</a> <a id="882" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="884" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="888" href="Tactics.Eta.html#888" class="Bound">i</a> <a id="890" class="Symbol">_)</a> <a id="893" class="Symbol">→</a> <a id="895" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="899" href="Tactics.Eta.html#888" class="Bound">i</a> <a id="901" class="Symbol">(</a><a id="902" href="Reflection.Syntax.html#1085" class="InductiveConstructor">♯</a> <a id="904" class="Symbol">(</a><a id="905" href="Data.List.Base.html#4873" class="Function">length</a> <a id="912" href="Tactics.Eta.html#768" class="Bound">as</a> <a id="915" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="917" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="921" class="Symbol">(</a><a id="922" href="Data.Fin.Base.html#1261" class="Function">toℕ</a> <a id="926" href="Tactics.Eta.html#880" class="Bound">n</a><a id="927" class="Symbol">)))</a>
    <a id="935" href="Reflection.Utils.Debug.html#1155" class="Function">print</a> <a id="941" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="943" class="String">&quot;f′: &quot;</a> <a id="950" href="Class.Semigroup.Core.html#413" class="Field Operator">◇</a> <a id="952" href="Class.Show.Core.html#177" class="Field">show</a> <a id="957" href="Tactics.Eta.html#821" class="Bound">f′</a>
    <a id="964" href="Agda.Builtin.Reflection.html#8452" class="Postulate">unify</a> <a id="970" href="Tactics.Eta.html#615" class="Bound">hole</a> <a id="975" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="977" href="Data.List.Base.html#4201" class="Function">foldr</a> <a id="983" class="Symbol">(λ</a> <a id="986" href="Tactics.Eta.html#986" class="Bound">x</a> <a id="988" href="Tactics.Eta.html#988" class="Bound">t</a> <a id="990" class="Symbol">→</a> <a id="992" href="Reflection.Term.html#1852" class="InductiveConstructor Operator">Π[</a> <a id="995" class="String">&quot;_&quot;</a> <a id="999" href="Reflection.Term.html#1852" class="InductiveConstructor Operator">∶</a> <a id="1001" href="Tactics.Eta.html#986" class="Bound">x</a> <a id="1003" href="Reflection.Term.html#1852" class="InductiveConstructor Operator">]</a> <a id="1005" href="Tactics.Eta.html#988" class="Bound">t</a><a id="1006" class="Symbol">)</a> <a id="1008" href="Tactics.Eta.html#821" class="Bound">f′</a> <a id="1011" href="Tactics.Eta.html#768" class="Bound">as</a>

<a id="1015" class="Keyword">private</a>
  <a id="p"></a><a id="1025" href="Tactics.Eta.html#1025" class="Function">p</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="Agda.Primitive.html#320" class="Primitive">Set</a>
  <a id="1035" href="Tactics.Eta.html#1025" class="Function">p</a> <a id="1037" class="Symbol">=</a> <a id="1039" class="Symbol">∀</a> <a id="1041" class="Symbol">{</a><a id="1042" href="Tactics.Eta.html#1042" class="Bound">n</a><a id="1043" class="Symbol">}</a> <a id="1045" class="Symbol">→</a> <a id="1047" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1051" href="Tactics.Eta.html#1042" class="Bound">n</a>

  <a id="∀p"></a><a id="1056" href="Tactics.Eta.html#1056" class="Function">∀p</a> <a id="1059" class="Symbol">:</a> <a id="1061" class="Symbol">∀</a> <a id="1063" class="Symbol">{</a><a id="1064" href="Tactics.Eta.html#1064" class="Bound">n</a><a id="1065" class="Symbol">}</a> <a id="1067" class="Symbol">→</a> <a id="1069" href="Agda.Primitive.html#320" class="Primitive">Set</a>
  <a id="1075" href="Tactics.Eta.html#1056" class="Function">∀p</a> <a id="1078" class="Symbol">{</a><a id="1079" href="Tactics.Eta.html#1079" class="Bound">n</a><a id="1080" class="Symbol">}</a> <a id="1082" class="Symbol">=</a> <a id="1084" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1088" href="Tactics.Eta.html#1079" class="Bound">n</a>

  <a id="1093" href="Tactics.Eta.html#1093" class="Function">_</a> <a id="1095" class="Symbol">:</a> <a id="1097" href="Agda.Primitive.html#320" class="Primitive">Set</a>
  <a id="1103" class="Symbol">_</a> <a id="1105" class="Symbol">=</a> <a id="1107" href="Tactics.Eta.html#586" class="Macro">η</a> <a id="1109" href="Tactics.Eta.html#1056" class="Function">∀p</a>

  <a id="∀kp"></a><a id="1115" href="Tactics.Eta.html#1115" class="Function">∀kp</a> <a id="1119" class="Symbol">:</a> <a id="1121" class="Symbol">∀</a> <a id="1123" class="Symbol">(</a><a id="1124" href="Tactics.Eta.html#1124" class="Bound">m</a> <a id="1126" class="Symbol">:</a> <a id="1128" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1129" class="Symbol">)</a> <a id="1131" class="Symbol">{</a><a id="1132" href="Tactics.Eta.html#1132" class="Bound">n</a><a id="1133" class="Symbol">}</a> <a id="1135" class="Symbol">→</a> <a id="1137" href="Agda.Primitive.html#320" class="Primitive">Set</a>
  <a id="1143" href="Tactics.Eta.html#1115" class="Function">∀kp</a> <a id="1147" class="Symbol">_</a> <a id="1149" class="Symbol">{</a><a id="1150" href="Tactics.Eta.html#1150" class="Bound">n</a><a id="1151" class="Symbol">}</a> <a id="1153" class="Symbol">=</a> <a id="1155" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1159" href="Tactics.Eta.html#1150" class="Bound">n</a>

  <a id="1164" href="Tactics.Eta.html#1164" class="Function">_</a> <a id="1166" class="Symbol">:</a> <a id="1168" href="Agda.Primitive.html#320" class="Primitive">Set</a>
  <a id="1174" class="Symbol">_</a> <a id="1176" class="Symbol">=</a> <a id="1178" href="Tactics.Eta.html#586" class="Macro">η</a> <a id="1180" class="Symbol">(</a><a id="1181" href="Tactics.Eta.html#1115" class="Function">∀kp</a> <a id="1185" class="Number">0</a><a id="1186" class="Symbol">)</a>

  <a id="∀k2p"></a><a id="1191" href="Tactics.Eta.html#1191" class="Function">∀k2p</a> <a id="1196" class="Symbol">:</a> <a id="1198" class="Symbol">∀</a> <a id="1200" class="Symbol">(</a><a id="1201" href="Tactics.Eta.html#1201" class="Bound">m</a> <a id="1203" class="Symbol">:</a> <a id="1205" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1206" class="Symbol">)</a> <a id="1208" class="Symbol">{</a><a id="1209" href="Tactics.Eta.html#1209" class="Bound">k</a> <a id="1211" class="Symbol">:</a> <a id="1213" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1214" class="Symbol">}</a> <a id="1216" class="Symbol">{</a><a id="1217" href="Tactics.Eta.html#1217" class="Bound">n</a><a id="1218" class="Symbol">}</a> <a id="1220" class="Symbol">→</a> <a id="1222" href="Agda.Primitive.html#320" class="Primitive">Set</a>
  <a id="1228" href="Tactics.Eta.html#1191" class="Function">∀k2p</a> <a id="1233" class="Symbol">_</a> <a id="1235" class="Symbol">{</a><a id="1236" class="Argument">n</a> <a id="1238" class="Symbol">=</a> <a id="1240" href="Tactics.Eta.html#1240" class="Bound">n</a><a id="1241" class="Symbol">}</a> <a id="1243" class="Symbol">=</a> <a id="1245" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1249" href="Tactics.Eta.html#1240" class="Bound">n</a>

  <a id="1254" href="Tactics.Eta.html#1254" class="Function">_</a> <a id="1256" class="Symbol">:</a> <a id="1258" href="Agda.Primitive.html#320" class="Primitive">Set</a>
  <a id="1264" class="Symbol">_</a> <a id="1266" class="Symbol">=</a> <a id="1268" href="Tactics.Eta.html#586" class="Macro">η</a> <a id="1270" class="Symbol">(</a><a id="1271" href="Tactics.Eta.html#1191" class="Function">∀k2p</a> <a id="1276" class="Number">0</a> <a id="1278" class="Symbol">{</a><a id="1279" class="Number">1</a><a id="1280" class="Symbol">})</a>
</pre></body></html>