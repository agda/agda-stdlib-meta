<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.DecEq</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactic/Derive/DecEq.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Deriving decidable equality. This works in several cases that use</a>
<a id="70" class="Comment">-- mutual recursion, examples are at the bottom.</a>
<a id="119" class="Comment">--</a>
<a id="122" class="Comment">-- TODO: This breaks with:</a>
<a id="149" class="Comment">-- - dependent records, e.g. Product</a>
<a id="186" class="Comment">-- - anything listed in Tactic.Derive</a>
<a id="224" class="Comment">-- - maybe more</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">-v</a> <a id="256" class="Pragma">allTactics:100</a> <a id="271" class="Symbol">#-}</a>
<a id="275" class="Symbol">{-#</a> <a id="279" class="Keyword">OPTIONS</a> <a id="287" class="Pragma">--safe</a> <a id="294" class="Symbol">#-}</a>
<a id="298" class="Keyword">module</a> <a id="305" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a> <a id="325" class="Keyword">where</a>

<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Prelude.html" class="Module">Prelude</a>
<a id="352" class="Keyword">open</a> <a id="357" class="Keyword">import</a> <a id="364" href="Meta.html" class="Module">Meta</a>

<a id="370" class="Keyword">import</a> <a id="377" href="Data.List.html" class="Module">Data.List</a> <a id="387" class="Symbol">as</a> <a id="390" class="Module">L</a>
<a id="392" class="Keyword">import</a> <a id="399" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="418" class="Symbol">as</a> <a id="421" class="Module">NE</a>

<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Relation.Nullary.Product.html" class="Module">Relation.Nullary.Product</a>

<a id="531" class="Keyword">open</a> <a id="536" class="Keyword">import</a> <a id="543" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="Reflection.Term.html" class="Module">Reflection.Term</a> <a id="589" class="Keyword">using</a> <a id="595" class="Symbol">(</a><a id="596" href="Reflection.Term.html#4619" class="Function Operator">_≟-Pattern_</a><a id="607" class="Symbol">)</a>
<a id="609" class="Keyword">open</a> <a id="614" class="Keyword">import</a> <a id="621" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="638" class="Keyword">open</a> <a id="643" class="Keyword">import</a> <a id="650" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>

<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Class.DecEq.Core.html" class="Module">Class.DecEq.Core</a>
<a id="701" class="Keyword">open</a> <a id="706" class="Keyword">import</a> <a id="713" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="751" class="Keyword">open</a> <a id="756" class="Keyword">import</a> <a id="763" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="787" class="Keyword">open</a> <a id="792" class="Keyword">import</a> <a id="799" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="818" class="Keyword">open</a> <a id="823" class="Keyword">import</a> <a id="830" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="851" class="Keyword">open</a> <a id="856" class="Keyword">import</a> <a id="863" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="877" class="Symbol">(</a><a id="878" class="Keyword">quote</a> <a id="884" href="Class.DecEq.Core.html#66" class="Record">DecEq</a><a id="889" class="Symbol">)</a> <a id="891" class="Symbol">(</a><a id="892" class="Keyword">quote</a> <a id="898" href="Class.DecEq.Core.html#108" class="Field Operator">_≟_</a><a id="901" class="Symbol">)</a>

<a id="904" class="Keyword">instance</a>
  <a id="915" href="Tactic.Derive.DecEq.html#915" class="Function">_</a> <a id="917" class="Symbol">=</a> <a id="919" href="Tactic.ClauseBuilder.html#10741" class="Function">ContextMonad-MonadTC</a>

<a id="941" class="Keyword">open</a> <a id="946" href="Tactic.ClauseBuilder.html#10971" class="Module">ClauseExprM</a>

<a id="`yes"></a><a id="959" href="Tactic.Derive.DecEq.html#959" class="Function">`yes</a> <a id="`no"></a><a id="964" href="Tactic.Derive.DecEq.html#964" class="Function">`no</a> <a id="968" class="Symbol">:</a> <a id="970" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="975" class="Symbol">→</a> <a id="977" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="982" href="Tactic.Derive.DecEq.html#959" class="Function">`yes</a> <a id="987" href="Tactic.Derive.DecEq.html#987" class="Bound">x</a> <a id="989" class="Symbol">=</a> <a id="991" class="Keyword">quote</a> <a id="997" href="Relation.Nullary.html#1568" class="InductiveConstructor Operator">_because_</a> <a id="1007" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">◆⟦</a> <a id="1010" class="Keyword">quote</a> <a id="1016" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>  <a id="1022" href="Reflection.Syntax.html#2841" class="InductiveConstructor Operator">◆</a> <a id="1024" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">∣</a> <a id="1026" class="Keyword">quote</a> <a id="1032" href="Relation.Nullary.html#911" class="InductiveConstructor">ofʸ</a> <a id="1036" href="Reflection.Syntax.html#2865" class="InductiveConstructor Operator">◆⟦</a> <a id="1039" href="Tactic.Derive.DecEq.html#987" class="Bound">x</a> <a id="1041" href="Reflection.Syntax.html#2865" class="InductiveConstructor Operator">⟧</a> <a id="1043" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">⟧</a>
<a id="1045" href="Tactic.Derive.DecEq.html#964" class="Function">`no</a>  <a id="1050" href="Tactic.Derive.DecEq.html#1050" class="Bound">x</a> <a id="1052" class="Symbol">=</a> <a id="1054" class="Keyword">quote</a> <a id="1060" href="Relation.Nullary.html#1568" class="InductiveConstructor Operator">_because_</a> <a id="1070" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">◆⟦</a> <a id="1073" class="Keyword">quote</a> <a id="1079" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> <a id="1085" href="Reflection.Syntax.html#2841" class="InductiveConstructor Operator">◆</a> <a id="1087" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">∣</a> <a id="1089" class="Keyword">quote</a> <a id="1095" href="Relation.Nullary.html#948" class="InductiveConstructor">ofⁿ</a> <a id="1099" href="Reflection.Syntax.html#2865" class="InductiveConstructor Operator">◆⟦</a> <a id="1102" href="Tactic.Derive.DecEq.html#1050" class="Bound">x</a> <a id="1104" href="Reflection.Syntax.html#2865" class="InductiveConstructor Operator">⟧</a> <a id="1106" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">⟧</a>

<a id="map&#39;"></a><a id="1109" href="Tactic.Derive.DecEq.html#1109" class="Function">map&#39;</a> <a id="1114" class="Symbol">:</a> <a id="1116" class="Symbol">∀</a> <a id="1118" class="Symbol">{</a><a id="1119" href="Tactic.Derive.DecEq.html#1119" class="Bound">p</a> <a id="1121" href="Tactic.Derive.DecEq.html#1121" class="Bound">q</a><a id="1122" class="Symbol">}</a> <a id="1124" class="Symbol">{</a><a id="1125" href="Tactic.Derive.DecEq.html#1125" class="Bound">P</a> <a id="1127" class="Symbol">:</a> <a id="1129" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1133" href="Tactic.Derive.DecEq.html#1119" class="Bound">p</a><a id="1134" class="Symbol">}</a> <a id="1136" class="Symbol">{</a><a id="1137" href="Tactic.Derive.DecEq.html#1137" class="Bound">Q</a> <a id="1139" class="Symbol">:</a> <a id="1141" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1145" href="Tactic.Derive.DecEq.html#1121" class="Bound">q</a><a id="1146" class="Symbol">}</a> <a id="1148" class="Symbol">→</a> <a id="1150" href="Tactic.Derive.DecEq.html#1125" class="Bound">P</a> <a id="1152" href="Function.Bundles.html#8518" class="Function Operator">⇔</a> <a id="1154" href="Tactic.Derive.DecEq.html#1137" class="Bound">Q</a> <a id="1156" class="Symbol">→</a> <a id="1158" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="1162" href="Tactic.Derive.DecEq.html#1125" class="Bound">P</a> <a id="1164" class="Symbol">→</a> <a id="1166" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="1170" href="Tactic.Derive.DecEq.html#1137" class="Bound">Q</a>
<a id="1172" href="Tactic.Derive.DecEq.html#1109" class="Function">map&#39;</a> <a id="1177" class="Keyword">record</a> <a id="1184" class="Symbol">{</a> <a id="1186" href="Function.Bundles.html#4236" class="Field">f</a> <a id="1188" class="Symbol">=</a> <a id="1190" href="Tactic.Derive.DecEq.html#1190" class="Bound">f</a> <a id="1192" class="Symbol">;</a> <a id="1194" href="Function.Bundles.html#4256" class="Field">g</a> <a id="1196" class="Symbol">=</a> <a id="1198" href="Tactic.Derive.DecEq.html#1198" class="Bound">g</a> <a id="1200" class="Symbol">}</a> <a id="1202" class="Symbol">=</a> <a id="1204" href="Relation.Nullary.Decidable.Core.html#3645" class="Function">map′</a> <a id="1209" href="Tactic.Derive.DecEq.html#1190" class="Bound">f</a> <a id="1211" href="Tactic.Derive.DecEq.html#1198" class="Bound">g</a>

<a id="1214" class="Keyword">module</a> <a id="1221" href="Tactic.Derive.DecEq.html#1221" class="Module">_</a> <a id="1223" class="Symbol">(</a><a id="1224" href="Tactic.Derive.DecEq.html#1224" class="Bound">transName</a> <a id="1234" class="Symbol">:</a> <a id="1236" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1241" class="Symbol">→</a> <a id="1243" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1249" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="1253" class="Symbol">)</a> <a id="1255" class="Keyword">where</a>

  <a id="1264" href="Tactic.Derive.DecEq.html#1264" class="Function">eqFromTerm</a> <a id="1275" class="Symbol">:</a> <a id="1277" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1282" class="Symbol">→</a> <a id="1284" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1289" class="Symbol">→</a> <a id="1291" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1296" class="Symbol">→</a> <a id="1298" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="1305" href="Tactic.Derive.DecEq.html#1264" class="Function">eqFromTerm</a> <a id="1316" class="Symbol">(</a><a id="1317" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="1321" href="Tactic.Derive.DecEq.html#1321" class="Bound">n</a> <a id="1323" class="Symbol">_)</a> <a id="1326" href="Tactic.Derive.DecEq.html#1326" class="Bound">t</a> <a id="1328" href="Tactic.Derive.DecEq.html#1328" class="Bound">t&#39;</a> <a id="1331" class="Keyword">with</a> <a id="1336" href="Tactic.Derive.DecEq.html#1224" class="Bound">transName</a> <a id="1346" href="Tactic.Derive.DecEq.html#1321" class="Bound">n</a>
  <a id="1350" class="Symbol">...</a> <a id="1354" class="Symbol">|</a> <a id="1356" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1361" href="Tactic.Derive.DecEq.html#1361" class="Bound">n&#39;</a>     <a id="1368" class="Symbol">=</a> <a id="1370" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="1374" class="Symbol">(</a><a id="1375" class="Keyword">quote</a> <a id="1381" href="Class.DecEq.Core.html#108" class="Field Operator">_≟_</a><a id="1384" class="Symbol">)</a> <a id="1386" class="Symbol">(</a><a id="1387" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="1392" class="Symbol">(</a><a id="1393" href="Tactic.Derive.DecEq.html#1361" class="Bound">n&#39;</a> <a id="1396" href="Reflection.Syntax.html#2578" class="InductiveConstructor Operator">∙</a><a id="1397" class="Symbol">)</a> <a id="1399" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1401" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="1406" class="Bound">t</a> <a id="1408" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1410" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="1415" class="Bound">t&#39;</a> <a id="1418" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1420" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1422" class="Symbol">)</a>
  <a id="1426" class="Symbol">...</a> <a id="1430" class="Symbol">|</a> <a id="1432" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>     <a id="1444" class="Symbol">=</a> <a id="1446" class="Keyword">quote</a> <a id="1452" href="Class.DecEq.Core.html#108" class="Field Operator">_≟_</a> <a id="1456" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∙⟦</a> <a id="1459" class="Bound">t</a> <a id="1461" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∣</a> <a id="1463" class="Bound">t&#39;</a> <a id="1466" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">⟧</a>
  <a id="1470" href="Tactic.Derive.DecEq.html#1264" class="CatchallClause Function">eqFromTerm</a><a id="1480" class="CatchallClause"> </a><a id="1481" class="CatchallClause Symbol">_</a><a id="1482" class="CatchallClause"> </a><a id="1483" href="Tactic.Derive.DecEq.html#1483" class="CatchallClause Bound">t</a><a id="1484" class="CatchallClause"> </a><a id="1485" href="Tactic.Derive.DecEq.html#1485" class="CatchallClause Bound">t&#39;</a> <a id="1488" class="Symbol">=</a> <a id="1490" class="Keyword">quote</a> <a id="1496" href="Class.DecEq.Core.html#108" class="Field Operator">_≟_</a> <a id="1500" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∙⟦</a> <a id="1503" href="Tactic.Derive.DecEq.html#1483" class="Bound">t</a> <a id="1505" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∣</a> <a id="1507" href="Tactic.Derive.DecEq.html#1485" class="Bound">t&#39;</a> <a id="1510" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">⟧</a>

  <a id="1515" href="Tactic.Derive.DecEq.html#1515" class="Function">toDecEqName</a> <a id="1527" class="Symbol">:</a> <a id="1529" href="Tactic.ClauseBuilder.html#1322" class="Function">SinglePattern</a> <a id="1543" class="Symbol">→</a> <a id="1545" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1550" class="Symbol">(</a><a id="1551" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1556" class="Symbol">→</a> <a id="1558" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1563" class="Symbol">→</a> <a id="1565" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="1569" class="Symbol">)</a>
  <a id="1573" href="Tactic.Derive.DecEq.html#1515" class="Function">toDecEqName</a> <a id="1585" class="Symbol">(</a><a id="1586" href="Tactic.Derive.DecEq.html#1586" class="Bound">l</a> <a id="1588" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1590" class="Symbol">_)</a> <a id="1593" class="Symbol">=</a> <a id="1595" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1601" class="Symbol">(λ</a> <a id="1604" class="Keyword">where</a> <a id="1610" class="Symbol">(_</a> <a id="1613" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1615" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1619" class="Symbol">_</a> <a id="1621" href="Tactic.Derive.DecEq.html#1621" class="Bound">t</a><a id="1622" class="Symbol">)</a> <a id="1624" class="Symbol">→</a> <a id="1626" href="Tactic.Derive.DecEq.html#1264" class="Function">eqFromTerm</a> <a id="1637" href="Tactic.Derive.DecEq.html#1621" class="Bound">t</a><a id="1638" class="Symbol">)</a> <a id="1640" href="Tactic.Derive.DecEq.html#1586" class="Bound">l</a>

  <a id="1645" class="Comment">-- on the diagonal we have one pattern, outside we don&#39;t care</a>
  <a id="1709" class="Comment">-- assume that the types in the pattern are properly normalized</a>
  <a id="1775" href="Tactic.Derive.DecEq.html#1775" class="Function">mapDiag</a> <a id="1783" class="Symbol">:</a> <a id="1785" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1791" href="Tactic.ClauseBuilder.html#1322" class="Function">SinglePattern</a> <a id="1805" class="Symbol">→</a> <a id="1807" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1810" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="1817" href="Tactic.Derive.DecEq.html#1775" class="Function">mapDiag</a> <a id="1825" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>          <a id="1842" class="Symbol">=</a> <a id="1844" href="Class.Monad.Core.html#241" class="Field">return</a> <a id="1851" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1853" href="Tactic.Derive.DecEq.html#964" class="Function">`no</a> <a id="1857" href="Reflection.Syntax.html#2163" class="InductiveConstructor Operator">`λ⦅</a> <a id="1861" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1863" class="Symbol">(</a><a id="1864" class="String">&quot;&quot;</a> <a id="1867" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1869" href="Reflection.Syntax.html#1059" class="InductiveConstructor">vArg?</a><a id="1874" class="Symbol">)</a> <a id="1876" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1878" href="Reflection.Syntax.html#2163" class="InductiveConstructor Operator">⦆∅</a>
  <a id="1883" href="Tactic.Derive.DecEq.html#1775" class="Function">mapDiag</a> <a id="1891" class="Symbol">(</a><a id="1892" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1897" href="Tactic.Derive.DecEq.html#1897" class="Bound">p</a><a id="1898" class="Symbol">@(</a><a id="1900" href="Tactic.Derive.DecEq.html#1900" class="Bound">l</a> <a id="1902" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1904" class="Symbol">_))</a> <a id="1908" class="Symbol">=</a> <a id="1910" class="Keyword">let</a> <a id="1914" href="Tactic.Derive.DecEq.html#1914" class="Bound">k</a> <a id="1916" class="Symbol">=</a> <a id="1918" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1925" href="Tactic.Derive.DecEq.html#1900" class="Bound">l</a> <a id="1927" class="Keyword">in</a> <a id="1930" class="Keyword">do</a>
    <a id="1937" href="Tactic.Derive.DecEq.html#1937" class="Bound">typeList</a> <a id="1946" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="1948" href="Class.Traversable.Core.html#260" class="Function">traverse</a> <a id="1957" class="Symbol">⦃</a> <a id="1959" href="Class.Functor.Instances.html#408" class="Function">Functor-List</a> <a id="1972" class="Symbol">⦄</a> <a id="1974" href="Class.MonadTC.html#1753" class="Field">inferType</a> <a id="1984" class="Symbol">(</a><a id="1985" href="Data.List.Base.html#5874" class="Function">applyDownFrom</a> <a id="1999" href="Reflection.Syntax.html#1131" class="InductiveConstructor">♯</a> <a id="2001" class="Symbol">(</a><a id="2002" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2009" href="Tactic.Derive.DecEq.html#1900" class="Bound">l</a><a id="2010" class="Symbol">))</a>
    <a id="2017" href="Class.Monad.Core.html#241" class="Field">return</a> <a id="2024" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2026" class="Keyword">quote</a> <a id="2032" href="Tactic.Derive.DecEq.html#1109" class="Function">map&#39;</a> <a id="2037" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∙⟦</a> <a id="2040" href="Tactic.Derive.DecEq.html#2346" class="Function">genEquiv</a> <a id="2049" href="Tactic.Derive.DecEq.html#1914" class="Bound">k</a> <a id="2051" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∣</a> <a id="2053" href="Tactic.Derive.DecEq.html#2107" class="Function">genPf</a> <a id="2059" href="Tactic.Derive.DecEq.html#1914" class="Bound">k</a> <a id="2061" class="Symbol">(</a><a id="2062" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="2068" href="Tactic.Derive.DecEq.html#1264" class="Function">eqFromTerm</a> <a id="2079" href="Tactic.Derive.DecEq.html#1937" class="Bound">typeList</a><a id="2087" class="Symbol">)</a> <a id="2089" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">⟧</a>
    <a id="2095" class="Keyword">where</a>
      <a id="2107" href="Tactic.Derive.DecEq.html#2107" class="Function">genPf</a> <a id="2113" class="Symbol">:</a> <a id="2115" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2117" class="Symbol">→</a> <a id="2119" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2124" class="Symbol">(</a><a id="2125" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="2130" class="Symbol">→</a> <a id="2132" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="2137" class="Symbol">→</a> <a id="2139" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="2143" class="Symbol">)</a> <a id="2145" class="Symbol">→</a> <a id="2147" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
      <a id="2158" href="Tactic.Derive.DecEq.html#2107" class="Function">genPf</a> <a id="2164" href="Tactic.Derive.DecEq.html#2164" class="Bound">k</a> <a id="2166" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>      <a id="2174" class="Symbol">=</a> <a id="2176" href="Tactic.Derive.DecEq.html#959" class="Function">`yes</a> <a id="2181" class="Symbol">(</a><a id="2182" class="Keyword">quote</a> <a id="2188" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a> <a id="2191" href="Reflection.Syntax.html#2841" class="InductiveConstructor Operator">◆</a><a id="2192" class="Symbol">)</a>
      <a id="2200" href="Tactic.Derive.DecEq.html#2107" class="Function">genPf</a> <a id="2206" href="Tactic.Derive.DecEq.html#2206" class="Bound">k</a> <a id="2208" class="Symbol">(</a><a id="2209" href="Tactic.Derive.DecEq.html#2209" class="Bound">n</a> <a id="2211" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2213" href="Tactic.Derive.DecEq.html#2213" class="Bound">l</a><a id="2214" class="Symbol">)</a> <a id="2216" class="Symbol">=</a> <a id="2218" class="Keyword">quote</a> <a id="2224" href="Relation.Nullary.Product.html#930" class="Function Operator">_×-dec_</a> <a id="2232" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∙⟦</a> <a id="2235" href="Tactic.Derive.DecEq.html#2107" class="Function">genPf</a> <a id="2241" href="Tactic.Derive.DecEq.html#2206" class="Bound">k</a> <a id="2243" href="Tactic.Derive.DecEq.html#2213" class="Bound">l</a> <a id="2245" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∣</a> <a id="2247" href="Tactic.Derive.DecEq.html#2209" class="Bound">n</a> <a id="2249" class="Symbol">(</a><a id="2250" href="Reflection.Syntax.html#1131" class="InductiveConstructor">♯</a> <a id="2252" class="Symbol">(</a><a id="2253" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2260" href="Tactic.Derive.DecEq.html#2213" class="Bound">l</a><a id="2261" class="Symbol">))</a> <a id="2264" class="Symbol">(</a><a id="2265" href="Reflection.Syntax.html#1131" class="InductiveConstructor">♯</a> <a id="2267" class="Symbol">(</a><a id="2268" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2275" href="Tactic.Derive.DecEq.html#2213" class="Bound">l</a> <a id="2277" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="2279" href="Tactic.Derive.DecEq.html#2206" class="Bound">k</a><a id="2280" class="Symbol">))</a> <a id="2283" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">⟧</a>

      <a id="2292" class="Comment">-- c x1 .. xn ≡ c y1 .. yn ⇔ x1 ≡ y1 .. xn ≡ yn</a>
      <a id="2346" href="Tactic.Derive.DecEq.html#2346" class="Function">genEquiv</a> <a id="2355" class="Symbol">:</a> <a id="2357" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2359" class="Symbol">→</a> <a id="2361" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
      <a id="2372" href="Tactic.Derive.DecEq.html#2346" class="Function">genEquiv</a> <a id="2381" href="Tactic.Derive.DecEq.html#2381" class="Bound">n</a> <a id="2383" class="Symbol">=</a> <a id="2385" class="Keyword">quote</a> <a id="2391" href="Function.Bundles.html#9622" class="Function">mk⇔</a> <a id="2395" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∙⟦</a> <a id="2398" href="Reflection.Syntax.html#2250" class="InductiveConstructor Operator">`λ⟦</a> <a id="2402" href="Tactic.Derive.DecEq.html#2493" class="Function">reflPattern</a> <a id="2414" href="Tactic.Derive.DecEq.html#2381" class="Bound">n</a> <a id="2416" href="Reflection.Syntax.html#2250" class="InductiveConstructor Operator">⇒</a> <a id="2418" class="Keyword">quote</a> <a id="2424" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2429" href="Reflection.Syntax.html#2841" class="InductiveConstructor Operator">◆</a> <a id="2431" href="Reflection.Syntax.html#2250" class="InductiveConstructor Operator">⟧</a> <a id="2433" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">∣</a> <a id="2435" href="Reflection.Syntax.html#2250" class="InductiveConstructor Operator">`λ⟦</a> <a id="2439" class="Keyword">quote</a> <a id="2445" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2450" href="Reflection.Syntax.html#2959" class="InductiveConstructor Operator">◇</a> <a id="2452" href="Reflection.Syntax.html#2250" class="InductiveConstructor Operator">⇒</a> <a id="2454" href="Tactic.Derive.DecEq.html#2649" class="Function">reflTerm</a> <a id="2463" href="Tactic.Derive.DecEq.html#2381" class="Bound">n</a> <a id="2465" href="Reflection.Syntax.html#2250" class="InductiveConstructor Operator">⟧</a> <a id="2467" href="Reflection.Syntax.html#2642" class="InductiveConstructor Operator">⟧</a>
        <a id="2477" class="Keyword">where</a>
          <a id="2493" href="Tactic.Derive.DecEq.html#2493" class="Function">reflPattern</a> <a id="2505" class="Symbol">:</a> <a id="2507" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2509" class="Symbol">→</a> <a id="2511" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
          <a id="2529" href="Tactic.Derive.DecEq.html#2493" class="Function">reflPattern</a> <a id="2541" class="Number">0</a>       <a id="2549" class="Symbol">=</a> <a id="2551" class="Keyword">quote</a> <a id="2557" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a> <a id="2560" href="Reflection.Syntax.html#2959" class="InductiveConstructor Operator">◇</a>
          <a id="2572" href="Tactic.Derive.DecEq.html#2493" class="Function">reflPattern</a> <a id="2584" class="Symbol">(</a><a id="2585" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2589" href="Tactic.Derive.DecEq.html#2589" class="Bound">n</a><a id="2590" class="Symbol">)</a> <a id="2592" class="Symbol">=</a> <a id="2594" class="Keyword">quote</a> <a id="2600" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,_</a> <a id="2604" href="Reflection.Syntax.html#3039" class="InductiveConstructor Operator">◇⟦</a> <a id="2607" href="Tactic.Derive.DecEq.html#2493" class="Function">reflPattern</a> <a id="2619" href="Tactic.Derive.DecEq.html#2589" class="Bound">n</a> <a id="2621" href="Reflection.Syntax.html#3039" class="InductiveConstructor Operator">∣</a> <a id="2623" class="Keyword">quote</a> <a id="2629" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2634" href="Reflection.Syntax.html#2959" class="InductiveConstructor Operator">◇</a> <a id="2636" href="Reflection.Syntax.html#3039" class="InductiveConstructor Operator">⟧</a>

          <a id="2649" href="Tactic.Derive.DecEq.html#2649" class="Function">reflTerm</a> <a id="2658" class="Symbol">:</a> <a id="2660" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2662" class="Symbol">→</a> <a id="2664" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
          <a id="2679" href="Tactic.Derive.DecEq.html#2649" class="Function">reflTerm</a> <a id="2688" class="Number">0</a>       <a id="2696" class="Symbol">=</a> <a id="2698" class="Keyword">quote</a> <a id="2704" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a> <a id="2707" href="Reflection.Syntax.html#2841" class="InductiveConstructor Operator">◆</a>
          <a id="2719" href="Tactic.Derive.DecEq.html#2649" class="Function">reflTerm</a> <a id="2728" class="Symbol">(</a><a id="2729" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2733" href="Tactic.Derive.DecEq.html#2733" class="Bound">n</a><a id="2734" class="Symbol">)</a> <a id="2736" class="Symbol">=</a> <a id="2738" class="Keyword">quote</a> <a id="2744" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,_</a> <a id="2748" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">◆⟦</a> <a id="2751" href="Tactic.Derive.DecEq.html#2649" class="Function">reflTerm</a> <a id="2760" href="Tactic.Derive.DecEq.html#2733" class="Bound">n</a> <a id="2762" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">∣</a> <a id="2764" class="Keyword">quote</a> <a id="2770" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2775" href="Reflection.Syntax.html#2841" class="InductiveConstructor Operator">◆</a> <a id="2777" href="Reflection.Syntax.html#2905" class="InductiveConstructor Operator">⟧</a>

  <a id="2782" href="Tactic.Derive.DecEq.html#2782" class="Function">toMapDiag</a> <a id="2792" class="Symbol">:</a> <a id="2794" href="Tactic.ClauseBuilder.html#1322" class="Function">SinglePattern</a> <a id="2808" class="Symbol">→</a> <a id="2810" href="Tactic.ClauseBuilder.html#1322" class="Function">SinglePattern</a> <a id="2824" class="Symbol">→</a> <a id="2826" href="Data.List.NonEmpty.Base.html#1088" class="Record">NE.List⁺</a> <a id="2835" href="Tactic.ClauseBuilder.html#1322" class="Function">SinglePattern</a> <a id="2849" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2851" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="2854" class="Symbol">(</a><a id="2855" href="Tactic.ClauseBuilder.html#5826" class="Datatype">ClauseExpr</a> <a id="2866" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="2868" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2874" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="2878" class="Symbol">)</a>
  <a id="2882" href="Tactic.Derive.DecEq.html#2782" class="Function">toMapDiag</a> <a id="2892" href="Tactic.Derive.DecEq.html#2892" class="Bound">p</a><a id="2893" class="Symbol">@(_</a> <a id="2897" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2899" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2903" class="Symbol">_</a> <a id="2905" href="Tactic.Derive.DecEq.html#2905" class="Bound">p₁</a><a id="2907" class="Symbol">)</a> <a id="2909" href="Tactic.Derive.DecEq.html#2909" class="Bound">p&#39;</a><a id="2911" class="Symbol">@(_</a> <a id="2915" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2917" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2921" class="Symbol">_</a> <a id="2923" href="Tactic.Derive.DecEq.html#2923" class="Bound">p₂</a><a id="2925" class="Symbol">)</a> <a id="2927" class="Symbol">=</a>
    <a id="2933" class="Symbol">(</a><a id="2934" href="Tactic.Derive.DecEq.html#2892" class="Bound">p</a> <a id="2936" href="Data.List.NonEmpty.Base.html#1134" class="InductiveConstructor Operator">NE.∷</a> <a id="2941" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2943" href="Tactic.Derive.DecEq.html#2909" class="Bound">p&#39;</a> <a id="2946" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="2948" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2950" href="Tactic.ClauseBuilder.html#12911" class="Function">finishMatch</a> <a id="2962" class="Symbol">(</a><a id="2963" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2966" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="2968" href="Tactic.Derive.DecEq.html#2905" class="Bound">p₁</a> <a id="2971" href="Reflection.Term.html#4619" class="Function Operator">≟-Pattern</a> <a id="2981" href="Tactic.Derive.DecEq.html#2923" class="Bound">p₂</a> <a id="2984" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a> <a id="2986" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="2991" href="Tactic.Derive.DecEq.html#1775" class="Function">mapDiag</a> <a id="2999" class="Symbol">(</a><a id="3000" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3005" href="Tactic.Derive.DecEq.html#2892" class="Bound">p</a><a id="3006" class="Symbol">)</a> <a id="3008" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="3013" href="Tactic.Derive.DecEq.html#1775" class="Function">mapDiag</a> <a id="3021" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a><a id="3028" class="Symbol">))</a>

<a id="3032" class="Keyword">module</a> <a id="3039" href="Tactic.Derive.DecEq.html#3039" class="Module">_</a> <a id="3041" class="Symbol">⦃</a> <a id="3043" href="Tactic.Derive.DecEq.html#3043" class="Bound">_</a> <a id="3045" class="Symbol">:</a> <a id="3047" href="Class.MonadTC.html#621" class="Record">TCOptions</a> <a id="3057" class="Symbol">⦄</a> <a id="3059" class="Keyword">where</a>
  <a id="3067" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="3080" class="Symbol">:</a> <a id="3082" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3087" class="Symbol">(</a><a id="3088" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3093" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3095" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="3099" class="Symbol">)</a> <a id="3101" class="Symbol">→</a> <a id="3103" href="Reflection.Tactic.html#508" class="Function">UnquoteDecl</a>
  <a id="3117" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="3130" class="Symbol">=</a> <a id="3132" href="Tactic.Derive.html#4940" class="Function">derive-Class</a> <a id="3145" class="Number">0</a> <a id="3147" class="Symbol">(λ</a> <a id="3150" href="Tactic.Derive.DecEq.html#3150" class="Bound">transName</a> <a id="3160" href="Tactic.Derive.DecEq.html#3160" class="Bound">ps</a> <a id="3163" class="Symbol">→</a> <a id="3165" href="Data.List.Base.html#2217" class="Function">cartesianProductWith</a> <a id="3186" class="Symbol">(</a><a id="3187" href="Tactic.Derive.DecEq.html#2782" class="Function">toMapDiag</a> <a id="3197" href="Tactic.Derive.DecEq.html#3150" class="Bound">transName</a><a id="3206" class="Symbol">)</a> <a id="3208" href="Tactic.Derive.DecEq.html#3160" class="Bound">ps</a> <a id="3211" href="Tactic.Derive.DecEq.html#3160" class="Bound">ps</a><a id="3213" class="Symbol">)</a>

<a id="3216" class="Keyword">private</a>
  <a id="3226" class="Keyword">open</a> <a id="3231" class="Keyword">import</a> <a id="3238" href="Tactic.Derive.TestTypes.html" class="Module">Tactic.Derive.TestTypes</a>
  <a id="3264" class="Keyword">open</a> <a id="3269" class="Keyword">import</a> <a id="3276" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

  <a id="3295" class="Keyword">unquoteDecl</a> <a id="DecEq-These"></a><a id="3307" href="Tactic.Derive.DecEq.html#3307" class="Function">DecEq-These</a> <a id="3319" class="Symbol">=</a> <a id="3321" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="3334" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3336" class="Symbol">(</a><a id="3337" class="Keyword">quote</a> <a id="3343" href="Data.These.Base.html#537" class="Datatype">These</a> <a id="3349" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3351" href="Tactic.Derive.DecEq.html#3307" class="Function">DecEq-These</a><a id="3362" class="Symbol">)</a> <a id="3364" href="Data.List.Base.html#5034" class="Function Operator">]</a>

  <a id="3369" class="Keyword">unquoteDecl</a> <a id="DecEq-⊎"></a><a id="3381" href="Tactic.Derive.DecEq.html#3381" class="Function">DecEq-⊎</a> <a id="3389" class="Symbol">=</a> <a id="3391" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="3404" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3406" class="Symbol">(</a><a id="3407" class="Keyword">quote</a> <a id="3413" href="Data.Sum.Base.html#743" class="Datatype Operator">_⊎_</a> <a id="3417" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3419" href="Tactic.Derive.DecEq.html#3381" class="Function">DecEq-⊎</a><a id="3426" class="Symbol">)</a> <a id="3428" href="Data.List.Base.html#5034" class="Function Operator">]</a>

  <a id="3433" class="Keyword">unquoteDecl</a> <a id="DecEq-Bool"></a><a id="3445" href="Tactic.Derive.DecEq.html#3445" class="Function">DecEq-Bool</a> <a id="DecEq-ℤ"></a><a id="3456" href="Tactic.Derive.DecEq.html#3456" class="Function">DecEq-ℤ</a> <a id="DecEq-List"></a><a id="3464" href="Tactic.Derive.DecEq.html#3464" class="Function">DecEq-List</a> <a id="DecEq-Maybe"></a><a id="3475" href="Tactic.Derive.DecEq.html#3475" class="Function">DecEq-Maybe</a> <a id="DecEq-ℕ"></a><a id="3487" href="Tactic.Derive.DecEq.html#3487" class="Function">DecEq-ℕ</a> <a id="DecEq-Sign"></a><a id="3495" href="Tactic.Derive.DecEq.html#3495" class="Function">DecEq-Sign</a> <a id="DecEq-⊤"></a><a id="3506" href="Tactic.Derive.DecEq.html#3506" class="Function">DecEq-⊤</a> <a id="3514" class="Symbol">=</a> <a id="3516" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="3529" class="Symbol">((</a><a id="3531" class="Keyword">quote</a> <a id="3537" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a> <a id="3542" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3544" href="Tactic.Derive.DecEq.html#3445" class="Function">DecEq-Bool</a><a id="3554" class="Symbol">)</a> <a id="3556" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3558" class="Symbol">(</a><a id="3559" class="Keyword">quote</a> <a id="3565" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="3567" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3569" href="Tactic.Derive.DecEq.html#3456" class="Function">DecEq-ℤ</a><a id="3576" class="Symbol">)</a> <a id="3578" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3580" class="Symbol">(</a><a id="3581" class="Keyword">quote</a> <a id="3587" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3592" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3594" href="Tactic.Derive.DecEq.html#3464" class="Function">DecEq-List</a><a id="3604" class="Symbol">)</a> <a id="3606" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3608" class="Symbol">(</a><a id="3609" class="Keyword">quote</a> <a id="3615" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3621" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3623" href="Tactic.Derive.DecEq.html#3475" class="Function">DecEq-Maybe</a><a id="3634" class="Symbol">)</a> <a id="3636" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3638" class="Symbol">(</a><a id="3639" class="Keyword">quote</a> <a id="3645" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="3647" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3649" href="Tactic.Derive.DecEq.html#3487" class="Function">DecEq-ℕ</a><a id="3656" class="Symbol">)</a> <a id="3658" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3660" class="Symbol">(</a><a id="3661" class="Keyword">quote</a> <a id="3667" href="Data.Sign.Base.html#516" class="Datatype">Sign</a> <a id="3672" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3674" href="Tactic.Derive.DecEq.html#3495" class="Function">DecEq-Sign</a><a id="3684" class="Symbol">)</a> <a id="3686" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3688" class="Symbol">(</a><a id="3689" class="Keyword">quote</a> <a id="3695" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a> <a id="3697" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3699" href="Tactic.Derive.DecEq.html#3506" class="Function">DecEq-⊤</a><a id="3706" class="Symbol">)</a> <a id="3708" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3710" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="3712" class="Symbol">)</a>

  <a id="3717" class="Keyword">unquoteDecl</a> <a id="DecEq-Fin"></a><a id="3729" href="Tactic.Derive.DecEq.html#3729" class="Function">DecEq-Fin</a> <a id="3739" class="Symbol">=</a> <a id="3741" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="3754" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3756" class="Symbol">(</a><a id="3757" class="Keyword">quote</a> <a id="3763" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="3767" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3769" href="Tactic.Derive.DecEq.html#3729" class="Function">DecEq-Fin</a><a id="3778" class="Symbol">)</a> <a id="3780" href="Data.List.Base.html#5034" class="Function Operator">]</a>

  <a id="3785" class="Comment">-- this doesn&#39;t work since the clause builder machinery doesn&#39;t deal</a>
  <a id="3856" class="Comment">-- with absurd patterns yet</a>

  <a id="3887" class="Comment">--unquoteDecl DecEq-Vec = derive-DecEq [ (quote Vec , DecEq-Vec) ]</a>

  <a id="3957" class="Keyword">unquoteDecl</a> <a id="DecEq-E1"></a><a id="3969" href="Tactic.Derive.DecEq.html#3969" class="Function">DecEq-E1</a> <a id="3978" class="Symbol">=</a> <a id="3980" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="3993" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3995" class="Symbol">(</a><a id="3996" class="Keyword">quote</a> <a id="4002" href="Tactic.Derive.TestTypes.html#193" class="Datatype">E1</a> <a id="4005" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4007" href="Tactic.Derive.DecEq.html#3969" class="Function">DecEq-E1</a><a id="4015" class="Symbol">)</a> <a id="4017" href="Data.List.Base.html#5034" class="Function Operator">]</a>
  <a id="4021" class="Keyword">unquoteDecl</a> <a id="DecEq-E2"></a><a id="4033" href="Tactic.Derive.DecEq.html#4033" class="Function">DecEq-E2</a> <a id="4042" class="Symbol">=</a> <a id="4044" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="4057" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4059" class="Symbol">(</a><a id="4060" class="Keyword">quote</a> <a id="4066" href="Tactic.Derive.TestTypes.html#298" class="Datatype">E2</a> <a id="4069" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4071" href="Tactic.Derive.DecEq.html#4033" class="Function">DecEq-E2</a><a id="4079" class="Symbol">)</a> <a id="4081" href="Data.List.Base.html#5034" class="Function Operator">]</a>

  <a id="4086" class="Comment">-- this uses mutual recursion with List E3</a>
  <a id="4131" class="Keyword">unquoteDecl</a> <a id="DecEq-E3"></a><a id="4143" href="Tactic.Derive.DecEq.html#4143" class="Function">DecEq-E3</a> <a id="4152" class="Symbol">=</a> <a id="4154" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="4167" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4169" class="Symbol">(</a><a id="4170" class="Keyword">quote</a> <a id="4176" href="Tactic.Derive.TestTypes.html#376" class="Datatype">E3</a> <a id="4179" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4181" href="Tactic.Derive.DecEq.html#4143" class="Function">DecEq-E3</a><a id="4189" class="Symbol">)</a> <a id="4191" href="Data.List.Base.html#5034" class="Function Operator">]</a>
  <a id="4195" class="Comment">-- unquoteDecl DecEq-E4 = derive-DecEq [ (quote E4 , DecEq-E4) ]</a>

  <a id="4263" class="Keyword">unquoteDecl</a> <a id="DecEq-R1"></a><a id="4275" href="Tactic.Derive.DecEq.html#4275" class="Function">DecEq-R1</a> <a id="4284" class="Symbol">=</a> <a id="4286" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="4299" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4301" class="Symbol">(</a><a id="4302" class="Keyword">quote</a> <a id="4308" href="Tactic.Derive.TestTypes.html#586" class="Record">R1</a> <a id="4311" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4313" href="Tactic.Derive.DecEq.html#4275" class="Function">DecEq-R1</a><a id="4321" class="Symbol">)</a> <a id="4323" href="Data.List.Base.html#5034" class="Function Operator">]</a>
  <a id="4327" class="Keyword">unquoteDecl</a> <a id="DecEq-R2"></a><a id="4339" href="Tactic.Derive.DecEq.html#4339" class="Function">DecEq-R2</a> <a id="4348" class="Symbol">=</a> <a id="4350" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="4363" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4365" class="Symbol">(</a><a id="4366" class="Keyword">quote</a> <a id="4372" href="Tactic.Derive.TestTypes.html#647" class="Record">R2</a> <a id="4375" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4377" href="Tactic.Derive.DecEq.html#4339" class="Function">DecEq-R2</a><a id="4385" class="Symbol">)</a> <a id="4387" href="Data.List.Base.html#5034" class="Function Operator">]</a>

  <a id="4392" class="Keyword">unquoteDecl</a> <a id="DecEq-M₁"></a><a id="4404" href="Tactic.Derive.DecEq.html#4404" class="Function">DecEq-M₁</a> <a id="DecEq-M₂"></a><a id="4413" href="Tactic.Derive.DecEq.html#4413" class="Function">DecEq-M₂</a> <a id="4422" class="Symbol">=</a> <a id="4424" href="Tactic.Derive.DecEq.html#3067" class="Function">derive-DecEq</a> <a id="4437" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4439" class="Symbol">(</a><a id="4440" class="Keyword">quote</a> <a id="4446" href="Tactic.Derive.TestTypes.html#794" class="Datatype">M₁</a> <a id="4449" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4451" href="Tactic.Derive.DecEq.html#4404" class="Function">DecEq-M₁</a><a id="4459" class="Symbol">)</a> <a id="4461" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4463" class="Symbol">(</a><a id="4464" class="Keyword">quote</a> <a id="4470" href="Tactic.Derive.TestTypes.html#808" class="Datatype">M₂</a> <a id="4473" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4475" href="Tactic.Derive.DecEq.html#4413" class="Function">DecEq-M₂</a><a id="4483" class="Symbol">)</a> <a id="4485" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4487" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

  <a id="4493" class="Comment">-- Expected: DecEq-Term DecEq-Product</a>
</pre></body></html>