<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.DecEq</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/agda/agda-stdlib-meta/tree/master///Tactic/Derive/DecEq.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Deriving decidable equality. This works in several cases that use</a>
<a id="70" class="Comment">-- mutual recursion, examples are at the bottom.</a>
<a id="119" class="Comment">--</a>
<a id="122" class="Comment">-- TODO: This breaks with:</a>
<a id="149" class="Comment">-- - dependent records, e.g. Product</a>
<a id="186" class="Comment">-- - anything listed in Tactic.Derive</a>
<a id="224" class="Comment">-- - maybe more</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">-v</a> <a id="256" class="Pragma">allTactics:100</a> <a id="271" class="Symbol">#-}</a>
<a id="275" class="Symbol">{-#</a> <a id="279" class="Keyword">OPTIONS</a> <a id="287" class="Pragma">--safe</a> <a id="294" class="Symbol">#-}</a>
<a id="298" class="Keyword">module</a> <a id="305" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a> <a id="325" class="Keyword">where</a>

<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Meta.Init.html" class="Module">Meta.Init</a>

<a id="380" class="Keyword">import</a> <a id="387" href="Data.List.html" class="Module">Data.List</a> <a id="397" class="Symbol">as</a> <a id="400" class="Module">L</a>
<a id="402" class="Keyword">import</a> <a id="409" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="428" class="Symbol">as</a> <a id="431" class="Module">NE</a>

<a id="435" class="Keyword">open</a> <a id="440" class="Keyword">import</a> <a id="447" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="504" class="Keyword">open</a> <a id="509" class="Keyword">import</a> <a id="516" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="534" class="Keyword">open</a> <a id="539" class="Keyword">import</a> <a id="546" href="Reflection.AST.Term.html" class="Module">Reflection.AST.Term</a> <a id="566" class="Keyword">using</a> <a id="572" class="Symbol">(</a><a id="573" href="Reflection.AST.Term.html#5709" class="Function Operator">_≟-Pattern_</a><a id="584" class="Symbol">)</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>

<a id="649" class="Keyword">open</a> <a id="654" class="Keyword">import</a> <a id="661" href="Class.DecEq.Core.html" class="Module">Class.DecEq.Core</a>
<a id="678" class="Keyword">open</a> <a id="683" class="Keyword">import</a> <a id="690" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="704" class="Keyword">open</a> <a id="709" class="Keyword">import</a> <a id="716" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="728" class="Keyword">open</a> <a id="733" class="Keyword">import</a> <a id="740" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="764" class="Keyword">open</a> <a id="769" class="Keyword">import</a> <a id="776" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="795" class="Keyword">open</a> <a id="800" class="Keyword">import</a> <a id="807" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="828" class="Keyword">open</a> <a id="833" class="Keyword">import</a> <a id="840" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="854" class="Symbol">(</a><a id="855" class="Keyword">quote</a> <a id="861" href="Class.DecEq.Core.html#117" class="Record">DecEq</a><a id="866" class="Symbol">)</a> <a id="868" class="Symbol">(</a><a id="869" class="Keyword">quote</a> <a id="875" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a><a id="878" class="Symbol">)</a>

<a id="881" class="Keyword">instance</a>
  <a id="892" href="Tactic.Derive.DecEq.html#892" class="Function">_</a> <a id="894" class="Symbol">=</a> <a id="896" href="Tactic.ClauseBuilder.html#10734" class="Function">ContextMonad-MonadTC</a>

<a id="918" class="Keyword">open</a> <a id="923" href="Tactic.ClauseBuilder.html#10978" class="Module">ClauseExprM</a>

<a id="`yes"></a><a id="936" href="Tactic.Derive.DecEq.html#936" class="Function">`yes</a> <a id="`no"></a><a id="941" href="Tactic.Derive.DecEq.html#941" class="Function">`no</a> <a id="945" class="Symbol">:</a> <a id="947" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="952" class="Symbol">→</a> <a id="954" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="959" href="Tactic.Derive.DecEq.html#936" class="Function">`yes</a> <a id="964" href="Tactic.Derive.DecEq.html#964" class="Bound">x</a> <a id="966" class="Symbol">=</a> <a id="968" class="Keyword">quote</a> <a id="974" href="Relation.Nullary.Decidable.Core.html#1905" class="InductiveConstructor Operator">_because_</a> <a id="984" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">◆⟦</a> <a id="987" class="Keyword">quote</a> <a id="993" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>  <a id="999" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a> <a id="1001" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">∣</a> <a id="1003" class="Keyword">quote</a> <a id="1009" href="Relation.Nullary.Reflects.html#1054" class="InductiveConstructor">ofʸ</a> <a id="1013" href="Reflection.Syntax.html#3187" class="InductiveConstructor Operator">◆⟦</a> <a id="1016" href="Tactic.Derive.DecEq.html#964" class="Bound">x</a> <a id="1018" href="Reflection.Syntax.html#3187" class="InductiveConstructor Operator">⟧</a> <a id="1020" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">⟧</a>
<a id="1022" href="Tactic.Derive.DecEq.html#941" class="Function">`no</a>  <a id="1027" href="Tactic.Derive.DecEq.html#1027" class="Bound">x</a> <a id="1029" class="Symbol">=</a> <a id="1031" class="Keyword">quote</a> <a id="1037" href="Relation.Nullary.Decidable.Core.html#1905" class="InductiveConstructor Operator">_because_</a> <a id="1047" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">◆⟦</a> <a id="1050" class="Keyword">quote</a> <a id="1056" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1062" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a> <a id="1064" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">∣</a> <a id="1066" class="Keyword">quote</a> <a id="1072" href="Relation.Nullary.Reflects.html#1091" class="InductiveConstructor">ofⁿ</a> <a id="1076" href="Reflection.Syntax.html#3187" class="InductiveConstructor Operator">◆⟦</a> <a id="1079" href="Tactic.Derive.DecEq.html#1027" class="Bound">x</a> <a id="1081" href="Reflection.Syntax.html#3187" class="InductiveConstructor Operator">⟧</a> <a id="1083" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">⟧</a>

<a id="1086" class="Comment">-- We take the Dec P argument first to improve type checking performance.</a>
<a id="1160" class="Comment">-- It&#39;s easy to infer the type of P from this argument and we need to know</a>
<a id="1235" class="Comment">-- P to be able to check the pattern lambda generated for the P → Q direction</a>
<a id="1313" class="Comment">-- of the isomorphism. Having the isomorphism first would cause the type checker</a>
<a id="1394" class="Comment">-- to go back and forth between the pattern lambda and the Dec P argument,</a>
<a id="1469" class="Comment">-- inferring just enough of the type of make progress on the lambda.</a>
<a id="map&#39;"></a><a id="1538" href="Tactic.Derive.DecEq.html#1538" class="Function">map&#39;</a> <a id="1543" class="Symbol">:</a> <a id="1545" class="Symbol">∀</a> <a id="1547" class="Symbol">{</a><a id="1548" href="Tactic.Derive.DecEq.html#1548" class="Bound">p</a> <a id="1550" href="Tactic.Derive.DecEq.html#1550" class="Bound">q</a><a id="1551" class="Symbol">}</a> <a id="1553" class="Symbol">{</a><a id="1554" href="Tactic.Derive.DecEq.html#1554" class="Bound">P</a> <a id="1556" class="Symbol">:</a> <a id="1558" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1562" href="Tactic.Derive.DecEq.html#1548" class="Bound">p</a><a id="1563" class="Symbol">}</a> <a id="1565" class="Symbol">{</a><a id="1566" href="Tactic.Derive.DecEq.html#1566" class="Bound">Q</a> <a id="1568" class="Symbol">:</a> <a id="1570" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1574" href="Tactic.Derive.DecEq.html#1550" class="Bound">q</a><a id="1575" class="Symbol">}</a> <a id="1577" class="Symbol">→</a> <a id="1579" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a> <a id="1583" href="Tactic.Derive.DecEq.html#1554" class="Bound">P</a> <a id="1585" class="Symbol">→</a> <a id="1587" href="Tactic.Derive.DecEq.html#1554" class="Bound">P</a> <a id="1589" href="Function.Bundles.html#12400" class="Function Operator">⇔</a> <a id="1591" href="Tactic.Derive.DecEq.html#1566" class="Bound">Q</a> <a id="1593" class="Symbol">→</a> <a id="1595" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a> <a id="1599" href="Tactic.Derive.DecEq.html#1566" class="Bound">Q</a>
<a id="1601" href="Tactic.Derive.DecEq.html#1538" class="Function">map&#39;</a> <a id="1606" href="Tactic.Derive.DecEq.html#1606" class="Bound">d</a> <a id="1608" class="Keyword">record</a> <a id="1615" class="Symbol">{</a> <a id="1617" href="Function.Bundles.html#4810" class="Field">to</a> <a id="1620" class="Symbol">=</a> <a id="1622" href="Tactic.Derive.DecEq.html#1622" class="Bound">to</a> <a id="1625" class="Symbol">;</a> <a id="1627" href="Function.Bundles.html#4834" class="Field">from</a> <a id="1632" class="Symbol">=</a> <a id="1634" href="Tactic.Derive.DecEq.html#1634" class="Bound">from</a> <a id="1639" class="Symbol">}</a> <a id="1641" class="Symbol">=</a> <a id="1643" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">map′</a> <a id="1648" href="Tactic.Derive.DecEq.html#1622" class="Bound">to</a> <a id="1651" href="Tactic.Derive.DecEq.html#1634" class="Bound">from</a> <a id="1656" href="Tactic.Derive.DecEq.html#1606" class="Bound">d</a>

<a id="1659" class="Keyword">module</a> <a id="1666" href="Tactic.Derive.DecEq.html#1666" class="Module">_</a> <a id="1668" class="Symbol">(</a><a id="1669" href="Tactic.Derive.DecEq.html#1669" class="Bound">transName</a> <a id="1679" class="Symbol">:</a> <a id="1681" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1686" class="Symbol">→</a> <a id="1688" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1694" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="1698" class="Symbol">)</a> <a id="1700" class="Keyword">where</a>

  <a id="1709" href="Tactic.Derive.DecEq.html#1709" class="Function">eqFromTerm</a> <a id="1720" class="Symbol">:</a> <a id="1722" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1727" class="Symbol">→</a> <a id="1729" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1734" class="Symbol">→</a> <a id="1736" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1741" class="Symbol">→</a> <a id="1743" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="1750" href="Tactic.Derive.DecEq.html#1709" class="Function">eqFromTerm</a> <a id="1761" class="Symbol">(</a><a id="1762" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1766" href="Tactic.Derive.DecEq.html#1766" class="Bound">n</a> <a id="1768" class="Symbol">_)</a> <a id="1771" href="Tactic.Derive.DecEq.html#1771" class="Bound">t</a> <a id="1773" href="Tactic.Derive.DecEq.html#1773" class="Bound">t&#39;</a> <a id="1776" class="Keyword">with</a> <a id="1781" href="Tactic.Derive.DecEq.html#1669" class="Bound">transName</a> <a id="1791" href="Tactic.Derive.DecEq.html#1766" class="Bound">n</a>
  <a id="1795" class="Symbol">...</a> <a id="1799" class="Symbol">|</a> <a id="1801" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1806" href="Tactic.Derive.DecEq.html#1806" class="Bound">n&#39;</a>     <a id="1813" class="Symbol">=</a> <a id="1815" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1819" class="Symbol">(</a><a id="1820" class="Keyword">quote</a> <a id="1826" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a><a id="1829" class="Symbol">)</a> <a id="1831" class="Symbol">(</a><a id="1832" href="Reflection.AST.Argument.html#1453" class="InductiveConstructor">iArg</a> <a id="1837" class="Symbol">(</a><a id="1838" href="Tactic.Derive.DecEq.html#1806" class="Bound">n&#39;</a> <a id="1841" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a><a id="1842" class="Symbol">)</a> <a id="1844" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1846" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="1851" class="Bound">t</a> <a id="1853" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1855" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="1860" class="Bound">t&#39;</a> <a id="1863" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1865" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1867" class="Symbol">)</a>
  <a id="1871" class="Symbol">...</a> <a id="1875" class="Symbol">|</a> <a id="1877" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>     <a id="1889" class="Symbol">=</a> <a id="1891" class="Keyword">quote</a> <a id="1897" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a> <a id="1901" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="1904" class="Bound">t</a> <a id="1906" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="1908" class="Bound">t&#39;</a> <a id="1911" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>
  <a id="1915" href="Tactic.Derive.DecEq.html#1709" class="CatchallClause Function">eqFromTerm</a><a id="1925" class="CatchallClause"> </a><a id="1926" class="CatchallClause Symbol">_</a><a id="1927" class="CatchallClause"> </a><a id="1928" href="Tactic.Derive.DecEq.html#1928" class="CatchallClause Bound">t</a><a id="1929" class="CatchallClause"> </a><a id="1930" href="Tactic.Derive.DecEq.html#1930" class="CatchallClause Bound">t&#39;</a> <a id="1933" class="Symbol">=</a> <a id="1935" class="Keyword">quote</a> <a id="1941" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a> <a id="1945" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="1948" href="Tactic.Derive.DecEq.html#1928" class="Bound">t</a> <a id="1950" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="1952" href="Tactic.Derive.DecEq.html#1930" class="Bound">t&#39;</a> <a id="1955" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>

  <a id="1960" href="Tactic.Derive.DecEq.html#1960" class="Function">toDecEqName</a> <a id="1972" class="Symbol">:</a> <a id="1974" href="Tactic.ClauseBuilder.html#1351" class="Function">SinglePattern</a> <a id="1988" class="Symbol">→</a> <a id="1990" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1995" class="Symbol">(</a><a id="1996" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2001" class="Symbol">→</a> <a id="2003" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2008" class="Symbol">→</a> <a id="2010" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2014" class="Symbol">)</a>
  <a id="2018" href="Tactic.Derive.DecEq.html#1960" class="Function">toDecEqName</a> <a id="2030" class="Symbol">(</a><a id="2031" href="Tactic.Derive.DecEq.html#2031" class="Bound">l</a> <a id="2033" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2035" class="Symbol">_)</a> <a id="2038" class="Symbol">=</a> <a id="2040" href="Data.List.Base.html#1634" class="Function">L.map</a> <a id="2046" class="Symbol">(λ</a> <a id="2049" class="Keyword">where</a> <a id="2055" class="Symbol">(_</a> <a id="2058" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2060" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="2064" class="Symbol">_</a> <a id="2066" href="Tactic.Derive.DecEq.html#2066" class="Bound">t</a><a id="2067" class="Symbol">)</a> <a id="2069" class="Symbol">→</a> <a id="2071" href="Tactic.Derive.DecEq.html#1709" class="Function">eqFromTerm</a> <a id="2082" href="Tactic.Derive.DecEq.html#2066" class="Bound">t</a><a id="2083" class="Symbol">)</a> <a id="2085" href="Tactic.Derive.DecEq.html#2031" class="Bound">l</a>

  <a id="2090" class="Comment">-- on the diagonal we have one pattern, outside we don&#39;t care</a>
  <a id="2154" class="Comment">-- assume that the types in the pattern are properly normalized</a>
  <a id="2220" href="Tactic.Derive.DecEq.html#2220" class="Function">mapDiag</a> <a id="2228" class="Symbol">:</a> <a id="2230" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2236" href="Tactic.ClauseBuilder.html#1351" class="Function">SinglePattern</a> <a id="2250" class="Symbol">→</a> <a id="2252" href="Reflection.TCI.html#617" class="Function">TC</a> <a id="2255" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="2262" href="Tactic.Derive.DecEq.html#2220" class="Function">mapDiag</a> <a id="2270" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>          <a id="2287" class="Symbol">=</a> <a id="2289" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="2296" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2298" href="Tactic.Derive.DecEq.html#941" class="Function">`no</a> <a id="2302" href="Reflection.Syntax.html#2485" class="InductiveConstructor Operator">`λ⦅</a> <a id="2306" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="2308" class="Symbol">(</a><a id="2309" class="String">&quot;&quot;</a> <a id="2312" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2314" href="Reflection.Syntax.html#1381" class="InductiveConstructor">vArg?</a><a id="2319" class="Symbol">)</a> <a id="2321" href="Data.List.Base.html#5205" class="Function Operator">]</a> <a id="2323" href="Reflection.Syntax.html#2485" class="InductiveConstructor Operator">⦆∅</a>
  <a id="2328" href="Tactic.Derive.DecEq.html#2220" class="Function">mapDiag</a> <a id="2336" class="Symbol">(</a><a id="2337" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2342" href="Tactic.Derive.DecEq.html#2342" class="Bound">p</a><a id="2343" class="Symbol">@(</a><a id="2345" href="Tactic.Derive.DecEq.html#2345" class="Bound">l</a> <a id="2347" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2349" class="Symbol">_))</a> <a id="2353" class="Symbol">=</a> <a id="2355" class="Keyword">let</a> <a id="2359" href="Tactic.Derive.DecEq.html#2359" class="Bound">k</a> <a id="2361" class="Symbol">=</a> <a id="2363" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2370" href="Tactic.Derive.DecEq.html#2345" class="Bound">l</a> <a id="2372" class="Keyword">in</a> <a id="2375" class="Keyword">do</a>
    <a id="2382" href="Tactic.Derive.DecEq.html#2382" class="Bound">typeList</a> <a id="2391" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="2393" href="Class.Traversable.Core.html#288" class="Function">traverse</a> <a id="2402" class="Symbol">⦃</a> <a id="2404" href="Class.Functor.Instances.html#436" class="Function">Functor-List</a> <a id="2417" class="Symbol">⦄</a> <a id="2419" href="Class.MonadTC.html#1798" class="Field">inferType</a> <a id="2429" class="Symbol">(</a><a id="2430" href="Data.List.Base.html#6320" class="Function">applyDownFrom</a> <a id="2444" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="2446" class="Symbol">(</a><a id="2447" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2454" href="Tactic.Derive.DecEq.html#2345" class="Bound">l</a><a id="2455" class="Symbol">))</a>
    <a id="2462" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="2469" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2471" class="Keyword">quote</a> <a id="2477" href="Tactic.Derive.DecEq.html#1538" class="Function">map&#39;</a> <a id="2482" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="2485" href="Tactic.Derive.DecEq.html#2552" class="Function">genPf</a> <a id="2491" href="Tactic.Derive.DecEq.html#2359" class="Bound">k</a> <a id="2493" class="Symbol">(</a><a id="2494" href="Data.List.Base.html#1634" class="Function">L.map</a> <a id="2500" href="Tactic.Derive.DecEq.html#1709" class="Function">eqFromTerm</a> <a id="2511" href="Tactic.Derive.DecEq.html#2382" class="Bound">typeList</a><a id="2519" class="Symbol">)</a> <a id="2521" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="2523" href="Tactic.Derive.DecEq.html#2791" class="Function">genEquiv</a> <a id="2532" href="Tactic.Derive.DecEq.html#2359" class="Bound">k</a> <a id="2534" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>
    <a id="2540" class="Keyword">where</a>
      <a id="2552" href="Tactic.Derive.DecEq.html#2552" class="Function">genPf</a> <a id="2558" class="Symbol">:</a> <a id="2560" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2562" class="Symbol">→</a> <a id="2564" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2569" class="Symbol">(</a><a id="2570" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2575" class="Symbol">→</a> <a id="2577" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2582" class="Symbol">→</a> <a id="2584" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2588" class="Symbol">)</a> <a id="2590" class="Symbol">→</a> <a id="2592" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="2603" href="Tactic.Derive.DecEq.html#2552" class="Function">genPf</a> <a id="2609" href="Tactic.Derive.DecEq.html#2609" class="Bound">k</a> <a id="2611" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>      <a id="2619" class="Symbol">=</a> <a id="2621" href="Tactic.Derive.DecEq.html#936" class="Function">`yes</a> <a id="2626" class="Symbol">(</a><a id="2627" class="Keyword">quote</a> <a id="2633" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2636" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a><a id="2637" class="Symbol">)</a>
      <a id="2645" href="Tactic.Derive.DecEq.html#2552" class="Function">genPf</a> <a id="2651" href="Tactic.Derive.DecEq.html#2651" class="Bound">k</a> <a id="2653" class="Symbol">(</a><a id="2654" href="Tactic.Derive.DecEq.html#2654" class="Bound">n</a> <a id="2656" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2658" href="Tactic.Derive.DecEq.html#2658" class="Bound">l</a><a id="2659" class="Symbol">)</a> <a id="2661" class="Symbol">=</a> <a id="2663" class="Keyword">quote</a> <a id="2669" href="Relation.Nullary.Decidable.Core.html#3103" class="Function Operator">_×-dec_</a> <a id="2677" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="2680" href="Tactic.Derive.DecEq.html#2552" class="Function">genPf</a> <a id="2686" href="Tactic.Derive.DecEq.html#2651" class="Bound">k</a> <a id="2688" href="Tactic.Derive.DecEq.html#2658" class="Bound">l</a> <a id="2690" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="2692" href="Tactic.Derive.DecEq.html#2654" class="Bound">n</a> <a id="2694" class="Symbol">(</a><a id="2695" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="2697" class="Symbol">(</a><a id="2698" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2705" href="Tactic.Derive.DecEq.html#2658" class="Bound">l</a><a id="2706" class="Symbol">))</a> <a id="2709" class="Symbol">(</a><a id="2710" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="2712" class="Symbol">(</a><a id="2713" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2720" href="Tactic.Derive.DecEq.html#2658" class="Bound">l</a> <a id="2722" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="2724" href="Tactic.Derive.DecEq.html#2651" class="Bound">k</a><a id="2725" class="Symbol">))</a> <a id="2728" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>

      <a id="2737" class="Comment">-- c x1 .. xn ≡ c y1 .. yn ⇔ x1 ≡ y1 .. xn ≡ yn</a>
      <a id="2791" href="Tactic.Derive.DecEq.html#2791" class="Function">genEquiv</a> <a id="2800" class="Symbol">:</a> <a id="2802" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2804" class="Symbol">→</a> <a id="2806" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="2817" href="Tactic.Derive.DecEq.html#2791" class="Function">genEquiv</a> <a id="2826" href="Tactic.Derive.DecEq.html#2826" class="Bound">n</a> <a id="2828" class="Symbol">=</a> <a id="2830" class="Keyword">quote</a> <a id="2836" href="Function.Bundles.html#13499" class="Function">mk⇔</a> <a id="2840" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="2843" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">`λ⟦</a> <a id="2847" href="Tactic.Derive.DecEq.html#2938" class="Function">reflPattern</a> <a id="2859" href="Tactic.Derive.DecEq.html#2826" class="Bound">n</a> <a id="2861" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⇒</a> <a id="2863" class="Keyword">quote</a> <a id="2869" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2874" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a> <a id="2876" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⟧</a> <a id="2878" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="2880" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">`λ⟦</a> <a id="2884" class="Keyword">quote</a> <a id="2890" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2895" href="Reflection.Syntax.html#3281" class="InductiveConstructor Operator">◇</a> <a id="2897" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⇒</a> <a id="2899" href="Tactic.Derive.DecEq.html#3094" class="Function">reflTerm</a> <a id="2908" href="Tactic.Derive.DecEq.html#2826" class="Bound">n</a> <a id="2910" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⟧</a> <a id="2912" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>
        <a id="2922" class="Keyword">where</a>
          <a id="2938" href="Tactic.Derive.DecEq.html#2938" class="Function">reflPattern</a> <a id="2950" class="Symbol">:</a> <a id="2952" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2954" class="Symbol">→</a> <a id="2956" href="Agda.Builtin.Reflection.html#5031" class="Datatype">Pattern</a>
          <a id="2974" href="Tactic.Derive.DecEq.html#2938" class="Function">reflPattern</a> <a id="2986" class="Number">0</a>       <a id="2994" class="Symbol">=</a> <a id="2996" class="Keyword">quote</a> <a id="3002" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3005" href="Reflection.Syntax.html#3281" class="InductiveConstructor Operator">◇</a>
          <a id="3017" href="Tactic.Derive.DecEq.html#2938" class="Function">reflPattern</a> <a id="3029" class="Symbol">(</a><a id="3030" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3034" href="Tactic.Derive.DecEq.html#3034" class="Bound">n</a><a id="3035" class="Symbol">)</a> <a id="3037" class="Symbol">=</a> <a id="3039" class="Keyword">quote</a> <a id="3045" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="3049" href="Reflection.Syntax.html#3361" class="InductiveConstructor Operator">◇⟦</a> <a id="3052" href="Tactic.Derive.DecEq.html#2938" class="Function">reflPattern</a> <a id="3064" href="Tactic.Derive.DecEq.html#3034" class="Bound">n</a> <a id="3066" href="Reflection.Syntax.html#3361" class="InductiveConstructor Operator">∣</a> <a id="3068" class="Keyword">quote</a> <a id="3074" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3079" href="Reflection.Syntax.html#3281" class="InductiveConstructor Operator">◇</a> <a id="3081" href="Reflection.Syntax.html#3361" class="InductiveConstructor Operator">⟧</a>

          <a id="3094" href="Tactic.Derive.DecEq.html#3094" class="Function">reflTerm</a> <a id="3103" class="Symbol">:</a> <a id="3105" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3107" class="Symbol">→</a> <a id="3109" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
          <a id="3124" href="Tactic.Derive.DecEq.html#3094" class="Function">reflTerm</a> <a id="3133" class="Number">0</a>       <a id="3141" class="Symbol">=</a> <a id="3143" class="Keyword">quote</a> <a id="3149" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3152" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a>
          <a id="3164" href="Tactic.Derive.DecEq.html#3094" class="Function">reflTerm</a> <a id="3173" class="Symbol">(</a><a id="3174" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3178" href="Tactic.Derive.DecEq.html#3178" class="Bound">n</a><a id="3179" class="Symbol">)</a> <a id="3181" class="Symbol">=</a> <a id="3183" class="Keyword">quote</a> <a id="3189" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="3193" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">◆⟦</a> <a id="3196" href="Tactic.Derive.DecEq.html#3094" class="Function">reflTerm</a> <a id="3205" href="Tactic.Derive.DecEq.html#3178" class="Bound">n</a> <a id="3207" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">∣</a> <a id="3209" class="Keyword">quote</a> <a id="3215" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3220" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a> <a id="3222" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">⟧</a>

  <a id="3227" href="Tactic.Derive.DecEq.html#3227" class="Function">toMapDiag</a> <a id="3237" class="Symbol">:</a> <a id="3239" href="Tactic.ClauseBuilder.html#1351" class="Function">SinglePattern</a> <a id="3253" class="Symbol">→</a> <a id="3255" href="Tactic.ClauseBuilder.html#1351" class="Function">SinglePattern</a> <a id="3269" class="Symbol">→</a> <a id="3271" href="Data.List.NonEmpty.Base.html#1229" class="Record">NE.List⁺</a> <a id="3280" href="Tactic.ClauseBuilder.html#1351" class="Function">SinglePattern</a> <a id="3294" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3296" href="Reflection.TCI.html#617" class="Function">TC</a> <a id="3299" class="Symbol">(</a><a id="3300" href="Tactic.ClauseBuilder.html#5843" class="Datatype">ClauseExpr</a> <a id="3311" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3313" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3319" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="3323" class="Symbol">)</a>
  <a id="3327" href="Tactic.Derive.DecEq.html#3227" class="Function">toMapDiag</a> <a id="3337" href="Tactic.Derive.DecEq.html#3337" class="Bound">p</a><a id="3338" class="Symbol">@(_</a> <a id="3342" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3344" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3348" class="Symbol">_</a> <a id="3350" href="Tactic.Derive.DecEq.html#3350" class="Bound">p₁</a><a id="3352" class="Symbol">)</a> <a id="3354" href="Tactic.Derive.DecEq.html#3354" class="Bound">p&#39;</a><a id="3356" class="Symbol">@(_</a> <a id="3360" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3362" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3366" class="Symbol">_</a> <a id="3368" href="Tactic.Derive.DecEq.html#3368" class="Bound">p₂</a><a id="3370" class="Symbol">)</a> <a id="3372" class="Symbol">=</a>
    <a id="3378" class="Symbol">(</a><a id="3379" href="Tactic.Derive.DecEq.html#3337" class="Bound">p</a> <a id="3381" href="Data.List.NonEmpty.Base.html#1275" class="InductiveConstructor Operator">NE.∷</a> <a id="3386" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3388" href="Tactic.Derive.DecEq.html#3354" class="Bound">p&#39;</a> <a id="3391" href="Data.List.Base.html#5205" class="Function Operator">]</a> <a id="3393" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3395" href="Tactic.ClauseBuilder.html#12920" class="Function">finishMatch</a> <a id="3407" class="Symbol">(</a><a id="3408" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="3411" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌊</a> <a id="3413" href="Tactic.Derive.DecEq.html#3350" class="Bound">p₁</a> <a id="3416" href="Reflection.AST.Term.html#5709" class="Function Operator">≟-Pattern</a> <a id="3426" href="Tactic.Derive.DecEq.html#3368" class="Bound">p₂</a> <a id="3429" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌋</a> <a id="3431" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="3436" href="Tactic.Derive.DecEq.html#2220" class="Function">mapDiag</a> <a id="3444" class="Symbol">(</a><a id="3445" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3450" href="Tactic.Derive.DecEq.html#3337" class="Bound">p</a><a id="3451" class="Symbol">)</a> <a id="3453" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="3458" href="Tactic.Derive.DecEq.html#2220" class="Function">mapDiag</a> <a id="3466" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3473" class="Symbol">))</a>

<a id="3477" class="Keyword">module</a> <a id="3484" href="Tactic.Derive.DecEq.html#3484" class="Module">_</a> <a id="3486" class="Symbol">⦃</a> <a id="3488" href="Tactic.Derive.DecEq.html#3488" class="Bound">_</a> <a id="3490" class="Symbol">:</a> <a id="3492" href="Class.MonadTC.html#666" class="Record">TCOptions</a> <a id="3502" class="Symbol">⦄</a> <a id="3504" class="Keyword">where</a>
  <a id="3512" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="3525" class="Symbol">:</a> <a id="3527" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3532" class="Symbol">(</a><a id="3533" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3538" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3540" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="3544" class="Symbol">)</a> <a id="3546" class="Symbol">→</a> <a id="3548" href="Reflection.Tactic.html#518" class="Function">UnquoteDecl</a>
  <a id="3562" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="3575" class="Symbol">=</a> <a id="3577" href="Tactic.Derive.html#5784" class="Function">derive-Class</a> <a id="3590" class="Number">0</a> <a id="3592" class="Symbol">(λ</a> <a id="3595" href="Tactic.Derive.DecEq.html#3595" class="Bound">transName</a> <a id="3605" href="Tactic.Derive.DecEq.html#3605" class="Bound">ps</a> <a id="3608" class="Symbol">→</a> <a id="3610" href="Data.List.Base.html#2132" class="Function">cartesianProductWith</a> <a id="3631" class="Symbol">(</a><a id="3632" href="Tactic.Derive.DecEq.html#3227" class="Function">toMapDiag</a> <a id="3642" href="Tactic.Derive.DecEq.html#3595" class="Bound">transName</a><a id="3651" class="Symbol">)</a> <a id="3653" href="Tactic.Derive.DecEq.html#3605" class="Bound">ps</a> <a id="3656" href="Tactic.Derive.DecEq.html#3605" class="Bound">ps</a><a id="3658" class="Symbol">)</a>

<a id="3661" class="Keyword">private</a>
  <a id="3671" class="Keyword">open</a> <a id="3676" class="Keyword">import</a> <a id="3683" href="Tactic.Derive.TestTypes.html" class="Module">Tactic.Derive.TestTypes</a>
  <a id="3709" class="Keyword">open</a> <a id="3714" class="Keyword">import</a> <a id="3721" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

  <a id="3740" class="Keyword">unquoteDecl</a> <a id="DecEq-These"></a><a id="3752" href="Tactic.Derive.DecEq.html#3752" class="Function">DecEq-These</a> <a id="3764" class="Symbol">=</a> <a id="3766" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="3779" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3781" class="Symbol">(</a><a id="3782" class="Keyword">quote</a> <a id="3788" href="Data.These.Base.html#537" class="Datatype">These</a> <a id="3794" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3796" href="Tactic.Derive.DecEq.html#3752" class="Function">DecEq-These</a><a id="3807" class="Symbol">)</a> <a id="3809" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="3814" class="Keyword">unquoteDecl</a> <a id="DecEq-⊎"></a><a id="3826" href="Tactic.Derive.DecEq.html#3826" class="Function">DecEq-⊎</a> <a id="3834" class="Symbol">=</a> <a id="3836" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="3849" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3851" class="Symbol">(</a><a id="3852" class="Keyword">quote</a> <a id="3858" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a> <a id="3862" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3864" href="Tactic.Derive.DecEq.html#3826" class="Function">DecEq-⊎</a><a id="3871" class="Symbol">)</a> <a id="3873" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="3878" class="Keyword">unquoteDecl</a> <a id="DecEq-Bool"></a><a id="3890" href="Tactic.Derive.DecEq.html#3890" class="Function">DecEq-Bool</a> <a id="DecEq-ℤ"></a><a id="3901" href="Tactic.Derive.DecEq.html#3901" class="Function">DecEq-ℤ</a> <a id="DecEq-List"></a><a id="3909" href="Tactic.Derive.DecEq.html#3909" class="Function">DecEq-List</a> <a id="DecEq-Maybe"></a><a id="3920" href="Tactic.Derive.DecEq.html#3920" class="Function">DecEq-Maybe</a> <a id="DecEq-ℕ"></a><a id="3932" href="Tactic.Derive.DecEq.html#3932" class="Function">DecEq-ℕ</a> <a id="DecEq-Sign"></a><a id="3940" href="Tactic.Derive.DecEq.html#3940" class="Function">DecEq-Sign</a> <a id="DecEq-⊤"></a><a id="3951" href="Tactic.Derive.DecEq.html#3951" class="Function">DecEq-⊤</a> <a id="3959" class="Symbol">=</a> <a id="3961" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="3974" class="Symbol">((</a><a id="3976" class="Keyword">quote</a> <a id="3982" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="3987" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3989" href="Tactic.Derive.DecEq.html#3890" class="Function">DecEq-Bool</a><a id="3999" class="Symbol">)</a> <a id="4001" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4003" class="Symbol">(</a><a id="4004" class="Keyword">quote</a> <a id="4010" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a> <a id="4012" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4014" href="Tactic.Derive.DecEq.html#3901" class="Function">DecEq-ℤ</a><a id="4021" class="Symbol">)</a> <a id="4023" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4025" class="Symbol">(</a><a id="4026" class="Keyword">quote</a> <a id="4032" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4037" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4039" href="Tactic.Derive.DecEq.html#3909" class="Function">DecEq-List</a><a id="4049" class="Symbol">)</a> <a id="4051" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4053" class="Symbol">(</a><a id="4054" class="Keyword">quote</a> <a id="4060" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4066" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4068" href="Tactic.Derive.DecEq.html#3920" class="Function">DecEq-Maybe</a><a id="4079" class="Symbol">)</a> <a id="4081" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4083" class="Symbol">(</a><a id="4084" class="Keyword">quote</a> <a id="4090" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4092" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4094" href="Tactic.Derive.DecEq.html#3932" class="Function">DecEq-ℕ</a><a id="4101" class="Symbol">)</a> <a id="4103" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4105" class="Symbol">(</a><a id="4106" class="Keyword">quote</a> <a id="4112" href="Data.Sign.Base.html#523" class="Datatype">Sign</a> <a id="4117" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4119" href="Tactic.Derive.DecEq.html#3940" class="Function">DecEq-Sign</a><a id="4129" class="Symbol">)</a> <a id="4131" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4133" class="Symbol">(</a><a id="4134" class="Keyword">quote</a> <a id="4140" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="4142" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4144" href="Tactic.Derive.DecEq.html#3951" class="Function">DecEq-⊤</a><a id="4151" class="Symbol">)</a> <a id="4153" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4155" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4157" class="Symbol">)</a>

  <a id="4162" class="Keyword">unquoteDecl</a> <a id="DecEq-Fin"></a><a id="4174" href="Tactic.Derive.DecEq.html#4174" class="Function">DecEq-Fin</a> <a id="4184" class="Symbol">=</a> <a id="4186" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="4199" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4201" class="Symbol">(</a><a id="4202" class="Keyword">quote</a> <a id="4208" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="4212" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4214" href="Tactic.Derive.DecEq.html#4174" class="Function">DecEq-Fin</a><a id="4223" class="Symbol">)</a> <a id="4225" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="4230" class="Comment">-- this doesn&#39;t work since the clause builder machinery doesn&#39;t deal</a>
  <a id="4301" class="Comment">-- with absurd patterns yet</a>

  <a id="4332" class="Comment">--unquoteDecl DecEq-Vec = derive-DecEq [ (quote Vec , DecEq-Vec) ]</a>

  <a id="4402" class="Keyword">unquoteDecl</a> <a id="DecEq-E1"></a><a id="4414" href="Tactic.Derive.DecEq.html#4414" class="Function">DecEq-E1</a> <a id="4423" class="Symbol">=</a> <a id="4425" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="4438" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4440" class="Symbol">(</a><a id="4441" class="Keyword">quote</a> <a id="4447" href="Tactic.Derive.TestTypes.html#204" class="Datatype">E1</a> <a id="4450" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4452" href="Tactic.Derive.DecEq.html#4414" class="Function">DecEq-E1</a><a id="4460" class="Symbol">)</a> <a id="4462" href="Data.List.Base.html#5205" class="Function Operator">]</a>
  <a id="4466" class="Keyword">unquoteDecl</a> <a id="DecEq-E2"></a><a id="4478" href="Tactic.Derive.DecEq.html#4478" class="Function">DecEq-E2</a> <a id="4487" class="Symbol">=</a> <a id="4489" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="4502" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4504" class="Symbol">(</a><a id="4505" class="Keyword">quote</a> <a id="4511" href="Tactic.Derive.TestTypes.html#309" class="Datatype">E2</a> <a id="4514" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4516" href="Tactic.Derive.DecEq.html#4478" class="Function">DecEq-E2</a><a id="4524" class="Symbol">)</a> <a id="4526" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="4531" class="Comment">-- this uses mutual recursion with List E3</a>
  <a id="4576" class="Keyword">unquoteDecl</a> <a id="DecEq-E3"></a><a id="4588" href="Tactic.Derive.DecEq.html#4588" class="Function">DecEq-E3</a> <a id="4597" class="Symbol">=</a> <a id="4599" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="4612" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4614" class="Symbol">(</a><a id="4615" class="Keyword">quote</a> <a id="4621" href="Tactic.Derive.TestTypes.html#387" class="Datatype">E3</a> <a id="4624" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4626" href="Tactic.Derive.DecEq.html#4588" class="Function">DecEq-E3</a><a id="4634" class="Symbol">)</a> <a id="4636" href="Data.List.Base.html#5205" class="Function Operator">]</a>
  <a id="4640" class="Comment">-- unquoteDecl DecEq-E4 = derive-DecEq [ (quote E4 , DecEq-E4) ]</a>

  <a id="4708" class="Keyword">unquoteDecl</a> <a id="DecEq-R1"></a><a id="4720" href="Tactic.Derive.DecEq.html#4720" class="Function">DecEq-R1</a> <a id="4729" class="Symbol">=</a> <a id="4731" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="4744" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4746" class="Symbol">(</a><a id="4747" class="Keyword">quote</a> <a id="4753" href="Tactic.Derive.TestTypes.html#597" class="Record">R1</a> <a id="4756" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4758" href="Tactic.Derive.DecEq.html#4720" class="Function">DecEq-R1</a><a id="4766" class="Symbol">)</a> <a id="4768" href="Data.List.Base.html#5205" class="Function Operator">]</a>
  <a id="4772" class="Keyword">unquoteDecl</a> <a id="DecEq-R2"></a><a id="4784" href="Tactic.Derive.DecEq.html#4784" class="Function">DecEq-R2</a> <a id="4793" class="Symbol">=</a> <a id="4795" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="4808" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4810" class="Symbol">(</a><a id="4811" class="Keyword">quote</a> <a id="4817" href="Tactic.Derive.TestTypes.html#658" class="Record">R2</a> <a id="4820" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4822" href="Tactic.Derive.DecEq.html#4784" class="Function">DecEq-R2</a><a id="4830" class="Symbol">)</a> <a id="4832" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="4837" class="Keyword">unquoteDecl</a> <a id="DecEq-M₁"></a><a id="4849" href="Tactic.Derive.DecEq.html#4849" class="Function">DecEq-M₁</a> <a id="DecEq-M₂"></a><a id="4858" href="Tactic.Derive.DecEq.html#4858" class="Function">DecEq-M₂</a> <a id="4867" class="Symbol">=</a> <a id="4869" href="Tactic.Derive.DecEq.html#3512" class="Function">derive-DecEq</a> <a id="4882" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4884" class="Symbol">(</a><a id="4885" class="Keyword">quote</a> <a id="4891" href="Tactic.Derive.TestTypes.html#805" class="Datatype">M₁</a> <a id="4894" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4896" href="Tactic.Derive.DecEq.html#4849" class="Function">DecEq-M₁</a><a id="4904" class="Symbol">)</a> <a id="4906" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4908" class="Symbol">(</a><a id="4909" class="Keyword">quote</a> <a id="4915" href="Tactic.Derive.TestTypes.html#819" class="Datatype">M₂</a> <a id="4918" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4920" href="Tactic.Derive.DecEq.html#4858" class="Function">DecEq-M₂</a><a id="4928" class="Symbol">)</a> <a id="4930" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4932" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="4938" class="Comment">-- Expected: DecEq-Term DecEq-Product</a>
</pre></body></html>