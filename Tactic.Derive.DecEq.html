<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.DecEq</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/agda/agda-stdlib-meta/tree/master///Tactic/Derive/DecEq.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Deriving decidable equality. This works in several cases that use</a>
<a id="70" class="Comment">-- mutual recursion, examples are at the bottom.</a>
<a id="119" class="Comment">--</a>
<a id="122" class="Comment">-- TODO: This breaks with:</a>
<a id="149" class="Comment">-- - dependent records, e.g. Product</a>
<a id="186" class="Comment">-- - anything listed in Tactic.Derive</a>
<a id="224" class="Comment">-- - maybe more</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">-v</a> <a id="256" class="Pragma">allTactics:100</a> <a id="271" class="Symbol">#-}</a>
<a id="275" class="Symbol">{-#</a> <a id="279" class="Keyword">OPTIONS</a> <a id="287" class="Pragma">--safe</a> <a id="294" class="Pragma">--with-K</a> <a id="303" class="Symbol">#-}</a>
<a id="307" class="Keyword">module</a> <a id="314" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a> <a id="334" class="Keyword">where</a>

<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="366" class="Keyword">open</a> <a id="371" class="Keyword">import</a> <a id="378" href="Meta.Init.html" class="Module">Meta.Init</a>

<a id="389" class="Keyword">import</a> <a id="396" href="Data.List.html" class="Module">Data.List</a> <a id="406" class="Symbol">as</a> <a id="409" class="Module">L</a>
<a id="411" class="Keyword">import</a> <a id="418" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="437" class="Symbol">as</a> <a id="440" class="Module">NE</a>

<a id="444" class="Keyword">open</a> <a id="449" class="Keyword">import</a> <a id="456" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="473" class="Keyword">open</a> <a id="478" class="Keyword">import</a> <a id="485" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="543" class="Keyword">open</a> <a id="548" class="Keyword">import</a> <a id="555" href="Reflection.AST.Term.html" class="Module">Reflection.AST.Term</a> <a id="575" class="Keyword">using</a> <a id="581" class="Symbol">(</a><a id="582" href="Reflection.AST.Term.html#5709" class="Function Operator">_≟-Pattern_</a><a id="593" class="Symbol">)</a>
<a id="595" class="Keyword">open</a> <a id="600" class="Keyword">import</a> <a id="607" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="624" class="Keyword">open</a> <a id="629" class="Keyword">import</a> <a id="636" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>

<a id="658" class="Keyword">open</a> <a id="663" class="Keyword">import</a> <a id="670" href="Class.DecEq.Core.html" class="Module">Class.DecEq.Core</a>
<a id="687" class="Keyword">open</a> <a id="692" class="Keyword">import</a> <a id="699" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="713" class="Keyword">open</a> <a id="718" class="Keyword">import</a> <a id="725" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="737" class="Keyword">open</a> <a id="742" class="Keyword">import</a> <a id="749" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="773" class="Keyword">open</a> <a id="778" class="Keyword">import</a> <a id="785" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="804" class="Keyword">open</a> <a id="809" class="Keyword">import</a> <a id="816" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="837" class="Keyword">open</a> <a id="842" class="Keyword">import</a> <a id="849" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="863" class="Symbol">(</a><a id="864" class="Keyword">quote</a> <a id="870" href="Class.DecEq.Core.html#117" class="Record">DecEq</a><a id="875" class="Symbol">)</a> <a id="877" class="Symbol">(</a><a id="878" class="Keyword">quote</a> <a id="884" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a><a id="887" class="Symbol">)</a>


<a id="891" class="Keyword">open</a> <a id="896" href="Tactic.ClauseBuilder.html#10889" class="Module">ClauseExprM</a>

<a id="909" class="Keyword">private</a>
  <a id="919" class="Keyword">instance</a> <a id="928" href="Tactic.Derive.DecEq.html#928" class="Function">_</a> <a id="930" class="Symbol">=</a> <a id="932" href="Tactic.ClauseBuilder.html#10645" class="Function">ContextMonad-MonadTC</a>

  <a id="`yes"></a><a id="956" href="Tactic.Derive.DecEq.html#956" class="Function">`yes</a> <a id="`no"></a><a id="961" href="Tactic.Derive.DecEq.html#961" class="Function">`no</a> <a id="965" class="Symbol">:</a> <a id="967" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="972" class="Symbol">→</a> <a id="974" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="981" href="Tactic.Derive.DecEq.html#956" class="Function">`yes</a> <a id="986" href="Tactic.Derive.DecEq.html#986" class="Bound">x</a> <a id="988" class="Symbol">=</a> <a id="990" class="Keyword">quote</a> <a id="996" href="Relation.Nullary.Decidable.Core.html#1905" class="InductiveConstructor Operator">_because_</a> <a id="1006" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">◆⟦</a> <a id="1009" class="Keyword">quote</a> <a id="1015" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>  <a id="1021" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a> <a id="1023" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">∣</a> <a id="1025" class="Keyword">quote</a> <a id="1031" href="Relation.Nullary.Reflects.html#1054" class="InductiveConstructor">ofʸ</a> <a id="1035" href="Reflection.Syntax.html#3187" class="InductiveConstructor Operator">◆⟦</a> <a id="1038" href="Tactic.Derive.DecEq.html#986" class="Bound">x</a> <a id="1040" href="Reflection.Syntax.html#3187" class="InductiveConstructor Operator">⟧</a> <a id="1042" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">⟧</a>
  <a id="1046" href="Tactic.Derive.DecEq.html#961" class="Function">`no</a>  <a id="1051" href="Tactic.Derive.DecEq.html#1051" class="Bound">x</a> <a id="1053" class="Symbol">=</a> <a id="1055" class="Keyword">quote</a> <a id="1061" href="Relation.Nullary.Decidable.Core.html#1905" class="InductiveConstructor Operator">_because_</a> <a id="1071" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">◆⟦</a> <a id="1074" class="Keyword">quote</a> <a id="1080" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1086" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a> <a id="1088" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">∣</a> <a id="1090" class="Keyword">quote</a> <a id="1096" href="Relation.Nullary.Reflects.html#1091" class="InductiveConstructor">ofⁿ</a> <a id="1100" href="Reflection.Syntax.html#3187" class="InductiveConstructor Operator">◆⟦</a> <a id="1103" href="Tactic.Derive.DecEq.html#1051" class="Bound">x</a> <a id="1105" href="Reflection.Syntax.html#3187" class="InductiveConstructor Operator">⟧</a> <a id="1107" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">⟧</a>

  <a id="1112" class="Comment">-- We take the Dec P argument first to improve type checking performance.</a>
  <a id="1188" class="Comment">-- It&#39;s easy to infer the type of P from this argument and we need to know</a>
  <a id="1265" class="Comment">-- P to be able to check the pattern lambda generated for the P → Q direction</a>
  <a id="1345" class="Comment">-- of the isomorphism. Having the isomorphism first would cause the type checker</a>
  <a id="1428" class="Comment">-- to go back and forth between the pattern lambda and the Dec P argument,</a>
  <a id="1505" class="Comment">-- inferring just enough of the type of make progress on the lambda.</a>
  <a id="map&#39;"></a><a id="1576" href="Tactic.Derive.DecEq.html#1576" class="Function">map&#39;</a> <a id="1581" class="Symbol">:</a> <a id="1583" class="Symbol">∀</a> <a id="1585" class="Symbol">{</a><a id="1586" href="Tactic.Derive.DecEq.html#1586" class="Bound">p</a> <a id="1588" href="Tactic.Derive.DecEq.html#1588" class="Bound">q</a><a id="1589" class="Symbol">}</a> <a id="1591" class="Symbol">{</a><a id="1592" href="Tactic.Derive.DecEq.html#1592" class="Bound">P</a> <a id="1594" class="Symbol">:</a> <a id="1596" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1600" href="Tactic.Derive.DecEq.html#1586" class="Bound">p</a><a id="1601" class="Symbol">}</a> <a id="1603" class="Symbol">{</a><a id="1604" href="Tactic.Derive.DecEq.html#1604" class="Bound">Q</a> <a id="1606" class="Symbol">:</a> <a id="1608" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1612" href="Tactic.Derive.DecEq.html#1588" class="Bound">q</a><a id="1613" class="Symbol">}</a> <a id="1615" class="Symbol">→</a> <a id="1617" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a> <a id="1621" href="Tactic.Derive.DecEq.html#1592" class="Bound">P</a> <a id="1623" class="Symbol">→</a> <a id="1625" href="Tactic.Derive.DecEq.html#1592" class="Bound">P</a> <a id="1627" href="Function.Bundles.html#12400" class="Function Operator">⇔</a> <a id="1629" href="Tactic.Derive.DecEq.html#1604" class="Bound">Q</a> <a id="1631" class="Symbol">→</a> <a id="1633" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a> <a id="1637" href="Tactic.Derive.DecEq.html#1604" class="Bound">Q</a>
  <a id="1641" href="Tactic.Derive.DecEq.html#1576" class="Function">map&#39;</a> <a id="1646" href="Tactic.Derive.DecEq.html#1646" class="Bound">d</a> <a id="1648" class="Keyword">record</a> <a id="1655" class="Symbol">{</a> <a id="1657" href="Function.Bundles.html#4810" class="Field">to</a> <a id="1660" class="Symbol">=</a> <a id="1662" href="Tactic.Derive.DecEq.html#1662" class="Bound">to</a> <a id="1665" class="Symbol">;</a> <a id="1667" href="Function.Bundles.html#4834" class="Field">from</a> <a id="1672" class="Symbol">=</a> <a id="1674" href="Tactic.Derive.DecEq.html#1674" class="Bound">from</a> <a id="1679" class="Symbol">}</a> <a id="1681" class="Symbol">=</a> <a id="1683" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">map′</a> <a id="1688" href="Tactic.Derive.DecEq.html#1662" class="Bound">to</a> <a id="1691" href="Tactic.Derive.DecEq.html#1674" class="Bound">from</a> <a id="1696" href="Tactic.Derive.DecEq.html#1646" class="Bound">d</a>

  <a id="1701" class="Keyword">module</a> <a id="1708" href="Tactic.Derive.DecEq.html#1708" class="Module">_</a> <a id="1710" class="Symbol">(</a><a id="1711" href="Tactic.Derive.DecEq.html#1711" class="Bound">transName</a> <a id="1721" class="Symbol">:</a> <a id="1723" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1728" class="Symbol">→</a> <a id="1730" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1736" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="1740" class="Symbol">)</a> <a id="1742" class="Keyword">where</a>

    <a id="1753" href="Tactic.Derive.DecEq.html#1753" class="Function">eqFromTerm</a> <a id="1764" class="Symbol">:</a> <a id="1766" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1771" class="Symbol">→</a> <a id="1773" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1778" class="Symbol">→</a> <a id="1780" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1785" class="Symbol">→</a> <a id="1787" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="1796" href="Tactic.Derive.DecEq.html#1753" class="Function">eqFromTerm</a> <a id="1807" class="Symbol">(</a><a id="1808" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1812" href="Tactic.Derive.DecEq.html#1812" class="Bound">n</a> <a id="1814" class="Symbol">_)</a> <a id="1817" href="Tactic.Derive.DecEq.html#1817" class="Bound">t</a> <a id="1819" href="Tactic.Derive.DecEq.html#1819" class="Bound">t&#39;</a> <a id="1822" class="Keyword">with</a> <a id="1827" href="Tactic.Derive.DecEq.html#1711" class="Bound">transName</a> <a id="1837" href="Tactic.Derive.DecEq.html#1812" class="Bound">n</a>
    <a id="1843" class="Symbol">...</a> <a id="1847" class="Symbol">|</a> <a id="1849" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1854" href="Tactic.Derive.DecEq.html#1854" class="Bound">n&#39;</a>     <a id="1861" class="Symbol">=</a> <a id="1863" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1867" class="Symbol">(</a><a id="1868" class="Keyword">quote</a> <a id="1874" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a><a id="1877" class="Symbol">)</a> <a id="1879" class="Symbol">(</a><a id="1880" href="Reflection.AST.Argument.html#1453" class="InductiveConstructor">iArg</a> <a id="1885" class="Symbol">(</a><a id="1886" href="Tactic.Derive.DecEq.html#1854" class="Bound">n&#39;</a> <a id="1889" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a><a id="1890" class="Symbol">)</a> <a id="1892" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1894" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="1899" class="Bound">t</a> <a id="1901" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1903" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="1908" class="Bound">t&#39;</a> <a id="1911" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1913" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1915" class="Symbol">)</a>
    <a id="1921" class="Symbol">...</a> <a id="1925" class="Symbol">|</a> <a id="1927" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>     <a id="1939" class="Symbol">=</a> <a id="1941" class="Keyword">quote</a> <a id="1947" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a> <a id="1951" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="1954" class="Bound">t</a> <a id="1956" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="1958" class="Bound">t&#39;</a> <a id="1961" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>
    <a id="1967" href="Tactic.Derive.DecEq.html#1753" class="CatchallClause Function">eqFromTerm</a><a id="1977" class="CatchallClause"> </a><a id="1978" class="CatchallClause Symbol">_</a><a id="1979" class="CatchallClause"> </a><a id="1980" href="Tactic.Derive.DecEq.html#1980" class="CatchallClause Bound">t</a><a id="1981" class="CatchallClause"> </a><a id="1982" href="Tactic.Derive.DecEq.html#1982" class="CatchallClause Bound">t&#39;</a> <a id="1985" class="Symbol">=</a> <a id="1987" class="Keyword">quote</a> <a id="1993" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a> <a id="1997" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="2000" href="Tactic.Derive.DecEq.html#1980" class="Bound">t</a> <a id="2002" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="2004" href="Tactic.Derive.DecEq.html#1982" class="Bound">t&#39;</a> <a id="2007" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>

    <a id="2014" href="Tactic.Derive.DecEq.html#2014" class="Function">toDecEqName</a> <a id="2026" class="Symbol">:</a> <a id="2028" href="Tactic.ClauseBuilder.html#1262" class="Function">SinglePattern</a> <a id="2042" class="Symbol">→</a> <a id="2044" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2049" class="Symbol">(</a><a id="2050" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2055" class="Symbol">→</a> <a id="2057" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2062" class="Symbol">→</a> <a id="2064" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2068" class="Symbol">)</a>
    <a id="2074" href="Tactic.Derive.DecEq.html#2014" class="Function">toDecEqName</a> <a id="2086" class="Symbol">(</a><a id="2087" href="Tactic.Derive.DecEq.html#2087" class="Bound">l</a> <a id="2089" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2091" class="Symbol">_)</a> <a id="2094" class="Symbol">=</a> <a id="2096" href="Data.List.Base.html#1634" class="Function">L.map</a> <a id="2102" class="Symbol">(λ</a> <a id="2105" class="Keyword">where</a> <a id="2111" class="Symbol">(_</a> <a id="2114" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2116" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="2120" class="Symbol">_</a> <a id="2122" href="Tactic.Derive.DecEq.html#2122" class="Bound">t</a><a id="2123" class="Symbol">)</a> <a id="2125" class="Symbol">→</a> <a id="2127" href="Tactic.Derive.DecEq.html#1753" class="Function">eqFromTerm</a> <a id="2138" href="Tactic.Derive.DecEq.html#2122" class="Bound">t</a><a id="2139" class="Symbol">)</a> <a id="2141" href="Tactic.Derive.DecEq.html#2087" class="Bound">l</a>

    <a id="2148" class="Comment">-- on the diagonal we have one pattern, outside we don&#39;t care</a>
    <a id="2214" class="Comment">-- assume that the types in the pattern are properly normalized</a>
    <a id="2282" href="Tactic.Derive.DecEq.html#2282" class="Function">mapDiag</a> <a id="2290" class="Symbol">:</a> <a id="2292" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2298" href="Tactic.ClauseBuilder.html#1262" class="Function">SinglePattern</a> <a id="2312" class="Symbol">→</a> <a id="2314" href="Reflection.TCI.html#554" class="Function">TC</a> <a id="2317" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="2326" href="Tactic.Derive.DecEq.html#2282" class="Function">mapDiag</a> <a id="2334" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>          <a id="2351" class="Symbol">=</a> <a id="2353" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="2360" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2362" href="Tactic.Derive.DecEq.html#961" class="Function">`no</a> <a id="2366" href="Reflection.Syntax.html#2485" class="InductiveConstructor Operator">`λ⦅</a> <a id="2370" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="2372" class="Symbol">(</a><a id="2373" class="String">&quot;&quot;</a> <a id="2376" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2378" href="Reflection.Syntax.html#1381" class="InductiveConstructor">vArg?</a><a id="2383" class="Symbol">)</a> <a id="2385" href="Data.List.Base.html#5205" class="Function Operator">]</a> <a id="2387" href="Reflection.Syntax.html#2485" class="InductiveConstructor Operator">⦆∅</a>
    <a id="2394" href="Tactic.Derive.DecEq.html#2282" class="Function">mapDiag</a> <a id="2402" class="Symbol">(</a><a id="2403" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2408" href="Tactic.Derive.DecEq.html#2408" class="Bound">p</a><a id="2409" class="Symbol">@(</a><a id="2411" href="Tactic.Derive.DecEq.html#2411" class="Bound">l</a> <a id="2413" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2415" class="Symbol">_))</a> <a id="2419" class="Symbol">=</a> <a id="2421" class="Keyword">let</a> <a id="2425" href="Tactic.Derive.DecEq.html#2425" class="Bound">k</a> <a id="2427" class="Symbol">=</a> <a id="2429" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2436" href="Tactic.Derive.DecEq.html#2411" class="Bound">l</a> <a id="2438" class="Keyword">in</a> <a id="2441" class="Keyword">do</a>
      <a id="2450" href="Tactic.Derive.DecEq.html#2450" class="Bound">typeList</a> <a id="2459" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="2461" href="Class.Traversable.Core.html#297" class="Function">traverse</a> <a id="2470" class="Symbol">⦃</a> <a id="2472" href="Class.Functor.Instances.html#445" class="Function">Functor-List</a> <a id="2485" class="Symbol">⦄</a> <a id="2487" href="Class.MonadTC.html#1736" class="Field">inferType</a> <a id="2497" class="Symbol">(</a><a id="2498" href="Data.List.Base.html#6320" class="Function">applyDownFrom</a> <a id="2512" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="2514" class="Symbol">(</a><a id="2515" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2522" href="Tactic.Derive.DecEq.html#2411" class="Bound">l</a><a id="2523" class="Symbol">))</a>
      <a id="2532" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="2539" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2541" class="Keyword">quote</a> <a id="2547" href="Tactic.Derive.DecEq.html#1576" class="Function">map&#39;</a> <a id="2552" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="2555" href="Tactic.Derive.DecEq.html#2626" class="Function">genPf</a> <a id="2561" href="Tactic.Derive.DecEq.html#2425" class="Bound">k</a> <a id="2563" class="Symbol">(</a><a id="2564" href="Data.List.Base.html#1634" class="Function">L.map</a> <a id="2570" href="Tactic.Derive.DecEq.html#1753" class="Function">eqFromTerm</a> <a id="2581" href="Tactic.Derive.DecEq.html#2450" class="Bound">typeList</a><a id="2589" class="Symbol">)</a> <a id="2591" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="2593" href="Tactic.Derive.DecEq.html#2873" class="Function">genEquiv</a> <a id="2602" href="Tactic.Derive.DecEq.html#2425" class="Bound">k</a> <a id="2604" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>
      <a id="2612" class="Keyword">where</a>
        <a id="2626" href="Tactic.Derive.DecEq.html#2626" class="Function">genPf</a> <a id="2632" class="Symbol">:</a> <a id="2634" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2636" class="Symbol">→</a> <a id="2638" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2643" class="Symbol">(</a><a id="2644" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2649" class="Symbol">→</a> <a id="2651" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2656" class="Symbol">→</a> <a id="2658" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2662" class="Symbol">)</a> <a id="2664" class="Symbol">→</a> <a id="2666" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
        <a id="2679" href="Tactic.Derive.DecEq.html#2626" class="Function">genPf</a> <a id="2685" href="Tactic.Derive.DecEq.html#2685" class="Bound">k</a> <a id="2687" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>      <a id="2695" class="Symbol">=</a> <a id="2697" href="Tactic.Derive.DecEq.html#956" class="Function">`yes</a> <a id="2702" class="Symbol">(</a><a id="2703" class="Keyword">quote</a> <a id="2709" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2712" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a><a id="2713" class="Symbol">)</a>
        <a id="2723" href="Tactic.Derive.DecEq.html#2626" class="Function">genPf</a> <a id="2729" href="Tactic.Derive.DecEq.html#2729" class="Bound">k</a> <a id="2731" class="Symbol">(</a><a id="2732" href="Tactic.Derive.DecEq.html#2732" class="Bound">n</a> <a id="2734" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2736" href="Tactic.Derive.DecEq.html#2736" class="Bound">l</a><a id="2737" class="Symbol">)</a> <a id="2739" class="Symbol">=</a> <a id="2741" class="Keyword">quote</a> <a id="2747" href="Relation.Nullary.Decidable.Core.html#3103" class="Function Operator">_×-dec_</a> <a id="2755" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="2758" href="Tactic.Derive.DecEq.html#2626" class="Function">genPf</a> <a id="2764" href="Tactic.Derive.DecEq.html#2729" class="Bound">k</a> <a id="2766" href="Tactic.Derive.DecEq.html#2736" class="Bound">l</a> <a id="2768" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="2770" href="Tactic.Derive.DecEq.html#2732" class="Bound">n</a> <a id="2772" class="Symbol">(</a><a id="2773" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="2775" class="Symbol">(</a><a id="2776" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2783" href="Tactic.Derive.DecEq.html#2736" class="Bound">l</a><a id="2784" class="Symbol">))</a> <a id="2787" class="Symbol">(</a><a id="2788" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="2790" class="Symbol">(</a><a id="2791" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2798" href="Tactic.Derive.DecEq.html#2736" class="Bound">l</a> <a id="2800" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="2802" href="Tactic.Derive.DecEq.html#2729" class="Bound">k</a><a id="2803" class="Symbol">))</a> <a id="2806" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>

        <a id="2817" class="Comment">-- c x1 .. xn ≡ c y1 .. yn ⇔ x1 ≡ y1 .. xn ≡ yn</a>
        <a id="2873" href="Tactic.Derive.DecEq.html#2873" class="Function">genEquiv</a> <a id="2882" class="Symbol">:</a> <a id="2884" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2886" class="Symbol">→</a> <a id="2888" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
        <a id="2901" href="Tactic.Derive.DecEq.html#2873" class="Function">genEquiv</a> <a id="2910" href="Tactic.Derive.DecEq.html#2910" class="Bound">n</a> <a id="2912" class="Symbol">=</a> <a id="2914" class="Keyword">quote</a> <a id="2920" href="Function.Bundles.html#13499" class="Function">mk⇔</a> <a id="2924" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="2927" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">`λ⟦</a> <a id="2931" href="Tactic.Derive.DecEq.html#3026" class="Function">reflPattern</a> <a id="2943" href="Tactic.Derive.DecEq.html#2910" class="Bound">n</a> <a id="2945" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⇒</a> <a id="2947" class="Keyword">quote</a> <a id="2953" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2958" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a> <a id="2960" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⟧</a> <a id="2962" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="2964" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">`λ⟦</a> <a id="2968" class="Keyword">quote</a> <a id="2974" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2979" href="Reflection.Syntax.html#3281" class="InductiveConstructor Operator">◇</a> <a id="2981" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⇒</a> <a id="2983" href="Tactic.Derive.DecEq.html#3188" class="Function">reflTerm</a> <a id="2992" href="Tactic.Derive.DecEq.html#2910" class="Bound">n</a> <a id="2994" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⟧</a> <a id="2996" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a>
          <a id="3008" class="Keyword">where</a>
            <a id="3026" href="Tactic.Derive.DecEq.html#3026" class="Function">reflPattern</a> <a id="3038" class="Symbol">:</a> <a id="3040" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3042" class="Symbol">→</a> <a id="3044" href="Agda.Builtin.Reflection.html#5031" class="Datatype">Pattern</a>
            <a id="3064" href="Tactic.Derive.DecEq.html#3026" class="Function">reflPattern</a> <a id="3076" class="Number">0</a>       <a id="3084" class="Symbol">=</a> <a id="3086" class="Keyword">quote</a> <a id="3092" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3095" href="Reflection.Syntax.html#3281" class="InductiveConstructor Operator">◇</a>
            <a id="3109" href="Tactic.Derive.DecEq.html#3026" class="Function">reflPattern</a> <a id="3121" class="Symbol">(</a><a id="3122" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3126" href="Tactic.Derive.DecEq.html#3126" class="Bound">n</a><a id="3127" class="Symbol">)</a> <a id="3129" class="Symbol">=</a> <a id="3131" class="Keyword">quote</a> <a id="3137" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="3141" href="Reflection.Syntax.html#3361" class="InductiveConstructor Operator">◇⟦</a> <a id="3144" href="Tactic.Derive.DecEq.html#3026" class="Function">reflPattern</a> <a id="3156" href="Tactic.Derive.DecEq.html#3126" class="Bound">n</a> <a id="3158" href="Reflection.Syntax.html#3361" class="InductiveConstructor Operator">∣</a> <a id="3160" class="Keyword">quote</a> <a id="3166" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3171" href="Reflection.Syntax.html#3281" class="InductiveConstructor Operator">◇</a> <a id="3173" href="Reflection.Syntax.html#3361" class="InductiveConstructor Operator">⟧</a>

            <a id="3188" href="Tactic.Derive.DecEq.html#3188" class="Function">reflTerm</a> <a id="3197" class="Symbol">:</a> <a id="3199" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3201" class="Symbol">→</a> <a id="3203" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
            <a id="3220" href="Tactic.Derive.DecEq.html#3188" class="Function">reflTerm</a> <a id="3229" class="Number">0</a>       <a id="3237" class="Symbol">=</a> <a id="3239" class="Keyword">quote</a> <a id="3245" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3248" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a>
            <a id="3262" href="Tactic.Derive.DecEq.html#3188" class="Function">reflTerm</a> <a id="3271" class="Symbol">(</a><a id="3272" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3276" href="Tactic.Derive.DecEq.html#3276" class="Bound">n</a><a id="3277" class="Symbol">)</a> <a id="3279" class="Symbol">=</a> <a id="3281" class="Keyword">quote</a> <a id="3287" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="3291" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">◆⟦</a> <a id="3294" href="Tactic.Derive.DecEq.html#3188" class="Function">reflTerm</a> <a id="3303" href="Tactic.Derive.DecEq.html#3276" class="Bound">n</a> <a id="3305" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">∣</a> <a id="3307" class="Keyword">quote</a> <a id="3313" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3318" href="Reflection.Syntax.html#3163" class="InductiveConstructor Operator">◆</a> <a id="3320" href="Reflection.Syntax.html#3227" class="InductiveConstructor Operator">⟧</a>

    <a id="3327" href="Tactic.Derive.DecEq.html#3327" class="Function">toMapDiag</a> <a id="3337" class="Symbol">:</a> <a id="3339" href="Tactic.ClauseBuilder.html#1262" class="Function">SinglePattern</a> <a id="3353" class="Symbol">→</a> <a id="3355" href="Tactic.ClauseBuilder.html#1262" class="Function">SinglePattern</a> <a id="3369" class="Symbol">→</a> <a id="3371" href="Data.List.NonEmpty.Base.html#1229" class="Record">NE.List⁺</a> <a id="3380" href="Tactic.ClauseBuilder.html#1262" class="Function">SinglePattern</a> <a id="3394" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3396" href="Reflection.TCI.html#554" class="Function">TC</a> <a id="3399" class="Symbol">(</a><a id="3400" href="Tactic.ClauseBuilder.html#5754" class="Datatype">ClauseExpr</a> <a id="3411" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3413" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3419" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="3423" class="Symbol">)</a>
    <a id="3429" href="Tactic.Derive.DecEq.html#3327" class="Function">toMapDiag</a> <a id="3439" href="Tactic.Derive.DecEq.html#3439" class="Bound">p</a><a id="3440" class="Symbol">@(_</a> <a id="3444" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3446" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3450" class="Symbol">_</a> <a id="3452" href="Tactic.Derive.DecEq.html#3452" class="Bound">p₁</a><a id="3454" class="Symbol">)</a> <a id="3456" href="Tactic.Derive.DecEq.html#3456" class="Bound">p&#39;</a><a id="3458" class="Symbol">@(_</a> <a id="3462" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3464" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3468" class="Symbol">_</a> <a id="3470" href="Tactic.Derive.DecEq.html#3470" class="Bound">p₂</a><a id="3472" class="Symbol">)</a> <a id="3474" class="Symbol">=</a>
      <a id="3482" class="Symbol">(</a><a id="3483" href="Tactic.Derive.DecEq.html#3439" class="Bound">p</a> <a id="3485" href="Data.List.NonEmpty.Base.html#1275" class="InductiveConstructor Operator">NE.∷</a> <a id="3490" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3492" href="Tactic.Derive.DecEq.html#3456" class="Bound">p&#39;</a> <a id="3495" href="Data.List.Base.html#5205" class="Function Operator">]</a> <a id="3497" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3499" href="Tactic.ClauseBuilder.html#12831" class="Function">finishMatch</a> <a id="3511" class="Symbol">(</a><a id="3512" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="3515" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌊</a> <a id="3517" href="Tactic.Derive.DecEq.html#3452" class="Bound">p₁</a> <a id="3520" href="Reflection.AST.Term.html#5709" class="Function Operator">≟-Pattern</a> <a id="3530" href="Tactic.Derive.DecEq.html#3470" class="Bound">p₂</a> <a id="3533" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌋</a> <a id="3535" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="3540" href="Tactic.Derive.DecEq.html#2282" class="Function">mapDiag</a> <a id="3548" class="Symbol">(</a><a id="3549" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3554" href="Tactic.Derive.DecEq.html#3439" class="Bound">p</a><a id="3555" class="Symbol">)</a> <a id="3557" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="3562" href="Tactic.Derive.DecEq.html#2282" class="Function">mapDiag</a> <a id="3570" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3577" class="Symbol">))</a>

<a id="3581" class="Keyword">module</a> <a id="3588" href="Tactic.Derive.DecEq.html#3588" class="Module">_</a> <a id="3590" class="Symbol">⦃</a> <a id="3592" href="Tactic.Derive.DecEq.html#3592" class="Bound">_</a> <a id="3594" class="Symbol">:</a> <a id="3596" href="Class.MonadTC.html#620" class="Record">TCOptions</a> <a id="3606" class="Symbol">⦄</a> <a id="3608" class="Keyword">where</a>
  <a id="3616" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="3629" class="Symbol">:</a> <a id="3631" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3636" class="Symbol">(</a><a id="3637" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3642" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3644" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="3648" class="Symbol">)</a> <a id="3650" class="Symbol">→</a> <a id="3652" href="Reflection.Tactic.html#476" class="Function">UnquoteDecl</a>
  <a id="3666" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="3679" class="Symbol">=</a> <a id="3681" href="Tactic.Derive.html#5784" class="Function">derive-Class</a> <a id="3694" class="Number">0</a> <a id="3696" class="Symbol">(λ</a> <a id="3699" href="Tactic.Derive.DecEq.html#3699" class="Bound">transName</a> <a id="3709" href="Tactic.Derive.DecEq.html#3709" class="Bound">ps</a> <a id="3712" class="Symbol">→</a> <a id="3714" href="Data.List.Base.html#2132" class="Function">cartesianProductWith</a> <a id="3735" class="Symbol">(</a><a id="3736" href="Tactic.Derive.DecEq.html#3327" class="Function">toMapDiag</a> <a id="3746" href="Tactic.Derive.DecEq.html#3699" class="Bound">transName</a><a id="3755" class="Symbol">)</a> <a id="3757" href="Tactic.Derive.DecEq.html#3709" class="Bound">ps</a> <a id="3760" href="Tactic.Derive.DecEq.html#3709" class="Bound">ps</a><a id="3762" class="Symbol">)</a>

<a id="3765" class="Keyword">private</a>
  <a id="3775" class="Keyword">open</a> <a id="3780" class="Keyword">import</a> <a id="3787" href="Tactic.Derive.TestTypes.html" class="Module">Tactic.Derive.TestTypes</a>
  <a id="3813" class="Keyword">open</a> <a id="3818" class="Keyword">import</a> <a id="3825" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

  <a id="3844" class="Keyword">unquoteDecl</a> <a id="DecEq-These"></a><a id="3856" href="Tactic.Derive.DecEq.html#3856" class="Function">DecEq-These</a> <a id="3868" class="Symbol">=</a> <a id="3870" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="3883" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3885" class="Symbol">(</a><a id="3886" class="Keyword">quote</a> <a id="3892" href="Data.These.Base.html#537" class="Datatype">These</a> <a id="3898" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3900" href="Tactic.Derive.DecEq.html#3856" class="Function">DecEq-These</a><a id="3911" class="Symbol">)</a> <a id="3913" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="3918" class="Keyword">unquoteDecl</a> <a id="DecEq-⊎"></a><a id="3930" href="Tactic.Derive.DecEq.html#3930" class="Function">DecEq-⊎</a> <a id="3938" class="Symbol">=</a> <a id="3940" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="3953" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3955" class="Symbol">(</a><a id="3956" class="Keyword">quote</a> <a id="3962" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a> <a id="3966" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3968" href="Tactic.Derive.DecEq.html#3930" class="Function">DecEq-⊎</a><a id="3975" class="Symbol">)</a> <a id="3977" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="3982" class="Keyword">unquoteDecl</a> <a id="DecEq-Bool"></a><a id="3994" href="Tactic.Derive.DecEq.html#3994" class="Function">DecEq-Bool</a> <a id="DecEq-ℤ"></a><a id="4005" href="Tactic.Derive.DecEq.html#4005" class="Function">DecEq-ℤ</a> <a id="DecEq-List"></a><a id="4013" href="Tactic.Derive.DecEq.html#4013" class="Function">DecEq-List</a> <a id="DecEq-Maybe"></a><a id="4024" href="Tactic.Derive.DecEq.html#4024" class="Function">DecEq-Maybe</a> <a id="DecEq-ℕ"></a><a id="4036" href="Tactic.Derive.DecEq.html#4036" class="Function">DecEq-ℕ</a> <a id="DecEq-Sign"></a><a id="4044" href="Tactic.Derive.DecEq.html#4044" class="Function">DecEq-Sign</a> <a id="DecEq-⊤"></a><a id="4055" href="Tactic.Derive.DecEq.html#4055" class="Function">DecEq-⊤</a> <a id="4063" class="Symbol">=</a> <a id="4065" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="4078" class="Symbol">((</a><a id="4080" class="Keyword">quote</a> <a id="4086" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="4091" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4093" href="Tactic.Derive.DecEq.html#3994" class="Function">DecEq-Bool</a><a id="4103" class="Symbol">)</a> <a id="4105" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4107" class="Symbol">(</a><a id="4108" class="Keyword">quote</a> <a id="4114" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a> <a id="4116" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4118" href="Tactic.Derive.DecEq.html#4005" class="Function">DecEq-ℤ</a><a id="4125" class="Symbol">)</a> <a id="4127" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4129" class="Symbol">(</a><a id="4130" class="Keyword">quote</a> <a id="4136" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4141" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4143" href="Tactic.Derive.DecEq.html#4013" class="Function">DecEq-List</a><a id="4153" class="Symbol">)</a> <a id="4155" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4157" class="Symbol">(</a><a id="4158" class="Keyword">quote</a> <a id="4164" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4170" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4172" href="Tactic.Derive.DecEq.html#4024" class="Function">DecEq-Maybe</a><a id="4183" class="Symbol">)</a> <a id="4185" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4187" class="Symbol">(</a><a id="4188" class="Keyword">quote</a> <a id="4194" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4196" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4198" href="Tactic.Derive.DecEq.html#4036" class="Function">DecEq-ℕ</a><a id="4205" class="Symbol">)</a> <a id="4207" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4209" class="Symbol">(</a><a id="4210" class="Keyword">quote</a> <a id="4216" href="Data.Sign.Base.html#523" class="Datatype">Sign</a> <a id="4221" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4223" href="Tactic.Derive.DecEq.html#4044" class="Function">DecEq-Sign</a><a id="4233" class="Symbol">)</a> <a id="4235" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4237" class="Symbol">(</a><a id="4238" class="Keyword">quote</a> <a id="4244" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="4246" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4248" href="Tactic.Derive.DecEq.html#4055" class="Function">DecEq-⊤</a><a id="4255" class="Symbol">)</a> <a id="4257" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4259" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4261" class="Symbol">)</a>

  <a id="4266" class="Keyword">unquoteDecl</a> <a id="DecEq-Fin"></a><a id="4278" href="Tactic.Derive.DecEq.html#4278" class="Function">DecEq-Fin</a> <a id="4288" class="Symbol">=</a> <a id="4290" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="4303" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4305" class="Symbol">(</a><a id="4306" class="Keyword">quote</a> <a id="4312" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="4316" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4318" href="Tactic.Derive.DecEq.html#4278" class="Function">DecEq-Fin</a><a id="4327" class="Symbol">)</a> <a id="4329" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="4334" class="Comment">-- this doesn&#39;t work since the clause builder machinery doesn&#39;t deal</a>
  <a id="4405" class="Comment">-- with absurd patterns yet</a>

  <a id="4436" class="Comment">--unquoteDecl DecEq-Vec = derive-DecEq [ (quote Vec , DecEq-Vec) ]</a>

  <a id="4506" class="Keyword">unquoteDecl</a> <a id="DecEq-E1"></a><a id="4518" href="Tactic.Derive.DecEq.html#4518" class="Function">DecEq-E1</a> <a id="4527" class="Symbol">=</a> <a id="4529" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="4542" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4544" class="Symbol">(</a><a id="4545" class="Keyword">quote</a> <a id="4551" href="Tactic.Derive.TestTypes.html#204" class="Datatype">E1</a> <a id="4554" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4556" href="Tactic.Derive.DecEq.html#4518" class="Function">DecEq-E1</a><a id="4564" class="Symbol">)</a> <a id="4566" href="Data.List.Base.html#5205" class="Function Operator">]</a>
  <a id="4570" class="Keyword">unquoteDecl</a> <a id="DecEq-E2"></a><a id="4582" href="Tactic.Derive.DecEq.html#4582" class="Function">DecEq-E2</a> <a id="4591" class="Symbol">=</a> <a id="4593" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="4606" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4608" class="Symbol">(</a><a id="4609" class="Keyword">quote</a> <a id="4615" href="Tactic.Derive.TestTypes.html#309" class="Datatype">E2</a> <a id="4618" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4620" href="Tactic.Derive.DecEq.html#4582" class="Function">DecEq-E2</a><a id="4628" class="Symbol">)</a> <a id="4630" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="4635" class="Comment">-- this uses mutual recursion with List E3</a>
  <a id="4680" class="Keyword">unquoteDecl</a> <a id="DecEq-E3"></a><a id="4692" href="Tactic.Derive.DecEq.html#4692" class="Function">DecEq-E3</a> <a id="4701" class="Symbol">=</a> <a id="4703" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="4716" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4718" class="Symbol">(</a><a id="4719" class="Keyword">quote</a> <a id="4725" href="Tactic.Derive.TestTypes.html#387" class="Datatype">E3</a> <a id="4728" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4730" href="Tactic.Derive.DecEq.html#4692" class="Function">DecEq-E3</a><a id="4738" class="Symbol">)</a> <a id="4740" href="Data.List.Base.html#5205" class="Function Operator">]</a>
  <a id="4744" class="Comment">-- unquoteDecl DecEq-E4 = derive-DecEq [ (quote E4 , DecEq-E4) ]</a>

  <a id="4812" class="Keyword">unquoteDecl</a> <a id="DecEq-R1"></a><a id="4824" href="Tactic.Derive.DecEq.html#4824" class="Function">DecEq-R1</a> <a id="4833" class="Symbol">=</a> <a id="4835" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="4848" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4850" class="Symbol">(</a><a id="4851" class="Keyword">quote</a> <a id="4857" href="Tactic.Derive.TestTypes.html#597" class="Record">R1</a> <a id="4860" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4862" href="Tactic.Derive.DecEq.html#4824" class="Function">DecEq-R1</a><a id="4870" class="Symbol">)</a> <a id="4872" href="Data.List.Base.html#5205" class="Function Operator">]</a>
  <a id="4876" class="Keyword">unquoteDecl</a> <a id="DecEq-R2"></a><a id="4888" href="Tactic.Derive.DecEq.html#4888" class="Function">DecEq-R2</a> <a id="4897" class="Symbol">=</a> <a id="4899" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="4912" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4914" class="Symbol">(</a><a id="4915" class="Keyword">quote</a> <a id="4921" href="Tactic.Derive.TestTypes.html#658" class="Record">R2</a> <a id="4924" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4926" href="Tactic.Derive.DecEq.html#4888" class="Function">DecEq-R2</a><a id="4934" class="Symbol">)</a> <a id="4936" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="4941" class="Keyword">unquoteDecl</a> <a id="DecEq-M₁"></a><a id="4953" href="Tactic.Derive.DecEq.html#4953" class="Function">DecEq-M₁</a> <a id="DecEq-M₂"></a><a id="4962" href="Tactic.Derive.DecEq.html#4962" class="Function">DecEq-M₂</a> <a id="4971" class="Symbol">=</a> <a id="4973" href="Tactic.Derive.DecEq.html#3616" class="Function">derive-DecEq</a> <a id="4986" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4988" class="Symbol">(</a><a id="4989" class="Keyword">quote</a> <a id="4995" href="Tactic.Derive.TestTypes.html#805" class="Datatype">M₁</a> <a id="4998" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5000" href="Tactic.Derive.DecEq.html#4953" class="Function">DecEq-M₁</a><a id="5008" class="Symbol">)</a> <a id="5010" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5012" class="Symbol">(</a><a id="5013" class="Keyword">quote</a> <a id="5019" href="Tactic.Derive.TestTypes.html#819" class="Datatype">M₂</a> <a id="5022" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5024" href="Tactic.Derive.DecEq.html#4962" class="Function">DecEq-M₂</a><a id="5032" class="Symbol">)</a> <a id="5034" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5036" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="5042" class="Comment">-- Expected: DecEq-Term DecEq-Product</a>
</pre></body></html>