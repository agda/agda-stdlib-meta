<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.Utils.TCI</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Reflection/Utils/TCI.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Keyword">module</a> <a id="43" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a> <a id="64" class="Keyword">where</a>

<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Prelude.html" class="Module">Prelude</a>
<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Meta.html" class="Module">Meta</a>

<a id="109" class="Keyword">import</a> <a id="116" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="125" class="Keyword">open</a> <a id="130" class="Keyword">import</a> <a id="137" href="Data.List.html" class="Module">Data.List</a> <a id="147" class="Keyword">using</a> <a id="153" class="Symbol">(</a><a id="154" href="Data.List.Base.html#1553" class="Function">map</a><a id="157" class="Symbol">;</a> <a id="159" href="Data.List.Base.html#2819" class="Function">zipWith</a><a id="166" class="Symbol">)</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="236" class="Keyword">using</a> <a id="242" class="Symbol">(</a><a id="243" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊_⌋</a><a id="246" class="Symbol">)</a>

<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Class.DecEq.html" class="Module">Class.DecEq</a>

<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="300" class="Keyword">open</a> <a id="305" class="Keyword">import</a> <a id="312" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Class.MonadError.Instances.html" class="Module">Class.MonadError.Instances</a>
<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Class.MonadReader.Instances.html" class="Module">Class.MonadReader.Instances</a>
<a id="403" class="Keyword">open</a> <a id="408" class="Keyword">import</a> <a id="415" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="470" class="Keyword">private</a>
  <a id="480" class="Keyword">variable</a> <a id="489" href="Reflection.Utils.TCI.html#489" class="Generalizable">a</a> <a id="491" href="Reflection.Utils.TCI.html#491" class="Generalizable">b</a> <a id="493" href="Reflection.Utils.TCI.html#493" class="Generalizable">c</a> <a id="495" class="Symbol">:</a> <a id="497" href="Agda.Primitive.html#591" class="Postulate">Level</a>
           <a id="514" href="Reflection.Utils.TCI.html#514" class="Generalizable">A</a> <a id="516" class="Symbol">:</a> <a id="518" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="522" href="Reflection.Utils.TCI.html#489" class="Generalizable">a</a>
           <a id="535" href="Reflection.Utils.TCI.html#535" class="Generalizable">B</a> <a id="537" class="Symbol">:</a> <a id="539" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="543" href="Reflection.Utils.TCI.html#491" class="Generalizable">b</a>

<a id="546" class="Keyword">module</a> <a id="553" href="Reflection.Utils.TCI.html#553" class="Module">_</a> <a id="555" class="Symbol">{</a><a id="556" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="558" class="Symbol">:</a> <a id="560" class="Symbol">∀</a> <a id="562" class="Symbol">{</a><a id="563" href="Reflection.Utils.TCI.html#563" class="Bound">a</a><a id="564" class="Symbol">}</a> <a id="566" class="Symbol">→</a> <a id="568" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="572" href="Reflection.Utils.TCI.html#563" class="Bound">a</a> <a id="574" class="Symbol">→</a> <a id="576" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="580" href="Reflection.Utils.TCI.html#563" class="Bound">a</a><a id="581" class="Symbol">}</a> <a id="583" class="Symbol">⦃</a> <a id="585" href="Reflection.Utils.TCI.html#585" class="Bound">_</a> <a id="587" class="Symbol">:</a> <a id="589" href="Class.Monad.Core.html#203" class="Record">Monad</a> <a id="595" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="597" class="Symbol">⦄</a> <a id="599" class="Symbol">⦃</a> <a id="601" href="Reflection.Utils.TCI.html#601" class="Bound">me</a> <a id="604" class="Symbol">:</a> <a id="606" href="Class.MonadError.html#263" class="Record">MonadError</a> <a id="617" class="Symbol">(</a><a id="618" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="623" href="Agda.Builtin.Reflection.html#7876" class="Datatype">ErrorPart</a><a id="632" class="Symbol">)</a> <a id="634" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="636" class="Symbol">⦄</a>
         <a id="647" class="Symbol">⦃</a> <a id="649" href="Reflection.Utils.TCI.html#649" class="Bound">mre</a> <a id="653" class="Symbol">:</a> <a id="655" href="Class.MonadReader.html#228" class="Record">MonadReader</a> <a id="667" href="Class.MonadTC.html#819" class="Record">TCEnv</a> <a id="673" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="675" class="Symbol">⦄</a> <a id="677" class="Symbol">⦃</a> <a id="679" href="Reflection.Utils.TCI.html#679" class="Bound">_</a> <a id="681" class="Symbol">:</a> <a id="683" href="Class.MonadTC.html#1520" class="Record">MonadTC</a> <a id="691" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="693" class="Symbol">⦄</a> <a id="695" class="Keyword">where</a>

  <a id="704" class="Keyword">instance</a> <a id="713" href="Reflection.Utils.TCI.html#713" class="Function">_</a> <a id="715" class="Symbol">=</a> <a id="717" href="Class.Monad.Core.html#655" class="Function">Functor-M</a>

  <a id="730" href="Reflection.Utils.TCI.html#730" class="Function">logTelescope</a> <a id="743" class="Symbol">:</a> <a id="745" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="750" class="Symbol">(</a><a id="751" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="757" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="764" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="766" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="770" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="774" class="Symbol">)</a> <a id="776" class="Symbol">→</a> <a id="778" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="780" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
  <a id="784" href="Reflection.Utils.TCI.html#730" class="Function">logTelescope</a> <a id="797" href="Reflection.Utils.TCI.html#797" class="Bound">l</a> <a id="799" class="Symbol">=</a> <a id="801" href="Class.MonadTC.html#6390" class="Function">withAppendDebugPath</a> <a id="821" class="String">&quot;context&quot;</a> <a id="831" class="Keyword">do</a>
    <a id="838" href="Class.MonadError.html#359" class="Field">catch</a> <a id="844" class="Symbol">(</a><a id="845" href="Reflection.Utils.TCI.html#936" class="Function">helper</a> <a id="852" class="Symbol">(</a><a id="853" href="Data.List.Base.html#4873" class="Function">length</a> <a id="860" href="Reflection.Utils.TCI.html#797" class="Bound">l</a><a id="861" class="Symbol">)</a> <a id="863" href="Reflection.Utils.TCI.html#797" class="Bound">l</a><a id="864" class="Symbol">)</a> <a id="866" class="Symbol">(λ</a> <a id="869" href="Reflection.Utils.TCI.html#869" class="Bound">_</a> <a id="871" class="Symbol">→</a> <a id="873" href="Class.MonadTC.html#8788" class="Function">debugLog1</a> <a id="883" class="String">&quot;Error while printing the context!&quot;</a><a id="918" class="Symbol">)</a>
    <a id="924" class="Keyword">where</a>
      <a id="936" href="Reflection.Utils.TCI.html#936" class="Function">helper</a> <a id="943" class="Symbol">:</a> <a id="945" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="947" class="Symbol">→</a> <a id="949" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="954" class="Symbol">(</a><a id="955" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="961" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="968" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="970" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="974" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="978" class="Symbol">)</a> <a id="980" class="Symbol">→</a> <a id="982" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="984" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
      <a id="992" href="Reflection.Utils.TCI.html#936" class="Function">helper</a> <a id="999" href="Reflection.Utils.TCI.html#999" class="Bound">n</a> <a id="1001" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1004" class="Symbol">=</a> <a id="1006" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1013" class="Symbol">_</a>
      <a id="1021" href="Reflection.Utils.TCI.html#936" class="Function">helper</a> <a id="1028" href="Reflection.Utils.TCI.html#1028" class="Bound">n</a> <a id="1030" class="Symbol">((</a><a id="1032" href="Reflection.Utils.TCI.html#1032" class="Bound">x</a> <a id="1034" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1036" href="Reflection.Utils.TCI.html#1036" class="Bound">ty</a><a id="1038" class="Symbol">@(</a><a id="1040" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1044" class="Symbol">_</a> <a id="1046" href="Reflection.Utils.TCI.html#1046" class="Bound">t</a><a id="1047" class="Symbol">))</a> <a id="1050" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1052" href="Reflection.Utils.TCI.html#1052" class="Bound">l</a><a id="1053" class="Symbol">)</a> <a id="1055" class="Symbol">=</a> <a id="1057" class="Keyword">do</a>
        <a id="1068" class="Keyword">let</a> <a id="1072" href="Reflection.Utils.TCI.html#1072" class="Bound">name</a> <a id="1077" class="Symbol">=</a> <a id="1079" href="Function.Base.html#4130" class="Function Operator">case</a> <a id="1084" href="Reflection.Utils.TCI.html#1032" class="Bound">x</a> <a id="1086" href="Function.Base.html#4130" class="Function Operator">of</a> <a id="1089" class="Symbol">λ</a> <a id="1091" class="Keyword">where</a>
          <a id="1107" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>   <a id="1117" class="Symbol">→</a> <a id="1119" class="String">&quot;?&quot;</a>
          <a id="1133" class="Symbol">(</a><a id="1134" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1139" class="String">&quot;&quot;</a><a id="1141" class="Symbol">)</a> <a id="1143" class="Symbol">→</a> <a id="1145" class="String">&quot;_&quot;</a>
          <a id="1159" class="Symbol">(</a><a id="1160" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1165" href="Reflection.Utils.TCI.html#1165" class="Bound">x</a><a id="1166" class="Symbol">)</a>  <a id="1169" class="Symbol">→</a> <a id="1171" href="Reflection.Utils.TCI.html#1165" class="Bound">x</a>
        <a id="1181" href="Class.MonadTC.html#5721" class="Function">debugLog</a> <a id="1190" class="Symbol">(</a><a id="1191" class="String">&quot;  &quot;</a> <a id="1196" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1199" href="Reflection.Utils.TCI.html#1072" class="Bound">name</a> <a id="1204" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1207" class="String">&quot; : &quot;</a>  <a id="1214" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1217" href="Reflection.Utils.html#5655" class="Function">mapVars</a> <a id="1225" class="Symbol">(</a><a id="1226" href="Data.Nat.Base.html#2883" class="Primitive Operator">_∸</a> <a id="1229" class="Symbol">(</a><a id="1230" href="Reflection.Utils.TCI.html#1028" class="Bound">n</a> <a id="1232" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="1234" class="Symbol">(</a><a id="1235" class="Number">1</a> <a id="1237" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1239" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1246" href="Reflection.Utils.TCI.html#1052" class="Bound">l</a><a id="1247" class="Symbol">)))</a> <a id="1251" href="Reflection.Utils.TCI.html#1046" class="Bound">t</a> <a id="1253" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1256" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1258" class="Symbol">)</a>
        <a id="1268" href="Class.MonadTC.html#7874" class="Function">extendContext</a> <a id="1282" class="Symbol">(</a><a id="1283" href="Reflection.Utils.TCI.html#1072" class="Bound">name</a> <a id="1288" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1290" href="Reflection.Utils.TCI.html#1036" class="Bound">ty</a><a id="1292" class="Symbol">)</a> <a id="1294" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1296" href="Reflection.Utils.TCI.html#936" class="Function">helper</a> <a id="1303" href="Reflection.Utils.TCI.html#1028" class="Bound">n</a> <a id="1305" href="Reflection.Utils.TCI.html#1052" class="Bound">l</a>

  <a id="1310" href="Reflection.Utils.TCI.html#1310" class="Function">logContext</a> <a id="1321" class="Symbol">:</a> <a id="1323" href="Reflection.Term.html#1580" class="Function">Telescope</a> <a id="1333" class="Symbol">→</a> <a id="1335" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="1337" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
  <a id="1341" href="Reflection.Utils.TCI.html#1310" class="Function">logContext</a> <a id="1352" href="Reflection.Utils.TCI.html#1352" class="Bound">l</a> <a id="1354" class="Symbol">=</a> <a id="1356" href="Class.MonadTC.html#6390" class="Function">withAppendDebugPath</a> <a id="1376" class="String">&quot;context&quot;</a> <a id="1386" class="Keyword">do</a>
    <a id="1393" href="Class.MonadTC.html#8788" class="Function">debugLog1</a> <a id="1403" class="String">&quot;Context:&quot;</a>
    <a id="1418" href="Class.MonadError.html#359" class="Field">catch</a> <a id="1424" class="Symbol">(</a><a id="1425" href="Reflection.Utils.TCI.html#1766" class="Function">helper</a> <a id="1432" class="Symbol">(</a><a id="1433" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1440" href="Reflection.Utils.TCI.html#1352" class="Bound">l</a><a id="1441" class="Symbol">)</a> <a id="1443" href="Reflection.Utils.TCI.html#1352" class="Bound">l</a><a id="1444" class="Symbol">)</a> <a id="1446" class="Symbol">(λ</a> <a id="1449" href="Reflection.Utils.TCI.html#1449" class="Bound">_</a> <a id="1451" class="Symbol">→</a> <a id="1453" href="Class.MonadTC.html#8788" class="Function">debugLog1</a> <a id="1463" class="String">&quot;Error while printing the context!&quot;</a><a id="1498" class="Symbol">)</a>
    <a id="1504" href="Class.MonadError.html#359" class="Field">catch</a> <a id="1510" class="Symbol">(</a><a id="1511" class="Keyword">do</a>
      <a id="1520" href="Reflection.Utils.TCI.html#1520" class="Bound">goalTy</a> <a id="1527" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1529" href="Class.MonadTC.html#9098" class="Function">goalTy</a>
      <a id="1542" href="Class.MonadTC.html#5721" class="Function">debugLog</a> <a id="1551" class="Symbol">(</a><a id="1552" class="String">&quot;  ⊢ &quot;</a> <a id="1559" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1562" href="Reflection.Utils.TCI.html#1520" class="Bound">goalTy</a> <a id="1569" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1572" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1574" class="Symbol">))</a>
      <a id="1583" class="Symbol">λ</a> <a id="1585" href="Reflection.Utils.TCI.html#1585" class="Bound">_</a> <a id="1587" class="Symbol">→</a> <a id="1589" class="Keyword">do</a>
        <a id="1600" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="1605" href="Reflection.Utils.TCI.html#1605" class="Bound">t</a> <a id="1607" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1609" href="Class.MonadReader.html#386" class="Function">reader</a> <a id="1616" href="Class.MonadTC.html#1027" class="Field">TCEnv.goal</a>
          <a id="1637" class="Keyword">where</a> <a id="1643" class="CatchallClause Symbol">_</a> <a id="1645" class="Symbol">→</a> <a id="1647" href="Class.MonadTC.html#8719" class="Function">error1</a> <a id="1654" class="String">&quot;Bug in logContext!&quot;</a>
        <a id="1683" href="Class.MonadTC.html#5721" class="Function">debugLog</a> <a id="1692" class="Symbol">(</a><a id="1693" class="String">&quot;Error while infering the goal type! Goal: &quot;</a> <a id="1738" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1741" href="Reflection.Utils.TCI.html#1605" class="Bound">t</a> <a id="1743" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1746" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1748" class="Symbol">)</a>
    <a id="1754" class="Keyword">where</a>
      <a id="1766" href="Reflection.Utils.TCI.html#1766" class="Function">helper</a> <a id="1773" class="Symbol">:</a> <a id="1775" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1777" class="Symbol">→</a> <a id="1779" href="Reflection.Term.html#1580" class="Function">Telescope</a> <a id="1789" class="Symbol">→</a> <a id="1791" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="1793" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
      <a id="1801" href="Reflection.Utils.TCI.html#1766" class="Function">helper</a> <a id="1808" href="Reflection.Utils.TCI.html#1808" class="Bound">n</a> <a id="1810" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1813" class="Symbol">=</a> <a id="1815" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1822" class="Symbol">_</a>
      <a id="1830" href="Reflection.Utils.TCI.html#1766" class="Function">helper</a> <a id="1837" href="Reflection.Utils.TCI.html#1837" class="Bound">n</a> <a id="1839" class="Symbol">((_</a> <a id="1843" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1845" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1849" class="Symbol">_</a> <a id="1851" href="Reflection.Utils.TCI.html#1851" class="Bound">t</a><a id="1852" class="Symbol">)</a> <a id="1854" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1856" href="Reflection.Utils.TCI.html#1856" class="Bound">l</a><a id="1857" class="Symbol">)</a> <a id="1859" class="Symbol">=</a> <a id="1861" class="Keyword">do</a>
        <a id="1872" href="Reflection.Utils.TCI.html#1766" class="Function">helper</a> <a id="1879" href="Reflection.Utils.TCI.html#1837" class="Bound">n</a> <a id="1881" href="Reflection.Utils.TCI.html#1856" class="Bound">l</a>
        <a id="1891" href="Class.MonadTC.html#5721" class="Function">debugLog</a> <a id="1900" class="Symbol">(</a><a id="1901" class="String">&quot;  &quot;</a> <a id="1906" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1909" href="Reflection.Syntax.html#1085" class="InductiveConstructor">♯</a> <a id="1911" class="Symbol">(</a><a id="1912" href="Reflection.Utils.TCI.html#1837" class="Bound">n</a> <a id="1914" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="1916" class="Symbol">(</a><a id="1917" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1924" href="Reflection.Utils.TCI.html#1856" class="Bound">l</a> <a id="1926" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1928" class="Number">1</a><a id="1929" class="Symbol">))</a> <a id="1932" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1935" class="String">&quot; : &quot;</a> <a id="1941" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1944" href="Reflection.Utils.html#5655" class="Function">mapVars</a> <a id="1952" class="Symbol">(</a><a id="1953" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+</a> <a id="1956" class="Symbol">(</a><a id="1957" href="Reflection.Utils.TCI.html#1837" class="Bound">n</a> <a id="1959" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="1961" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1968" href="Reflection.Utils.TCI.html#1856" class="Bound">l</a><a id="1969" class="Symbol">))</a> <a id="1972" href="Reflection.Utils.TCI.html#1851" class="Bound">t</a> <a id="1974" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="1977" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1979" class="Symbol">)</a>

  <a id="1984" href="Reflection.Utils.TCI.html#1984" class="Function">logCurrentContext</a> <a id="2002" class="Symbol">:</a> <a id="2004" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="2006" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
  <a id="2010" href="Reflection.Utils.TCI.html#1984" class="Function">logCurrentContext</a> <a id="2028" class="Symbol">=</a> <a id="2030" href="Class.MonadTC.html#8955" class="Function">markDontFail</a> <a id="2043" class="String">&quot;logCurrentContext&quot;</a> <a id="2063" class="Symbol">(</a><a id="2064" href="Reflection.Utils.TCI.html#1310" class="Function">logContext</a> <a id="2075" href="Class.Monad.Core.html#424" class="Function Operator">=&lt;&lt;</a> <a id="2079" href="Class.MonadTC.html#8025" class="Function">getContext</a><a id="2089" class="Symbol">)</a>

  <a id="2094" href="Reflection.Utils.TCI.html#2094" class="Function">inDebugPath</a> <a id="2106" class="Symbol">:</a> <a id="2108" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2115" class="Symbol">→</a> <a id="2117" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="2119" href="Reflection.Utils.TCI.html#514" class="Generalizable">A</a> <a id="2121" class="Symbol">→</a> <a id="2123" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="2125" href="Reflection.Utils.TCI.html#514" class="Generalizable">A</a>
  <a id="2129" href="Reflection.Utils.TCI.html#2094" class="Function">inDebugPath</a> <a id="2141" href="Reflection.Utils.TCI.html#2141" class="Bound">path</a> <a id="2146" href="Reflection.Utils.TCI.html#2146" class="Bound">x</a> <a id="2148" class="Symbol">=</a> <a id="2150" href="Class.MonadTC.html#6390" class="Function">withAppendDebugPath</a> <a id="2170" href="Reflection.Utils.TCI.html#2141" class="Bound">path</a> <a id="2175" class="Keyword">do</a>
    <a id="2182" href="Class.MonadTC.html#5721" class="Function">debugLog</a> <a id="2191" class="Symbol">((</a><a id="2193" class="String">&quot;*****&quot;</a> <a id="2201" href="Data.String.Base.html#3008" class="Function Operator">&lt;+&gt;</a> <a id="2205" href="Reflection.Utils.TCI.html#2141" class="Bound">path</a> <a id="2210" href="Data.String.Base.html#3008" class="Function Operator">&lt;+&gt;</a> <a id="2214" class="String">&quot;*****&quot;</a><a id="2221" class="Symbol">)</a> <a id="2223" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="2226" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2228" class="Symbol">)</a>
    <a id="2234" href="Reflection.Utils.TCI.html#1984" class="Function">logCurrentContext</a>
    <a id="2256" href="Reflection.Utils.TCI.html#2146" class="Bound">x</a>

  <a id="2261" href="Reflection.Utils.TCI.html#2261" class="Function">viewAndReduceTy</a> <a id="2277" class="Symbol">:</a> <a id="2279" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="2284" class="Symbol">→</a> <a id="2286" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="2288" href="Reflection.Utils.html#713" class="Function">TypeView</a>
  <a id="2299" href="Reflection.Utils.TCI.html#2261" class="Function">viewAndReduceTy</a> <a id="2315" href="Reflection.Utils.TCI.html#2315" class="Bound">ty</a> <a id="2318" class="Symbol">=</a> <a id="2320" href="Reflection.Utils.TCI.html#2393" class="Function">helper</a> <a id="2327" href="Reflection.Utils.TCI.html#2315" class="Bound">ty</a> <a id="2330" href="Class.Monad.Core.html#424" class="Function Operator">=&lt;&lt;</a> <a id="2334" class="Symbol">(</a><a id="2335" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2342" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2344" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="2350" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2352" href="Reflection.Utils.html#2517" class="Function">viewTy</a><a id="2358" class="Symbol">)</a> <a id="2360" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="2364" href="Class.MonadTC.html#1834" class="Field">normalise</a> <a id="2374" href="Reflection.Utils.TCI.html#2315" class="Bound">ty</a>
    <a id="2381" class="Keyword">where</a>
      <a id="2393" href="Reflection.Utils.TCI.html#2393" class="Function">helper</a> <a id="2400" class="Symbol">:</a> <a id="2402" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="2407" class="Symbol">→</a> <a id="2409" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2411" class="Symbol">→</a> <a id="2413" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="2415" href="Reflection.Utils.html#713" class="Function">TypeView</a>
      <a id="2430" href="Reflection.Utils.TCI.html#2393" class="Function">helper</a> <a id="2437" href="Reflection.Utils.TCI.html#2437" class="Bound">ty</a>    <a id="2443" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a> <a id="2448" class="Symbol">=</a> <a id="2450" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="2457" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2459" href="Reflection.Utils.html#2517" class="Function">viewTy</a> <a id="2466" href="Reflection.Utils.TCI.html#2437" class="Bound">ty</a>
      <a id="2475" href="Reflection.Utils.TCI.html#2393" class="Function">helper</a> <a id="2482" href="Reflection.Utils.TCI.html#2482" class="Bound">ty</a> <a id="2485" class="Symbol">(</a><a id="2486" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2490" href="Reflection.Utils.TCI.html#2490" class="Bound">k</a><a id="2491" class="Symbol">)</a> <a id="2493" class="Keyword">with</a> <a id="2498" href="Reflection.Utils.html#2517" class="Function">viewTy</a> <a id="2505" href="Reflection.Utils.TCI.html#2482" class="Bound">ty</a>
      <a id="2514" class="Symbol">...</a> <a id="2518" class="Symbol">|</a> <a id="2520" class="Symbol">(</a><a id="2521" href="Reflection.Utils.TCI.html#2521" class="Bound">tel</a> <a id="2525" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2527" href="Reflection.Utils.TCI.html#2527" class="Bound">ty&#39;</a><a id="2530" class="Symbol">)</a> <a id="2532" class="Symbol">=</a> <a id="2534" href="Class.MonadTC.html#8401" class="Function">extendContext&#39;</a> <a id="2549" class="Symbol">(</a><a id="2550" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2554" class="Symbol">(λ</a> <a id="2557" class="Keyword">where</a> <a id="2563" class="Symbol">(</a><a id="2564" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2568" href="Reflection.Utils.TCI.html#2568" class="Bound">s</a> <a id="2570" href="Reflection.Utils.TCI.html#2570" class="Bound">t</a><a id="2571" class="Symbol">)</a> <a id="2573" class="Symbol">→</a> <a id="2575" href="Reflection.Utils.TCI.html#2568" class="Bound">s</a> <a id="2577" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2579" href="Reflection.Utils.TCI.html#2570" class="Bound">t</a><a id="2580" class="Symbol">)</a> <a id="2582" href="Reflection.Utils.TCI.html#2521" class="Bound">tel</a><a id="2585" class="Symbol">)</a> <a id="2587" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2589" class="Keyword">do</a>
        <a id="2600" href="Reflection.Utils.TCI.html#2600" class="Bound">rTy</a> <a id="2604" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2606" href="Class.MonadTC.html#1871" class="Field">reduce</a> <a id="2613" href="Reflection.Utils.TCI.html#2527" class="Bound">ty&#39;</a>
        <a id="2625" class="Symbol">(</a><a id="2626" href="Reflection.Utils.TCI.html#2626" class="Bound">tel&#39;</a> <a id="2631" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2633" href="Reflection.Utils.TCI.html#2633" class="Bound">rTy&#39;</a><a id="2637" class="Symbol">)</a> <a id="2639" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2641" href="Reflection.Utils.TCI.html#2393" class="Function">helper</a> <a id="2648" href="Reflection.Utils.TCI.html#2600" class="Bound">rTy</a> <a id="2652" class="Bound">k</a>
        <a id="2662" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="2669" class="Symbol">(</a><a id="2670" href="Reflection.Utils.TCI.html#2521" class="Bound">tel</a> <a id="2674" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2677" href="Reflection.Utils.TCI.html#2626" class="Bound">tel&#39;</a> <a id="2682" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2684" href="Reflection.Utils.TCI.html#2633" class="Bound">rTy&#39;</a><a id="2688" class="Symbol">)</a>

  <a id="2693" href="Reflection.Utils.TCI.html#2693" class="Function">getType&#39;</a> <a id="2702" class="Symbol">:</a> <a id="2704" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2709" class="Symbol">→</a> <a id="2711" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="2713" href="Reflection.Utils.html#713" class="Function">TypeView</a>
  <a id="2724" href="Reflection.Utils.TCI.html#2693" class="Function">getType&#39;</a> <a id="2733" href="Reflection.Utils.TCI.html#2733" class="Bound">n</a> <a id="2735" class="Symbol">=</a> <a id="2737" href="Reflection.Utils.TCI.html#2261" class="Function">viewAndReduceTy</a> <a id="2753" href="Class.Monad.Core.html#424" class="Function Operator">=&lt;&lt;</a> <a id="2757" href="Class.MonadTC.html#2202" class="Field">getType</a> <a id="2765" href="Reflection.Utils.TCI.html#2733" class="Bound">n</a>

  <a id="2770" href="Reflection.Utils.TCI.html#2770" class="Function">getDataDef</a> <a id="2781" class="Symbol">:</a> <a id="2783" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2788" class="Symbol">→</a> <a id="2790" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="2792" href="Reflection.Utils.html#761" class="Record">DataDef</a>
  <a id="2802" href="Reflection.Utils.TCI.html#2770" class="Function">getDataDef</a> <a id="2813" href="Reflection.Utils.TCI.html#2813" class="Bound">n</a> <a id="2815" class="Symbol">=</a> <a id="2817" href="Reflection.Utils.TCI.html#2094" class="Function">inDebugPath</a> <a id="2829" class="String">&quot;getDataDef&quot;</a> <a id="2842" class="Keyword">do</a>
    <a id="2849" href="Class.MonadTC.html#5721" class="Function">debugLog</a> <a id="2858" class="Symbol">(</a><a id="2859" class="String">&quot;Find details for datatype: &quot;</a> <a id="2889" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="2892" href="Reflection.Utils.TCI.html#2813" class="Bound">n</a> <a id="2894" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="2897" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2899" class="Symbol">)</a>
    <a id="2905" class="Symbol">(</a><a id="2906" href="Agda.Builtin.Reflection.html#7235" class="InductiveConstructor">data-type</a> <a id="2916" href="Reflection.Utils.TCI.html#2916" class="Bound">pars</a> <a id="2921" href="Reflection.Utils.TCI.html#2921" class="Bound">cs</a><a id="2923" class="Symbol">)</a> <a id="2925" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2927" href="Class.MonadTC.html#2239" class="Field">getDefinition</a> <a id="2941" href="Reflection.Utils.TCI.html#2813" class="Bound">n</a>
      <a id="2949" class="Keyword">where</a> <a id="2955" class="CatchallClause Symbol">_</a> <a id="2957" class="Symbol">→</a> <a id="2959" href="Class.MonadTC.html#8719" class="Function">error1</a> <a id="2966" class="String">&quot;Not a data definition!&quot;</a>
    <a id="2995" href="Class.MonadTC.html#6031" class="Function">debugLogᵐ</a> <a id="3005" class="Symbol">(</a><a id="3006" class="String">&quot;Constructor names: &quot;</a> <a id="3028" href="Class.MonadTC.html#5279" class="Function Operator">∷ᵈᵐ</a> <a id="3032" href="Reflection.Utils.TCI.html#2921" class="Bound">cs</a> <a id="3035" href="Class.MonadTC.html#5421" class="Function Operator">ᵛ</a> <a id="3037" href="Class.MonadTC.html#5279" class="Function Operator">∷ᵈᵐ</a> <a id="3041" href="Class.MonadTC.html#5216" class="Function">[]ᵐ</a><a id="3044" class="Symbol">)</a>
    <a id="3050" href="Reflection.Utils.TCI.html#3050" class="Bound">cs&#39;</a> <a id="3054" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="3056" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="3065" class="Symbol">(λ</a> <a id="3068" href="Reflection.Utils.TCI.html#3068" class="Bound">n</a> <a id="3070" class="Symbol">→</a> <a id="3072" class="Symbol">(</a><a id="3073" href="Reflection.Utils.TCI.html#3068" class="Bound">n</a> <a id="3075" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,_</a><a id="3077" class="Symbol">)</a> <a id="3079" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3083" href="Reflection.Utils.TCI.html#2693" class="Function">getType&#39;</a> <a id="3092" href="Reflection.Utils.TCI.html#3068" class="Bound">n</a><a id="3093" class="Symbol">)</a> <a id="3095" href="Reflection.Utils.TCI.html#2921" class="Bound">cs</a>
    <a id="3102" href="Class.MonadTC.html#6031" class="Function">debugLogᵐ</a> <a id="3112" class="Symbol">(</a><a id="3113" class="String">&quot;Result: &quot;</a> <a id="3124" href="Class.MonadTC.html#5279" class="Function Operator">∷ᵈᵐ</a> <a id="3128" href="Reflection.Utils.TCI.html#3050" class="Bound">cs&#39;</a> <a id="3132" href="Class.MonadTC.html#5496" class="Function Operator">ᵛⁿ</a> <a id="3135" href="Class.MonadTC.html#5279" class="Function Operator">∷ᵈᵐ</a> <a id="3139" href="Class.MonadTC.html#5216" class="Function">[]ᵐ</a><a id="3142" class="Symbol">)</a>
    <a id="3148" href="Reflection.Utils.TCI.html#3148" class="Bound">args</a> <a id="3153" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="3155" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="3161" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3165" href="Reflection.Utils.TCI.html#2693" class="Function">getType&#39;</a> <a id="3174" href="Reflection.Utils.TCI.html#2813" class="Bound">n</a>
    <a id="3180" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="3187" class="Keyword">record</a> <a id="3194" class="Symbol">{</a> <a id="3196" href="Reflection.Utils.html#793" class="Field">name</a> <a id="3201" class="Symbol">=</a> <a id="3203" href="Reflection.Utils.TCI.html#2813" class="Bound">n</a> <a id="3205" class="Symbol">;</a> <a id="3207" href="Reflection.Utils.html#809" class="Field">constructors</a> <a id="3220" class="Symbol">=</a> <a id="3222" href="Reflection.Utils.TCI.html#3050" class="Bound">cs&#39;</a> <a id="3226" class="Symbol">;</a> <a id="3228" href="Reflection.Utils.html#851" class="Field">params</a> <a id="3235" class="Symbol">=</a> <a id="3237" href="Data.List.Base.html#7316" class="Function">take</a> <a id="3242" href="Reflection.Utils.TCI.html#2916" class="Bound">pars</a> <a id="3247" href="Reflection.Utils.TCI.html#3148" class="Bound">args</a> <a id="3252" class="Symbol">;</a> <a id="3254" href="Reflection.Utils.html#886" class="Field">indices</a> <a id="3262" class="Symbol">=</a> <a id="3264" href="Data.List.Base.html#7436" class="Function">drop</a> <a id="3269" href="Reflection.Utils.TCI.html#2916" class="Bound">pars</a> <a id="3274" href="Reflection.Utils.TCI.html#3148" class="Bound">args</a> <a id="3279" class="Symbol">}</a>

  <a id="3284" href="Reflection.Utils.TCI.html#3284" class="Function">getRecordDef</a> <a id="3297" class="Symbol">:</a> <a id="3299" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3304" class="Symbol">→</a> <a id="3306" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="3308" href="Reflection.Utils.html#926" class="Record">RecordDef</a>
  <a id="3320" href="Reflection.Utils.TCI.html#3284" class="Function">getRecordDef</a> <a id="3333" href="Reflection.Utils.TCI.html#3333" class="Bound">n</a> <a id="3335" class="Symbol">=</a> <a id="3337" class="Keyword">do</a>
    <a id="3344" class="Symbol">(</a><a id="3345" href="Agda.Builtin.Reflection.html#7294" class="InductiveConstructor">record-type</a> <a id="3357" href="Reflection.Utils.TCI.html#3357" class="Bound">c</a> <a id="3359" href="Reflection.Utils.TCI.html#3359" class="Bound">fs</a><a id="3361" class="Symbol">)</a> <a id="3363" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="3365" href="Class.MonadTC.html#2239" class="Field">getDefinition</a> <a id="3379" href="Reflection.Utils.TCI.html#3333" class="Bound">n</a>
      <a id="3387" class="Keyword">where</a> <a id="3393" class="CatchallClause Symbol">_</a> <a id="3395" class="Symbol">→</a> <a id="3397" href="Class.MonadTC.html#8719" class="Function">error1</a> <a id="3404" class="String">&quot;Not a record definition!&quot;</a>
    <a id="3435" href="Reflection.Utils.TCI.html#3435" class="Bound">args</a> <a id="3440" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="3442" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="3448" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3452" href="Reflection.Utils.TCI.html#2693" class="Function">getType&#39;</a> <a id="3461" href="Reflection.Utils.TCI.html#3333" class="Bound">n</a>
    <a id="3467" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="3474" class="Symbol">(</a><a id="3475" class="Keyword">record</a> <a id="3482" class="Symbol">{</a> <a id="3484" href="Reflection.Utils.html#960" class="Field">name</a> <a id="3489" class="Symbol">=</a> <a id="3491" href="Reflection.Utils.TCI.html#3357" class="Bound">c</a> <a id="3493" class="Symbol">;</a> <a id="3495" href="Reflection.Utils.html#976" class="Field">fields</a> <a id="3502" class="Symbol">=</a> <a id="3504" href="Reflection.Utils.TCI.html#3359" class="Bound">fs</a> <a id="3507" class="Symbol">;</a> <a id="3509" href="Reflection.Utils.html#1005" class="Field">params</a> <a id="3516" class="Symbol">=</a> <a id="3518" href="Reflection.Utils.TCI.html#3435" class="Bound">args</a> <a id="3523" class="Symbol">})</a>

  <a id="3529" href="Reflection.Utils.TCI.html#3529" class="Function">getDataOrRecordDef</a> <a id="3548" class="Symbol">:</a> <a id="3550" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3555" class="Symbol">→</a> <a id="3557" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="3559" class="Symbol">(</a><a id="3560" href="Reflection.Utils.html#761" class="Record">DataDef</a> <a id="3568" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="3570" href="Reflection.Utils.html#926" class="Record">RecordDef</a><a id="3579" class="Symbol">)</a>
  <a id="3583" href="Reflection.Utils.TCI.html#3529" class="Function">getDataOrRecordDef</a> <a id="3602" href="Reflection.Utils.TCI.html#3602" class="Bound">n</a> <a id="3604" class="Symbol">=</a>
    <a id="3610" href="Class.MonadError.html#359" class="Field">catch</a> <a id="3616" class="Symbol">(</a><a id="3617" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="3622" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3626" href="Reflection.Utils.TCI.html#2770" class="Function">getDataDef</a> <a id="3637" href="Reflection.Utils.TCI.html#3602" class="Bound">n</a><a id="3638" class="Symbol">)</a>
      <a id="3646" class="Symbol">λ</a> <a id="3648" href="Reflection.Utils.TCI.html#3648" class="Bound">_</a> <a id="3650" class="Symbol">→</a> <a id="3652" href="Class.MonadError.html#359" class="Field">catch</a> <a id="3658" class="Symbol">(</a><a id="3659" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="3664" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3668" href="Reflection.Utils.TCI.html#3284" class="Function">getRecordDef</a> <a id="3681" href="Reflection.Utils.TCI.html#3602" class="Bound">n</a><a id="3682" class="Symbol">)</a>
      <a id="3690" class="Symbol">λ</a> <a id="3692" href="Reflection.Utils.TCI.html#3692" class="Bound">_</a> <a id="3694" class="Symbol">→</a> <a id="3696" href="Class.MonadTC.html#8719" class="Function">error1</a> <a id="3703" class="String">&quot;Neither a data not a record definition!&quot;</a>

  <a id="3748" href="Reflection.Utils.TCI.html#3748" class="Function">getParams</a> <a id="3758" class="Symbol">:</a> <a id="3760" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3765" class="Symbol">→</a> <a id="3767" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="3769" class="Symbol">(</a><a id="3770" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3775" class="Symbol">(</a><a id="3776" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="3780" class="Symbol">(</a><a id="3781" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="3785" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="3789" class="Symbol">)))</a>
  <a id="3795" href="Reflection.Utils.TCI.html#3748" class="Function">getParams</a> <a id="3805" href="Reflection.Utils.TCI.html#3805" class="Bound">n</a> <a id="3807" class="Symbol">=</a> <a id="3809" href="Data.Sum.Base.html#929" class="Function Operator">Data.Sum.[</a> <a id="3820" href="Reflection.Utils.html#851" class="Field">DataDef.params</a> <a id="3835" href="Data.Sum.Base.html#929" class="Function Operator">,</a> <a id="3837" href="Reflection.Utils.html#1005" class="Field">RecordDef.params</a> <a id="3854" href="Data.Sum.Base.html#929" class="Function Operator">]</a> <a id="3856" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3860" href="Reflection.Utils.TCI.html#3529" class="Function">getDataOrRecordDef</a> <a id="3879" href="Reflection.Utils.TCI.html#3805" class="Bound">n</a>

  <a id="3884" href="Reflection.Utils.TCI.html#3884" class="Function">getParamsAndIndices</a> <a id="3904" class="Symbol">:</a> <a id="3906" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3911" class="Symbol">→</a> <a id="3913" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="3915" class="Symbol">(</a><a id="3916" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3921" class="Symbol">(</a><a id="3922" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="3926" class="Symbol">(</a><a id="3927" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="3931" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="3935" class="Symbol">)))</a>
  <a id="3941" href="Reflection.Utils.TCI.html#3884" class="Function">getParamsAndIndices</a> <a id="3961" href="Reflection.Utils.TCI.html#3961" class="Bound">n</a> <a id="3963" class="Symbol">=</a>
    <a id="3969" href="Data.Sum.Base.html#929" class="Function Operator">Data.Sum.[</a> <a id="3980" class="Symbol">(λ</a> <a id="3983" href="Reflection.Utils.TCI.html#3983" class="Bound">d</a> <a id="3985" class="Symbol">→</a> <a id="3987" href="Reflection.Utils.html#851" class="Field">DataDef.params</a> <a id="4002" href="Reflection.Utils.TCI.html#3983" class="Bound">d</a> <a id="4004" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="4007" href="Reflection.Utils.html#886" class="Field">DataDef.indices</a> <a id="4023" href="Reflection.Utils.TCI.html#3983" class="Bound">d</a><a id="4024" class="Symbol">)</a> <a id="4026" href="Data.Sum.Base.html#929" class="Function Operator">,</a> <a id="4028" href="Reflection.Utils.html#1005" class="Field">RecordDef.params</a> <a id="4045" href="Data.Sum.Base.html#929" class="Function Operator">]</a> <a id="4047" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="4051" href="Reflection.Utils.TCI.html#3529" class="Function">getDataOrRecordDef</a> <a id="4070" href="Reflection.Utils.TCI.html#3961" class="Bound">n</a>

  <a id="4075" href="Reflection.Utils.TCI.html#4075" class="Function">getFuel</a> <a id="4083" class="Symbol">:</a> <a id="4085" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="4092" class="Symbol">→</a> <a id="4094" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="4096" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
  <a id="4100" href="Reflection.Utils.TCI.html#4075" class="Function">getFuel</a> <a id="4108" href="Reflection.Utils.TCI.html#4108" class="Bound">s</a> <a id="4110" class="Symbol">=</a> <a id="4112" class="Keyword">do</a>
    <a id="4119" href="Reflection.Utils.TCI.html#4119" class="Bound">fuels</a> <a id="4125" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4127" href="Class.MonadReader.html#386" class="Function">reader</a> <a id="4134" class="Symbol">(λ</a> <a id="4137" class="Keyword">where</a> <a id="4143" class="Keyword">record</a> <a id="4150" class="Symbol">{</a> <a id="4152" href="Class.MonadTC.html#1060" class="Field">options</a> <a id="4160" class="Symbol">=</a> <a id="4162" class="Keyword">record</a> <a id="4169" class="Symbol">{</a> <a id="4171" href="Class.MonadTC.html#680" class="Field">fuel</a> <a id="4176" class="Symbol">=</a> <a id="4178" href="Reflection.Utils.TCI.html#4178" class="Bound">f</a> <a id="4180" class="Symbol">}</a> <a id="4182" class="Symbol">}</a> <a id="4184" class="Symbol">→</a> <a id="4186" href="Reflection.Utils.TCI.html#4178" class="Bound">f</a> <a id="4188" class="Symbol">)</a>
    <a id="4194" href="Function.Base.html#4130" class="Function Operator">case</a> <a id="4199" href="Prelude.html#905" class="Function">lookupᵇ</a> <a id="4207" class="Symbol">(λ</a> <a id="4210" href="Reflection.Utils.TCI.html#4210" class="Bound">s</a> <a id="4212" href="Reflection.Utils.TCI.html#4212" class="Bound">s&#39;</a> <a id="4215" class="Symbol">→</a> <a id="4217" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="4219" href="Reflection.Utils.TCI.html#4210" class="Bound">s</a> <a id="4221" href="Class.DecEq.Core.html#519" class="Field Operator">≟</a> <a id="4223" href="Reflection.Utils.TCI.html#4212" class="Bound">s&#39;</a> <a id="4226" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a><a id="4227" class="Symbol">)</a> <a id="4229" href="Reflection.Utils.TCI.html#4119" class="Bound">fuels</a> <a id="4235" href="Reflection.Utils.TCI.html#4108" class="Bound">s</a> <a id="4237" href="Function.Base.html#4130" class="Function Operator">of</a> <a id="4240" class="Symbol">λ</a> <a id="4242" class="Keyword">where</a>
      <a id="4254" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>  <a id="4263" class="Symbol">→</a> <a id="4265" href="Class.MonadTC.html#8719" class="Function">error1</a> <a id="4272" class="Symbol">(</a><a id="4273" class="String">&quot;Key&quot;</a> <a id="4279" href="Data.String.Base.html#3008" class="Function Operator">&lt;+&gt;</a> <a id="4283" href="Reflection.Utils.TCI.html#4108" class="Bound">s</a> <a id="4285" href="Data.String.Base.html#3008" class="Function Operator">&lt;+&gt;</a> <a id="4289" class="String">&quot;doesn&#39;t exist in the fuels map&quot;</a><a id="4321" class="Symbol">)</a>
      <a id="4329" class="Symbol">(</a><a id="4330" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4335" href="Reflection.Utils.TCI.html#4335" class="Bound">f</a><a id="4336" class="Symbol">)</a> <a id="4338" class="Symbol">→</a> <a id="4340" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4347" href="Reflection.Utils.TCI.html#4335" class="Bound">f</a>

  <a id="4352" href="Reflection.Utils.TCI.html#4352" class="Function">isSort</a> <a id="4359" class="Symbol">:</a> <a id="4361" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="4366" class="Symbol">→</a> <a id="4368" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="4370" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
  <a id="4377" href="Reflection.Utils.TCI.html#4352" class="Function">isSort</a> <a id="4384" href="Reflection.Utils.TCI.html#4384" class="Bound">t</a> <a id="4386" class="Symbol">=</a> <a id="4388" class="Keyword">do</a>
    <a id="4395" class="Symbol">(</a><a id="4396" href="Reflection.Term.html#1405" class="InductiveConstructor">agda-sort</a> <a id="4406" class="Symbol">_)</a> <a id="4409" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4411" href="Class.MonadTC.html#1834" class="Field">normalise</a> <a id="4421" href="Reflection.Utils.TCI.html#4384" class="Bound">t</a>
      <a id="4429" class="Keyword">where</a> <a id="4435" class="CatchallClause Symbol">_</a> <a id="4437" class="Symbol">→</a> <a id="4439" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4446" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
    <a id="4456" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4463" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>

  <a id="4471" href="Reflection.Utils.TCI.html#4471" class="Function">isNArySort</a> <a id="4482" class="Symbol">:</a> <a id="4484" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="4486" class="Symbol">→</a> <a id="4488" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="4493" class="Symbol">→</a> <a id="4495" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="4497" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
  <a id="4504" href="Reflection.Utils.TCI.html#4471" class="Function">isNArySort</a> <a id="4515" href="Reflection.Utils.TCI.html#4515" class="Bound">n</a> <a id="4517" href="Reflection.Utils.TCI.html#4517" class="Bound">t</a> <a id="4519" class="Symbol">=</a> <a id="4521" class="Keyword">do</a>
    <a id="4528" class="Symbol">(</a><a id="4529" href="Reflection.Utils.TCI.html#4529" class="Bound">tel</a> <a id="4533" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4535" href="Reflection.Utils.TCI.html#4535" class="Bound">ty</a><a id="4537" class="Symbol">)</a> <a id="4539" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4541" href="Reflection.Utils.TCI.html#2261" class="Function">viewAndReduceTy</a> <a id="4557" href="Reflection.Utils.TCI.html#4517" class="Bound">t</a>
    <a id="4563" href="Reflection.Utils.TCI.html#4563" class="Bound">b</a> <a id="4565" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4567" href="Reflection.Utils.TCI.html#4352" class="Function">isSort</a> <a id="4574" href="Reflection.Utils.TCI.html#4535" class="Bound">ty</a>
    <a id="4581" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4588" class="Symbol">(</a><a id="4589" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="4591" class="Symbol">(</a><a id="4592" href="Data.List.Base.html#4873" class="Function">length</a> <a id="4599" href="Reflection.Utils.TCI.html#4529" class="Bound">tel</a><a id="4602" class="Symbol">)</a> <a id="4604" href="Class.DecEq.Core.html#519" class="Field Operator">≟</a> <a id="4606" href="Reflection.Utils.TCI.html#4515" class="Bound">n</a> <a id="4608" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a> <a id="4610" href="Data.Bool.Base.html#995" class="Function Operator">∧</a> <a id="4612" href="Reflection.Utils.TCI.html#4563" class="Bound">b</a><a id="4613" class="Symbol">)</a>

  <a id="4618" href="Reflection.Utils.TCI.html#4618" class="Function">isDefT</a> <a id="4625" class="Symbol">:</a> <a id="4627" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4632" class="Symbol">→</a> <a id="4634" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="4639" class="Symbol">→</a> <a id="4641" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="4643" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
  <a id="4650" href="Reflection.Utils.TCI.html#4618" class="Function">isDefT</a> <a id="4657" href="Reflection.Utils.TCI.html#4657" class="Bound">n</a> <a id="4659" href="Reflection.Utils.TCI.html#4659" class="Bound">t</a> <a id="4661" class="Symbol">=</a> <a id="4663" class="Keyword">do</a>
    <a id="4670" class="Symbol">(</a><a id="4671" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="4675" href="Reflection.Utils.TCI.html#4675" class="Bound">n&#39;</a> <a id="4678" class="Symbol">_)</a> <a id="4681" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4683" href="Class.MonadTC.html#1834" class="Field">normalise</a> <a id="4693" href="Reflection.Utils.TCI.html#4659" class="Bound">t</a>
      <a id="4701" class="Keyword">where</a> <a id="4707" class="CatchallClause Symbol">_</a> <a id="4709" class="Symbol">→</a> <a id="4711" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4718" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
    <a id="4728" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4735" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="4737" href="Reflection.Utils.TCI.html#4657" class="Bound">n</a> <a id="4739" href="Class.DecEq.Core.html#519" class="Field Operator">≟</a> <a id="4741" href="Reflection.Utils.TCI.html#4675" class="Bound">n&#39;</a> <a id="4744" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a>

  <a id="4749" class="Comment">-- run a computation that returns a term, resetting the TC state but</a>
  <a id="4820" class="Comment">-- ensuring that the term doesn&#39;t contain any metavariables</a>
  <a id="4882" href="Reflection.Utils.TCI.html#4882" class="Function">withSafeReset</a> <a id="4896" class="Symbol">:</a> <a id="4898" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="4900" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="4905" class="Symbol">→</a> <a id="4907" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="4909" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="4916" href="Reflection.Utils.TCI.html#4882" class="Function">withSafeReset</a> <a id="4930" href="Reflection.Utils.TCI.html#4930" class="Bound">x</a> <a id="4932" class="Symbol">=</a> <a id="4934" href="Class.MonadTC.html#2525" class="Function">runAndReset</a> <a id="4946" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4948" class="Keyword">do</a>
    <a id="4955" href="Reflection.Utils.TCI.html#4955" class="Bound">t</a> <a id="4957" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4959" href="Reflection.Utils.TCI.html#4930" class="Bound">x</a>
    <a id="4965" class="Keyword">let</a> <a id="4969" href="Reflection.Utils.TCI.html#4969" class="Bound">m</a> <a id="4971" class="Symbol">=</a> <a id="4973" href="Reflection.Utils.html#1277" class="Function">findMetas</a> <a id="4983" href="Reflection.Utils.TCI.html#4955" class="Bound">t</a>
    <a id="4989" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="4992" href="Data.List.Base.html#4532" class="Function">null</a> <a id="4997" href="Reflection.Utils.TCI.html#4969" class="Bound">m</a>
      <a id="5005" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="5010" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="5017" href="Reflection.Utils.TCI.html#4955" class="Bound">t</a>
      <a id="5025" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="5030" class="Keyword">do</a>
        <a id="5041" href="Class.MonadTC.html#6031" class="Function">debugLogᵐ</a> <a id="5051" class="Symbol">(</a><a id="5052" class="String">&quot;Remaining metavariables:&quot;</a> <a id="5079" href="Class.MonadTC.html#5279" class="Function Operator">∷ᵈᵐ</a> <a id="5083" href="Reflection.Utils.TCI.html#4969" class="Bound">m</a> <a id="5085" href="Class.MonadTC.html#5496" class="Function Operator">ᵛⁿ</a> <a id="5088" href="Class.MonadTC.html#5279" class="Function Operator">∷ᵈᵐ</a> <a id="5092" href="Class.MonadTC.html#5216" class="Function">[]ᵐ</a><a id="5095" class="Symbol">)</a>
        <a id="5105" href="Class.MonadTC.html#5721" class="Function">debugLog</a> <a id="5114" class="Symbol">(</a><a id="5115" class="String">&quot;In term: &quot;</a> <a id="5127" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="5130" href="Reflection.Utils.TCI.html#4955" class="Bound">t</a> <a id="5132" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="5135" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="5137" class="Symbol">)</a>
        <a id="5147" href="Class.MonadTC.html#8719" class="Function">error1</a> <a id="5154" class="String">&quot;Unsolved metavariables remaining in withSafeReset!&quot;</a>

  <a id="5210" class="Comment">-- apply a list of terms to a name, picking the correct constructor &amp; visibility</a>
  <a id="5293" href="Reflection.Utils.TCI.html#5293" class="Function">applyWithVisibility</a> <a id="5313" class="Symbol">:</a> <a id="5315" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5320" class="Symbol">→</a> <a id="5322" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5327" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="5332" class="Symbol">→</a> <a id="5334" href="Reflection.Utils.TCI.html#556" class="Bound">M</a> <a id="5336" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="5343" href="Reflection.Utils.TCI.html#5293" class="Function">applyWithVisibility</a> <a id="5363" href="Reflection.Utils.TCI.html#5363" class="Bound">n</a> <a id="5365" href="Reflection.Utils.TCI.html#5365" class="Bound">l</a> <a id="5367" class="Symbol">=</a> <a id="5369" class="Keyword">do</a>
    <a id="5376" class="Symbol">(</a><a id="5377" href="Reflection.Utils.TCI.html#5377" class="Bound">argTys</a> <a id="5384" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5386" class="Symbol">_)</a> <a id="5389" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="5391" href="Reflection.Utils.TCI.html#2693" class="Function">getType&#39;</a> <a id="5400" href="Reflection.Utils.TCI.html#5363" class="Bound">n</a>
    <a id="5406" href="Class.MonadTC.html#3108" class="Function">nameConstr</a> <a id="5417" href="Reflection.Utils.TCI.html#5363" class="Bound">n</a> <a id="5419" class="Symbol">(</a><a id="5420" href="Data.List.Base.html#2819" class="Function">zipWith</a> <a id="5428" class="Symbol">(λ</a> <a id="5431" class="Keyword">where</a> <a id="5437" class="Symbol">(</a><a id="5438" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="5442" class="Symbol">_</a> <a id="5444" class="Symbol">(</a><a id="5445" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="5449" href="Reflection.Utils.TCI.html#5449" class="Bound">i</a> <a id="5451" class="Symbol">_))</a> <a id="5455" class="Symbol">→</a> <a id="5457" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="5461" href="Reflection.Utils.TCI.html#5449" class="Bound">i</a><a id="5462" class="Symbol">)</a> <a id="5464" href="Reflection.Utils.TCI.html#5377" class="Bound">argTys</a> <a id="5471" href="Reflection.Utils.TCI.html#5365" class="Bound">l</a><a id="5472" class="Symbol">)</a>
</pre></body></html>