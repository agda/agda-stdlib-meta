<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Existentials</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/agda-stdlib-meta/tree/master///Tactic/Existentials.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Tactic.Existentials.html" class="Module">Tactic.Existentials</a> <a id="28" class="Keyword">where</a>

<a id="35" class="Keyword">open</a> <a id="40" class="Keyword">import</a> <a id="47" href="MetaPrelude.html" class="Module">MetaPrelude</a>

<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="Reflection.html" class="Module">Reflection</a> <a id="83" class="Keyword">hiding</a> <a id="90" class="Symbol">(</a><a id="91" href="Reflection.TCM.Syntax.html#623" class="Function Operator">_&gt;&gt;=_</a><a id="96" class="Symbol">;</a> <a id="98" href="Reflection.TCM.Syntax.html#693" class="Function Operator">_&gt;&gt;_</a><a id="102" class="Symbol">;</a> <a id="104" href="Reflection.html#5116" class="Function Operator">_≟_</a><a id="107" class="Symbol">)</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Reflection.Syntax.html" class="Module">Reflection.Syntax</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>

<a id="199" class="Keyword">open</a> <a id="204" class="Keyword">import</a> <a id="211" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="Class.Monad.html" class="Module">Class.Monad</a>

<a id="mkExistential"></a><a id="250" href="Tactic.Existentials.html#250" class="Function">mkExistential</a> <a id="264" class="Symbol">:</a> <a id="266" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="268" class="Symbol">→</a> <a id="270" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="275" class="Symbol">→</a> <a id="277" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="280" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="285" href="Tactic.Existentials.html#250" class="Function">mkExistential</a> <a id="299" href="Tactic.Existentials.html#299" class="Bound">lvl</a> <a id="303" href="Tactic.Existentials.html#303" class="Bound">t</a> <a id="305" class="Symbol">=</a> <a id="307" class="Keyword">do</a>
  <a id="312" href="Tactic.Existentials.html#312" class="Bound">ty</a> <a id="315" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="317" href="Agda.Builtin.Reflection.html#9696" class="Postulate">getType</a> <a id="325" href="Tactic.Existentials.html#303" class="Bound">t</a>
  <a id="329" class="Keyword">let</a> <a id="333" href="Tactic.Existentials.html#333" class="Bound">n</a> <a id="335" class="Symbol">=</a> <a id="337" href="Data.List.Base.html#5083" class="Function">length</a> <a id="344" class="Symbol">(</a><a id="345" href="Reflection.Utils.html#2941" class="Function">argTys</a> <a id="352" href="Tactic.Existentials.html#312" class="Bound">ty</a><a id="354" class="Symbol">)</a> <a id="356" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="358" href="Tactic.Existentials.html#299" class="Bound">lvl</a>
  <a id="364" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="371" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="373" href="Tactic.Existentials.html#392" class="Function">go</a> <a id="376" href="Tactic.Existentials.html#333" class="Bound">n</a> <a id="378" href="Tactic.Existentials.html#333" class="Bound">n</a>
  <a id="382" class="Keyword">where</a>
    <a id="392" href="Tactic.Existentials.html#392" class="Function">go</a> <a id="395" class="Symbol">:</a> <a id="397" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="399" class="Symbol">→</a> <a id="401" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="403" class="Symbol">→</a> <a id="405" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="414" href="Tactic.Existentials.html#392" class="Function">go</a> <a id="417" href="Tactic.Existentials.html#417" class="Bound">n₀</a> <a id="420" class="Number">0</a>       <a id="428" class="Symbol">=</a> <a id="430" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="434" href="Tactic.Existentials.html#303" class="Bound">t</a> <a id="436" class="Symbol">(</a><a id="437" href="Class.Functor.Core.html#263" class="Function">fmap</a> <a id="442" class="Symbol">(λ</a> <a id="445" href="Tactic.Existentials.html#445" class="Bound">n</a> <a id="447" class="Symbol">→</a> <a id="449" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="454" class="Symbol">(</a><a id="455" href="Reflection.Syntax.html#1452" class="InductiveConstructor">♯</a> <a id="457" href="Tactic.Existentials.html#445" class="Bound">n</a><a id="458" class="Symbol">))</a> <a id="461" class="Symbol">(</a><a id="462" href="Data.List.Base.html#7419" class="Function">reverse</a> <a id="470" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="472" href="Data.List.Base.html#6860" class="Function">upTo</a> <a id="477" href="Tactic.Existentials.html#417" class="Bound">n₀</a><a id="479" class="Symbol">))</a>
    <a id="486" href="Tactic.Existentials.html#392" class="Function">go</a> <a id="489" href="Tactic.Existentials.html#489" class="Bound">n₀</a> <a id="492" class="Symbol">(</a><a id="493" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="497" href="Tactic.Existentials.html#497" class="Bound">n</a><a id="498" class="Symbol">)</a> <a id="500" class="Symbol">=</a> <a id="502" class="Keyword">quote</a> <a id="508" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="510" href="Reflection.Syntax.html#2923" class="InductiveConstructor Operator">∙⟦</a> <a id="513" class="Symbol">(</a><a id="514" href="Reflection.Syntax.html#2234" class="InductiveConstructor Operator">`λ</a> <a id="517" class="String">&quot;_&quot;</a> <a id="521" href="Reflection.Syntax.html#2234" class="InductiveConstructor Operator">⇒</a> <a id="523" href="Tactic.Existentials.html#392" class="Function">go</a> <a id="526" href="Tactic.Existentials.html#489" class="Bound">n₀</a> <a id="529" href="Tactic.Existentials.html#497" class="Bound">n</a><a id="530" class="Symbol">)</a> <a id="532" href="Reflection.Syntax.html#2923" class="InductiveConstructor Operator">⟧</a>

<a id="535" class="Keyword">macro</a>
  <a id="mk∃"></a><a id="543" href="Tactic.Existentials.html#543" class="Function">mk∃</a> <a id="547" class="Symbol">:</a> <a id="549" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="554" class="Symbol">→</a> <a id="556" href="Reflection.Tactic.html#489" class="Function">Tactic</a>
  <a id="565" href="Tactic.Existentials.html#543" class="Function">mk∃</a> <a id="569" href="Tactic.Existentials.html#569" class="Bound">t</a> <a id="571" href="Tactic.Existentials.html#571" class="Bound">hole</a> <a id="576" class="Symbol">=</a> <a id="578" href="Tactic.Existentials.html#250" class="Function">mkExistential</a> <a id="592" class="Number">0</a> <a id="594" href="Tactic.Existentials.html#569" class="Bound">t</a> <a id="596" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="600" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="606" href="Tactic.Existentials.html#571" class="Bound">hole</a>

<a id="612" class="Keyword">private</a>
  <a id="622" class="Keyword">data</a> <a id="X"></a><a id="627" href="Tactic.Existentials.html#627" class="Datatype">X</a> <a id="629" class="Symbol">:</a> <a id="631" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="633" class="Symbol">→</a> <a id="635" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="642" class="Symbol">→</a> <a id="644" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="646" class="Symbol">→</a> <a id="648" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="652" class="Keyword">where</a>
    <a id="X.mkX"></a><a id="662" href="Tactic.Existentials.html#662" class="InductiveConstructor">mkX</a> <a id="666" class="Symbol">:</a> <a id="668" href="Tactic.Existentials.html#627" class="Datatype">X</a> <a id="670" class="Number">0</a> <a id="672" class="String">&quot;&quot;</a> <a id="675" class="Number">1</a>

  <a id="680" href="Tactic.Existentials.html#680" class="Function">_</a> <a id="682" class="Symbol">:</a> <a id="684" href="Tactic.Existentials.html#543" class="Macro">mk∃</a> <a id="688" href="Tactic.Existentials.html#627" class="Datatype">X</a>
  <a id="692" class="Symbol">_</a> <a id="694" class="Symbol">=</a> <a id="696" class="Number">0</a> <a id="698" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="700" class="String">&quot;&quot;</a> <a id="703" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="705" class="Number">1</a> <a id="707" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="709" href="Tactic.Existentials.html#662" class="InductiveConstructor">mkX</a>

  <a id="716" class="Keyword">module</a> <a id="723" href="Tactic.Existentials.html#723" class="Module">_</a> <a id="725" class="Symbol">(</a><a id="726" href="Tactic.Existentials.html#726" class="Bound">n</a> <a id="728" class="Symbol">:</a> <a id="730" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="731" class="Symbol">)</a> <a id="733" class="Keyword">where</a>
    <a id="743" class="Keyword">data</a> <a id="748" href="Tactic.Existentials.html#748" class="Datatype">Y</a> <a id="750" class="Symbol">:</a> <a id="752" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="759" class="Symbol">→</a> <a id="761" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="763" class="Symbol">→</a> <a id="765" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="769" class="Keyword">where</a>
      <a id="781" href="Tactic.Existentials.html#781" class="InductiveConstructor">mkY</a> <a id="785" class="Symbol">:</a> <a id="787" href="Tactic.Existentials.html#748" class="Datatype">Y</a> <a id="789" class="String">&quot;&quot;</a> <a id="792" class="Number">1</a>

    <a id="799" href="Tactic.Existentials.html#799" class="Function">_</a> <a id="801" class="Symbol">:</a> <a id="803" href="Tactic.Existentials.html#543" class="Macro">mk∃</a> <a id="807" href="Tactic.Existentials.html#748" class="Datatype">Y</a>
    <a id="813" class="Symbol">_</a> <a id="815" class="Symbol">=</a> <a id="817" class="String">&quot;&quot;</a> <a id="820" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="822" class="Number">1</a> <a id="824" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="826" href="Tactic.Existentials.html#781" class="InductiveConstructor">mkY</a>

    <a id="835" class="Keyword">module</a> <a id="842" href="Tactic.Existentials.html#842" class="Module">_</a> <a id="844" class="Symbol">(</a><a id="845" href="Tactic.Existentials.html#845" class="Bound">s</a> <a id="847" class="Symbol">:</a> <a id="849" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="855" class="Symbol">)</a> <a id="857" class="Keyword">where</a>

      <a id="870" class="Keyword">data</a> <a id="875" href="Tactic.Existentials.html#875" class="Datatype">Z</a> <a id="877" class="Symbol">:</a> <a id="879" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="881" class="Symbol">→</a> <a id="883" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="887" class="Keyword">where</a>
        <a id="901" href="Tactic.Existentials.html#901" class="InductiveConstructor">mkZ</a> <a id="905" class="Symbol">:</a> <a id="907" href="Tactic.Existentials.html#875" class="Datatype">Z</a> <a id="909" class="Number">1</a>

      <a id="918" href="Tactic.Existentials.html#918" class="Function">_</a> <a id="920" class="Symbol">:</a> <a id="922" href="Tactic.Existentials.html#543" class="Macro">mk∃</a> <a id="926" href="Tactic.Existentials.html#875" class="Datatype">Z</a>
      <a id="934" class="Symbol">_</a> <a id="936" class="Symbol">=</a> <a id="938" class="Number">1</a> <a id="940" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="942" href="Tactic.Existentials.html#901" class="InductiveConstructor">mkZ</a>

    <a id="951" href="Tactic.Existentials.html#951" class="Function">_</a> <a id="953" class="Symbol">:</a> <a id="955" href="Tactic.Existentials.html#543" class="Macro">mk∃</a> <a id="959" href="Tactic.Existentials.html#875" class="Datatype">Z</a>
    <a id="965" class="Symbol">_</a> <a id="967" class="Symbol">=</a> <a id="969" class="String">&quot;sth&quot;</a> <a id="975" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="977" class="Number">1</a> <a id="979" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="981" href="Tactic.Existentials.html#901" class="InductiveConstructor">mkZ</a>

  <a id="988" href="Tactic.Existentials.html#988" class="Function">_</a> <a id="990" class="Symbol">:</a> <a id="992" href="Tactic.Existentials.html#543" class="Macro">mk∃</a> <a id="996" href="Tactic.Existentials.html#748" class="Datatype">Y</a>
  <a id="1000" class="Symbol">_</a> <a id="1002" class="Symbol">=</a> <a id="1004" class="Number">42</a> <a id="1007" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1009" class="String">&quot;&quot;</a> <a id="1012" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1014" class="Number">1</a> <a id="1016" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1018" href="Tactic.Existentials.html#781" class="InductiveConstructor">mkY</a>

  <a id="1025" href="Tactic.Existentials.html#1025" class="Function">_</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="Tactic.Existentials.html#543" class="Macro">mk∃</a> <a id="1033" href="Tactic.Existentials.html#875" class="Datatype">Z</a>
  <a id="1037" class="Symbol">_</a> <a id="1039" class="Symbol">=</a> <a id="1041" class="Number">0</a> <a id="1043" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1045" class="String">&quot;sth&quot;</a> <a id="1051" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1053" class="Number">1</a> <a id="1055" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1057" href="Tactic.Existentials.html#901" class="InductiveConstructor">mkZ</a>
</pre></body></html>