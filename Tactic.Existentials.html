<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Existentials</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/agda/agda-stdlib-meta/tree/master///Tactic/Existentials.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Keyword">module</a> <a id="43" href="Tactic.Existentials.html" class="Module">Tactic.Existentials</a> <a id="63" class="Keyword">where</a>

<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>

<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Reflection.html" class="Module">Reflection</a> <a id="119" class="Keyword">hiding</a> <a id="126" class="Symbol">(</a><a id="127" href="Reflection.TCM.Syntax.html#623" class="Function Operator">_&gt;&gt;=_</a><a id="132" class="Symbol">;</a> <a id="134" href="Reflection.TCM.Syntax.html#693" class="Function Operator">_&gt;&gt;_</a><a id="138" class="Symbol">;</a> <a id="140" href="Reflection.html#5116" class="Function Operator">_≟_</a><a id="143" class="Symbol">)</a>
<a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Reflection.Syntax.html" class="Module">Reflection.Syntax</a>
<a id="175" class="Keyword">open</a> <a id="180" class="Keyword">import</a> <a id="187" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="205" class="Keyword">open</a> <a id="210" class="Keyword">import</a> <a id="217" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>

<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="261" class="Keyword">open</a> <a id="266" class="Keyword">import</a> <a id="273" href="Class.Monad.html" class="Module">Class.Monad</a>

<a id="mkExistential"></a><a id="286" href="Tactic.Existentials.html#286" class="Function">mkExistential</a> <a id="300" class="Symbol">:</a> <a id="302" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="304" class="Symbol">→</a> <a id="306" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="311" class="Symbol">→</a> <a id="313" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="316" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="321" href="Tactic.Existentials.html#286" class="Function">mkExistential</a> <a id="335" href="Tactic.Existentials.html#335" class="Bound">lvl</a> <a id="339" href="Tactic.Existentials.html#339" class="Bound">t</a> <a id="341" class="Symbol">=</a> <a id="343" class="Keyword">do</a>
  <a id="348" href="Tactic.Existentials.html#348" class="Bound">ty</a> <a id="351" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="353" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="361" href="Tactic.Existentials.html#339" class="Bound">t</a>
  <a id="365" class="Keyword">let</a> <a id="369" href="Tactic.Existentials.html#369" class="Bound">n</a> <a id="371" class="Symbol">=</a> <a id="373" href="Data.List.Base.html#5044" class="Function">length</a> <a id="380" class="Symbol">(</a><a id="381" href="Reflection.Utils.Core.html#1072" class="Function">argTys</a> <a id="388" href="Tactic.Existentials.html#348" class="Bound">ty</a><a id="390" class="Symbol">)</a> <a id="392" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="394" href="Tactic.Existentials.html#335" class="Bound">lvl</a>
  <a id="400" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="407" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="409" href="Tactic.Existentials.html#428" class="Function">go</a> <a id="412" href="Tactic.Existentials.html#369" class="Bound">n</a> <a id="414" href="Tactic.Existentials.html#369" class="Bound">n</a>
  <a id="418" class="Keyword">where</a>
    <a id="428" href="Tactic.Existentials.html#428" class="Function">go</a> <a id="431" class="Symbol">:</a> <a id="433" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="435" class="Symbol">→</a> <a id="437" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="439" class="Symbol">→</a> <a id="441" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="450" href="Tactic.Existentials.html#428" class="Function">go</a> <a id="453" href="Tactic.Existentials.html#453" class="Bound">n₀</a> <a id="456" class="Number">0</a>       <a id="464" class="Symbol">=</a> <a id="466" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="470" href="Tactic.Existentials.html#339" class="Bound">t</a> <a id="472" class="Symbol">(</a><a id="473" href="Class.Functor.Core.html#272" class="Function">fmap</a> <a id="478" class="Symbol">(λ</a> <a id="481" href="Tactic.Existentials.html#481" class="Bound">n</a> <a id="483" class="Symbol">→</a> <a id="485" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="490" class="Symbol">(</a><a id="491" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="493" href="Tactic.Existentials.html#481" class="Bound">n</a><a id="494" class="Symbol">))</a> <a id="497" class="Symbol">(</a><a id="498" href="Data.List.Base.html#7225" class="Function">reverse</a> <a id="506" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="508" href="Data.List.Base.html#6689" class="Function">upTo</a> <a id="513" href="Tactic.Existentials.html#453" class="Bound">n₀</a><a id="515" class="Symbol">))</a>
    <a id="522" href="Tactic.Existentials.html#428" class="Function">go</a> <a id="525" href="Tactic.Existentials.html#525" class="Bound">n₀</a> <a id="528" class="Symbol">(</a><a id="529" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="533" href="Tactic.Existentials.html#533" class="Bound">n</a><a id="534" class="Symbol">)</a> <a id="536" class="Symbol">=</a> <a id="538" class="Keyword">quote</a> <a id="544" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="546" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="549" class="Symbol">(</a><a id="550" href="Reflection.Syntax.html#2235" class="InductiveConstructor Operator">`λ</a> <a id="553" class="String">&quot;_&quot;</a> <a id="557" href="Reflection.Syntax.html#2235" class="InductiveConstructor Operator">⇒</a> <a id="559" href="Tactic.Existentials.html#428" class="Function">go</a> <a id="562" href="Tactic.Existentials.html#525" class="Bound">n₀</a> <a id="565" href="Tactic.Existentials.html#533" class="Bound">n</a><a id="566" class="Symbol">)</a> <a id="568" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a>

<a id="571" class="Keyword">macro</a>
  <a id="mk∃"></a><a id="579" href="Tactic.Existentials.html#579" class="Function">mk∃</a> <a id="583" class="Symbol">:</a> <a id="585" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="590" class="Symbol">→</a> <a id="592" href="Reflection.Tactic.html#453" class="Function">Tactic</a>
  <a id="601" href="Tactic.Existentials.html#579" class="Function">mk∃</a> <a id="605" href="Tactic.Existentials.html#605" class="Bound">t</a> <a id="607" href="Tactic.Existentials.html#607" class="Bound">hole</a> <a id="612" class="Symbol">=</a> <a id="614" href="Tactic.Existentials.html#286" class="Function">mkExistential</a> <a id="628" class="Number">0</a> <a id="630" href="Tactic.Existentials.html#605" class="Bound">t</a> <a id="632" href="Class.Monad.Core.html#299" class="Field Operator">&gt;&gt;=</a> <a id="636" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="642" href="Tactic.Existentials.html#607" class="Bound">hole</a>

<a id="648" class="Keyword">private</a>
  <a id="658" class="Keyword">data</a> <a id="X"></a><a id="663" href="Tactic.Existentials.html#663" class="Datatype">X</a> <a id="665" class="Symbol">:</a> <a id="667" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="669" class="Symbol">→</a> <a id="671" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="678" class="Symbol">→</a> <a id="680" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="682" class="Symbol">→</a> <a id="684" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="688" class="Keyword">where</a>
    <a id="X.mkX"></a><a id="698" href="Tactic.Existentials.html#698" class="InductiveConstructor">mkX</a> <a id="702" class="Symbol">:</a> <a id="704" href="Tactic.Existentials.html#663" class="Datatype">X</a> <a id="706" class="Number">0</a> <a id="708" class="String">&quot;&quot;</a> <a id="711" class="Number">1</a>

  <a id="716" href="Tactic.Existentials.html#716" class="Function">_</a> <a id="718" class="Symbol">:</a> <a id="720" href="Tactic.Existentials.html#579" class="Macro">mk∃</a> <a id="724" href="Tactic.Existentials.html#663" class="Datatype">X</a>
  <a id="728" class="Symbol">_</a> <a id="730" class="Symbol">=</a> <a id="732" class="Number">0</a> <a id="734" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="736" class="String">&quot;&quot;</a> <a id="739" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="741" class="Number">1</a> <a id="743" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="745" href="Tactic.Existentials.html#698" class="InductiveConstructor">mkX</a>

  <a id="752" class="Keyword">module</a> <a id="759" href="Tactic.Existentials.html#759" class="Module">_</a> <a id="761" class="Symbol">(</a><a id="762" href="Tactic.Existentials.html#762" class="Bound">n</a> <a id="764" class="Symbol">:</a> <a id="766" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="767" class="Symbol">)</a> <a id="769" class="Keyword">where</a>
    <a id="779" class="Keyword">data</a> <a id="784" href="Tactic.Existentials.html#784" class="Datatype">Y</a> <a id="786" class="Symbol">:</a> <a id="788" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="795" class="Symbol">→</a> <a id="797" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="799" class="Symbol">→</a> <a id="801" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="805" class="Keyword">where</a>
      <a id="817" href="Tactic.Existentials.html#817" class="InductiveConstructor">mkY</a> <a id="821" class="Symbol">:</a> <a id="823" href="Tactic.Existentials.html#784" class="Datatype">Y</a> <a id="825" class="String">&quot;&quot;</a> <a id="828" class="Number">1</a>

    <a id="835" href="Tactic.Existentials.html#835" class="Function">_</a> <a id="837" class="Symbol">:</a> <a id="839" href="Tactic.Existentials.html#579" class="Macro">mk∃</a> <a id="843" href="Tactic.Existentials.html#784" class="Datatype">Y</a>
    <a id="849" class="Symbol">_</a> <a id="851" class="Symbol">=</a> <a id="853" class="String">&quot;&quot;</a> <a id="856" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="858" class="Number">1</a> <a id="860" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="862" href="Tactic.Existentials.html#817" class="InductiveConstructor">mkY</a>

    <a id="871" class="Keyword">module</a> <a id="878" href="Tactic.Existentials.html#878" class="Module">_</a> <a id="880" class="Symbol">(</a><a id="881" href="Tactic.Existentials.html#881" class="Bound">s</a> <a id="883" class="Symbol">:</a> <a id="885" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="891" class="Symbol">)</a> <a id="893" class="Keyword">where</a>

      <a id="906" class="Keyword">data</a> <a id="911" href="Tactic.Existentials.html#911" class="Datatype">Z</a> <a id="913" class="Symbol">:</a> <a id="915" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="917" class="Symbol">→</a> <a id="919" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="923" class="Keyword">where</a>
        <a id="937" href="Tactic.Existentials.html#937" class="InductiveConstructor">mkZ</a> <a id="941" class="Symbol">:</a> <a id="943" href="Tactic.Existentials.html#911" class="Datatype">Z</a> <a id="945" class="Number">1</a>

      <a id="954" href="Tactic.Existentials.html#954" class="Function">_</a> <a id="956" class="Symbol">:</a> <a id="958" href="Tactic.Existentials.html#579" class="Macro">mk∃</a> <a id="962" href="Tactic.Existentials.html#911" class="Datatype">Z</a>
      <a id="970" class="Symbol">_</a> <a id="972" class="Symbol">=</a> <a id="974" class="Number">1</a> <a id="976" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="978" href="Tactic.Existentials.html#937" class="InductiveConstructor">mkZ</a>

    <a id="987" href="Tactic.Existentials.html#987" class="Function">_</a> <a id="989" class="Symbol">:</a> <a id="991" href="Tactic.Existentials.html#579" class="Macro">mk∃</a> <a id="995" href="Tactic.Existentials.html#911" class="Datatype">Z</a>
    <a id="1001" class="Symbol">_</a> <a id="1003" class="Symbol">=</a> <a id="1005" class="String">&quot;sth&quot;</a> <a id="1011" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1013" class="Number">1</a> <a id="1015" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1017" href="Tactic.Existentials.html#937" class="InductiveConstructor">mkZ</a>

  <a id="1024" href="Tactic.Existentials.html#1024" class="Function">_</a> <a id="1026" class="Symbol">:</a> <a id="1028" href="Tactic.Existentials.html#579" class="Macro">mk∃</a> <a id="1032" href="Tactic.Existentials.html#784" class="Datatype">Y</a>
  <a id="1036" class="Symbol">_</a> <a id="1038" class="Symbol">=</a> <a id="1040" class="Number">42</a> <a id="1043" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1045" class="String">&quot;&quot;</a> <a id="1048" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1050" class="Number">1</a> <a id="1052" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1054" href="Tactic.Existentials.html#817" class="InductiveConstructor">mkY</a>

  <a id="1061" href="Tactic.Existentials.html#1061" class="Function">_</a> <a id="1063" class="Symbol">:</a> <a id="1065" href="Tactic.Existentials.html#579" class="Macro">mk∃</a> <a id="1069" href="Tactic.Existentials.html#911" class="Datatype">Z</a>
  <a id="1073" class="Symbol">_</a> <a id="1075" class="Symbol">=</a> <a id="1077" class="Number">0</a> <a id="1079" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1081" class="String">&quot;sth&quot;</a> <a id="1087" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1089" class="Number">1</a> <a id="1091" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1093" href="Tactic.Existentials.html#937" class="InductiveConstructor">mkZ</a>
</pre></body></html>