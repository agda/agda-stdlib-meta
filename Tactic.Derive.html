<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/2.6.4-compat/Tactic/Derive.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Generic type class dervations. Works with mutually recursive types</a>
<a id="71" class="Comment">-- and can use mutual recursion to satisfy the termination</a>
<a id="130" class="Comment">-- checker. Writing an actual derivation strategy then does not</a>
<a id="194" class="Comment">-- require dealing with any mutual recursion, it is all handled here.</a>
<a id="264" class="Comment">--</a>
<a id="267" class="Comment">-- TODO: This breaks with:</a>
<a id="294" class="Comment">-- - mutual recursion that nests too deep (i.e. deeper than 1, e.g. Term)</a>
<a id="368" class="Comment">-- - indexed datatypes that require absurd clauses (e.g. Vec)</a>
<a id="430" class="Comment">--</a>
<a id="433" class="Comment">-- TODO: support type classes with more than one field</a>
<a id="488" class="Comment">--</a>
<a id="491" class="Comment">-- TODO: enable using existing code for instance when mutually recursing</a>
<a id="564" class="Comment">--</a>
<a id="567" class="Comment">-- TODO: Requires K to pass the termination checker. Maybe we can do without somehow.</a>

<a id="654" class="Symbol">{-#</a> <a id="658" class="Keyword">OPTIONS</a> <a id="666" class="Pragma">-v</a> <a id="669" class="Pragma">allTactics:100</a> <a id="684" class="Symbol">#-}</a>
<a id="688" class="Symbol">{-#</a> <a id="692" class="Keyword">OPTIONS</a> <a id="700" class="Pragma">--safe</a> <a id="707" class="Pragma">--without-K</a> <a id="719" class="Symbol">#-}</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Meta.html" class="Module">Meta</a>

<a id="741" class="Keyword">module</a> <a id="748" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="762" class="Symbol">(</a><a id="763" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="773" class="Symbol">:</a> <a id="775" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="779" class="Symbol">)</a> <a id="781" class="Symbol">(</a><a id="782" href="Tactic.Derive.html#782" class="Bound">projName</a> <a id="791" class="Symbol">:</a> <a id="793" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="797" class="Symbol">)</a> <a id="799" class="Keyword">where</a>

<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Prelude.html" class="Module">Prelude</a>

<a id="827" class="Keyword">open</a> <a id="832" class="Keyword">import</a> <a id="839" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="863" class="Keyword">using</a> <a id="869" class="Symbol">()</a> <a id="872" class="Keyword">renaming</a> <a id="881" class="Symbol">(</a><a id="882" href="Agda.Builtin.Reflection.html#621" class="Primitive">primShowQName</a> <a id="896" class="Symbol">to</a> <a id="899" class="Primitive">showName</a><a id="907" class="Symbol">)</a>

<a id="910" class="Keyword">import</a> <a id="917" href="Data.List.html" class="Module">Data.List</a> <a id="927" class="Symbol">as</a> <a id="930" class="Module">L</a>
<a id="932" class="Keyword">import</a> <a id="939" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="958" class="Symbol">as</a> <a id="961" class="Module">NE</a>
<a id="964" class="Keyword">import</a> <a id="971" href="Data.String.html" class="Module">Data.String</a> <a id="983" class="Symbol">as</a> <a id="986" class="Module">S</a>
<a id="988" class="Keyword">open</a> <a id="993" class="Keyword">import</a> <a id="1000" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1011" class="Keyword">using</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Data.Maybe.Base.html#1641" class="Function">fromMaybe</a><a id="1027" class="Symbol">)</a>
<a id="1029" class="Keyword">open</a> <a id="1034" class="Keyword">import</a> <a id="1041" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="1059" class="Keyword">open</a> <a id="1064" class="Keyword">import</a> <a id="1071" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="1088" class="Keyword">open</a> <a id="1093" class="Keyword">import</a> <a id="1100" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>
<a id="1121" class="Keyword">open</a> <a id="1126" class="Keyword">import</a> <a id="1133" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>
<a id="1160" class="Keyword">open</a> <a id="1165" class="Keyword">import</a> <a id="1172" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>

<a id="1194" class="Keyword">open</a> <a id="1199" class="Keyword">import</a> <a id="1206" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="1218" class="Keyword">open</a> <a id="1223" class="Keyword">import</a> <a id="1230" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="1242" class="Keyword">open</a> <a id="1247" class="Keyword">import</a> <a id="1254" href="Class.Traversable.html" class="Module">Class.Traversable</a>
<a id="1272" class="Keyword">open</a> <a id="1277" class="Keyword">import</a> <a id="1284" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="1298" class="Keyword">open</a> <a id="1303" class="Keyword">import</a> <a id="1310" href="Class.MonadReader.Instances.html" class="Module">Class.MonadReader.Instances</a>
<a id="1338" class="Keyword">open</a> <a id="1343" class="Keyword">import</a> <a id="1350" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>

<a id="1375" class="Keyword">instance</a>
  <a id="1386" href="Tactic.Derive.html#1386" class="Function">_</a> <a id="1388" class="Symbol">=</a> <a id="1390" href="Tactic.ClauseBuilder.html#10688" class="Function">ContextMonad-MonadTC</a>
  <a id="1413" href="Tactic.Derive.html#1413" class="Function">_</a> <a id="1415" class="Symbol">=</a> <a id="1417" href="Class.Monad.Core.html#582" class="Function">Functor-M</a>

<a id="1428" class="Keyword">open</a> <a id="1433" href="Tactic.ClauseBuilder.html#10918" class="Module">ClauseExprM</a>

<a id="genClassType"></a><a id="1446" href="Tactic.Derive.html#1446" class="Function">genClassType</a> <a id="1459" class="Symbol">:</a> <a id="1461" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1463" class="Symbol">→</a> <a id="1465" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1478" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1483" class="Symbol">→</a> <a id="1485" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1488" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a>
<a id="1493" href="Tactic.Derive.html#1446" class="Function">genClassType</a> <a id="1506" href="Tactic.Derive.html#1506" class="Bound">arity</a> <a id="1512" href="Tactic.Derive.html#1512" class="Bound">dName</a> <a id="1518" href="Tactic.Derive.html#1518" class="Bound">wName</a> <a id="1524" class="Symbol">=</a> <a id="1526" class="Keyword">do</a>
  <a id="1531" href="Tactic.Derive.html#1531" class="Bound">params</a> <a id="1538" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="1540" href="Reflection.Utils.TCI.html#7668" class="Function">getParamsAndIndices</a> <a id="1560" href="Tactic.Derive.html#1512" class="Bound">dName</a>
  <a id="1568" href="Tactic.Derive.html#1568" class="Bound">adjParams</a> <a id="1578" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="1580" href="Tactic.Derive.html#1879" class="Function">adjustParams</a> <a id="1593" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1595" href="Data.List.Base.html#7316" class="Function">take</a> <a id="1600" class="Symbol">(</a><a id="1601" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1608" href="Tactic.Derive.html#1531" class="Bound">params</a> <a id="1615" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="1617" href="Tactic.Derive.html#1506" class="Bound">arity</a><a id="1622" class="Symbol">)</a> <a id="1624" href="Tactic.Derive.html#1531" class="Bound">params</a>
  <a id="1633" href="Class.MonadTC.html#8832" class="Function">debugLog1</a> <a id="1643" class="String">&quot;AdjustedParams: &quot;</a>
  <a id="1664" href="Reflection.Utils.TCI.html#4641" class="Function">logTelescope</a> <a id="1677" class="Symbol">(</a><a id="1678" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1684" class="Symbol">((λ</a> <a id="1688" class="Keyword">where</a> <a id="1694" class="Symbol">(</a><a id="1695" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1699" href="Tactic.Derive.html#1699" class="Bound">s</a> <a id="1701" href="Tactic.Derive.html#1701" class="Bound">x</a><a id="1702" class="Symbol">)</a> <a id="1704" class="Symbol">→</a> <a id="1706" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1711" href="Tactic.Derive.html#1699" class="Bound">s</a> <a id="1713" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1715" href="Tactic.Derive.html#1701" class="Bound">x</a><a id="1716" class="Symbol">)</a> <a id="1718" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1720" href="Agda.Builtin.Sigma.html#251" class="Field">proj₁</a><a id="1725" class="Symbol">)</a> <a id="1727" href="Tactic.Derive.html#1568" class="Bound">adjParams</a><a id="1736" class="Symbol">)</a>
  <a id="1740" href="Tactic.Derive.html#1740" class="Bound">ty</a> <a id="1743" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="1745" href="Reflection.Utils.TCI.html#9003" class="Function">applyWithVisibility</a> <a id="1765" href="Tactic.Derive.html#1512" class="Bound">dName</a> <a id="1771" class="Symbol">(</a><a id="1772" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1778" href="Reflection.Syntax.html#1131" class="InductiveConstructor">♯</a> <a id="1780" class="Symbol">(</a><a id="1781" href="Tactic.Derive.html#2378" class="Function">trueIndices</a> <a id="1793" href="Tactic.Derive.html#1568" class="Bound">adjParams</a><a id="1802" class="Symbol">))</a>
  <a id="1807" href="Class.Monad.Core.html#241" class="Field">return</a> <a id="1814" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1816" href="Tactic.Derive.html#2544" class="Function">modifyClassType</a> <a id="1832" href="Tactic.Derive.html#1518" class="Bound">wName</a> <a id="1838" class="Symbol">(</a><a id="1839" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1845" href="Agda.Builtin.Sigma.html#251" class="Field">proj₁</a> <a id="1851" href="Tactic.Derive.html#1568" class="Bound">adjParams</a> <a id="1861" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1863" href="Tactic.Derive.html#1740" class="Bound">ty</a><a id="1865" class="Symbol">)</a>
  <a id="1869" class="Keyword">where</a>
    <a id="1879" href="Tactic.Derive.html#1879" class="Function">adjustParams</a> <a id="1892" class="Symbol">:</a> <a id="1894" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1899" class="Symbol">(</a><a id="1900" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1904" class="Symbol">(</a><a id="1905" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="1909" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="1913" class="Symbol">))</a> <a id="1916" class="Symbol">→</a> <a id="1918" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1921" class="Symbol">(</a><a id="1922" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1927" class="Symbol">((</a><a id="1929" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1933" class="Symbol">(</a><a id="1934" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="1938" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="1942" class="Symbol">))</a> <a id="1945" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1947" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="1951" class="Symbol">))</a>
    <a id="1958" href="Tactic.Derive.html#1879" class="Function">adjustParams</a> <a id="1971" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1974" class="Symbol">=</a> <a id="1976" href="Class.Monad.Core.html#241" class="Field">return</a> <a id="1983" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="1990" href="Tactic.Derive.html#1879" class="Function">adjustParams</a> <a id="2003" class="Symbol">(</a><a id="2004" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2008" href="Tactic.Derive.html#2008" class="Bound">x</a> <a id="2010" class="Symbol">(</a><a id="2011" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="2015" class="Symbol">_</a> <a id="2017" href="Tactic.Derive.html#2017" class="Bound">t</a><a id="2018" class="Symbol">)</a> <a id="2020" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2022" href="Tactic.Derive.html#2022" class="Bound">l</a><a id="2023" class="Symbol">)</a> <a id="2025" class="Symbol">=</a> <a id="2027" class="Keyword">do</a>
      <a id="2036" href="Tactic.Derive.html#2036" class="Bound">a</a> <a id="2038" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="2040" class="Symbol">(</a><a id="2041" href="Data.Bool.Base.html#1292" class="Function Operator">if_then</a> <a id="2049" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2051" class="Symbol">(</a><a id="2052" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2056" class="String">&quot;_&quot;</a> <a id="2060" class="Symbol">(</a><a id="2061" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="2066" class="Symbol">(</a><a id="2067" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2077" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">∙⟦</a> <a id="2080" href="Reflection.Syntax.html#1131" class="InductiveConstructor">♯</a> <a id="2082" class="Number">0</a> <a id="2084" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">⟧</a><a id="2085" class="Symbol">))</a> <a id="2088" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2090" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="2095" class="Symbol">)</a> <a id="2097" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="2099" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2104" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2106" class="Symbol">)</a> <a id="2108" href="Class.Functor.Core.html#205" class="Field Operator">&lt;$&gt;</a> <a id="2112" href="Reflection.Utils.TCI.html#8227" class="Function">isNArySort</a> <a id="2123" href="Tactic.Derive.html#1506" class="Bound">arity</a> <a id="2129" href="Tactic.Derive.html#2017" class="Bound">t</a>
      <a id="2137" href="Tactic.Derive.html#2137" class="Bound">ps</a> <a id="2140" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="2142" href="Class.MonadTC.html#7918" class="Function">extendContext</a> <a id="2156" class="Symbol">(</a><a id="2157" href="Tactic.Derive.html#2008" class="Bound">x</a> <a id="2159" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2161" href="Reflection.Argument.html#1280" class="InductiveConstructor">hArg</a> <a id="2166" href="Tactic.Derive.html#2017" class="Bound">t</a><a id="2167" class="Symbol">)</a> <a id="2169" class="Symbol">(</a><a id="2170" href="Tactic.Derive.html#1879" class="Function">adjustParams</a> <a id="2183" href="Tactic.Derive.html#2022" class="Bound">l</a><a id="2184" class="Symbol">)</a>
      <a id="2192" class="Keyword">let</a> <a id="2196" href="Tactic.Derive.html#2196" class="Bound">ps&#39;</a> <a id="2200" class="Symbol">=</a> <a id="2202" href="Function.Base.html#1563" class="Function">flip</a> <a id="2207" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="2213" href="Tactic.Derive.html#2137" class="Bound">ps</a> <a id="2216" class="Symbol">λ</a> <a id="2218" class="Keyword">where</a>
        <a id="2232" class="Symbol">(</a><a id="2233" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2237" href="Tactic.Derive.html#2237" class="Bound">s</a> <a id="2239" class="Symbol">(</a><a id="2240" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="2244" href="Tactic.Derive.html#2244" class="Bound">i</a> <a id="2246" href="Tactic.Derive.html#2246" class="Bound">t</a><a id="2247" class="Symbol">)</a> <a id="2249" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2251" href="Tactic.Derive.html#2251" class="Bound">b</a><a id="2252" class="Symbol">)</a> <a id="2254" class="Symbol">→</a> <a id="2256" class="Symbol">(</a><a id="2257" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2261" href="Tactic.Derive.html#2237" class="Bound">s</a> <a id="2263" class="Symbol">(</a><a id="2264" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="2268" href="Tactic.Derive.html#2244" class="Bound">i</a> <a id="2270" class="Symbol">(</a><a id="2271" href="Reflection.Utils.html#5384" class="Function">mapVars</a> <a id="2279" class="Symbol">(</a><a id="2280" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+</a> <a id="2283" class="Symbol">(</a><a id="2284" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2287" href="Tactic.Derive.html#2251" class="Bound">b</a> <a id="2289" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="2294" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2301" href="Tactic.Derive.html#2036" class="Bound">a</a> <a id="2303" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2308" class="Number">0</a><a id="2309" class="Symbol">))</a> <a id="2312" href="Tactic.Derive.html#2246" class="Bound">t</a><a id="2313" class="Symbol">))</a> <a id="2316" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2318" href="Tactic.Derive.html#2251" class="Bound">b</a><a id="2319" class="Symbol">)</a>
      <a id="2327" href="Class.Monad.Core.html#241" class="Field">return</a> <a id="2334" class="Symbol">(((</a><a id="2337" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2341" href="Tactic.Derive.html#2008" class="Bound">x</a> <a id="2343" class="Symbol">(</a><a id="2344" href="Reflection.Argument.html#1280" class="InductiveConstructor">hArg</a> <a id="2349" href="Tactic.Derive.html#2017" class="Bound">t</a><a id="2350" class="Symbol">)</a> <a id="2352" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2354" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="2358" class="Symbol">)</a> <a id="2360" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2362" href="Tactic.Derive.html#2036" class="Bound">a</a><a id="2363" class="Symbol">)</a> <a id="2365" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2368" href="Tactic.Derive.html#2196" class="Bound">ps&#39;</a><a id="2371" class="Symbol">)</a>

    <a id="2378" href="Tactic.Derive.html#2378" class="Function">trueIndices</a> <a id="2390" class="Symbol">:</a> <a id="2392" class="Symbol">{</a><a id="2393" href="Tactic.Derive.html#2393" class="Bound">A</a> <a id="2395" class="Symbol">:</a> <a id="2397" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="2400" class="Symbol">}</a> <a id="2402" class="Symbol">→</a> <a id="2404" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2409" class="Symbol">(</a><a id="2410" href="Tactic.Derive.html#2393" class="Bound">A</a> <a id="2412" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2414" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="2418" class="Symbol">)</a> <a id="2420" class="Symbol">→</a> <a id="2422" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2427" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="2433" href="Tactic.Derive.html#2378" class="Function">trueIndices</a> <a id="2445" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2448" class="Symbol">=</a> <a id="2450" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="2457" href="Tactic.Derive.html#2378" class="Function">trueIndices</a> <a id="2469" class="Symbol">(</a><a id="2470" href="Tactic.Derive.html#2470" class="Bound">x</a> <a id="2472" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2474" href="Tactic.Derive.html#2474" class="Bound">l</a><a id="2475" class="Symbol">)</a> <a id="2477" class="Symbol">=</a> <a id="2479" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2482" href="Agda.Builtin.Sigma.html#263" class="Field">proj₂</a> <a id="2488" href="Tactic.Derive.html#2470" class="Bound">x</a> <a id="2490" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="2495" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2502" href="Tactic.Derive.html#2474" class="Bound">l</a> <a id="2504" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2506" href="Tactic.Derive.html#2378" class="Function">trueIndices</a> <a id="2518" href="Tactic.Derive.html#2474" class="Bound">l</a> <a id="2520" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2525" href="Tactic.Derive.html#2378" class="Function">trueIndices</a> <a id="2537" href="Tactic.Derive.html#2474" class="Bound">l</a>

    <a id="2544" href="Tactic.Derive.html#2544" class="Function">modifyClassType</a> <a id="2560" class="Symbol">:</a> <a id="2562" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2568" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2573" class="Symbol">→</a> <a id="2575" href="Reflection.Utils.html#713" class="Function">TypeView</a> <a id="2584" class="Symbol">→</a> <a id="2586" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a>
    <a id="2595" href="Tactic.Derive.html#2544" class="Function">modifyClassType</a> <a id="2611" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>  <a id="2620" class="Symbol">(</a><a id="2621" href="Tactic.Derive.html#2621" class="Bound">tel</a> <a id="2625" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2627" href="Tactic.Derive.html#2627" class="Bound">ty</a><a id="2629" class="Symbol">)</a> <a id="2631" class="Symbol">=</a> <a id="2633" href="Reflection.Utils.html#2538" class="Function">tyView</a> <a id="2640" class="Symbol">(</a><a id="2641" href="Tactic.Derive.html#2621" class="Bound">tel</a> <a id="2645" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2647" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2657" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">∙⟦</a> <a id="2660" href="Tactic.Derive.html#2627" class="Bound">ty</a> <a id="2663" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">⟧</a><a id="2664" class="Symbol">)</a>
    <a id="2670" href="Tactic.Derive.html#2544" class="Function">modifyClassType</a> <a id="2686" class="Symbol">(</a><a id="2687" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2692" href="Tactic.Derive.html#2692" class="Bound">n</a><a id="2693" class="Symbol">)</a> <a id="2695" class="Symbol">(</a><a id="2696" href="Tactic.Derive.html#2696" class="Bound">tel</a> <a id="2700" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2702" href="Tactic.Derive.html#2702" class="Bound">ty</a><a id="2704" class="Symbol">)</a> <a id="2706" class="Symbol">=</a> <a id="2708" href="Reflection.Utils.html#2538" class="Function">tyView</a> <a id="2715" class="Symbol">(</a><a id="2716" href="Tactic.Derive.html#2696" class="Bound">tel</a> <a id="2720" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2722" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2732" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">∙⟦</a> <a id="2735" href="Tactic.Derive.html#2692" class="Bound">n</a> <a id="2737" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">∙⟦</a> <a id="2740" href="Tactic.Derive.html#2702" class="Bound">ty</a> <a id="2743" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">⟧</a> <a id="2745" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">⟧</a><a id="2746" class="Symbol">)</a>

<a id="lookupName"></a><a id="2749" href="Tactic.Derive.html#2749" class="Function">lookupName</a> <a id="2760" class="Symbol">:</a> <a id="2762" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2767" class="Symbol">(</a><a id="2768" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2773" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2775" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="2779" class="Symbol">)</a> <a id="2781" class="Symbol">→</a> <a id="2783" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2788" class="Symbol">→</a> <a id="2790" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2796" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
<a id="2801" href="Tactic.Derive.html#2749" class="Function">lookupName</a> <a id="2812" class="Symbol">=</a> <a id="2814" href="Prelude.html#905" class="Function">lookupᵇ</a> <a id="2822" class="Symbol">(λ</a> <a id="2825" href="Tactic.Derive.html#2825" class="Bound">n</a> <a id="2827" href="Tactic.Derive.html#2827" class="Bound">n&#39;</a> <a id="2830" class="Symbol">→</a> <a id="2832" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="2834" href="Tactic.Derive.html#2825" class="Bound">n</a> <a id="2836" href="Class.DecEq.Core.html#108" class="Field Operator">≟</a> <a id="2838" href="Tactic.Derive.html#2827" class="Bound">n&#39;</a> <a id="2841" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a><a id="2842" class="Symbol">)</a>

<a id="2845" class="Comment">-- Look at the constructors of the argument and return all types that</a>
<a id="2915" class="Comment">-- recursively contain it. This isn&#39;t very clever right now.</a>
<a id="genMutualHelpers"></a><a id="2976" href="Tactic.Derive.html#2976" class="Function">genMutualHelpers</a> <a id="2993" class="Symbol">:</a> <a id="2995" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3000" class="Symbol">→</a> <a id="3002" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3005" class="Symbol">(</a><a id="3006" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3011" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="3015" class="Symbol">)</a>
<a id="3017" href="Tactic.Derive.html#2976" class="Function">genMutualHelpers</a> <a id="3034" href="Tactic.Derive.html#3034" class="Bound">n</a> <a id="3036" class="Symbol">=</a> <a id="3038" class="Keyword">do</a>
  <a id="3043" href="Tactic.Derive.html#3043" class="Bound">tys</a> <a id="3047" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="3049" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="3055" class="Symbol">(</a><a id="3056" href="Reflection.Argument.html#2530" class="Function">unArg</a> <a id="3062" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3064" href="Reflection.Abstraction.html#1738" class="Function">unAbs</a><a id="3069" class="Symbol">)</a> <a id="3071" href="Class.Functor.Core.html#205" class="Field Operator">&lt;$&gt;</a> <a id="3075" class="Symbol">(</a><a id="3076" href="Data.List.Base.html#4459" class="Function">L.concatMap</a> <a id="3088" class="Symbol">(</a><a id="3089" href="Agda.Builtin.Sigma.html#251" class="Field">proj₁</a> <a id="3095" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3097" href="Reflection.Utils.html#2422" class="Function">viewTy</a> <a id="3104" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3106" href="Agda.Builtin.Sigma.html#263" class="Field">proj₂</a><a id="3111" class="Symbol">)</a> <a id="3113" href="Class.Functor.Core.html#205" class="Field Operator">&lt;$&gt;</a> <a id="3117" href="Class.MonadTC.html#9632" class="Function">getConstrs</a> <a id="3128" href="Tactic.Derive.html#3034" class="Bound">n</a><a id="3129" class="Symbol">)</a>
  <a id="3133" href="Class.Monad.Core.html#241" class="Field">return</a> <a id="3140" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3142" href="Data.List.Base.html#9026" class="Function">deduplicate</a> <a id="3154" href="Class.DecEq.Core.html#108" class="Field Operator">_≟_</a> <a id="3158" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3160" href="Data.List.Base.html#1638" class="Function">L.mapMaybe</a> <a id="3171" href="Tactic.Derive.html#3194" class="Function">helper</a> <a id="3178" href="Tactic.Derive.html#3043" class="Bound">tys</a>
  <a id="3184" class="Keyword">where</a>
    <a id="3194" href="Tactic.Derive.html#3194" class="Function">helper</a> <a id="3201" class="Symbol">:</a> <a id="3203" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="3208" class="Symbol">→</a> <a id="3210" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3216" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="3225" href="Tactic.Derive.html#3194" class="Function">helper</a> <a id="3232" class="Symbol">(</a><a id="3233" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="3237" href="Tactic.Derive.html#3237" class="Bound">n&#39;</a> <a id="3240" href="Tactic.Derive.html#3240" class="Bound">args</a><a id="3244" class="Symbol">)</a> <a id="3246" class="Symbol">=</a>
      <a id="3254" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="3257" href="Data.List.Base.html#4686" class="Function">L.any</a> <a id="3263" class="Symbol">(λ</a> <a id="3266" class="Keyword">where</a> <a id="3272" class="Symbol">(</a><a id="3273" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3277" class="Symbol">_</a> <a id="3279" class="Symbol">(</a><a id="3280" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="3284" href="Tactic.Derive.html#3284" class="Bound">n&#39;&#39;</a> <a id="3288" class="Symbol">_))</a> <a id="3292" class="Symbol">→</a> <a id="3294" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="3296" href="Tactic.Derive.html#3034" class="Bound">n</a> <a id="3298" href="Class.DecEq.Core.html#108" class="Field Operator">≟</a> <a id="3300" href="Tactic.Derive.html#3284" class="Bound">n&#39;&#39;</a> <a id="3304" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a> <a id="3306" class="Symbol">;</a> <a id="3308" class="CatchallClause Symbol">_</a> <a id="3310" class="Symbol">→</a> <a id="3312" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="3317" class="Symbol">)</a> <a id="3319" href="Tactic.Derive.html#3240" class="Bound">args</a>
      <a id="3330" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="3335" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3340" href="Tactic.Derive.html#3237" class="Bound">n&#39;</a> <a id="3343" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="3348" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
    <a id="3360" href="Tactic.Derive.html#3194" class="CatchallClause Function">helper</a><a id="3366" class="CatchallClause"> </a><a id="3367" class="CatchallClause Symbol">_</a> <a id="3369" class="Symbol">=</a> <a id="3371" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="3380" class="Keyword">module</a> <a id="3387" href="Tactic.Derive.html#3387" class="Module">_</a> <a id="3389" class="Symbol">(</a><a id="3390" href="Tactic.Derive.html#3390" class="Bound">arity</a> <a id="3396" class="Symbol">:</a> <a id="3398" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="3399" class="Symbol">)</a> <a id="3401" class="Symbol">(</a><a id="3402" href="Tactic.Derive.html#3402" class="Bound">genCe</a> <a id="3408" class="Symbol">:</a> <a id="3410" class="Symbol">(</a><a id="3411" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3416" class="Symbol">→</a> <a id="3418" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3424" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="3428" class="Symbol">)</a> <a id="3430" class="Symbol">→</a> <a id="3432" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3437" href="Tactic.ClauseBuilder.html#1273" class="Function">SinglePattern</a> <a id="3451" class="Symbol">→</a> <a id="3453" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3458" class="Symbol">(</a><a id="3459" href="Data.List.NonEmpty.Base.html#1088" class="Record">NE.List⁺</a> <a id="3468" href="Tactic.ClauseBuilder.html#1273" class="Function">SinglePattern</a> <a id="3482" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3484" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3487" class="Symbol">(</a><a id="3488" href="Tactic.ClauseBuilder.html#5765" class="Datatype">ClauseExpr</a> <a id="3499" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="3501" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3507" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="3511" class="Symbol">)))</a> <a id="3515" class="Keyword">where</a>
  <a id="3523" class="Comment">-- Generate the declaration &amp; definition of a particular derivation.</a>
  <a id="3594" class="Comment">--</a>
  <a id="3599" class="Comment">-- Takes a dictionary (for mutual recursion), a wrapper (also for</a>
  <a id="3667" class="Comment">-- mutual recursion), the name of the original type we want to derive</a>
  <a id="3739" class="Comment">-- Show for and the name we want to define Show originally at.</a>
  <a id="3804" href="Tactic.Derive.html#3804" class="Function">deriveSingle</a> <a id="3817" class="Symbol">:</a> <a id="3819" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3824" class="Symbol">(</a><a id="3825" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3830" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3832" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="3836" class="Symbol">)</a> <a id="3838" class="Symbol">→</a> <a id="3840" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3845" class="Symbol">→</a> <a id="3847" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3852" class="Symbol">→</a> <a id="3854" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3860" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3865" class="Symbol">→</a> <a id="3867" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3870" class="Symbol">(</a><a id="3871" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="3875" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3880" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3882" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="3887" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3889" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3894" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a><a id="3900" class="Symbol">)</a>
  <a id="3904" href="Tactic.Derive.html#3804" class="Function">deriveSingle</a> <a id="3917" href="Tactic.Derive.html#3917" class="Bound">transName</a> <a id="3927" href="Tactic.Derive.html#3927" class="Bound">dName</a> <a id="3933" href="Tactic.Derive.html#3933" class="Bound">iName</a> <a id="3939" href="Tactic.Derive.html#3939" class="Bound">wName</a> <a id="3945" class="Symbol">=</a> <a id="3947" href="Reflection.Utils.TCI.html#5941" class="Function">inDebugPath</a> <a id="3959" class="String">&quot;DeriveSingle&quot;</a> <a id="3974" class="Keyword">do</a>
    <a id="3981" href="Class.MonadTC.html#5765" class="Function">debugLog</a> <a id="3990" class="Symbol">(</a><a id="3991" class="String">&quot;For: &quot;</a> <a id="3999" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="4002" href="Tactic.Derive.html#3927" class="Bound">dName</a> <a id="4008" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="4011" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4013" class="Symbol">)</a>
    <a id="4019" href="Tactic.Derive.html#4019" class="Bound">goalTy</a> <a id="4026" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="4028" href="Tactic.Derive.html#1446" class="Function">genClassType</a> <a id="4041" href="Tactic.Derive.html#3390" class="Bound">arity</a> <a id="4047" href="Tactic.Derive.html#3927" class="Bound">dName</a> <a id="4053" href="Tactic.Derive.html#3939" class="Bound">wName</a>
    <a id="4063" href="Tactic.Derive.html#4063" class="Bound">ps</a> <a id="4066" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="4068" href="Tactic.ClauseBuilder.html#5279" class="Function">constructorPatterns&#39;</a> <a id="4089" class="Symbol">(</a><a id="4090" href="Data.Maybe.Base.html#1641" class="Function">fromMaybe</a> <a id="4100" href="Tactic.Derive.html#3927" class="Bound">dName</a> <a id="4106" href="Tactic.Derive.html#3939" class="Bound">wName</a> <a id="4112" href="Reflection.Syntax.html#2578" class="InductiveConstructor Operator">∙</a><a id="4113" class="Symbol">)</a>
    <a id="4119" class="Comment">-- TODO: find a good way of printing this</a>
    <a id="4165" class="Comment">--debugLogᵐ (&quot;Constrs: &quot; ∷ᵈᵐ ps ᵛⁿ ∷ᵈᵐ []ᵐ)</a>
    <a id="4213" href="Tactic.Derive.html#4213" class="Bound">cs</a> <a id="4216" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="4218" href="Class.MonadReader.html#335" class="Field">local</a> <a id="4224" class="Symbol">(λ</a> <a id="4227" href="Tactic.Derive.html#4227" class="Bound">c</a> <a id="4229" class="Symbol">→</a> <a id="4231" class="Keyword">record</a> <a id="4238" href="Tactic.Derive.html#4227" class="Bound">c</a> <a id="4240" class="Symbol">{</a> <a id="4242" href="Class.MonadTC.html#1020" class="Field">goal</a> <a id="4247" class="Symbol">=</a> <a id="4249" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="4254" href="Tactic.Derive.html#4019" class="Bound">goalTy</a> <a id="4261" class="Symbol">})</a> <a id="4264" href="Function.Base.html#1928" class="Function Operator">$</a>
      <a id="4272" href="Tactic.ClauseBuilder.html#11812" class="Function">singleMatchExpr</a> <a id="4288" class="Symbol">(</a><a id="4289" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4292" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4294" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4299" class="Symbol">(</a><a id="4300" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">Pattern.proj</a> <a id="4313" href="Tactic.Derive.html#782" class="Bound">projName</a><a id="4321" class="Symbol">))</a> <a id="4324" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4326" href="Tactic.ClauseBuilder.html#12769" class="Function">contMatch</a> <a id="4336" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4338" href="Tactic.ClauseBuilder.html#11277" class="Function">multiMatchExprM</a> <a id="4354" href="Function.Base.html#1928" class="Function Operator">$</a>
        <a id="4364" href="Tactic.Derive.html#3402" class="Bound">genCe</a> <a id="4370" class="Symbol">(</a><a id="4371" href="Tactic.Derive.html#2749" class="Function">lookupName</a> <a id="4382" href="Tactic.Derive.html#3917" class="Bound">transName</a><a id="4391" class="Symbol">)</a> <a id="4393" href="Tactic.Derive.html#4063" class="Bound">ps</a>
    <a id="4400" class="Keyword">let</a> <a id="4404" href="Tactic.Derive.html#4404" class="Bound">defName</a> <a id="4412" class="Symbol">=</a> <a id="4414" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="4420" class="Symbol">(</a><a id="4421" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="4427" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="4432" class="Symbol">(</a><a id="4433" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4438" href="Tactic.Derive.html#3933" class="Bound">iName</a><a id="4443" class="Symbol">)</a> <a id="4445" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4447" href="Tactic.Derive.html#2749" class="Function">lookupName</a> <a id="4458" href="Tactic.Derive.html#3917" class="Bound">transName</a><a id="4467" class="Symbol">)</a> <a id="4469" class="Symbol">(</a><a id="4470" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4475" href="Tactic.Derive.html#3933" class="Bound">iName</a><a id="4480" class="Symbol">)</a> <a id="4482" href="Tactic.Derive.html#3939" class="Bound">wName</a>
    <a id="4492" href="Class.Monad.Core.html#241" class="Field">return</a> <a id="4499" class="Symbol">(</a><a id="4500" href="Tactic.Derive.html#4404" class="Bound">defName</a> <a id="4508" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4510" href="Tactic.Derive.html#4019" class="Bound">goalTy</a> <a id="4517" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4519" href="Tactic.ClauseBuilder.html#7384" class="Function">clauseExprToClauses</a> <a id="4539" href="Tactic.Derive.html#4213" class="Bound">cs</a><a id="4541" class="Symbol">)</a>

  <a id="4546" href="Tactic.Derive.html#4546" class="Function">deriveMulti</a> <a id="4558" class="Symbol">:</a> <a id="4560" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4565" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4567" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4572" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4574" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4579" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4584" class="Symbol">→</a> <a id="4586" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="4589" class="Symbol">(</a><a id="4590" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4595" class="Symbol">(</a><a id="4596" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="4600" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4605" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4607" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="4612" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4614" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4619" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a><a id="4625" class="Symbol">))</a>
  <a id="4630" href="Tactic.Derive.html#4546" class="Function">deriveMulti</a> <a id="4642" class="Symbol">(</a><a id="4643" href="Tactic.Derive.html#4643" class="Bound">dName</a> <a id="4649" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4651" href="Tactic.Derive.html#4651" class="Bound">iName</a> <a id="4657" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4659" href="Tactic.Derive.html#4659" class="Bound">hClasses</a><a id="4667" class="Symbol">)</a> <a id="4669" class="Symbol">=</a> <a id="4671" class="Keyword">do</a>
    <a id="4678" href="Tactic.Derive.html#4678" class="Bound">hClassNames</a> <a id="4690" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="4692" href="Class.Traversable.Core.html#260" class="Function">traverse</a> <a id="4701" class="Symbol">⦃</a> <a id="4703" href="Class.Functor.Instances.html#408" class="Function">Functor-List</a> <a id="4716" class="Symbol">⦄</a>
      <a id="4724" class="Symbol">(λ</a> <a id="4727" href="Tactic.Derive.html#4727" class="Bound">cn</a> <a id="4730" class="Symbol">→</a> <a id="4732" href="Class.MonadTC.html#2018" class="Field">freshName</a> <a id="4742" class="Symbol">(</a><a id="4743" href="Tactic.Derive.html#899" class="Primitive">showName</a> <a id="4752" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="4762" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4767" class="String">&quot;-&quot;</a> <a id="4771" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4776" href="Tactic.Derive.html#899" class="Primitive">showName</a> <a id="4785" href="Tactic.Derive.html#4727" class="Bound">cn</a> <a id="4788" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4793" href="Tactic.Derive.html#899" class="Primitive">showName</a> <a id="4802" href="Tactic.Derive.html#4643" class="Bound">dName</a><a id="4807" class="Symbol">))</a> <a id="4810" href="Tactic.Derive.html#4659" class="Bound">hClasses</a>
    <a id="4823" href="Class.Traversable.Core.html#260" class="Function">traverse</a> <a id="4832" class="Symbol">⦃</a> <a id="4834" href="Class.Functor.Instances.html#408" class="Function">Functor-List</a> <a id="4847" class="Symbol">⦄</a> <a id="4849" class="Symbol">(</a><a id="4850" href="Tactic.Derive.html#3804" class="Function">deriveSingle</a> <a id="4863" class="Symbol">(</a><a id="4864" href="Data.List.Base.html#3579" class="Function">L.zip</a> <a id="4870" href="Tactic.Derive.html#4659" class="Bound">hClasses</a> <a id="4879" href="Tactic.Derive.html#4678" class="Bound">hClassNames</a><a id="4890" class="Symbol">)</a> <a id="4892" href="Tactic.Derive.html#4643" class="Bound">dName</a> <a id="4898" href="Tactic.Derive.html#4651" class="Bound">iName</a><a id="4903" class="Symbol">)</a> <a id="4905" class="Symbol">(</a><a id="4906" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="4914" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4916" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="4922" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4927" href="Tactic.Derive.html#4659" class="Bound">hClasses</a><a id="4935" class="Symbol">)</a>

  <a id="4940" href="Tactic.Derive.html#4940" class="Function">derive-Class</a> <a id="4953" class="Symbol">:</a> <a id="4955" class="Symbol">⦃</a> <a id="4957" href="Class.MonadTC.html#614" class="Record">TCOptions</a> <a id="4967" class="Symbol">⦄</a> <a id="4969" class="Symbol">→</a> <a id="4971" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4976" class="Symbol">(</a><a id="4977" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4982" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4984" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="4988" class="Symbol">)</a> <a id="4990" class="Symbol">→</a> <a id="4992" href="Reflection.Tactic.html#508" class="Function">UnquoteDecl</a>
  <a id="5006" href="Tactic.Derive.html#4940" class="Function">derive-Class</a> <a id="5019" href="Tactic.Derive.html#5019" class="Bound">l</a> <a id="5021" class="Symbol">=</a> <a id="5023" href="Reflection.Tactic.html#900" class="Function">initUnquoteWithGoal</a> <a id="5043" class="Symbol">(</a><a id="5044" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="5054" href="Reflection.Syntax.html#2578" class="InductiveConstructor Operator">∙</a><a id="5055" class="Symbol">)</a> <a id="5057" href="Function.Base.html#1928" class="Function Operator">$</a>
    <a id="5063" href="Class.MonadTC.html#3831" class="Function">declareAndDefineFuns</a> <a id="5084" href="Class.Monad.Core.html#351" class="Function Operator">=&lt;&lt;</a> <a id="5088" href="Data.List.Base.html#4403" class="Function">concat</a> <a id="5095" href="Class.Functor.Core.html#205" class="Field Operator">&lt;$&gt;</a> <a id="5099" href="Class.Traversable.Core.html#260" class="Function">traverse</a> <a id="5108" class="Symbol">⦃</a> <a id="5110" href="Class.Functor.Instances.html#408" class="Function">Functor-List</a> <a id="5123" class="Symbol">⦄</a> <a id="5125" href="Tactic.Derive.html#5150" class="Function">helper</a> <a id="5132" href="Tactic.Derive.html#5019" class="Bound">l</a>
    <a id="5138" class="Keyword">where</a>
      <a id="5150" href="Tactic.Derive.html#5150" class="Function">helper</a> <a id="5157" class="Symbol">:</a> <a id="5159" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5164" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5166" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5171" class="Symbol">→</a> <a id="5173" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="5176" class="Symbol">(</a><a id="5177" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5182" class="Symbol">(</a><a id="5183" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="5187" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5192" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5194" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="5199" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5201" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5206" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a><a id="5212" class="Symbol">))</a>
      <a id="5221" href="Tactic.Derive.html#5150" class="Function">helper</a> <a id="5228" class="Symbol">(</a><a id="5229" href="Tactic.Derive.html#5229" class="Bound">a</a> <a id="5231" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5233" href="Tactic.Derive.html#5233" class="Bound">b</a><a id="5234" class="Symbol">)</a> <a id="5236" class="Symbol">=</a> <a id="5238" class="Keyword">do</a> <a id="5241" href="Tactic.Derive.html#5241" class="Bound">hs</a> <a id="5244" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="5246" href="Tactic.Derive.html#2976" class="Function">genMutualHelpers</a> <a id="5263" href="Tactic.Derive.html#5229" class="Bound">a</a> <a id="5265" class="Symbol">;</a> <a id="5267" href="Tactic.Derive.html#4546" class="Function">deriveMulti</a> <a id="5279" class="Symbol">(</a><a id="5280" href="Tactic.Derive.html#5229" class="Bound">a</a> <a id="5282" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5284" href="Tactic.Derive.html#5233" class="Bound">b</a> <a id="5286" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5288" href="Tactic.Derive.html#5241" class="Bound">hs</a><a id="5290" class="Symbol">)</a>
</pre></body></html>