<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactic/Derive.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Generic type class dervations. Works with mutually recursive types</a>
<a id="71" class="Comment">-- and can use mutual recursion to satisfy the termination</a>
<a id="130" class="Comment">-- checker. Writing an actual derivation strategy then does not</a>
<a id="194" class="Comment">-- require dealing with any mutual recursion, it is all handled here.</a>
<a id="264" class="Comment">--</a>
<a id="267" class="Comment">-- TODO: This breaks with:</a>
<a id="294" class="Comment">-- - mutual recursion that nests too deep (i.e. deeper than 1, e.g. Term)</a>
<a id="368" class="Comment">-- - indexed datatypes that require absurd clauses (e.g. Vec)</a>
<a id="430" class="Comment">--</a>
<a id="433" class="Comment">-- TODO: support type classes with more than one field</a>
<a id="488" class="Comment">--</a>
<a id="491" class="Comment">-- TODO: enable using existing code for instance when mutually recursing</a>
<a id="564" class="Comment">--</a>
<a id="567" class="Comment">-- TODO: Requires K to pass the termination checker. Maybe we can do without somehow.</a>

<a id="654" class="Symbol">{-#</a> <a id="658" class="Keyword">OPTIONS</a> <a id="666" class="Pragma">-v</a> <a id="669" class="Pragma">allTactics:100</a> <a id="684" class="Symbol">#-}</a>
<a id="688" class="Symbol">{-#</a> <a id="692" class="Keyword">OPTIONS</a> <a id="700" class="Pragma">--safe</a> <a id="707" class="Pragma">--without-K</a> <a id="719" class="Symbol">#-}</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Meta.html" class="Module">Meta</a>

<a id="741" class="Keyword">module</a> <a id="748" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="762" class="Symbol">(</a><a id="763" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="773" class="Symbol">:</a> <a id="775" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="779" class="Symbol">)</a> <a id="781" class="Symbol">(</a><a id="782" href="Tactic.Derive.html#782" class="Bound">projName</a> <a id="791" class="Symbol">:</a> <a id="793" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="797" class="Symbol">)</a> <a id="799" class="Keyword">where</a>

<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Prelude.html" class="Module">Prelude</a>

<a id="827" class="Keyword">open</a> <a id="832" class="Keyword">import</a> <a id="839" href="Reflection.Name.html" class="Module">Reflection.Name</a> <a id="855" class="Keyword">using</a> <a id="861" class="Symbol">()</a> <a id="864" class="Keyword">renaming</a> <a id="873" class="Symbol">(</a><a id="874" href="Reflection.Name.html#1412" class="Function Operator">_≟_</a> <a id="878" class="Symbol">to</a> <a id="881" class="Function Operator">_≟-Name_</a><a id="889" class="Symbol">)</a>
<a id="891" class="Keyword">open</a> <a id="896" class="Keyword">import</a> <a id="903" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">()</a> <a id="936" class="Keyword">renaming</a> <a id="945" class="Symbol">(</a><a id="946" href="Agda.Builtin.Reflection.html#604" class="Primitive">primShowQName</a> <a id="960" class="Symbol">to</a> <a id="963" class="Primitive">showName</a><a id="971" class="Symbol">)</a>

<a id="974" class="Keyword">open</a> <a id="979" class="Keyword">import</a> <a id="986" href="Generics.html" class="Module">Generics</a>

<a id="996" class="Keyword">open</a> <a id="1001" class="Keyword">import</a> <a id="1008" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1019" class="Keyword">using</a> <a id="1025" class="Symbol">(</a><a id="1026" href="Data.Maybe.Base.html#1641" class="Function">fromMaybe</a><a id="1035" class="Symbol">)</a>
<a id="1037" class="Keyword">import</a> <a id="1044" href="Data.List.html" class="Module">Data.List</a> <a id="1054" class="Symbol">as</a> <a id="1057" class="Module">L</a>
<a id="1059" class="Keyword">import</a> <a id="1066" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="1085" class="Symbol">as</a> <a id="1088" class="Module">NE</a>
<a id="1091" class="Keyword">import</a> <a id="1098" href="Data.String.html" class="Module">Data.String</a> <a id="1110" class="Symbol">as</a> <a id="1113" class="Module">S</a>

<a id="1116" class="Keyword">open</a> <a id="1121" class="Keyword">import</a> <a id="1128" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="1156" class="Keyword">open</a> <a id="1161" class="Keyword">import</a> <a id="1168" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="1189" class="Keyword">open</a> <a id="1194" class="Keyword">import</a> <a id="1201" href="Tactic.Helpers.html" class="Module">Tactic.Helpers</a>

<a id="1217" class="Keyword">open</a> <a id="1222" class="Keyword">import</a> <a id="1229" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="1241" class="Keyword">open</a> <a id="1246" class="Keyword">import</a> <a id="1253" href="Class.Traversable.html" class="Module">Class.Traversable</a>
<a id="1271" class="Keyword">open</a> <a id="1276" class="Keyword">import</a> <a id="1283" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="1297" class="Keyword">open</a> <a id="1302" class="Keyword">import</a> <a id="1309" href="Class.MonadReader.Instances.html" class="Module">Class.MonadReader.Instances</a>
<a id="1337" class="Keyword">open</a> <a id="1342" class="Keyword">import</a> <a id="1349" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>

<a id="1374" class="Keyword">instance</a>
  <a id="1385" href="Tactic.Derive.html#1385" class="Function">_</a> <a id="1387" class="Symbol">=</a> <a id="1389" href="Tactic.ClauseBuilder.html#10738" class="Function">ContextMonad-MonadTC</a>
  <a id="1412" href="Tactic.Derive.html#1412" class="Function">_</a> <a id="1414" class="Symbol">=</a> <a id="1416" href="Class.Monad.Core.html#655" class="Function">Functor-M</a>

<a id="1427" class="Keyword">open</a> <a id="1432" href="Tactic.ClauseBuilder.html#10968" class="Module">ClauseExprM</a>

<a id="genClassType"></a><a id="1445" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="1458" class="Symbol">:</a> <a id="1460" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1462" class="Symbol">→</a> <a id="1464" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1469" class="Symbol">→</a> <a id="1471" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1477" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1482" class="Symbol">→</a> <a id="1484" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1487" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
<a id="1492" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="1505" href="Tactic.Derive.html#1505" class="Bound">arity</a> <a id="1511" href="Tactic.Derive.html#1511" class="Bound">dName</a> <a id="1517" href="Tactic.Derive.html#1517" class="Bound">wName</a> <a id="1523" class="Symbol">=</a> <a id="1525" class="Keyword">do</a>
  <a id="1530" href="Tactic.Derive.html#1530" class="Bound">params</a> <a id="1537" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1539" href="Tactic.Helpers.html#4359" class="Function">getParamsAndIndices</a> <a id="1559" href="Tactic.Derive.html#1511" class="Bound">dName</a>
  <a id="1567" href="Tactic.Derive.html#1567" class="Bound">adjParams</a> <a id="1577" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1579" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1592" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1594" href="Data.List.Base.html#7316" class="Function">take</a> <a id="1599" class="Symbol">(</a><a id="1600" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1607" href="Tactic.Derive.html#1530" class="Bound">params</a> <a id="1614" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="1616" href="Tactic.Derive.html#1505" class="Bound">arity</a><a id="1621" class="Symbol">)</a> <a id="1623" href="Tactic.Derive.html#1530" class="Bound">params</a>
  <a id="1632" href="Class.MonadTC.html#8481" class="Function">debugLog1</a> <a id="1642" class="String">&quot;AdjustedParams: &quot;</a>
  <a id="1663" href="Tactic.Helpers.html#1205" class="Function">logTelescope</a> <a id="1676" class="Symbol">(</a><a id="1677" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1683" class="Symbol">((λ</a> <a id="1687" class="Keyword">where</a> <a id="1693" class="Symbol">(</a><a id="1694" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1698" href="Tactic.Derive.html#1698" class="Bound">s</a> <a id="1700" href="Tactic.Derive.html#1700" class="Bound">x</a><a id="1701" class="Symbol">)</a> <a id="1703" class="Symbol">→</a> <a id="1705" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1710" href="Tactic.Derive.html#1698" class="Bound">s</a> <a id="1712" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1714" href="Tactic.Derive.html#1700" class="Bound">x</a><a id="1715" class="Symbol">)</a> <a id="1717" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1719" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a><a id="1724" class="Symbol">)</a> <a id="1726" href="Tactic.Derive.html#1567" class="Bound">adjParams</a><a id="1735" class="Symbol">)</a>
  <a id="1739" href="Tactic.Derive.html#1739" class="Bound">ty</a> <a id="1742" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1744" href="Tactic.Helpers.html#5492" class="Function">applyWithVisibility</a> <a id="1764" href="Tactic.Derive.html#1511" class="Bound">dName</a> <a id="1770" class="Symbol">(</a><a id="1771" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1777" href="Generics.Core.html#372" class="InductiveConstructor">♯</a> <a id="1779" class="Symbol">(</a><a id="1780" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="1792" href="Tactic.Derive.html#1567" class="Bound">adjParams</a><a id="1801" class="Symbol">))</a>
  <a id="1806" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1813" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1815" href="Tactic.Derive.html#2543" class="Function">modifyClassType</a> <a id="1831" href="Tactic.Derive.html#1517" class="Bound">wName</a> <a id="1837" class="Symbol">(</a><a id="1838" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1844" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="1850" href="Tactic.Derive.html#1567" class="Bound">adjParams</a> <a id="1860" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1862" href="Tactic.Derive.html#1739" class="Bound">ty</a><a id="1864" class="Symbol">)</a>
  <a id="1868" class="Keyword">where</a>
    <a id="1878" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1891" class="Symbol">:</a> <a id="1893" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1898" class="Symbol">(</a><a id="1899" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1903" class="Symbol">(</a><a id="1904" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1908" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="1912" class="Symbol">))</a> <a id="1915" class="Symbol">→</a> <a id="1917" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1926" class="Symbol">((</a><a id="1928" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1932" class="Symbol">(</a><a id="1933" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1937" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="1941" class="Symbol">))</a> <a id="1944" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1946" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a><a id="1950" class="Symbol">))</a>
    <a id="1957" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1970" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1973" class="Symbol">=</a> <a id="1975" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1982" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
    <a id="1989" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="2002" class="Symbol">(</a><a id="2003" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2007" href="Tactic.Derive.html#2007" class="Bound">x</a> <a id="2009" class="Symbol">(</a><a id="2010" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2014" class="Symbol">_</a> <a id="2016" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2017" class="Symbol">)</a> <a id="2019" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2021" href="Tactic.Derive.html#2021" class="Bound">l</a><a id="2022" class="Symbol">)</a> <a id="2024" class="Symbol">=</a> <a id="2026" class="Keyword">do</a>
      <a id="2035" href="Tactic.Derive.html#2035" class="Bound">a</a> <a id="2037" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2039" class="Symbol">(</a><a id="2040" href="Data.Bool.Base.html#1292" class="Function Operator">if_then</a> <a id="2048" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2050" class="Symbol">(</a><a id="2051" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2055" class="String">&quot;_&quot;</a> <a id="2059" class="Symbol">(</a><a id="2060" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="2065" class="Symbol">(</a><a id="2066" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2076" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2079" href="Generics.Core.html#372" class="InductiveConstructor">♯</a> <a id="2081" class="Number">0</a> <a id="2083" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2084" class="Symbol">))</a> <a id="2087" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2089" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="2094" class="Symbol">)</a> <a id="2096" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="2098" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2103" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2105" class="Symbol">)</a> <a id="2107" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="2111" href="Tactic.Helpers.html#4669" class="Function">isNArySort</a> <a id="2122" href="Tactic.Derive.html#1505" class="Bound">arity</a> <a id="2128" href="Tactic.Derive.html#2016" class="Bound">t</a>
      <a id="2136" href="Tactic.Derive.html#2136" class="Bound">ps</a> <a id="2139" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2141" href="Class.MonadTC.html#7567" class="Function">extendContext</a> <a id="2155" class="Symbol">(</a><a id="2156" href="Tactic.Derive.html#2007" class="Bound">x</a> <a id="2158" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2160" href="Reflection.Argument.html#1280" class="InductiveConstructor">hArg</a> <a id="2165" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2166" class="Symbol">)</a> <a id="2168" class="Symbol">(</a><a id="2169" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="2182" href="Tactic.Derive.html#2021" class="Bound">l</a><a id="2183" class="Symbol">)</a>
      <a id="2191" class="Keyword">let</a> <a id="2195" href="Tactic.Derive.html#2195" class="Bound">ps&#39;</a> <a id="2199" class="Symbol">=</a> <a id="2201" href="Function.Base.html#1563" class="Function">flip</a> <a id="2206" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="2212" href="Tactic.Derive.html#2136" class="Bound">ps</a> <a id="2215" class="Symbol">λ</a> <a id="2217" class="Keyword">where</a>
        <a id="2231" class="Symbol">(</a><a id="2232" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2236" href="Tactic.Derive.html#2236" class="Bound">s</a> <a id="2238" class="Symbol">(</a><a id="2239" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2243" href="Tactic.Derive.html#2243" class="Bound">i</a> <a id="2245" href="Tactic.Derive.html#2245" class="Bound">t</a><a id="2246" class="Symbol">)</a> <a id="2248" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2250" href="Tactic.Derive.html#2250" class="Bound">b</a><a id="2251" class="Symbol">)</a> <a id="2253" class="Symbol">→</a> <a id="2255" class="Symbol">(</a><a id="2256" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2260" href="Tactic.Derive.html#2236" class="Bound">s</a> <a id="2262" class="Symbol">(</a><a id="2263" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2267" href="Tactic.Derive.html#2243" class="Bound">i</a> <a id="2269" class="Symbol">(</a><a id="2270" href="Generics.Utils.html#5684" class="Function">mapVars</a> <a id="2278" class="Symbol">(</a><a id="2279" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+</a> <a id="2282" class="Symbol">(</a><a id="2283" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2286" href="Tactic.Derive.html#2250" class="Bound">b</a> <a id="2288" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="2293" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2300" href="Tactic.Derive.html#2035" class="Bound">a</a> <a id="2302" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2307" class="Number">0</a><a id="2308" class="Symbol">))</a> <a id="2311" href="Tactic.Derive.html#2245" class="Bound">t</a><a id="2312" class="Symbol">))</a> <a id="2315" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2317" href="Tactic.Derive.html#2250" class="Bound">b</a><a id="2318" class="Symbol">)</a>
      <a id="2326" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="2333" class="Symbol">(((</a><a id="2336" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2340" href="Tactic.Derive.html#2007" class="Bound">x</a> <a id="2342" class="Symbol">(</a><a id="2343" href="Reflection.Argument.html#1280" class="InductiveConstructor">hArg</a> <a id="2348" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2349" class="Symbol">)</a> <a id="2351" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2353" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="2357" class="Symbol">)</a> <a id="2359" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2361" href="Tactic.Derive.html#2035" class="Bound">a</a><a id="2362" class="Symbol">)</a> <a id="2364" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2367" href="Tactic.Derive.html#2195" class="Bound">ps&#39;</a><a id="2370" class="Symbol">)</a>

    <a id="2377" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2389" class="Symbol">:</a> <a id="2391" class="Symbol">{</a><a id="2392" href="Tactic.Derive.html#2392" class="Bound">A</a> <a id="2394" class="Symbol">:</a> <a id="2396" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="2399" class="Symbol">}</a> <a id="2401" class="Symbol">→</a> <a id="2403" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2408" class="Symbol">(</a><a id="2409" href="Tactic.Derive.html#2392" class="Bound">A</a> <a id="2411" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2413" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a><a id="2417" class="Symbol">)</a> <a id="2419" class="Symbol">→</a> <a id="2421" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2426" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
    <a id="2432" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2444" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2447" class="Symbol">=</a> <a id="2449" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
    <a id="2456" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2468" class="Symbol">(</a><a id="2469" href="Tactic.Derive.html#2469" class="Bound">x</a> <a id="2471" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2473" href="Tactic.Derive.html#2473" class="Bound">l</a><a id="2474" class="Symbol">)</a> <a id="2476" class="Symbol">=</a> <a id="2478" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2481" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="2487" href="Tactic.Derive.html#2469" class="Bound">x</a> <a id="2489" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="2494" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2501" href="Tactic.Derive.html#2473" class="Bound">l</a> <a id="2503" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2505" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2517" href="Tactic.Derive.html#2473" class="Bound">l</a> <a id="2519" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2524" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2536" href="Tactic.Derive.html#2473" class="Bound">l</a>

    <a id="2543" href="Tactic.Derive.html#2543" class="Function">modifyClassType</a> <a id="2559" class="Symbol">:</a> <a id="2561" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2567" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2572" class="Symbol">→</a> <a id="2574" href="Generics.Utils.html#2505" class="Function">TypeView</a> <a id="2583" class="Symbol">→</a> <a id="2585" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
    <a id="2594" href="Tactic.Derive.html#2543" class="Function">modifyClassType</a> <a id="2610" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>  <a id="2619" class="Symbol">(</a><a id="2620" href="Tactic.Derive.html#2620" class="Bound">tel</a> <a id="2624" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2626" href="Tactic.Derive.html#2626" class="Bound">ty</a><a id="2628" class="Symbol">)</a> <a id="2630" class="Symbol">=</a> <a id="2632" href="Generics.Utils.html#2662" class="Function">tyView</a> <a id="2639" class="Symbol">(</a><a id="2640" href="Tactic.Derive.html#2620" class="Bound">tel</a> <a id="2644" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2646" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2656" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2659" href="Tactic.Derive.html#2626" class="Bound">ty</a> <a id="2662" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2663" class="Symbol">)</a>
    <a id="2669" href="Tactic.Derive.html#2543" class="Function">modifyClassType</a> <a id="2685" class="Symbol">(</a><a id="2686" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2691" href="Tactic.Derive.html#2691" class="Bound">n</a><a id="2692" class="Symbol">)</a> <a id="2694" class="Symbol">(</a><a id="2695" href="Tactic.Derive.html#2695" class="Bound">tel</a> <a id="2699" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2701" href="Tactic.Derive.html#2701" class="Bound">ty</a><a id="2703" class="Symbol">)</a> <a id="2705" class="Symbol">=</a> <a id="2707" href="Generics.Utils.html#2662" class="Function">tyView</a> <a id="2714" class="Symbol">(</a><a id="2715" href="Tactic.Derive.html#2695" class="Bound">tel</a> <a id="2719" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2721" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2731" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2734" href="Tactic.Derive.html#2691" class="Bound">n</a> <a id="2736" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2739" href="Tactic.Derive.html#2701" class="Bound">ty</a> <a id="2742" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a> <a id="2744" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2745" class="Symbol">)</a>

<a id="lookupName"></a><a id="2748" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="2759" class="Symbol">:</a> <a id="2761" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2766" class="Symbol">(</a><a id="2767" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2772" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2774" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="2778" class="Symbol">)</a> <a id="2780" class="Symbol">→</a> <a id="2782" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2787" class="Symbol">→</a> <a id="2789" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2795" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
<a id="2800" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="2811" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2814" href="Tactic.Derive.html#2814" class="Bound">n</a> <a id="2816" class="Symbol">=</a> <a id="2818" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
<a id="2826" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="2837" class="Symbol">((</a><a id="2839" href="Tactic.Derive.html#2839" class="Bound">k</a> <a id="2841" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2843" href="Tactic.Derive.html#2843" class="Bound">v</a><a id="2844" class="Symbol">)</a> <a id="2846" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2848" href="Tactic.Derive.html#2848" class="Bound">l</a><a id="2849" class="Symbol">)</a> <a id="2851" href="Tactic.Derive.html#2851" class="Bound">n</a> <a id="2853" class="Symbol">=</a> <a id="2855" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2858" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="2860" href="Tactic.Derive.html#2839" class="Bound">k</a> <a id="2862" href="Tactic.Derive.html#881" class="Function Operator">≟-Name</a> <a id="2869" href="Tactic.Derive.html#2851" class="Bound">n</a> <a id="2871" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a> <a id="2873" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="2878" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2883" href="Tactic.Derive.html#2843" class="Bound">v</a> <a id="2885" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2890" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="2901" href="Tactic.Derive.html#2848" class="Bound">l</a> <a id="2903" href="Tactic.Derive.html#2851" class="Bound">n</a>

<a id="2906" class="Comment">-- Look at the constructors of the argument and return all types that</a>
<a id="2976" class="Comment">-- recursively contain it. This isn&#39;t very clever right now.</a>
<a id="genMutualHelpers"></a><a id="3037" href="Tactic.Derive.html#3037" class="Function">genMutualHelpers</a> <a id="3054" class="Symbol">:</a> <a id="3056" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3061" class="Symbol">→</a> <a id="3063" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3066" class="Symbol">(</a><a id="3067" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3072" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="3076" class="Symbol">)</a>
<a id="3078" href="Tactic.Derive.html#3037" class="Function">genMutualHelpers</a> <a id="3095" href="Tactic.Derive.html#3095" class="Bound">n</a> <a id="3097" class="Symbol">=</a> <a id="3099" class="Keyword">do</a>
  <a id="3104" href="Tactic.Derive.html#3104" class="Bound">tys</a> <a id="3108" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="3110" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="3116" class="Symbol">(</a><a id="3117" href="Reflection.Argument.html#2530" class="Function">unArg</a> <a id="3123" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3125" href="Reflection.Abstraction.html#1738" class="Function">unAbs</a><a id="3130" class="Symbol">)</a> <a id="3132" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3136" class="Symbol">(</a><a id="3137" href="Data.List.Base.html#4459" class="Function">L.concatMap</a> <a id="3149" class="Symbol">(</a><a id="3150" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="3156" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3158" href="Generics.Utils.html#2546" class="Function">viewTy</a> <a id="3165" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3167" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="3172" class="Symbol">)</a> <a id="3174" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3178" href="Class.MonadTC.html#9281" class="Function">getConstrs</a> <a id="3189" href="Tactic.Derive.html#3095" class="Bound">n</a><a id="3190" class="Symbol">)</a>
  <a id="3194" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="3201" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3203" href="Data.List.Base.html#9026" class="Function">deduplicate</a> <a id="3215" href="Tactic.Derive.html#881" class="Function Operator">_≟-Name_</a> <a id="3224" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3226" href="Data.List.Base.html#1638" class="Function">L.mapMaybe</a> <a id="3237" href="Tactic.Derive.html#3260" class="Function">helper</a> <a id="3244" href="Tactic.Derive.html#3104" class="Bound">tys</a>
  <a id="3250" class="Keyword">where</a>
    <a id="3260" href="Tactic.Derive.html#3260" class="Function">helper</a> <a id="3267" class="Symbol">:</a> <a id="3269" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="3274" class="Symbol">→</a> <a id="3276" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3282" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
    <a id="3291" href="Tactic.Derive.html#3260" class="Function">helper</a> <a id="3298" class="Symbol">(</a><a id="3299" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="3303" href="Tactic.Derive.html#3303" class="Bound">n&#39;</a> <a id="3306" href="Tactic.Derive.html#3306" class="Bound">args</a><a id="3310" class="Symbol">)</a> <a id="3312" class="Symbol">=</a>
      <a id="3320" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="3323" href="Data.List.Base.html#4686" class="Function">L.any</a> <a id="3329" class="Symbol">(λ</a> <a id="3332" class="Keyword">where</a> <a id="3338" class="Symbol">(</a><a id="3339" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="3343" class="Symbol">_</a> <a id="3345" class="Symbol">(</a><a id="3346" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="3350" href="Tactic.Derive.html#3350" class="Bound">n&#39;&#39;</a> <a id="3354" class="Symbol">_))</a> <a id="3358" class="Symbol">→</a> <a id="3360" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="3362" href="Tactic.Derive.html#3095" class="Bound">n</a> <a id="3364" href="Tactic.Derive.html#881" class="Function Operator">≟-Name</a> <a id="3371" href="Tactic.Derive.html#3350" class="Bound">n&#39;&#39;</a> <a id="3375" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a> <a id="3377" class="Symbol">;</a> <a id="3379" class="CatchallClause Symbol">_</a> <a id="3381" class="Symbol">→</a> <a id="3383" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="3388" class="Symbol">)</a> <a id="3390" href="Tactic.Derive.html#3306" class="Bound">args</a>
      <a id="3401" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="3406" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3411" href="Tactic.Derive.html#3303" class="Bound">n&#39;</a> <a id="3414" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="3419" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
    <a id="3431" href="Tactic.Derive.html#3260" class="CatchallClause Function">helper</a><a id="3437" class="CatchallClause"> </a><a id="3438" class="CatchallClause Symbol">_</a> <a id="3440" class="Symbol">=</a> <a id="3442" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

<a id="3451" class="Keyword">module</a> <a id="3458" href="Tactic.Derive.html#3458" class="Module">_</a> <a id="3460" class="Symbol">(</a><a id="3461" href="Tactic.Derive.html#3461" class="Bound">arity</a> <a id="3467" class="Symbol">:</a> <a id="3469" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="3470" class="Symbol">)</a> <a id="3472" class="Symbol">(</a><a id="3473" href="Tactic.Derive.html#3473" class="Bound">genCe</a> <a id="3479" class="Symbol">:</a> <a id="3481" class="Symbol">(</a><a id="3482" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3487" class="Symbol">→</a> <a id="3489" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3495" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="3499" class="Symbol">)</a> <a id="3501" class="Symbol">→</a> <a id="3503" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3508" href="Tactic.ClauseBuilder.html#1301" class="Function">SinglePattern</a> <a id="3522" class="Symbol">→</a> <a id="3524" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3529" class="Symbol">(</a><a id="3530" href="Data.List.NonEmpty.Base.html#1088" class="Record">NE.List⁺</a> <a id="3539" href="Tactic.ClauseBuilder.html#1301" class="Function">SinglePattern</a> <a id="3553" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3555" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3558" class="Symbol">(</a><a id="3559" href="Tactic.ClauseBuilder.html#5823" class="Datatype">ClauseExpr</a> <a id="3570" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="3572" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3578" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="3582" class="Symbol">)))</a> <a id="3586" class="Keyword">where</a>
  <a id="3594" class="Comment">-- Generate the declaration &amp; definition of a particular derivation.</a>
  <a id="3665" class="Comment">--</a>
  <a id="3670" class="Comment">-- Takes a dictionary (for mutual recursion), a wrapper (also for</a>
  <a id="3738" class="Comment">-- mutual recursion), the name of the original type we want to derive</a>
  <a id="3810" class="Comment">-- Show for and the name we want to define Show originally at.</a>
  <a id="3875" href="Tactic.Derive.html#3875" class="Function">deriveSingle</a> <a id="3888" class="Symbol">:</a> <a id="3890" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3895" class="Symbol">(</a><a id="3896" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3901" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3903" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="3907" class="Symbol">)</a> <a id="3909" class="Symbol">→</a> <a id="3911" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3916" class="Symbol">→</a> <a id="3918" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3923" class="Symbol">→</a> <a id="3925" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3931" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3936" class="Symbol">→</a> <a id="3938" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3941" class="Symbol">(</a><a id="3942" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="3946" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3951" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3953" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="3958" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3960" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3965" href="Agda.Builtin.Reflection.html#4727" class="Datatype">Clause</a><a id="3971" class="Symbol">)</a>
  <a id="3975" href="Tactic.Derive.html#3875" class="Function">deriveSingle</a> <a id="3988" href="Tactic.Derive.html#3988" class="Bound">transName</a> <a id="3998" href="Tactic.Derive.html#3998" class="Bound">dName</a> <a id="4004" href="Tactic.Derive.html#4004" class="Bound">iName</a> <a id="4010" href="Tactic.Derive.html#4010" class="Bound">wName</a> <a id="4016" class="Symbol">=</a> <a id="4018" href="Tactic.Helpers.html#2569" class="Function">inDebugPath</a> <a id="4030" class="String">&quot;DeriveSingle&quot;</a> <a id="4045" class="Keyword">do</a>
    <a id="4052" href="Class.MonadTC.html#5496" class="Function">debugLog</a> <a id="4061" class="Symbol">(</a><a id="4062" class="String">&quot;For: &quot;</a> <a id="4070" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="4073" href="Tactic.Derive.html#3998" class="Bound">dName</a> <a id="4079" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="4082" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4084" class="Symbol">)</a>
    <a id="4090" href="Tactic.Derive.html#4090" class="Bound">goalTy</a> <a id="4097" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4099" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="4112" href="Tactic.Derive.html#3461" class="Bound">arity</a> <a id="4118" href="Tactic.Derive.html#3998" class="Bound">dName</a> <a id="4124" href="Tactic.Derive.html#4010" class="Bound">wName</a>
    <a id="4134" href="Tactic.Derive.html#4134" class="Bound">ps</a> <a id="4137" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4139" href="Tactic.ClauseBuilder.html#5325" class="Function">constructorPatterns&#39;</a> <a id="4160" class="Symbol">(</a><a id="4161" href="Data.Maybe.Base.html#1641" class="Function">fromMaybe</a> <a id="4171" href="Tactic.Derive.html#3998" class="Bound">dName</a> <a id="4177" href="Tactic.Derive.html#4010" class="Bound">wName</a> <a id="4183" href="Generics.Core.html#1819" class="InductiveConstructor Operator">∙</a><a id="4184" class="Symbol">)</a>
    <a id="4190" class="Comment">-- TODO: find a good way of printing this</a>
    <a id="4236" class="Comment">--debugLogᵐ (&quot;Constrs: &quot; ∷ᵈᵐ ps ᵛⁿ ∷ᵈᵐ []ᵐ)</a>
    <a id="4284" href="Tactic.Derive.html#4284" class="Bound">cs</a> <a id="4287" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4289" href="Class.MonadReader.html#335" class="Field">local</a> <a id="4295" class="Symbol">(λ</a> <a id="4298" href="Tactic.Derive.html#4298" class="Bound">c</a> <a id="4300" class="Symbol">→</a> <a id="4302" class="Keyword">record</a> <a id="4309" href="Tactic.Derive.html#4298" class="Bound">c</a> <a id="4311" class="Symbol">{</a> <a id="4313" href="Class.MonadTC.html#829" class="Field">goal</a> <a id="4318" class="Symbol">=</a> <a id="4320" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="4325" href="Tactic.Derive.html#4090" class="Bound">goalTy</a> <a id="4332" class="Symbol">})</a> <a id="4335" href="Function.Base.html#1928" class="Function Operator">$</a>
      <a id="4343" href="Tactic.ClauseBuilder.html#11860" class="Function">singleMatchExpr</a> <a id="4359" class="Symbol">(</a><a id="4360" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="4363" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4365" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4370" class="Symbol">(</a><a id="4371" href="Agda.Builtin.Reflection.html#5654" class="InductiveConstructor">Pattern.proj</a> <a id="4384" href="Tactic.Derive.html#782" class="Bound">projName</a><a id="4392" class="Symbol">))</a> <a id="4395" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4397" href="Tactic.ClauseBuilder.html#12817" class="Function">contMatch</a> <a id="4407" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4409" href="Tactic.ClauseBuilder.html#11325" class="Function">multiMatchExprM</a> <a id="4425" href="Function.Base.html#1928" class="Function Operator">$</a>
        <a id="4435" href="Tactic.Derive.html#3473" class="Bound">genCe</a> <a id="4441" class="Symbol">(</a><a id="4442" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="4453" href="Tactic.Derive.html#3988" class="Bound">transName</a><a id="4462" class="Symbol">)</a> <a id="4464" href="Tactic.Derive.html#4134" class="Bound">ps</a>
    <a id="4471" class="Keyword">let</a> <a id="4475" href="Tactic.Derive.html#4475" class="Bound">defName</a> <a id="4483" class="Symbol">=</a> <a id="4485" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="4491" class="Symbol">(</a><a id="4492" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="4498" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="4503" class="Symbol">(</a><a id="4504" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4509" href="Tactic.Derive.html#4004" class="Bound">iName</a><a id="4514" class="Symbol">)</a> <a id="4516" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4518" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="4529" href="Tactic.Derive.html#3988" class="Bound">transName</a><a id="4538" class="Symbol">)</a> <a id="4540" class="Symbol">(</a><a id="4541" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4546" href="Tactic.Derive.html#4004" class="Bound">iName</a><a id="4551" class="Symbol">)</a> <a id="4553" href="Tactic.Derive.html#4010" class="Bound">wName</a>
    <a id="4563" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4570" class="Symbol">(</a><a id="4571" href="Tactic.Derive.html#4475" class="Bound">defName</a> <a id="4579" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4581" href="Tactic.Derive.html#4090" class="Bound">goalTy</a> <a id="4588" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4590" href="Tactic.ClauseBuilder.html#7442" class="Function">clauseExprToClauses</a> <a id="4610" href="Tactic.Derive.html#4284" class="Bound">cs</a><a id="4612" class="Symbol">)</a>

  <a id="4617" href="Tactic.Derive.html#4617" class="Function">deriveMulti</a> <a id="4629" class="Symbol">:</a> <a id="4631" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4636" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4638" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4643" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4645" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4650" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4655" class="Symbol">→</a> <a id="4657" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="4660" class="Symbol">(</a><a id="4661" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4666" class="Symbol">(</a><a id="4667" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="4671" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4676" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4678" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="4683" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4685" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4690" href="Agda.Builtin.Reflection.html#4727" class="Datatype">Clause</a><a id="4696" class="Symbol">))</a>
  <a id="4701" href="Tactic.Derive.html#4617" class="Function">deriveMulti</a> <a id="4713" class="Symbol">(</a><a id="4714" href="Tactic.Derive.html#4714" class="Bound">dName</a> <a id="4720" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4722" href="Tactic.Derive.html#4722" class="Bound">iName</a> <a id="4728" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4730" href="Tactic.Derive.html#4730" class="Bound">hClasses</a><a id="4738" class="Symbol">)</a> <a id="4740" class="Symbol">=</a> <a id="4742" class="Keyword">do</a>
    <a id="4749" href="Tactic.Derive.html#4749" class="Bound">hClassNames</a> <a id="4761" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4763" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="4772" class="Symbol">⦃</a> <a id="4774" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="4787" class="Symbol">⦄</a>
      <a id="4795" class="Symbol">(λ</a> <a id="4798" href="Tactic.Derive.html#4798" class="Bound">cn</a> <a id="4801" class="Symbol">→</a> <a id="4803" href="Class.MonadTC.html#1800" class="Field">freshName</a> <a id="4813" class="Symbol">(</a><a id="4814" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4823" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="4833" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4838" class="String">&quot;-&quot;</a> <a id="4842" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4847" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4856" href="Tactic.Derive.html#4798" class="Bound">cn</a> <a id="4859" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4864" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4873" href="Tactic.Derive.html#4714" class="Bound">dName</a><a id="4878" class="Symbol">))</a> <a id="4881" href="Tactic.Derive.html#4730" class="Bound">hClasses</a>
    <a id="4894" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="4903" class="Symbol">⦃</a> <a id="4905" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="4918" class="Symbol">⦄</a> <a id="4920" class="Symbol">(</a><a id="4921" href="Tactic.Derive.html#3875" class="Function">deriveSingle</a> <a id="4934" class="Symbol">(</a><a id="4935" href="Data.List.Base.html#3579" class="Function">L.zip</a> <a id="4941" href="Tactic.Derive.html#4730" class="Bound">hClasses</a> <a id="4950" href="Tactic.Derive.html#4749" class="Bound">hClassNames</a><a id="4961" class="Symbol">)</a> <a id="4963" href="Tactic.Derive.html#4714" class="Bound">dName</a> <a id="4969" href="Tactic.Derive.html#4722" class="Bound">iName</a><a id="4974" class="Symbol">)</a> <a id="4976" class="Symbol">(</a><a id="4977" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="4985" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4987" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="4993" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4998" href="Tactic.Derive.html#4730" class="Bound">hClasses</a><a id="5006" class="Symbol">)</a>

  <a id="5011" href="Tactic.Derive.html#5011" class="Function">derive-Class</a> <a id="5024" class="Symbol">:</a> <a id="5026" class="Symbol">⦃</a> <a id="5028" href="Tactic.Derive.html#5028" class="Symbol">_</a> <a id="5030" class="Symbol">:</a> <a id="5032" href="Reflection.Debug.html#2340" class="Record">DebugOptions</a> <a id="5045" class="Symbol">⦄</a> <a id="5047" class="Symbol">→</a> <a id="5049" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5054" class="Symbol">(</a><a id="5055" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5060" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5062" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="5066" class="Symbol">)</a> <a id="5068" class="Symbol">→</a> <a id="5070" href="Generics.Core.html#2480" class="Function">UnquoteDecl</a>
  <a id="5084" href="Tactic.Derive.html#5011" class="Function">derive-Class</a> <a id="5097" href="Tactic.Derive.html#5097" class="Bound">l</a> <a id="5099" class="Symbol">=</a> <a id="5101" href="Tactic.Helpers.html#6039" class="Function">initUnquoteWithGoal</a> <a id="5121" class="Symbol">(</a><a id="5122" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="5132" href="Generics.Core.html#1819" class="InductiveConstructor Operator">∙</a><a id="5133" class="Symbol">)</a> <a id="5135" href="Function.Base.html#1928" class="Function Operator">$</a>
    <a id="5141" href="Class.MonadTC.html#3561" class="Function">declareAndDefineFuns</a> <a id="5162" href="Class.Monad.Core.html#424" class="Function Operator">=&lt;&lt;</a> <a id="5166" href="Data.List.Base.html#4403" class="Function">concat</a> <a id="5173" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="5177" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="5186" class="Symbol">⦃</a> <a id="5188" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="5201" class="Symbol">⦄</a> <a id="5203" href="Tactic.Derive.html#5228" class="Function">helper</a> <a id="5210" href="Tactic.Derive.html#5097" class="Bound">l</a>
    <a id="5216" class="Keyword">where</a>
      <a id="5228" href="Tactic.Derive.html#5228" class="Function">helper</a> <a id="5235" class="Symbol">:</a> <a id="5237" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5242" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5244" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5249" class="Symbol">→</a> <a id="5251" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="5254" class="Symbol">(</a><a id="5255" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5260" class="Symbol">(</a><a id="5261" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="5265" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5270" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5272" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="5277" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5279" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5284" href="Agda.Builtin.Reflection.html#4727" class="Datatype">Clause</a><a id="5290" class="Symbol">))</a>
      <a id="5299" href="Tactic.Derive.html#5228" class="Function">helper</a> <a id="5306" class="Symbol">(</a><a id="5307" href="Tactic.Derive.html#5307" class="Bound">a</a> <a id="5309" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5311" href="Tactic.Derive.html#5311" class="Bound">b</a><a id="5312" class="Symbol">)</a> <a id="5314" class="Symbol">=</a> <a id="5316" class="Keyword">do</a> <a id="5319" href="Tactic.Derive.html#5319" class="Bound">hs</a> <a id="5322" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="5324" href="Tactic.Derive.html#3037" class="Function">genMutualHelpers</a> <a id="5341" href="Tactic.Derive.html#5307" class="Bound">a</a> <a id="5343" class="Symbol">;</a> <a id="5345" href="Tactic.Derive.html#4617" class="Function">deriveMulti</a> <a id="5357" class="Symbol">(</a><a id="5358" href="Tactic.Derive.html#5307" class="Bound">a</a> <a id="5360" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5362" href="Tactic.Derive.html#5311" class="Bound">b</a> <a id="5364" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5366" href="Tactic.Derive.html#5319" class="Bound">hs</a><a id="5368" class="Symbol">)</a>
</pre></body></html>