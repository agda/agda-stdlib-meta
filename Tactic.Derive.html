<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactic/Derive.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Generic type class dervations. Works with mutually recursive types</a>
<a id="71" class="Comment">-- and can use mutual recursion to satisfy the termination</a>
<a id="130" class="Comment">-- checker. Writing an actual derivation strategy then does not</a>
<a id="194" class="Comment">-- require dealing with any mutual recursion, it is all handled here.</a>
<a id="264" class="Comment">--</a>
<a id="267" class="Comment">-- TODO: This breaks with:</a>
<a id="294" class="Comment">-- - mutual recursion that nests too deep (i.e. deeper than 1, e.g. Term)</a>
<a id="368" class="Comment">-- - indexed datatypes that require absurd clauses (e.g. Vec)</a>
<a id="430" class="Comment">--</a>
<a id="433" class="Comment">-- TODO: support type classes with more than one field</a>
<a id="488" class="Comment">--</a>
<a id="491" class="Comment">-- TODO: enable using existing code for instance when mutually recursing</a>
<a id="564" class="Comment">--</a>
<a id="567" class="Comment">-- TODO: Requires K to pass the termination checker. Maybe we can do without somehow.</a>

<a id="654" class="Symbol">{-#</a> <a id="658" class="Keyword">OPTIONS</a> <a id="666" class="Pragma">-v</a> <a id="669" class="Pragma">allTactics:100</a> <a id="684" class="Symbol">#-}</a>
<a id="688" class="Symbol">{-#</a> <a id="692" class="Keyword">OPTIONS</a> <a id="700" class="Pragma">--safe</a> <a id="707" class="Pragma">--without-K</a> <a id="719" class="Symbol">#-}</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Meta.html" class="Module">Meta</a>

<a id="741" class="Keyword">module</a> <a id="748" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="762" class="Symbol">(</a><a id="763" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="773" class="Symbol">:</a> <a id="775" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="779" class="Symbol">)</a> <a id="781" class="Symbol">(</a><a id="782" href="Tactic.Derive.html#782" class="Bound">projName</a> <a id="791" class="Symbol">:</a> <a id="793" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="797" class="Symbol">)</a> <a id="799" class="Keyword">where</a>

<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Prelude.html" class="Module">Prelude</a>

<a id="827" class="Keyword">open</a> <a id="832" class="Keyword">import</a> <a id="839" href="Reflection.Name.html" class="Module">Reflection.Name</a> <a id="855" class="Keyword">using</a> <a id="861" class="Symbol">()</a> <a id="864" class="Keyword">renaming</a> <a id="873" class="Symbol">(</a><a id="874" href="Reflection.Name.html#1403" class="Function Operator">_≟_</a> <a id="878" class="Symbol">to</a> <a id="881" class="Function Operator">_≟-Name_</a><a id="889" class="Symbol">)</a>
<a id="891" class="Keyword">open</a> <a id="896" class="Keyword">import</a> <a id="903" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">()</a> <a id="936" class="Keyword">renaming</a> <a id="945" class="Symbol">(</a><a id="946" href="Agda.Builtin.Reflection.html#622" class="Primitive">primShowQName</a> <a id="960" class="Symbol">to</a> <a id="963" class="Primitive">showName</a><a id="971" class="Symbol">)</a>

<a id="974" class="Keyword">open</a> <a id="979" class="Keyword">import</a> <a id="986" href="Generics.html" class="Module">Generics</a>

<a id="996" class="Keyword">open</a> <a id="1001" class="Keyword">import</a> <a id="1008" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1019" class="Keyword">using</a> <a id="1025" class="Symbol">(</a><a id="1026" href="Data.Maybe.Base.html#1632" class="Function">fromMaybe</a><a id="1035" class="Symbol">)</a>
<a id="1037" class="Keyword">import</a> <a id="1044" href="Data.List.html" class="Module">Data.List</a> <a id="1054" class="Symbol">as</a> <a id="1057" class="Module">L</a>
<a id="1059" class="Keyword">import</a> <a id="1066" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="1085" class="Symbol">as</a> <a id="1088" class="Module">NE</a>
<a id="1091" class="Keyword">import</a> <a id="1098" href="Data.String.html" class="Module">Data.String</a> <a id="1110" class="Symbol">as</a> <a id="1113" class="Module">S</a>

<a id="1116" class="Keyword">open</a> <a id="1121" class="Keyword">import</a> <a id="1128" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="1156" class="Keyword">open</a> <a id="1161" class="Keyword">import</a> <a id="1168" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="1189" class="Keyword">open</a> <a id="1194" class="Keyword">import</a> <a id="1201" href="Tactic.Helpers.html" class="Module">Tactic.Helpers</a>

<a id="1217" class="Keyword">open</a> <a id="1222" class="Keyword">import</a> <a id="1229" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="1241" class="Keyword">open</a> <a id="1246" class="Keyword">import</a> <a id="1253" href="Class.Traversable.html" class="Module">Class.Traversable</a>
<a id="1271" class="Keyword">open</a> <a id="1276" class="Keyword">import</a> <a id="1283" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="1297" class="Keyword">open</a> <a id="1302" class="Keyword">import</a> <a id="1309" href="Class.MonadReader.Instances.html" class="Module">Class.MonadReader.Instances</a>
<a id="1337" class="Keyword">open</a> <a id="1342" class="Keyword">import</a> <a id="1349" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>

<a id="1374" class="Keyword">instance</a>
  <a id="1385" href="Tactic.Derive.html#1385" class="Function">_</a> <a id="1387" class="Symbol">=</a> <a id="1389" href="Tactic.ClauseBuilder.html#10822" class="Function">ContextMonad-MonadTC</a>
  <a id="1412" href="Tactic.Derive.html#1412" class="Function">_</a> <a id="1414" class="Symbol">=</a> <a id="1416" href="Class.Monad.Core.html#655" class="Function">Functor-M</a>

<a id="1427" class="Keyword">open</a> <a id="1432" href="Tactic.ClauseBuilder.html#11052" class="Module">ClauseExprM</a>

<a id="genClassType"></a><a id="1445" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="1458" class="Symbol">:</a> <a id="1460" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1462" class="Symbol">→</a> <a id="1464" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="1469" class="Symbol">→</a> <a id="1471" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1477" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="1482" class="Symbol">→</a> <a id="1484" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1487" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a>
<a id="1492" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="1505" href="Tactic.Derive.html#1505" class="Bound">arity</a> <a id="1511" href="Tactic.Derive.html#1511" class="Bound">dName</a> <a id="1517" href="Tactic.Derive.html#1517" class="Bound">wName</a> <a id="1523" class="Symbol">=</a> <a id="1525" class="Keyword">do</a>
  <a id="1530" href="Tactic.Derive.html#1530" class="Bound">params</a> <a id="1537" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1539" href="Tactic.Helpers.html#4334" class="Function">getParamsAndIndices</a> <a id="1559" href="Tactic.Derive.html#1511" class="Bound">dName</a>
  <a id="1567" href="Tactic.Derive.html#1567" class="Bound">adjParams</a> <a id="1577" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1579" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1592" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1594" href="Data.List.Base.html#7307" class="Function">take</a> <a id="1599" class="Symbol">(</a><a id="1600" href="Data.List.Base.html#4864" class="Function">length</a> <a id="1607" href="Tactic.Derive.html#1530" class="Bound">params</a> <a id="1614" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="1616" href="Tactic.Derive.html#1505" class="Bound">arity</a><a id="1621" class="Symbol">)</a> <a id="1623" href="Tactic.Derive.html#1530" class="Bound">params</a>
  <a id="1632" href="Class.MonadTC.html#8558" class="Function">debugLog1</a> <a id="1642" class="String">&quot;AdjustedParams: &quot;</a>
  <a id="1663" href="Tactic.Helpers.html#1205" class="Function">logTelescope</a> <a id="1676" class="Symbol">(</a><a id="1677" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="1683" class="Symbol">((λ</a> <a id="1687" class="Keyword">where</a> <a id="1693" class="Symbol">(</a><a id="1694" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1698" href="Tactic.Derive.html#1698" class="Bound">s</a> <a id="1700" href="Tactic.Derive.html#1700" class="Bound">x</a><a id="1701" class="Symbol">)</a> <a id="1703" class="Symbol">→</a> <a id="1705" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1710" href="Tactic.Derive.html#1698" class="Bound">s</a> <a id="1712" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1714" href="Tactic.Derive.html#1700" class="Bound">x</a><a id="1715" class="Symbol">)</a> <a id="1717" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1719" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="1724" class="Symbol">)</a> <a id="1726" href="Tactic.Derive.html#1567" class="Bound">adjParams</a><a id="1735" class="Symbol">)</a>
  <a id="1739" href="Tactic.Derive.html#1739" class="Bound">ty</a> <a id="1742" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1744" href="Tactic.Helpers.html#5467" class="Function">applyWithVisibility</a> <a id="1764" href="Tactic.Derive.html#1511" class="Bound">dName</a> <a id="1770" class="Symbol">(</a><a id="1771" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="1777" href="Generics.Core.html#372" class="InductiveConstructor">♯</a> <a id="1779" class="Symbol">(</a><a id="1780" href="Tactic.Derive.html#2373" class="Function">trueIndices</a> <a id="1792" href="Tactic.Derive.html#1567" class="Bound">adjParams</a><a id="1801" class="Symbol">))</a>
  <a id="1806" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1813" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1815" href="Tactic.Derive.html#2539" class="Function">modifyClassType</a> <a id="1831" href="Tactic.Derive.html#1517" class="Bound">wName</a> <a id="1837" class="Symbol">(</a><a id="1838" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="1844" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1850" href="Tactic.Derive.html#1567" class="Bound">adjParams</a> <a id="1860" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1862" href="Tactic.Derive.html#1739" class="Bound">ty</a><a id="1864" class="Symbol">)</a>
  <a id="1868" class="Keyword">where</a>
    <a id="1878" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1891" class="Symbol">:</a> <a id="1893" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1898" class="Symbol">(</a><a id="1899" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1903" class="Symbol">(</a><a id="1904" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="1908" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a><a id="1912" class="Symbol">))</a> <a id="1915" class="Symbol">→</a> <a id="1917" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1926" class="Symbol">((</a><a id="1928" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1932" class="Symbol">(</a><a id="1933" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="1937" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a><a id="1941" class="Symbol">))</a> <a id="1944" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1946" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1950" class="Symbol">))</a>
    <a id="1957" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1970" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1973" class="Symbol">=</a> <a id="1975" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1982" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="1989" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="2002" class="Symbol">(</a><a id="2003" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2007" href="Tactic.Derive.html#2007" class="Bound">x</a> <a id="2009" class="Symbol">(</a><a id="2010" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="2014" class="Symbol">_</a> <a id="2016" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2017" class="Symbol">)</a> <a id="2019" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2021" href="Tactic.Derive.html#2021" class="Bound">l</a><a id="2022" class="Symbol">)</a> <a id="2024" class="Symbol">=</a> <a id="2026" class="Keyword">do</a>
      <a id="2035" href="Tactic.Derive.html#2035" class="Bound">a</a> <a id="2037" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2039" class="Symbol">(</a><a id="2040" href="Data.Bool.Base.html#1283" class="Function Operator">if_then</a> <a id="2048" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2050" class="Symbol">(</a><a id="2051" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2055" class="String">&quot;_&quot;</a> <a id="2059" class="Symbol">(</a><a id="2060" href="Reflection.Argument.html#1333" class="InductiveConstructor">iArg</a> <a id="2065" class="Symbol">(</a><a id="2066" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2076" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2079" href="Generics.Core.html#372" class="InductiveConstructor">♯</a> <a id="2081" class="Number">0</a> <a id="2083" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2084" class="Symbol">))</a> <a id="2087" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2089" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="2094" class="Symbol">)</a> <a id="2096" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="2098" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2103" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2105" class="Symbol">)</a> <a id="2107" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="2111" href="Tactic.Helpers.html#4644" class="Function">isNArySort</a> <a id="2122" href="Tactic.Derive.html#1505" class="Bound">arity</a> <a id="2128" href="Tactic.Derive.html#2016" class="Bound">t</a>
      <a id="2136" href="Tactic.Derive.html#2136" class="Bound">ps</a> <a id="2139" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2141" href="Class.MonadTC.html#7585" class="Function">extendContext</a> <a id="2155" class="Symbol">(</a><a id="2156" href="Reflection.Argument.html#1271" class="InductiveConstructor">hArg</a> <a id="2161" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2162" class="Symbol">)</a> <a id="2164" class="Symbol">(</a><a id="2165" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="2178" href="Tactic.Derive.html#2021" class="Bound">l</a><a id="2179" class="Symbol">)</a>
      <a id="2187" class="Keyword">let</a> <a id="2191" href="Tactic.Derive.html#2191" class="Bound">ps&#39;</a> <a id="2195" class="Symbol">=</a> <a id="2197" href="Function.Base.html#1554" class="Function">flip</a> <a id="2202" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="2208" href="Tactic.Derive.html#2136" class="Bound">ps</a> <a id="2211" class="Symbol">λ</a> <a id="2213" class="Keyword">where</a>
        <a id="2227" class="Symbol">(</a><a id="2228" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2232" href="Tactic.Derive.html#2232" class="Bound">s</a> <a id="2234" class="Symbol">(</a><a id="2235" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="2239" href="Tactic.Derive.html#2239" class="Bound">i</a> <a id="2241" href="Tactic.Derive.html#2241" class="Bound">t</a><a id="2242" class="Symbol">)</a> <a id="2244" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2246" href="Tactic.Derive.html#2246" class="Bound">b</a><a id="2247" class="Symbol">)</a> <a id="2249" class="Symbol">→</a> <a id="2251" class="Symbol">(</a><a id="2252" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2256" href="Tactic.Derive.html#2232" class="Bound">s</a> <a id="2258" class="Symbol">(</a><a id="2259" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="2263" href="Tactic.Derive.html#2239" class="Bound">i</a> <a id="2265" class="Symbol">(</a><a id="2266" href="Generics.Utils.html#5684" class="Function">mapVars</a> <a id="2274" class="Symbol">(</a><a id="2275" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="2278" class="Symbol">(</a><a id="2279" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2282" href="Tactic.Derive.html#2246" class="Bound">b</a> <a id="2284" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2289" href="Data.List.Base.html#4864" class="Function">length</a> <a id="2296" href="Tactic.Derive.html#2035" class="Bound">a</a> <a id="2298" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2303" class="Number">0</a><a id="2304" class="Symbol">))</a> <a id="2307" href="Tactic.Derive.html#2241" class="Bound">t</a><a id="2308" class="Symbol">))</a> <a id="2311" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2313" href="Tactic.Derive.html#2246" class="Bound">b</a><a id="2314" class="Symbol">)</a>
      <a id="2322" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="2329" class="Symbol">(((</a><a id="2332" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2336" href="Tactic.Derive.html#2007" class="Bound">x</a> <a id="2338" class="Symbol">(</a><a id="2339" href="Reflection.Argument.html#1271" class="InductiveConstructor">hArg</a> <a id="2344" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2345" class="Symbol">)</a> <a id="2347" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2349" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="2353" class="Symbol">)</a> <a id="2355" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2357" href="Tactic.Derive.html#2035" class="Bound">a</a><a id="2358" class="Symbol">)</a> <a id="2360" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2363" href="Tactic.Derive.html#2191" class="Bound">ps&#39;</a><a id="2366" class="Symbol">)</a>

    <a id="2373" href="Tactic.Derive.html#2373" class="Function">trueIndices</a> <a id="2385" class="Symbol">:</a> <a id="2387" class="Symbol">{</a><a id="2388" href="Tactic.Derive.html#2388" class="Bound">A</a> <a id="2390" class="Symbol">:</a> <a id="2392" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2395" class="Symbol">}</a> <a id="2397" class="Symbol">→</a> <a id="2399" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2404" class="Symbol">(</a><a id="2405" href="Tactic.Derive.html#2388" class="Bound">A</a> <a id="2407" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2409" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="2413" class="Symbol">)</a> <a id="2415" class="Symbol">→</a> <a id="2417" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2422" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2428" href="Tactic.Derive.html#2373" class="Function">trueIndices</a> <a id="2440" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2443" class="Symbol">=</a> <a id="2445" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="2452" href="Tactic.Derive.html#2373" class="Function">trueIndices</a> <a id="2464" class="Symbol">(</a><a id="2465" href="Tactic.Derive.html#2465" class="Bound">x</a> <a id="2467" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2469" href="Tactic.Derive.html#2469" class="Bound">l</a><a id="2470" class="Symbol">)</a> <a id="2472" class="Symbol">=</a> <a id="2474" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2477" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="2483" href="Tactic.Derive.html#2465" class="Bound">x</a> <a id="2485" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2490" href="Data.List.Base.html#4864" class="Function">length</a> <a id="2497" href="Tactic.Derive.html#2469" class="Bound">l</a> <a id="2499" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2501" href="Tactic.Derive.html#2373" class="Function">trueIndices</a> <a id="2513" href="Tactic.Derive.html#2469" class="Bound">l</a> <a id="2515" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2520" href="Tactic.Derive.html#2373" class="Function">trueIndices</a> <a id="2532" href="Tactic.Derive.html#2469" class="Bound">l</a>

    <a id="2539" href="Tactic.Derive.html#2539" class="Function">modifyClassType</a> <a id="2555" class="Symbol">:</a> <a id="2557" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2563" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="2568" class="Symbol">→</a> <a id="2570" href="Generics.Utils.html#2505" class="Function">TypeView</a> <a id="2579" class="Symbol">→</a> <a id="2581" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a>
    <a id="2590" href="Tactic.Derive.html#2539" class="Function">modifyClassType</a> <a id="2606" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>  <a id="2615" class="Symbol">(</a><a id="2616" href="Tactic.Derive.html#2616" class="Bound">tel</a> <a id="2620" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2622" href="Tactic.Derive.html#2622" class="Bound">ty</a><a id="2624" class="Symbol">)</a> <a id="2626" class="Symbol">=</a> <a id="2628" href="Generics.Utils.html#2662" class="Function">tyView</a> <a id="2635" class="Symbol">(</a><a id="2636" href="Tactic.Derive.html#2616" class="Bound">tel</a> <a id="2640" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2642" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2652" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2655" href="Tactic.Derive.html#2622" class="Bound">ty</a> <a id="2658" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2659" class="Symbol">)</a>
    <a id="2665" href="Tactic.Derive.html#2539" class="Function">modifyClassType</a> <a id="2681" class="Symbol">(</a><a id="2682" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2687" href="Tactic.Derive.html#2687" class="Bound">n</a><a id="2688" class="Symbol">)</a> <a id="2690" class="Symbol">(</a><a id="2691" href="Tactic.Derive.html#2691" class="Bound">tel</a> <a id="2695" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2697" href="Tactic.Derive.html#2697" class="Bound">ty</a><a id="2699" class="Symbol">)</a> <a id="2701" class="Symbol">=</a> <a id="2703" href="Generics.Utils.html#2662" class="Function">tyView</a> <a id="2710" class="Symbol">(</a><a id="2711" href="Tactic.Derive.html#2691" class="Bound">tel</a> <a id="2715" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2717" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2727" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2730" href="Tactic.Derive.html#2687" class="Bound">n</a> <a id="2732" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2735" href="Tactic.Derive.html#2697" class="Bound">ty</a> <a id="2738" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a> <a id="2740" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2741" class="Symbol">)</a>

<a id="lookupName"></a><a id="2744" href="Tactic.Derive.html#2744" class="Function">lookupName</a> <a id="2755" class="Symbol">:</a> <a id="2757" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2762" class="Symbol">(</a><a id="2763" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="2768" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2770" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="2774" class="Symbol">)</a> <a id="2776" class="Symbol">→</a> <a id="2778" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="2783" class="Symbol">→</a> <a id="2785" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2791" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a>
<a id="2796" href="Tactic.Derive.html#2744" class="Function">lookupName</a> <a id="2807" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2810" href="Tactic.Derive.html#2810" class="Bound">n</a> <a id="2812" class="Symbol">=</a> <a id="2814" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="2822" href="Tactic.Derive.html#2744" class="Function">lookupName</a> <a id="2833" class="Symbol">((</a><a id="2835" href="Tactic.Derive.html#2835" class="Bound">k</a> <a id="2837" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2839" href="Tactic.Derive.html#2839" class="Bound">v</a><a id="2840" class="Symbol">)</a> <a id="2842" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2844" href="Tactic.Derive.html#2844" class="Bound">l</a><a id="2845" class="Symbol">)</a> <a id="2847" href="Tactic.Derive.html#2847" class="Bound">n</a> <a id="2849" class="Symbol">=</a> <a id="2851" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2854" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="2856" href="Tactic.Derive.html#2835" class="Bound">k</a> <a id="2858" href="Tactic.Derive.html#881" class="Function Operator">≟-Name</a> <a id="2865" href="Tactic.Derive.html#2847" class="Bound">n</a> <a id="2867" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a> <a id="2869" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2874" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2879" href="Tactic.Derive.html#2839" class="Bound">v</a> <a id="2881" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2886" href="Tactic.Derive.html#2744" class="Function">lookupName</a> <a id="2897" href="Tactic.Derive.html#2844" class="Bound">l</a> <a id="2899" href="Tactic.Derive.html#2847" class="Bound">n</a>

<a id="2902" class="Comment">-- Look at the constructors of the argument and return all types that</a>
<a id="2972" class="Comment">-- recursively contain it. This isn&#39;t very clever right now.</a>
<a id="genMutualHelpers"></a><a id="3033" href="Tactic.Derive.html#3033" class="Function">genMutualHelpers</a> <a id="3050" class="Symbol">:</a> <a id="3052" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3057" class="Symbol">→</a> <a id="3059" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3062" class="Symbol">(</a><a id="3063" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3068" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="3072" class="Symbol">)</a>
<a id="3074" href="Tactic.Derive.html#3033" class="Function">genMutualHelpers</a> <a id="3091" href="Tactic.Derive.html#3091" class="Bound">n</a> <a id="3093" class="Symbol">=</a> <a id="3095" class="Keyword">do</a>
  <a id="3100" href="Tactic.Derive.html#3100" class="Bound">tys</a> <a id="3104" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="3106" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="3112" class="Symbol">(</a><a id="3113" href="Reflection.Argument.html#2521" class="Function">unArg</a> <a id="3119" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3121" href="Reflection.Abstraction.html#1729" class="Function">unAbs</a><a id="3126" class="Symbol">)</a> <a id="3128" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3132" class="Symbol">(</a><a id="3133" href="Data.List.Base.html#4450" class="Function">L.concatMap</a> <a id="3145" class="Symbol">(</a><a id="3146" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3152" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3154" href="Generics.Utils.html#2546" class="Function">viewTy</a> <a id="3161" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3163" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="3168" class="Symbol">)</a> <a id="3170" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3174" href="Class.MonadTC.html#9358" class="Function">getConstrs</a> <a id="3185" href="Tactic.Derive.html#3091" class="Bound">n</a><a id="3186" class="Symbol">)</a>
  <a id="3190" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="3197" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3199" href="Data.List.Base.html#9017" class="Function">deduplicate</a> <a id="3211" href="Tactic.Derive.html#881" class="Function Operator">_≟-Name_</a> <a id="3220" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3222" href="Data.List.Base.html#1629" class="Function">L.mapMaybe</a> <a id="3233" href="Tactic.Derive.html#3256" class="Function">helper</a> <a id="3240" href="Tactic.Derive.html#3100" class="Bound">tys</a>
  <a id="3246" class="Keyword">where</a>
    <a id="3256" href="Tactic.Derive.html#3256" class="Function">helper</a> <a id="3263" class="Symbol">:</a> <a id="3265" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="3270" class="Symbol">→</a> <a id="3272" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3278" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a>
    <a id="3287" href="Tactic.Derive.html#3256" class="Function">helper</a> <a id="3294" class="Symbol">(</a><a id="3295" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="3299" href="Tactic.Derive.html#3299" class="Bound">n&#39;</a> <a id="3302" href="Tactic.Derive.html#3302" class="Bound">args</a><a id="3306" class="Symbol">)</a> <a id="3308" class="Symbol">=</a>
      <a id="3316" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="3319" href="Data.List.Base.html#4677" class="Function">L.any</a> <a id="3325" class="Symbol">(λ</a> <a id="3328" class="Keyword">where</a> <a id="3334" class="Symbol">(</a><a id="3335" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="3339" class="Symbol">_</a> <a id="3341" class="Symbol">(</a><a id="3342" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="3346" href="Tactic.Derive.html#3346" class="Bound">n&#39;&#39;</a> <a id="3350" class="Symbol">_))</a> <a id="3354" class="Symbol">→</a> <a id="3356" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="3358" href="Tactic.Derive.html#3091" class="Bound">n</a> <a id="3360" href="Tactic.Derive.html#881" class="Function Operator">≟-Name</a> <a id="3367" href="Tactic.Derive.html#3346" class="Bound">n&#39;&#39;</a> <a id="3371" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a> <a id="3373" class="Symbol">;</a> <a id="3375" class="CatchallClause Symbol">_</a> <a id="3377" class="Symbol">→</a> <a id="3379" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="3384" class="Symbol">)</a> <a id="3386" href="Tactic.Derive.html#3302" class="Bound">args</a>
      <a id="3397" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="3402" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3407" href="Tactic.Derive.html#3299" class="Bound">n&#39;</a> <a id="3410" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="3415" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="3427" href="Tactic.Derive.html#3256" class="CatchallClause Function">helper</a><a id="3433" class="CatchallClause"> </a><a id="3434" class="CatchallClause Symbol">_</a> <a id="3436" class="Symbol">=</a> <a id="3438" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="3447" class="Keyword">module</a> <a id="3454" href="Tactic.Derive.html#3454" class="Module">_</a> <a id="3456" class="Symbol">(</a><a id="3457" href="Tactic.Derive.html#3457" class="Bound">arity</a> <a id="3463" class="Symbol">:</a> <a id="3465" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3466" class="Symbol">)</a> <a id="3468" class="Symbol">(</a><a id="3469" href="Tactic.Derive.html#3469" class="Bound">genCe</a> <a id="3475" class="Symbol">:</a> <a id="3477" class="Symbol">(</a><a id="3478" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3483" class="Symbol">→</a> <a id="3485" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3491" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="3495" class="Symbol">)</a> <a id="3497" class="Symbol">→</a> <a id="3499" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3504" href="Tactic.ClauseBuilder.html#1301" class="Function">SinglePattern</a> <a id="3518" class="Symbol">→</a> <a id="3520" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3525" class="Symbol">(</a><a id="3526" href="Data.List.NonEmpty.Base.html#1079" class="Record">NE.List⁺</a> <a id="3535" href="Tactic.ClauseBuilder.html#1301" class="Function">SinglePattern</a> <a id="3549" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3551" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3554" class="Symbol">(</a><a id="3555" href="Tactic.ClauseBuilder.html#5817" class="Datatype">ClauseExpr</a> <a id="3566" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="3568" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3574" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a><a id="3578" class="Symbol">)))</a> <a id="3582" class="Keyword">where</a>
  <a id="3590" class="Comment">-- Generate the declaration &amp; definition of a particular derivation.</a>
  <a id="3661" class="Comment">--</a>
  <a id="3666" class="Comment">-- Takes a dictionary (for mutual recursion), a wrapper (also for</a>
  <a id="3734" class="Comment">-- mutual recursion), the name of the original type we want to derive</a>
  <a id="3806" class="Comment">-- Show for and the name we want to define Show originally at.</a>
  <a id="3871" href="Tactic.Derive.html#3871" class="Function">deriveSingle</a> <a id="3884" class="Symbol">:</a> <a id="3886" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3891" class="Symbol">(</a><a id="3892" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3897" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3899" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="3903" class="Symbol">)</a> <a id="3905" class="Symbol">→</a> <a id="3907" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3912" class="Symbol">→</a> <a id="3914" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3919" class="Symbol">→</a> <a id="3921" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3927" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3932" class="Symbol">→</a> <a id="3934" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3937" class="Symbol">(</a><a id="3938" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="3942" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3947" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3949" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="3954" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3956" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3961" href="Agda.Builtin.Reflection.html#4745" class="Datatype">Clause</a><a id="3967" class="Symbol">)</a>
  <a id="3971" href="Tactic.Derive.html#3871" class="Function">deriveSingle</a> <a id="3984" href="Tactic.Derive.html#3984" class="Bound">transName</a> <a id="3994" href="Tactic.Derive.html#3994" class="Bound">dName</a> <a id="4000" href="Tactic.Derive.html#4000" class="Bound">iName</a> <a id="4006" href="Tactic.Derive.html#4006" class="Bound">wName</a> <a id="4012" class="Symbol">=</a> <a id="4014" href="Tactic.Helpers.html#2566" class="Function">inDebugPath</a> <a id="4026" class="String">&quot;DeriveSingle&quot;</a> <a id="4041" class="Keyword">do</a>
    <a id="4048" href="Class.MonadTC.html#5514" class="Function">debugLog</a> <a id="4057" class="Symbol">(</a><a id="4058" class="String">&quot;For: &quot;</a> <a id="4066" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="4069" href="Tactic.Derive.html#3994" class="Bound">dName</a> <a id="4075" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="4078" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4080" class="Symbol">)</a>
    <a id="4086" href="Tactic.Derive.html#4086" class="Bound">goalTy</a> <a id="4093" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4095" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="4108" href="Tactic.Derive.html#3457" class="Bound">arity</a> <a id="4114" href="Tactic.Derive.html#3994" class="Bound">dName</a> <a id="4120" href="Tactic.Derive.html#4006" class="Bound">wName</a>
    <a id="4130" href="Tactic.Derive.html#4130" class="Bound">ps</a> <a id="4133" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4135" href="Tactic.ClauseBuilder.html#5319" class="Function">constructorPatterns&#39;</a> <a id="4156" class="Symbol">(</a><a id="4157" href="Data.Maybe.Base.html#1632" class="Function">fromMaybe</a> <a id="4167" href="Tactic.Derive.html#3994" class="Bound">dName</a> <a id="4173" href="Tactic.Derive.html#4006" class="Bound">wName</a> <a id="4179" href="Generics.Core.html#1819" class="InductiveConstructor Operator">∙</a><a id="4180" class="Symbol">)</a>
    <a id="4186" class="Comment">-- TODO: find a good way of printing this</a>
    <a id="4232" class="Comment">--debugLogᵐ (&quot;Constrs: &quot; ∷ᵈᵐ ps ᵛⁿ ∷ᵈᵐ []ᵐ)</a>
    <a id="4280" href="Tactic.Derive.html#4280" class="Bound">cs</a> <a id="4283" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4285" href="Class.MonadReader.html#335" class="Field">local</a> <a id="4291" class="Symbol">(λ</a> <a id="4294" href="Tactic.Derive.html#4294" class="Bound">c</a> <a id="4296" class="Symbol">→</a> <a id="4298" class="Keyword">record</a> <a id="4305" href="Tactic.Derive.html#4294" class="Bound">c</a> <a id="4307" class="Symbol">{</a> <a id="4309" href="Class.MonadTC.html#847" class="Field">goal</a> <a id="4314" class="Symbol">=</a> <a id="4316" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="4321" href="Tactic.Derive.html#4086" class="Bound">goalTy</a> <a id="4328" class="Symbol">})</a> <a id="4331" href="Function.Base.html#1919" class="Function Operator">$</a>
      <a id="4339" href="Tactic.ClauseBuilder.html#11944" class="Function">singleMatchExpr</a> <a id="4355" class="Symbol">(</a><a id="4356" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4359" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4361" href="Reflection.Argument.html#1333" class="InductiveConstructor">iArg</a> <a id="4366" class="Symbol">(</a><a id="4367" href="Agda.Builtin.Reflection.html#5629" class="InductiveConstructor">Pattern.proj</a> <a id="4380" href="Tactic.Derive.html#782" class="Bound">projName</a><a id="4388" class="Symbol">))</a> <a id="4391" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4393" href="Tactic.ClauseBuilder.html#12901" class="Function">contMatch</a> <a id="4403" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4405" href="Tactic.ClauseBuilder.html#11409" class="Function">multiMatchExprM</a> <a id="4421" href="Function.Base.html#1919" class="Function Operator">$</a>
        <a id="4431" href="Tactic.Derive.html#3469" class="Bound">genCe</a> <a id="4437" class="Symbol">(</a><a id="4438" href="Tactic.Derive.html#2744" class="Function">lookupName</a> <a id="4449" href="Tactic.Derive.html#3984" class="Bound">transName</a><a id="4458" class="Symbol">)</a> <a id="4460" href="Tactic.Derive.html#4130" class="Bound">ps</a>
    <a id="4467" class="Keyword">let</a> <a id="4471" href="Tactic.Derive.html#4471" class="Bound">defName</a> <a id="4479" class="Symbol">=</a> <a id="4481" href="Data.Maybe.Base.html#1362" class="Function">maybe</a> <a id="4487" class="Symbol">(</a><a id="4488" href="Data.Maybe.Base.html#1362" class="Function">maybe</a> <a id="4494" href="Reflection.Argument.html#1209" class="InductiveConstructor">vArg</a> <a id="4499" class="Symbol">(</a><a id="4500" href="Reflection.Argument.html#1333" class="InductiveConstructor">iArg</a> <a id="4505" href="Tactic.Derive.html#4000" class="Bound">iName</a><a id="4510" class="Symbol">)</a> <a id="4512" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4514" href="Tactic.Derive.html#2744" class="Function">lookupName</a> <a id="4525" href="Tactic.Derive.html#3984" class="Bound">transName</a><a id="4534" class="Symbol">)</a> <a id="4536" class="Symbol">(</a><a id="4537" href="Reflection.Argument.html#1333" class="InductiveConstructor">iArg</a> <a id="4542" href="Tactic.Derive.html#4000" class="Bound">iName</a><a id="4547" class="Symbol">)</a> <a id="4549" href="Tactic.Derive.html#4006" class="Bound">wName</a>
    <a id="4559" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4566" class="Symbol">(</a><a id="4567" href="Tactic.Derive.html#4471" class="Bound">defName</a> <a id="4575" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4577" href="Tactic.Derive.html#4086" class="Bound">goalTy</a> <a id="4584" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4586" href="Tactic.ClauseBuilder.html#7436" class="Function">clauseExprToClauses</a> <a id="4606" href="Tactic.Derive.html#4280" class="Bound">cs</a><a id="4608" class="Symbol">)</a>

  <a id="4613" href="Tactic.Derive.html#4613" class="Function">deriveMulti</a> <a id="4625" class="Symbol">:</a> <a id="4627" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4632" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4634" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4639" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4641" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4646" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4651" class="Symbol">→</a> <a id="4653" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="4656" class="Symbol">(</a><a id="4657" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4662" class="Symbol">(</a><a id="4663" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="4667" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4672" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4674" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="4679" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4681" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4686" href="Agda.Builtin.Reflection.html#4745" class="Datatype">Clause</a><a id="4692" class="Symbol">))</a>
  <a id="4697" href="Tactic.Derive.html#4613" class="Function">deriveMulti</a> <a id="4709" class="Symbol">(</a><a id="4710" href="Tactic.Derive.html#4710" class="Bound">dName</a> <a id="4716" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4718" href="Tactic.Derive.html#4718" class="Bound">iName</a> <a id="4724" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4726" href="Tactic.Derive.html#4726" class="Bound">hClasses</a><a id="4734" class="Symbol">)</a> <a id="4736" class="Symbol">=</a> <a id="4738" class="Keyword">do</a>
    <a id="4745" href="Tactic.Derive.html#4745" class="Bound">hClassNames</a> <a id="4757" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4759" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="4768" class="Symbol">⦃</a> <a id="4770" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="4783" class="Symbol">⦄</a>
      <a id="4791" class="Symbol">(λ</a> <a id="4794" href="Tactic.Derive.html#4794" class="Bound">cn</a> <a id="4797" class="Symbol">→</a> <a id="4799" href="Class.MonadTC.html#1818" class="Field">freshName</a> <a id="4809" class="Symbol">(</a><a id="4810" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4819" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="4829" href="Data.String.Base.html#2366" class="Function Operator">S.++</a> <a id="4834" class="String">&quot;-&quot;</a> <a id="4838" href="Data.String.Base.html#2366" class="Function Operator">S.++</a> <a id="4843" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4852" href="Tactic.Derive.html#4794" class="Bound">cn</a> <a id="4855" href="Data.String.Base.html#2366" class="Function Operator">S.++</a> <a id="4860" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4869" href="Tactic.Derive.html#4710" class="Bound">dName</a><a id="4874" class="Symbol">))</a> <a id="4877" href="Tactic.Derive.html#4726" class="Bound">hClasses</a>
    <a id="4890" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="4899" class="Symbol">⦃</a> <a id="4901" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="4914" class="Symbol">⦄</a> <a id="4916" class="Symbol">(</a><a id="4917" href="Tactic.Derive.html#3871" class="Function">deriveSingle</a> <a id="4930" class="Symbol">(</a><a id="4931" href="Data.List.Base.html#3570" class="Function">L.zip</a> <a id="4937" href="Tactic.Derive.html#4726" class="Bound">hClasses</a> <a id="4946" href="Tactic.Derive.html#4745" class="Bound">hClassNames</a><a id="4957" class="Symbol">)</a> <a id="4959" href="Tactic.Derive.html#4710" class="Bound">dName</a> <a id="4965" href="Tactic.Derive.html#4718" class="Bound">iName</a><a id="4970" class="Symbol">)</a> <a id="4972" class="Symbol">(</a><a id="4973" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4981" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4983" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="4989" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4994" href="Tactic.Derive.html#4726" class="Bound">hClasses</a><a id="5002" class="Symbol">)</a>

  <a id="5007" href="Tactic.Derive.html#5007" class="Function">derive-Class</a> <a id="5020" class="Symbol">:</a> <a id="5022" class="Symbol">⦃</a> <a id="5024" href="Tactic.Derive.html#5024" class="Symbol">_</a> <a id="5026" class="Symbol">:</a> <a id="5028" href="Reflection.Debug.html#2340" class="Record">DebugOptions</a> <a id="5041" class="Symbol">⦄</a> <a id="5043" class="Symbol">→</a> <a id="5045" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5050" class="Symbol">(</a><a id="5051" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="5056" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5058" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="5062" class="Symbol">)</a> <a id="5064" class="Symbol">→</a> <a id="5066" href="Generics.Core.html#2480" class="Function">UnquoteDecl</a>
  <a id="5080" href="Tactic.Derive.html#5007" class="Function">derive-Class</a> <a id="5093" href="Tactic.Derive.html#5093" class="Bound">l</a> <a id="5095" class="Symbol">=</a> <a id="5097" href="Tactic.Helpers.html#6014" class="Function">initUnquoteWithGoal</a> <a id="5117" class="Symbol">(</a><a id="5118" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="5128" href="Generics.Core.html#1819" class="InductiveConstructor Operator">∙</a><a id="5129" class="Symbol">)</a> <a id="5131" href="Function.Base.html#1919" class="Function Operator">$</a>
    <a id="5137" href="Class.MonadTC.html#3579" class="Function">declareAndDefineFuns</a> <a id="5158" href="Class.Monad.Core.html#424" class="Function Operator">=&lt;&lt;</a> <a id="5162" href="Data.List.Base.html#4394" class="Function">concat</a> <a id="5169" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="5173" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="5182" class="Symbol">⦃</a> <a id="5184" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="5197" class="Symbol">⦄</a> <a id="5199" href="Tactic.Derive.html#5224" class="Function">helper</a> <a id="5206" href="Tactic.Derive.html#5093" class="Bound">l</a>
    <a id="5212" class="Keyword">where</a>
      <a id="5224" href="Tactic.Derive.html#5224" class="Function">helper</a> <a id="5231" class="Symbol">:</a> <a id="5233" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="5238" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5240" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="5245" class="Symbol">→</a> <a id="5247" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="5250" class="Symbol">(</a><a id="5251" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5256" class="Symbol">(</a><a id="5257" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="5261" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="5266" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5268" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="5273" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5275" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5280" href="Agda.Builtin.Reflection.html#4745" class="Datatype">Clause</a><a id="5286" class="Symbol">))</a>
      <a id="5295" href="Tactic.Derive.html#5224" class="Function">helper</a> <a id="5302" class="Symbol">(</a><a id="5303" href="Tactic.Derive.html#5303" class="Bound">a</a> <a id="5305" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5307" href="Tactic.Derive.html#5307" class="Bound">b</a><a id="5308" class="Symbol">)</a> <a id="5310" class="Symbol">=</a> <a id="5312" class="Keyword">do</a> <a id="5315" href="Tactic.Derive.html#5315" class="Bound">hs</a> <a id="5318" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="5320" href="Tactic.Derive.html#3033" class="Function">genMutualHelpers</a> <a id="5337" href="Tactic.Derive.html#5303" class="Bound">a</a> <a id="5339" class="Symbol">;</a> <a id="5341" href="Tactic.Derive.html#4613" class="Function">deriveMulti</a> <a id="5353" class="Symbol">(</a><a id="5354" href="Tactic.Derive.html#5303" class="Bound">a</a> <a id="5356" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5358" href="Tactic.Derive.html#5307" class="Bound">b</a> <a id="5360" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5362" href="Tactic.Derive.html#5315" class="Bound">hs</a><a id="5364" class="Symbol">)</a>
</pre></body></html>