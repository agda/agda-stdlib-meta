<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactic/Derive.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Generic type class dervations. Works with mutually recursive types</a>
<a id="71" class="Comment">-- and can use mutual recursion to satisfy the termination</a>
<a id="130" class="Comment">-- checker. Writing an actual derivation strategy then does not</a>
<a id="194" class="Comment">-- require dealing with any mutual recursion, it is all handled here.</a>
<a id="264" class="Comment">--</a>
<a id="267" class="Comment">-- TODO: This breaks with:</a>
<a id="294" class="Comment">-- - mutual recursion that nests too deep (i.e. deeper than 1, e.g. Term)</a>
<a id="368" class="Comment">-- - indexed datatypes that require absurd clauses (e.g. Vec)</a>
<a id="430" class="Comment">--</a>
<a id="433" class="Comment">-- TODO: support type classes with more than one field</a>
<a id="488" class="Comment">--</a>
<a id="491" class="Comment">-- TODO: enable using existing code for instance when mutually recursing</a>
<a id="564" class="Comment">--</a>
<a id="567" class="Comment">-- TODO: Requires K to pass the termination checker. Maybe we can do without somehow.</a>

<a id="654" class="Symbol">{-#</a> <a id="658" class="Keyword">OPTIONS</a> <a id="666" class="Pragma">-v</a> <a id="669" class="Pragma">allTactics:100</a> <a id="684" class="Symbol">#-}</a>
<a id="688" class="Symbol">{-#</a> <a id="692" class="Keyword">OPTIONS</a> <a id="700" class="Pragma">--safe</a> <a id="707" class="Pragma">--without-K</a> <a id="719" class="Symbol">#-}</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Meta.html" class="Module">Meta</a>

<a id="741" class="Keyword">module</a> <a id="748" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="762" class="Symbol">(</a><a id="763" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="773" class="Symbol">:</a> <a id="775" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="779" class="Symbol">)</a> <a id="781" class="Symbol">(</a><a id="782" href="Tactic.Derive.html#782" class="Bound">projName</a> <a id="791" class="Symbol">:</a> <a id="793" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="797" class="Symbol">)</a> <a id="799" class="Keyword">where</a>

<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Prelude.html" class="Module">Prelude</a>

<a id="827" class="Keyword">open</a> <a id="832" class="Keyword">import</a> <a id="839" href="Reflection.Name.html" class="Module">Reflection.Name</a> <a id="855" class="Keyword">using</a> <a id="861" class="Symbol">()</a> <a id="864" class="Keyword">renaming</a> <a id="873" class="Symbol">(</a><a id="874" href="Reflection.Name.html#1412" class="Function Operator">_≟_</a> <a id="878" class="Symbol">to</a> <a id="881" class="Function Operator">_≟-Name_</a><a id="889" class="Symbol">)</a>
<a id="891" class="Keyword">open</a> <a id="896" class="Keyword">import</a> <a id="903" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">()</a> <a id="936" class="Keyword">renaming</a> <a id="945" class="Symbol">(</a><a id="946" href="Agda.Builtin.Reflection.html#604" class="Primitive">primShowQName</a> <a id="960" class="Symbol">to</a> <a id="963" class="Primitive">showName</a><a id="971" class="Symbol">)</a>

<a id="974" class="Keyword">open</a> <a id="979" class="Keyword">import</a> <a id="986" href="Generics.html" class="Module">Generics</a>

<a id="996" class="Keyword">open</a> <a id="1001" class="Keyword">import</a> <a id="1008" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1019" class="Keyword">using</a> <a id="1025" class="Symbol">(</a><a id="1026" href="Data.Maybe.Base.html#1641" class="Function">fromMaybe</a><a id="1035" class="Symbol">)</a>
<a id="1037" class="Keyword">import</a> <a id="1044" href="Data.List.html" class="Module">Data.List</a> <a id="1054" class="Symbol">as</a> <a id="1057" class="Module">L</a>
<a id="1059" class="Keyword">import</a> <a id="1066" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="1085" class="Symbol">as</a> <a id="1088" class="Module">NE</a>
<a id="1091" class="Keyword">import</a> <a id="1098" href="Data.String.html" class="Module">Data.String</a> <a id="1110" class="Symbol">as</a> <a id="1113" class="Module">S</a>

<a id="1116" class="Keyword">open</a> <a id="1121" class="Keyword">import</a> <a id="1128" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="1156" class="Keyword">open</a> <a id="1161" class="Keyword">import</a> <a id="1168" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="1189" class="Keyword">open</a> <a id="1194" class="Keyword">import</a> <a id="1201" href="Tactic.Helpers.html" class="Module">Tactic.Helpers</a>

<a id="1217" class="Keyword">open</a> <a id="1222" class="Keyword">import</a> <a id="1229" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="1241" class="Keyword">open</a> <a id="1246" class="Keyword">import</a> <a id="1253" href="Class.Traversable.html" class="Module">Class.Traversable</a>
<a id="1271" class="Keyword">open</a> <a id="1276" class="Keyword">import</a> <a id="1283" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="1297" class="Keyword">open</a> <a id="1302" class="Keyword">import</a> <a id="1309" href="Class.MonadReader.Instances.html" class="Module">Class.MonadReader.Instances</a>
<a id="1337" class="Keyword">open</a> <a id="1342" class="Keyword">import</a> <a id="1349" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>

<a id="1374" class="Keyword">instance</a>
  <a id="1385" href="Tactic.Derive.html#1385" class="Function">_</a> <a id="1387" class="Symbol">=</a> <a id="1389" href="Tactic.ClauseBuilder.html#10738" class="Function">ContextMonad-MonadTC</a>
  <a id="1412" href="Tactic.Derive.html#1412" class="Function">_</a> <a id="1414" class="Symbol">=</a> <a id="1416" href="Class.Monad.Core.html#655" class="Function">Functor-M</a>

<a id="1427" class="Keyword">open</a> <a id="1432" href="Tactic.ClauseBuilder.html#10968" class="Module">ClauseExprM</a>

<a id="genClassType"></a><a id="1445" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="1458" class="Symbol">:</a> <a id="1460" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1462" class="Symbol">→</a> <a id="1464" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1469" class="Symbol">→</a> <a id="1471" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1477" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1482" class="Symbol">→</a> <a id="1484" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1487" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
<a id="1492" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="1505" href="Tactic.Derive.html#1505" class="Bound">arity</a> <a id="1511" href="Tactic.Derive.html#1511" class="Bound">dName</a> <a id="1517" href="Tactic.Derive.html#1517" class="Bound">wName</a> <a id="1523" class="Symbol">=</a> <a id="1525" class="Keyword">do</a>
  <a id="1530" href="Tactic.Derive.html#1530" class="Bound">params</a> <a id="1537" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1539" href="Tactic.Helpers.html#4415" class="Function">getParamsAndIndices</a> <a id="1559" href="Tactic.Derive.html#1511" class="Bound">dName</a>
  <a id="1567" href="Tactic.Derive.html#1567" class="Bound">adjParams</a> <a id="1577" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1579" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1592" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1594" href="Data.List.Base.html#7316" class="Function">take</a> <a id="1599" class="Symbol">(</a><a id="1600" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1607" href="Tactic.Derive.html#1530" class="Bound">params</a> <a id="1614" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="1616" href="Tactic.Derive.html#1505" class="Bound">arity</a><a id="1621" class="Symbol">)</a> <a id="1623" href="Tactic.Derive.html#1530" class="Bound">params</a>
  <a id="1632" href="Class.MonadTC.html#8788" class="Function">debugLog1</a> <a id="1642" class="String">&quot;AdjustedParams: &quot;</a>
  <a id="1663" href="Tactic.Helpers.html#1261" class="Function">logTelescope</a> <a id="1676" class="Symbol">(</a><a id="1677" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1683" class="Symbol">((λ</a> <a id="1687" class="Keyword">where</a> <a id="1693" class="Symbol">(</a><a id="1694" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1698" href="Tactic.Derive.html#1698" class="Bound">s</a> <a id="1700" href="Tactic.Derive.html#1700" class="Bound">x</a><a id="1701" class="Symbol">)</a> <a id="1703" class="Symbol">→</a> <a id="1705" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1710" href="Tactic.Derive.html#1698" class="Bound">s</a> <a id="1712" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1714" href="Tactic.Derive.html#1700" class="Bound">x</a><a id="1715" class="Symbol">)</a> <a id="1717" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1719" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a><a id="1724" class="Symbol">)</a> <a id="1726" href="Tactic.Derive.html#1567" class="Bound">adjParams</a><a id="1735" class="Symbol">)</a>
  <a id="1739" href="Tactic.Derive.html#1739" class="Bound">ty</a> <a id="1742" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1744" href="Tactic.Helpers.html#5826" class="Function">applyWithVisibility</a> <a id="1764" href="Tactic.Derive.html#1511" class="Bound">dName</a> <a id="1770" class="Symbol">(</a><a id="1771" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1777" href="Generics.Core.html#372" class="InductiveConstructor">♯</a> <a id="1779" class="Symbol">(</a><a id="1780" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="1792" href="Tactic.Derive.html#1567" class="Bound">adjParams</a><a id="1801" class="Symbol">))</a>
  <a id="1806" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1813" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1815" href="Tactic.Derive.html#2543" class="Function">modifyClassType</a> <a id="1831" href="Tactic.Derive.html#1517" class="Bound">wName</a> <a id="1837" class="Symbol">(</a><a id="1838" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="1844" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="1850" href="Tactic.Derive.html#1567" class="Bound">adjParams</a> <a id="1860" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1862" href="Tactic.Derive.html#1739" class="Bound">ty</a><a id="1864" class="Symbol">)</a>
  <a id="1868" class="Keyword">where</a>
    <a id="1878" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1891" class="Symbol">:</a> <a id="1893" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1898" class="Symbol">(</a><a id="1899" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1903" class="Symbol">(</a><a id="1904" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1908" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="1912" class="Symbol">))</a> <a id="1915" class="Symbol">→</a> <a id="1917" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1926" class="Symbol">((</a><a id="1928" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1932" class="Symbol">(</a><a id="1933" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1937" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="1941" class="Symbol">))</a> <a id="1944" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1946" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a><a id="1950" class="Symbol">))</a>
    <a id="1957" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="1970" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1973" class="Symbol">=</a> <a id="1975" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="1982" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
    <a id="1989" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="2002" class="Symbol">(</a><a id="2003" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2007" href="Tactic.Derive.html#2007" class="Bound">x</a> <a id="2009" class="Symbol">(</a><a id="2010" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2014" class="Symbol">_</a> <a id="2016" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2017" class="Symbol">)</a> <a id="2019" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2021" href="Tactic.Derive.html#2021" class="Bound">l</a><a id="2022" class="Symbol">)</a> <a id="2024" class="Symbol">=</a> <a id="2026" class="Keyword">do</a>
      <a id="2035" href="Tactic.Derive.html#2035" class="Bound">a</a> <a id="2037" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2039" class="Symbol">(</a><a id="2040" href="Data.Bool.Base.html#1292" class="Function Operator">if_then</a> <a id="2048" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2050" class="Symbol">(</a><a id="2051" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2055" class="String">&quot;_&quot;</a> <a id="2059" class="Symbol">(</a><a id="2060" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="2065" class="Symbol">(</a><a id="2066" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2076" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2079" href="Generics.Core.html#372" class="InductiveConstructor">♯</a> <a id="2081" class="Number">0</a> <a id="2083" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2084" class="Symbol">))</a> <a id="2087" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2089" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="2094" class="Symbol">)</a> <a id="2096" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="2098" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2103" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2105" class="Symbol">)</a> <a id="2107" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="2111" href="Tactic.Helpers.html#5003" class="Function">isNArySort</a> <a id="2122" href="Tactic.Derive.html#1505" class="Bound">arity</a> <a id="2128" href="Tactic.Derive.html#2016" class="Bound">t</a>
      <a id="2136" href="Tactic.Derive.html#2136" class="Bound">ps</a> <a id="2139" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="2141" href="Class.MonadTC.html#7874" class="Function">extendContext</a> <a id="2155" class="Symbol">(</a><a id="2156" href="Tactic.Derive.html#2007" class="Bound">x</a> <a id="2158" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2160" href="Reflection.Argument.html#1280" class="InductiveConstructor">hArg</a> <a id="2165" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2166" class="Symbol">)</a> <a id="2168" class="Symbol">(</a><a id="2169" href="Tactic.Derive.html#1878" class="Function">adjustParams</a> <a id="2182" href="Tactic.Derive.html#2021" class="Bound">l</a><a id="2183" class="Symbol">)</a>
      <a id="2191" class="Keyword">let</a> <a id="2195" href="Tactic.Derive.html#2195" class="Bound">ps&#39;</a> <a id="2199" class="Symbol">=</a> <a id="2201" href="Function.Base.html#1563" class="Function">flip</a> <a id="2206" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="2212" href="Tactic.Derive.html#2136" class="Bound">ps</a> <a id="2215" class="Symbol">λ</a> <a id="2217" class="Keyword">where</a>
        <a id="2231" class="Symbol">(</a><a id="2232" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2236" href="Tactic.Derive.html#2236" class="Bound">s</a> <a id="2238" class="Symbol">(</a><a id="2239" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2243" href="Tactic.Derive.html#2243" class="Bound">i</a> <a id="2245" href="Tactic.Derive.html#2245" class="Bound">t</a><a id="2246" class="Symbol">)</a> <a id="2248" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2250" href="Tactic.Derive.html#2250" class="Bound">b</a><a id="2251" class="Symbol">)</a> <a id="2253" class="Symbol">→</a> <a id="2255" class="Symbol">(</a><a id="2256" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2260" href="Tactic.Derive.html#2236" class="Bound">s</a> <a id="2262" class="Symbol">(</a><a id="2263" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2267" href="Tactic.Derive.html#2243" class="Bound">i</a> <a id="2269" class="Symbol">(</a><a id="2270" href="Generics.Utils.html#5684" class="Function">mapVars</a> <a id="2278" class="Symbol">(</a><a id="2279" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+</a> <a id="2282" class="Symbol">(</a><a id="2283" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2286" href="Tactic.Derive.html#2250" class="Bound">b</a> <a id="2288" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="2293" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2300" href="Tactic.Derive.html#2035" class="Bound">a</a> <a id="2302" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2307" class="Number">0</a><a id="2308" class="Symbol">))</a> <a id="2311" href="Tactic.Derive.html#2245" class="Bound">t</a><a id="2312" class="Symbol">))</a> <a id="2315" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2317" href="Tactic.Derive.html#2250" class="Bound">b</a><a id="2318" class="Symbol">)</a>
      <a id="2326" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="2333" class="Symbol">(((</a><a id="2336" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="2340" href="Tactic.Derive.html#2007" class="Bound">x</a> <a id="2342" class="Symbol">(</a><a id="2343" href="Reflection.Argument.html#1280" class="InductiveConstructor">hArg</a> <a id="2348" href="Tactic.Derive.html#2016" class="Bound">t</a><a id="2349" class="Symbol">)</a> <a id="2351" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2353" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="2357" class="Symbol">)</a> <a id="2359" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2361" href="Tactic.Derive.html#2035" class="Bound">a</a><a id="2362" class="Symbol">)</a> <a id="2364" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2367" href="Tactic.Derive.html#2195" class="Bound">ps&#39;</a><a id="2370" class="Symbol">)</a>

    <a id="2377" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2389" class="Symbol">:</a> <a id="2391" class="Symbol">{</a><a id="2392" href="Tactic.Derive.html#2392" class="Bound">A</a> <a id="2394" class="Symbol">:</a> <a id="2396" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="2399" class="Symbol">}</a> <a id="2401" class="Symbol">→</a> <a id="2403" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2408" class="Symbol">(</a><a id="2409" href="Tactic.Derive.html#2392" class="Bound">A</a> <a id="2411" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2413" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a><a id="2417" class="Symbol">)</a> <a id="2419" class="Symbol">→</a> <a id="2421" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2426" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
    <a id="2432" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2444" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2447" class="Symbol">=</a> <a id="2449" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
    <a id="2456" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2468" class="Symbol">(</a><a id="2469" href="Tactic.Derive.html#2469" class="Bound">x</a> <a id="2471" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2473" href="Tactic.Derive.html#2473" class="Bound">l</a><a id="2474" class="Symbol">)</a> <a id="2476" class="Symbol">=</a> <a id="2478" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2481" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="2487" href="Tactic.Derive.html#2469" class="Bound">x</a> <a id="2489" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="2494" href="Data.List.Base.html#4873" class="Function">length</a> <a id="2501" href="Tactic.Derive.html#2473" class="Bound">l</a> <a id="2503" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2505" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2517" href="Tactic.Derive.html#2473" class="Bound">l</a> <a id="2519" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="2524" href="Tactic.Derive.html#2377" class="Function">trueIndices</a> <a id="2536" href="Tactic.Derive.html#2473" class="Bound">l</a>

    <a id="2543" href="Tactic.Derive.html#2543" class="Function">modifyClassType</a> <a id="2559" class="Symbol">:</a> <a id="2561" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2567" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2572" class="Symbol">→</a> <a id="2574" href="Generics.Utils.html#2505" class="Function">TypeView</a> <a id="2583" class="Symbol">→</a> <a id="2585" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
    <a id="2594" href="Tactic.Derive.html#2543" class="Function">modifyClassType</a> <a id="2610" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>  <a id="2619" class="Symbol">(</a><a id="2620" href="Tactic.Derive.html#2620" class="Bound">tel</a> <a id="2624" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2626" href="Tactic.Derive.html#2626" class="Bound">ty</a><a id="2628" class="Symbol">)</a> <a id="2630" class="Symbol">=</a> <a id="2632" href="Generics.Utils.html#2662" class="Function">tyView</a> <a id="2639" class="Symbol">(</a><a id="2640" href="Tactic.Derive.html#2620" class="Bound">tel</a> <a id="2644" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2646" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2656" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2659" href="Tactic.Derive.html#2626" class="Bound">ty</a> <a id="2662" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2663" class="Symbol">)</a>
    <a id="2669" href="Tactic.Derive.html#2543" class="Function">modifyClassType</a> <a id="2685" class="Symbol">(</a><a id="2686" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2691" href="Tactic.Derive.html#2691" class="Bound">n</a><a id="2692" class="Symbol">)</a> <a id="2694" class="Symbol">(</a><a id="2695" href="Tactic.Derive.html#2695" class="Bound">tel</a> <a id="2699" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2701" href="Tactic.Derive.html#2701" class="Bound">ty</a><a id="2703" class="Symbol">)</a> <a id="2705" class="Symbol">=</a> <a id="2707" href="Generics.Utils.html#2662" class="Function">tyView</a> <a id="2714" class="Symbol">(</a><a id="2715" href="Tactic.Derive.html#2695" class="Bound">tel</a> <a id="2719" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2721" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2731" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2734" href="Tactic.Derive.html#2691" class="Bound">n</a> <a id="2736" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2739" href="Tactic.Derive.html#2701" class="Bound">ty</a> <a id="2742" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a> <a id="2744" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2745" class="Symbol">)</a>

<a id="lookupName"></a><a id="2748" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="2759" class="Symbol">:</a> <a id="2761" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2766" class="Symbol">(</a><a id="2767" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2772" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2774" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="2778" class="Symbol">)</a> <a id="2780" class="Symbol">→</a> <a id="2782" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2787" class="Symbol">→</a> <a id="2789" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2795" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
<a id="2800" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="2811" class="Symbol">=</a> <a id="2813" href="Prelude.html#900" class="Function">lookupᵇ</a> <a id="2821" class="Symbol">(λ</a> <a id="2824" href="Tactic.Derive.html#2824" class="Bound">n</a> <a id="2826" href="Tactic.Derive.html#2826" class="Bound">n&#39;</a> <a id="2829" class="Symbol">→</a> <a id="2831" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="2833" href="Tactic.Derive.html#2824" class="Bound">n</a> <a id="2835" href="Tactic.Derive.html#881" class="Function Operator">≟-Name</a> <a id="2842" href="Tactic.Derive.html#2826" class="Bound">n&#39;</a> <a id="2845" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a><a id="2846" class="Symbol">)</a>

<a id="2849" class="Comment">-- Look at the constructors of the argument and return all types that</a>
<a id="2919" class="Comment">-- recursively contain it. This isn&#39;t very clever right now.</a>
<a id="genMutualHelpers"></a><a id="2980" href="Tactic.Derive.html#2980" class="Function">genMutualHelpers</a> <a id="2997" class="Symbol">:</a> <a id="2999" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3004" class="Symbol">→</a> <a id="3006" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3009" class="Symbol">(</a><a id="3010" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3015" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="3019" class="Symbol">)</a>
<a id="3021" href="Tactic.Derive.html#2980" class="Function">genMutualHelpers</a> <a id="3038" href="Tactic.Derive.html#3038" class="Bound">n</a> <a id="3040" class="Symbol">=</a> <a id="3042" class="Keyword">do</a>
  <a id="3047" href="Tactic.Derive.html#3047" class="Bound">tys</a> <a id="3051" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="3053" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="3059" class="Symbol">(</a><a id="3060" href="Reflection.Argument.html#2530" class="Function">unArg</a> <a id="3066" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3068" href="Reflection.Abstraction.html#1738" class="Function">unAbs</a><a id="3073" class="Symbol">)</a> <a id="3075" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3079" class="Symbol">(</a><a id="3080" href="Data.List.Base.html#4459" class="Function">L.concatMap</a> <a id="3092" class="Symbol">(</a><a id="3093" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="3099" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3101" href="Generics.Utils.html#2546" class="Function">viewTy</a> <a id="3108" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3110" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="3115" class="Symbol">)</a> <a id="3117" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="3121" href="Class.MonadTC.html#9588" class="Function">getConstrs</a> <a id="3132" href="Tactic.Derive.html#3038" class="Bound">n</a><a id="3133" class="Symbol">)</a>
  <a id="3137" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="3144" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3146" href="Data.List.Base.html#9026" class="Function">deduplicate</a> <a id="3158" href="Tactic.Derive.html#881" class="Function Operator">_≟-Name_</a> <a id="3167" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3169" href="Data.List.Base.html#1638" class="Function">L.mapMaybe</a> <a id="3180" href="Tactic.Derive.html#3203" class="Function">helper</a> <a id="3187" href="Tactic.Derive.html#3047" class="Bound">tys</a>
  <a id="3193" class="Keyword">where</a>
    <a id="3203" href="Tactic.Derive.html#3203" class="Function">helper</a> <a id="3210" class="Symbol">:</a> <a id="3212" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="3217" class="Symbol">→</a> <a id="3219" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3225" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
    <a id="3234" href="Tactic.Derive.html#3203" class="Function">helper</a> <a id="3241" class="Symbol">(</a><a id="3242" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="3246" href="Tactic.Derive.html#3246" class="Bound">n&#39;</a> <a id="3249" href="Tactic.Derive.html#3249" class="Bound">args</a><a id="3253" class="Symbol">)</a> <a id="3255" class="Symbol">=</a>
      <a id="3263" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="3266" href="Data.List.Base.html#4686" class="Function">L.any</a> <a id="3272" class="Symbol">(λ</a> <a id="3275" class="Keyword">where</a> <a id="3281" class="Symbol">(</a><a id="3282" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="3286" class="Symbol">_</a> <a id="3288" class="Symbol">(</a><a id="3289" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="3293" href="Tactic.Derive.html#3293" class="Bound">n&#39;&#39;</a> <a id="3297" class="Symbol">_))</a> <a id="3301" class="Symbol">→</a> <a id="3303" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="3305" href="Tactic.Derive.html#3038" class="Bound">n</a> <a id="3307" href="Tactic.Derive.html#881" class="Function Operator">≟-Name</a> <a id="3314" href="Tactic.Derive.html#3293" class="Bound">n&#39;&#39;</a> <a id="3318" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a> <a id="3320" class="Symbol">;</a> <a id="3322" class="CatchallClause Symbol">_</a> <a id="3324" class="Symbol">→</a> <a id="3326" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="3331" class="Symbol">)</a> <a id="3333" href="Tactic.Derive.html#3249" class="Bound">args</a>
      <a id="3344" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="3349" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3354" href="Tactic.Derive.html#3246" class="Bound">n&#39;</a> <a id="3357" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="3362" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
    <a id="3374" href="Tactic.Derive.html#3203" class="CatchallClause Function">helper</a><a id="3380" class="CatchallClause"> </a><a id="3381" class="CatchallClause Symbol">_</a> <a id="3383" class="Symbol">=</a> <a id="3385" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

<a id="3394" class="Keyword">module</a> <a id="3401" href="Tactic.Derive.html#3401" class="Module">_</a> <a id="3403" class="Symbol">(</a><a id="3404" href="Tactic.Derive.html#3404" class="Bound">arity</a> <a id="3410" class="Symbol">:</a> <a id="3412" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="3413" class="Symbol">)</a> <a id="3415" class="Symbol">(</a><a id="3416" href="Tactic.Derive.html#3416" class="Bound">genCe</a> <a id="3422" class="Symbol">:</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3430" class="Symbol">→</a> <a id="3432" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3438" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="3442" class="Symbol">)</a> <a id="3444" class="Symbol">→</a> <a id="3446" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3451" href="Tactic.ClauseBuilder.html#1301" class="Function">SinglePattern</a> <a id="3465" class="Symbol">→</a> <a id="3467" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3472" class="Symbol">(</a><a id="3473" href="Data.List.NonEmpty.Base.html#1088" class="Record">NE.List⁺</a> <a id="3482" href="Tactic.ClauseBuilder.html#1301" class="Function">SinglePattern</a> <a id="3496" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3498" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3501" class="Symbol">(</a><a id="3502" href="Tactic.ClauseBuilder.html#5823" class="Datatype">ClauseExpr</a> <a id="3513" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="3515" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3521" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="3525" class="Symbol">)))</a> <a id="3529" class="Keyword">where</a>
  <a id="3537" class="Comment">-- Generate the declaration &amp; definition of a particular derivation.</a>
  <a id="3608" class="Comment">--</a>
  <a id="3613" class="Comment">-- Takes a dictionary (for mutual recursion), a wrapper (also for</a>
  <a id="3681" class="Comment">-- mutual recursion), the name of the original type we want to derive</a>
  <a id="3753" class="Comment">-- Show for and the name we want to define Show originally at.</a>
  <a id="3818" href="Tactic.Derive.html#3818" class="Function">deriveSingle</a> <a id="3831" class="Symbol">:</a> <a id="3833" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3838" class="Symbol">(</a><a id="3839" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3844" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3846" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="3850" class="Symbol">)</a> <a id="3852" class="Symbol">→</a> <a id="3854" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3859" class="Symbol">→</a> <a id="3861" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3866" class="Symbol">→</a> <a id="3868" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3874" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3879" class="Symbol">→</a> <a id="3881" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="3884" class="Symbol">(</a><a id="3885" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="3889" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3894" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3896" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="3901" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3903" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3908" href="Agda.Builtin.Reflection.html#4727" class="Datatype">Clause</a><a id="3914" class="Symbol">)</a>
  <a id="3918" href="Tactic.Derive.html#3818" class="Function">deriveSingle</a> <a id="3931" href="Tactic.Derive.html#3931" class="Bound">transName</a> <a id="3941" href="Tactic.Derive.html#3941" class="Bound">dName</a> <a id="3947" href="Tactic.Derive.html#3947" class="Bound">iName</a> <a id="3953" href="Tactic.Derive.html#3953" class="Bound">wName</a> <a id="3959" class="Symbol">=</a> <a id="3961" href="Tactic.Helpers.html#2625" class="Function">inDebugPath</a> <a id="3973" class="String">&quot;DeriveSingle&quot;</a> <a id="3988" class="Keyword">do</a>
    <a id="3995" href="Class.MonadTC.html#5721" class="Function">debugLog</a> <a id="4004" class="Symbol">(</a><a id="4005" class="String">&quot;For: &quot;</a> <a id="4013" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="4016" href="Tactic.Derive.html#3941" class="Bound">dName</a> <a id="4022" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="4025" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4027" class="Symbol">)</a>
    <a id="4033" href="Tactic.Derive.html#4033" class="Bound">goalTy</a> <a id="4040" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4042" href="Tactic.Derive.html#1445" class="Function">genClassType</a> <a id="4055" href="Tactic.Derive.html#3404" class="Bound">arity</a> <a id="4061" href="Tactic.Derive.html#3941" class="Bound">dName</a> <a id="4067" href="Tactic.Derive.html#3953" class="Bound">wName</a>
    <a id="4077" href="Tactic.Derive.html#4077" class="Bound">ps</a> <a id="4080" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4082" href="Tactic.ClauseBuilder.html#5325" class="Function">constructorPatterns&#39;</a> <a id="4103" class="Symbol">(</a><a id="4104" href="Data.Maybe.Base.html#1641" class="Function">fromMaybe</a> <a id="4114" href="Tactic.Derive.html#3941" class="Bound">dName</a> <a id="4120" href="Tactic.Derive.html#3953" class="Bound">wName</a> <a id="4126" href="Generics.Core.html#1819" class="InductiveConstructor Operator">∙</a><a id="4127" class="Symbol">)</a>
    <a id="4133" class="Comment">-- TODO: find a good way of printing this</a>
    <a id="4179" class="Comment">--debugLogᵐ (&quot;Constrs: &quot; ∷ᵈᵐ ps ᵛⁿ ∷ᵈᵐ []ᵐ)</a>
    <a id="4227" href="Tactic.Derive.html#4227" class="Bound">cs</a> <a id="4230" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4232" href="Class.MonadReader.html#335" class="Field">local</a> <a id="4238" class="Symbol">(λ</a> <a id="4241" href="Tactic.Derive.html#4241" class="Bound">c</a> <a id="4243" class="Symbol">→</a> <a id="4245" class="Keyword">record</a> <a id="4252" href="Tactic.Derive.html#4241" class="Bound">c</a> <a id="4254" class="Symbol">{</a> <a id="4256" href="Class.MonadTC.html#1027" class="Field">goal</a> <a id="4261" class="Symbol">=</a> <a id="4263" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="4268" href="Tactic.Derive.html#4033" class="Bound">goalTy</a> <a id="4275" class="Symbol">})</a> <a id="4278" href="Function.Base.html#1928" class="Function Operator">$</a>
      <a id="4286" href="Tactic.ClauseBuilder.html#11860" class="Function">singleMatchExpr</a> <a id="4302" class="Symbol">(</a><a id="4303" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="4306" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4308" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4313" class="Symbol">(</a><a id="4314" href="Agda.Builtin.Reflection.html#5654" class="InductiveConstructor">Pattern.proj</a> <a id="4327" href="Tactic.Derive.html#782" class="Bound">projName</a><a id="4335" class="Symbol">))</a> <a id="4338" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4340" href="Tactic.ClauseBuilder.html#12817" class="Function">contMatch</a> <a id="4350" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4352" href="Tactic.ClauseBuilder.html#11325" class="Function">multiMatchExprM</a> <a id="4368" href="Function.Base.html#1928" class="Function Operator">$</a>
        <a id="4378" href="Tactic.Derive.html#3416" class="Bound">genCe</a> <a id="4384" class="Symbol">(</a><a id="4385" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="4396" href="Tactic.Derive.html#3931" class="Bound">transName</a><a id="4405" class="Symbol">)</a> <a id="4407" href="Tactic.Derive.html#4077" class="Bound">ps</a>
    <a id="4414" class="Keyword">let</a> <a id="4418" href="Tactic.Derive.html#4418" class="Bound">defName</a> <a id="4426" class="Symbol">=</a> <a id="4428" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="4434" class="Symbol">(</a><a id="4435" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="4441" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="4446" class="Symbol">(</a><a id="4447" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4452" href="Tactic.Derive.html#3947" class="Bound">iName</a><a id="4457" class="Symbol">)</a> <a id="4459" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4461" href="Tactic.Derive.html#2748" class="Function">lookupName</a> <a id="4472" href="Tactic.Derive.html#3931" class="Bound">transName</a><a id="4481" class="Symbol">)</a> <a id="4483" class="Symbol">(</a><a id="4484" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="4489" href="Tactic.Derive.html#3947" class="Bound">iName</a><a id="4494" class="Symbol">)</a> <a id="4496" href="Tactic.Derive.html#3953" class="Bound">wName</a>
    <a id="4506" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="4513" class="Symbol">(</a><a id="4514" href="Tactic.Derive.html#4418" class="Bound">defName</a> <a id="4522" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4524" href="Tactic.Derive.html#4033" class="Bound">goalTy</a> <a id="4531" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4533" href="Tactic.ClauseBuilder.html#7442" class="Function">clauseExprToClauses</a> <a id="4553" href="Tactic.Derive.html#4227" class="Bound">cs</a><a id="4555" class="Symbol">)</a>

  <a id="4560" href="Tactic.Derive.html#4560" class="Function">deriveMulti</a> <a id="4572" class="Symbol">:</a> <a id="4574" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4579" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4581" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4586" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4588" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4593" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4598" class="Symbol">→</a> <a id="4600" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="4603" class="Symbol">(</a><a id="4604" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4609" class="Symbol">(</a><a id="4610" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="4614" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4619" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4621" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="4626" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4628" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4633" href="Agda.Builtin.Reflection.html#4727" class="Datatype">Clause</a><a id="4639" class="Symbol">))</a>
  <a id="4644" href="Tactic.Derive.html#4560" class="Function">deriveMulti</a> <a id="4656" class="Symbol">(</a><a id="4657" href="Tactic.Derive.html#4657" class="Bound">dName</a> <a id="4663" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4665" href="Tactic.Derive.html#4665" class="Bound">iName</a> <a id="4671" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4673" href="Tactic.Derive.html#4673" class="Bound">hClasses</a><a id="4681" class="Symbol">)</a> <a id="4683" class="Symbol">=</a> <a id="4685" class="Keyword">do</a>
    <a id="4692" href="Tactic.Derive.html#4692" class="Bound">hClassNames</a> <a id="4704" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="4706" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="4715" class="Symbol">⦃</a> <a id="4717" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="4730" class="Symbol">⦄</a>
      <a id="4738" class="Symbol">(λ</a> <a id="4741" href="Tactic.Derive.html#4741" class="Bound">cn</a> <a id="4744" class="Symbol">→</a> <a id="4746" href="Class.MonadTC.html#2025" class="Field">freshName</a> <a id="4756" class="Symbol">(</a><a id="4757" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4766" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="4776" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4781" class="String">&quot;-&quot;</a> <a id="4785" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4790" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4799" href="Tactic.Derive.html#4741" class="Bound">cn</a> <a id="4802" href="Data.String.Base.html#2375" class="Function Operator">S.++</a> <a id="4807" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4816" href="Tactic.Derive.html#4657" class="Bound">dName</a><a id="4821" class="Symbol">))</a> <a id="4824" href="Tactic.Derive.html#4673" class="Bound">hClasses</a>
    <a id="4837" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="4846" class="Symbol">⦃</a> <a id="4848" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="4861" class="Symbol">⦄</a> <a id="4863" class="Symbol">(</a><a id="4864" href="Tactic.Derive.html#3818" class="Function">deriveSingle</a> <a id="4877" class="Symbol">(</a><a id="4878" href="Data.List.Base.html#3579" class="Function">L.zip</a> <a id="4884" href="Tactic.Derive.html#4673" class="Bound">hClasses</a> <a id="4893" href="Tactic.Derive.html#4692" class="Bound">hClassNames</a><a id="4904" class="Symbol">)</a> <a id="4906" href="Tactic.Derive.html#4657" class="Bound">dName</a> <a id="4912" href="Tactic.Derive.html#4665" class="Bound">iName</a><a id="4917" class="Symbol">)</a> <a id="4919" class="Symbol">(</a><a id="4920" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="4928" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4930" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="4936" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4941" href="Tactic.Derive.html#4673" class="Bound">hClasses</a><a id="4949" class="Symbol">)</a>

  <a id="4954" href="Tactic.Derive.html#4954" class="Function">derive-Class</a> <a id="4967" class="Symbol">:</a> <a id="4969" class="Symbol">⦃</a> <a id="4971" href="Class.MonadTC.html#621" class="Record">TCOptions</a> <a id="4981" class="Symbol">⦄</a> <a id="4983" class="Symbol">→</a> <a id="4985" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4990" class="Symbol">(</a><a id="4991" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4996" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4998" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="5002" class="Symbol">)</a> <a id="5004" class="Symbol">→</a> <a id="5006" href="Generics.Core.html#2480" class="Function">UnquoteDecl</a>
  <a id="5020" href="Tactic.Derive.html#4954" class="Function">derive-Class</a> <a id="5033" href="Tactic.Derive.html#5033" class="Bound">l</a> <a id="5035" class="Symbol">=</a> <a id="5037" href="Tactic.Helpers.html#6387" class="Function">initUnquoteWithGoal</a> <a id="5057" class="Symbol">(</a><a id="5058" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="5068" href="Generics.Core.html#1819" class="InductiveConstructor Operator">∙</a><a id="5069" class="Symbol">)</a> <a id="5071" href="Function.Base.html#1928" class="Function Operator">$</a>
    <a id="5077" href="Class.MonadTC.html#3786" class="Function">declareAndDefineFuns</a> <a id="5098" href="Class.Monad.Core.html#424" class="Function Operator">=&lt;&lt;</a> <a id="5102" href="Data.List.Base.html#4403" class="Function">concat</a> <a id="5109" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="5113" href="Class.Traversable.Core.html#456" class="Function">traverse</a> <a id="5122" class="Symbol">⦃</a> <a id="5124" href="Class.Functor.Instances.html#964" class="Function">Functor-List</a> <a id="5137" class="Symbol">⦄</a> <a id="5139" href="Tactic.Derive.html#5164" class="Function">helper</a> <a id="5146" href="Tactic.Derive.html#5033" class="Bound">l</a>
    <a id="5152" class="Keyword">where</a>
      <a id="5164" href="Tactic.Derive.html#5164" class="Function">helper</a> <a id="5171" class="Symbol">:</a> <a id="5173" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5178" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5180" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5185" class="Symbol">→</a> <a id="5187" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="5190" class="Symbol">(</a><a id="5191" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5196" class="Symbol">(</a><a id="5197" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="5201" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5206" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5208" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="5213" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5215" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5220" href="Agda.Builtin.Reflection.html#4727" class="Datatype">Clause</a><a id="5226" class="Symbol">))</a>
      <a id="5235" href="Tactic.Derive.html#5164" class="Function">helper</a> <a id="5242" class="Symbol">(</a><a id="5243" href="Tactic.Derive.html#5243" class="Bound">a</a> <a id="5245" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5247" href="Tactic.Derive.html#5247" class="Bound">b</a><a id="5248" class="Symbol">)</a> <a id="5250" class="Symbol">=</a> <a id="5252" class="Keyword">do</a> <a id="5255" href="Tactic.Derive.html#5255" class="Bound">hs</a> <a id="5258" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="5260" href="Tactic.Derive.html#2980" class="Function">genMutualHelpers</a> <a id="5277" href="Tactic.Derive.html#5243" class="Bound">a</a> <a id="5279" class="Symbol">;</a> <a id="5281" href="Tactic.Derive.html#4560" class="Function">deriveMulti</a> <a id="5293" class="Symbol">(</a><a id="5294" href="Tactic.Derive.html#5243" class="Bound">a</a> <a id="5296" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5298" href="Tactic.Derive.html#5247" class="Bound">b</a> <a id="5300" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5302" href="Tactic.Derive.html#5255" class="Bound">hs</a><a id="5304" class="Symbol">)</a>
</pre></body></html>