<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/tactics-and-deriving/Tactic/Derive.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">-- Generic type class dervations. Works with mutually recursive types</a>
<a id="71" class="Comment">-- and can use mutual recursion to satisfy the termination</a>
<a id="130" class="Comment">-- checker. Writing an actual derivation strategy then does not</a>
<a id="194" class="Comment">-- require dealing with any mutual recursion, it is all handled here.</a>
<a id="264" class="Comment">--</a>
<a id="267" class="Comment">-- TODO: This breaks with:</a>
<a id="294" class="Comment">-- - mutual recursion that nests too deep (i.e. deeper than 1, e.g. Term)</a>
<a id="368" class="Comment">-- - indexed datatypes that require absurd clauses (e.g. Vec)</a>
<a id="430" class="Comment">--</a>
<a id="433" class="Comment">-- TODO: support type classes with more than one field</a>
<a id="488" class="Comment">--</a>
<a id="491" class="Comment">-- TODO: enable using existing code for instance when mutually recursing</a>
<a id="564" class="Comment">--</a>
<a id="567" class="Comment">-- TODO: Requires K to pass the termination checker. Maybe we can do without somehow.</a>

<a id="654" class="Symbol">{-#</a> <a id="658" class="Keyword">OPTIONS</a> <a id="666" class="Pragma">-v</a> <a id="669" class="Pragma">allTactics:100</a> <a id="684" class="Symbol">#-}</a>
<a id="688" class="Symbol">{-#</a> <a id="692" class="Keyword">OPTIONS</a> <a id="700" class="Pragma">--safe</a> <a id="707" class="Pragma">--without-K</a> <a id="719" class="Symbol">#-}</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Meta.html" class="Module">Meta</a>

<a id="741" class="Keyword">module</a> <a id="748" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="762" class="Symbol">(</a><a id="763" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="773" class="Symbol">:</a> <a id="775" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="779" class="Symbol">)</a> <a id="781" class="Symbol">(</a><a id="782" href="Tactic.Derive.html#782" class="Bound">projName</a> <a id="791" class="Symbol">:</a> <a id="793" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="797" class="Symbol">)</a> <a id="799" class="Keyword">where</a>

<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Prelude.html" class="Module">Prelude</a>

<a id="827" class="Keyword">open</a> <a id="832" class="Keyword">import</a> <a id="839" href="Reflection.Name.html" class="Module">Reflection.Name</a> <a id="855" class="Keyword">using</a> <a id="861" class="Symbol">()</a> <a id="864" class="Keyword">renaming</a> <a id="873" class="Symbol">(</a><a id="874" href="Reflection.Name.html#1403" class="Function Operator">_≟_</a> <a id="878" class="Symbol">to</a> <a id="881" class="Function Operator">_≟-Name_</a><a id="889" class="Symbol">)</a>
<a id="891" class="Keyword">open</a> <a id="896" class="Keyword">import</a> <a id="903" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">()</a> <a id="936" class="Keyword">renaming</a> <a id="945" class="Symbol">(</a><a id="946" href="Agda.Builtin.Reflection.html#622" class="Primitive">primShowQName</a> <a id="960" class="Symbol">to</a> <a id="963" class="Primitive">showName</a><a id="971" class="Symbol">)</a>

<a id="974" class="Keyword">open</a> <a id="979" class="Keyword">import</a> <a id="986" href="Generics.html" class="Module">Generics</a>

<a id="996" class="Keyword">open</a> <a id="1001" class="Keyword">import</a> <a id="1008" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1019" class="Keyword">using</a> <a id="1025" class="Symbol">(</a><a id="1026" href="Data.Maybe.Base.html#1632" class="Function">fromMaybe</a><a id="1035" class="Symbol">)</a>
<a id="1037" class="Keyword">import</a> <a id="1044" href="Data.List.html" class="Module">Data.List</a> <a id="1054" class="Symbol">as</a> <a id="1057" class="Module">L</a>
<a id="1059" class="Keyword">import</a> <a id="1066" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="1085" class="Symbol">as</a> <a id="1088" class="Module">NE</a>
<a id="1091" class="Keyword">import</a> <a id="1098" href="Data.String.html" class="Module">Data.String</a> <a id="1110" class="Symbol">as</a> <a id="1113" class="Module">S</a>

<a id="1116" class="Keyword">open</a> <a id="1121" class="Keyword">import</a> <a id="1128" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="1156" class="Keyword">open</a> <a id="1161" class="Keyword">import</a> <a id="1168" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="1189" class="Keyword">open</a> <a id="1194" class="Keyword">import</a> <a id="1201" href="Tactic.Helpers.html" class="Module">Tactic.Helpers</a>

<a id="1217" class="Keyword">open</a> <a id="1222" class="Keyword">import</a> <a id="1229" href="Interface.Monad.Instance.html" class="Module">Interface.Monad.Instance</a>
<a id="1254" class="Keyword">open</a> <a id="1259" class="Keyword">import</a> <a id="1266" href="Interface.MonadReader.Instance.html" class="Module">Interface.MonadReader.Instance</a>
<a id="1297" class="Keyword">open</a> <a id="1302" class="Keyword">import</a> <a id="1309" href="Interface.MonadTC.Instance.html" class="Module">Interface.MonadTC.Instance</a>

<a id="1337" class="Keyword">instance</a>
  <a id="1348" href="Tactic.Derive.html#1348" class="Function">_</a> <a id="1350" class="Symbol">=</a> <a id="1352" href="Tactic.ClauseBuilder.html#10631" class="Function">ContextMonad-MonadTC</a>

<a id="1374" class="Keyword">open</a> <a id="1379" href="Tactic.ClauseBuilder.html#10861" class="Module">ClauseExprM</a>

<a id="genClassType"></a><a id="1392" href="Tactic.Derive.html#1392" class="Function">genClassType</a> <a id="1405" class="Symbol">:</a> <a id="1407" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="1416" class="Symbol">→</a> <a id="1418" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1424" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="1429" class="Symbol">→</a> <a id="1431" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="1434" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a>
<a id="1439" href="Tactic.Derive.html#1392" class="Function">genClassType</a> <a id="1452" href="Tactic.Derive.html#1452" class="Bound">arity</a> <a id="1458" href="Tactic.Derive.html#1458" class="Bound">dName</a> <a id="1464" href="Tactic.Derive.html#1464" class="Bound">wName</a> <a id="1470" class="Symbol">=</a> <a id="1472" class="Keyword">do</a>
  <a id="1477" href="Tactic.Derive.html#1477" class="Bound">params</a> <a id="1484" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="1486" href="Tactic.Helpers.html#4277" class="Function">getParamsAndIndices</a> <a id="1506" href="Tactic.Derive.html#1458" class="Bound">dName</a>
  <a id="1514" href="Tactic.Derive.html#1514" class="Bound">adjParams</a> <a id="1524" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="1526" href="Tactic.Derive.html#1825" class="Function">adjustParams</a> <a id="1539" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1541" href="Data.List.Base.html#7307" class="Function">take</a> <a id="1546" class="Symbol">(</a><a id="1547" href="Data.List.Base.html#4864" class="Function">length</a> <a id="1554" href="Tactic.Derive.html#1477" class="Bound">params</a> <a id="1561" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="1563" href="Tactic.Derive.html#1452" class="Bound">arity</a><a id="1568" class="Symbol">)</a> <a id="1570" href="Tactic.Derive.html#1477" class="Bound">params</a>
  <a id="1579" href="Interface.MonadTC.html#8578" class="Function">debugLog1</a> <a id="1589" class="String">&quot;AdjustedParams: &quot;</a>
  <a id="1610" href="Tactic.Helpers.html#1144" class="Function">logTelescope</a> <a id="1623" class="Symbol">(</a><a id="1624" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="1630" class="Symbol">((λ</a> <a id="1634" class="Keyword">where</a> <a id="1640" class="Symbol">(</a><a id="1641" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1645" href="Tactic.Derive.html#1645" class="Bound">s</a> <a id="1647" href="Tactic.Derive.html#1647" class="Bound">x</a><a id="1648" class="Symbol">)</a> <a id="1650" class="Symbol">→</a> <a id="1652" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1657" href="Tactic.Derive.html#1645" class="Bound">s</a> <a id="1659" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1661" href="Tactic.Derive.html#1647" class="Bound">x</a><a id="1662" class="Symbol">)</a> <a id="1664" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1666" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="1671" class="Symbol">)</a> <a id="1673" href="Tactic.Derive.html#1514" class="Bound">adjParams</a><a id="1682" class="Symbol">)</a>
  <a id="1686" href="Tactic.Derive.html#1686" class="Bound">ty</a> <a id="1689" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="1691" href="Tactic.Helpers.html#5410" class="Function">applyWithVisibility</a> <a id="1711" href="Tactic.Derive.html#1458" class="Bound">dName</a> <a id="1717" class="Symbol">(</a><a id="1718" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="1724" href="Generics.Core.html#372" class="InductiveConstructor">♯</a> <a id="1726" class="Symbol">(</a><a id="1727" href="Tactic.Derive.html#2320" class="Function">trueIndices</a> <a id="1739" href="Tactic.Derive.html#1514" class="Bound">adjParams</a><a id="1748" class="Symbol">))</a>
  <a id="1753" href="Interface.Monad.html#286" class="Field">return</a> <a id="1760" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1762" href="Tactic.Derive.html#2486" class="Function">modifyClassType</a> <a id="1778" href="Tactic.Derive.html#1464" class="Bound">wName</a> <a id="1784" class="Symbol">(</a><a id="1785" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="1791" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1797" href="Tactic.Derive.html#1514" class="Bound">adjParams</a> <a id="1807" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1809" href="Tactic.Derive.html#1686" class="Bound">ty</a><a id="1811" class="Symbol">)</a>
  <a id="1815" class="Keyword">where</a>
    <a id="1825" href="Tactic.Derive.html#1825" class="Function">adjustParams</a> <a id="1838" class="Symbol">:</a> <a id="1840" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1845" class="Symbol">(</a><a id="1846" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1850" class="Symbol">(</a><a id="1851" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="1855" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a><a id="1859" class="Symbol">))</a> <a id="1862" class="Symbol">→</a> <a id="1864" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="1867" class="Symbol">(</a><a id="1868" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1873" class="Symbol">((</a><a id="1875" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1879" class="Symbol">(</a><a id="1880" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="1884" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a><a id="1888" class="Symbol">))</a> <a id="1891" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1893" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1897" class="Symbol">))</a>
    <a id="1904" href="Tactic.Derive.html#1825" class="Function">adjustParams</a> <a id="1917" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1920" class="Symbol">=</a> <a id="1922" href="Interface.Monad.html#286" class="Field">return</a> <a id="1929" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="1936" href="Tactic.Derive.html#1825" class="Function">adjustParams</a> <a id="1949" class="Symbol">(</a><a id="1950" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1954" href="Tactic.Derive.html#1954" class="Bound">x</a> <a id="1956" class="Symbol">(</a><a id="1957" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="1961" class="Symbol">_</a> <a id="1963" href="Tactic.Derive.html#1963" class="Bound">t</a><a id="1964" class="Symbol">)</a> <a id="1966" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1968" href="Tactic.Derive.html#1968" class="Bound">l</a><a id="1969" class="Symbol">)</a> <a id="1971" class="Symbol">=</a> <a id="1973" class="Keyword">do</a>
      <a id="1982" href="Tactic.Derive.html#1982" class="Bound">a</a> <a id="1984" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="1986" class="Symbol">(</a><a id="1987" href="Data.Bool.Base.html#1283" class="Function Operator">if_then</a> <a id="1995" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1997" class="Symbol">(</a><a id="1998" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2002" class="String">&quot;_&quot;</a> <a id="2006" class="Symbol">(</a><a id="2007" href="Reflection.Argument.html#1333" class="InductiveConstructor">iArg</a> <a id="2012" class="Symbol">(</a><a id="2013" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2023" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2026" href="Generics.Core.html#372" class="InductiveConstructor">♯</a> <a id="2028" class="Number">0</a> <a id="2030" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2031" class="Symbol">))</a> <a id="2034" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2036" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="2041" class="Symbol">)</a> <a id="2043" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="2045" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2050" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2052" class="Symbol">)</a> <a id="2054" href="Interface.Monad.html#627" class="Function Operator">&lt;$&gt;</a> <a id="2058" href="Tactic.Helpers.html#4587" class="Function">isNArySort</a> <a id="2069" href="Tactic.Derive.html#1452" class="Bound">arity</a> <a id="2075" href="Tactic.Derive.html#1963" class="Bound">t</a>
      <a id="2083" href="Tactic.Derive.html#2083" class="Bound">ps</a> <a id="2086" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="2088" href="Interface.MonadTC.html#7605" class="Function">extendContext</a> <a id="2102" class="Symbol">(</a><a id="2103" href="Reflection.Argument.html#1271" class="InductiveConstructor">hArg</a> <a id="2108" href="Tactic.Derive.html#1963" class="Bound">t</a><a id="2109" class="Symbol">)</a> <a id="2111" class="Symbol">(</a><a id="2112" href="Tactic.Derive.html#1825" class="Function">adjustParams</a> <a id="2125" href="Tactic.Derive.html#1968" class="Bound">l</a><a id="2126" class="Symbol">)</a>
      <a id="2134" class="Keyword">let</a> <a id="2138" href="Tactic.Derive.html#2138" class="Bound">ps&#39;</a> <a id="2142" class="Symbol">=</a> <a id="2144" href="Function.Base.html#1554" class="Function">flip</a> <a id="2149" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="2155" href="Tactic.Derive.html#2083" class="Bound">ps</a> <a id="2158" class="Symbol">λ</a> <a id="2160" class="Keyword">where</a>
        <a id="2174" class="Symbol">(</a><a id="2175" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2179" href="Tactic.Derive.html#2179" class="Bound">s</a> <a id="2181" class="Symbol">(</a><a id="2182" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="2186" href="Tactic.Derive.html#2186" class="Bound">i</a> <a id="2188" href="Tactic.Derive.html#2188" class="Bound">t</a><a id="2189" class="Symbol">)</a> <a id="2191" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2193" href="Tactic.Derive.html#2193" class="Bound">b</a><a id="2194" class="Symbol">)</a> <a id="2196" class="Symbol">→</a> <a id="2198" class="Symbol">(</a><a id="2199" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2203" href="Tactic.Derive.html#2179" class="Bound">s</a> <a id="2205" class="Symbol">(</a><a id="2206" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="2210" href="Tactic.Derive.html#2186" class="Bound">i</a> <a id="2212" class="Symbol">(</a><a id="2213" href="Generics.Utils.html#5684" class="Function">mapVars</a> <a id="2221" class="Symbol">(</a><a id="2222" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="2225" class="Symbol">(</a><a id="2226" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2229" href="Tactic.Derive.html#2193" class="Bound">b</a> <a id="2231" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2236" href="Data.List.Base.html#4864" class="Function">length</a> <a id="2243" href="Tactic.Derive.html#1982" class="Bound">a</a> <a id="2245" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2250" class="Number">0</a><a id="2251" class="Symbol">))</a> <a id="2254" href="Tactic.Derive.html#2188" class="Bound">t</a><a id="2255" class="Symbol">))</a> <a id="2258" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2260" href="Tactic.Derive.html#2193" class="Bound">b</a><a id="2261" class="Symbol">)</a>
      <a id="2269" href="Interface.Monad.html#286" class="Field">return</a> <a id="2276" class="Symbol">(((</a><a id="2279" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="2283" href="Tactic.Derive.html#1954" class="Bound">x</a> <a id="2285" class="Symbol">(</a><a id="2286" href="Reflection.Argument.html#1271" class="InductiveConstructor">hArg</a> <a id="2291" href="Tactic.Derive.html#1963" class="Bound">t</a><a id="2292" class="Symbol">)</a> <a id="2294" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2296" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="2300" class="Symbol">)</a> <a id="2302" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2304" href="Tactic.Derive.html#1982" class="Bound">a</a><a id="2305" class="Symbol">)</a> <a id="2307" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2310" href="Tactic.Derive.html#2138" class="Bound">ps&#39;</a><a id="2313" class="Symbol">)</a>

    <a id="2320" href="Tactic.Derive.html#2320" class="Function">trueIndices</a> <a id="2332" class="Symbol">:</a> <a id="2334" class="Symbol">{</a><a id="2335" href="Tactic.Derive.html#2335" class="Bound">A</a> <a id="2337" class="Symbol">:</a> <a id="2339" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2342" class="Symbol">}</a> <a id="2344" class="Symbol">→</a> <a id="2346" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2351" class="Symbol">(</a><a id="2352" href="Tactic.Derive.html#2335" class="Bound">A</a> <a id="2354" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2356" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="2360" class="Symbol">)</a> <a id="2362" class="Symbol">→</a> <a id="2364" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2369" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="2375" href="Tactic.Derive.html#2320" class="Function">trueIndices</a> <a id="2387" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2390" class="Symbol">=</a> <a id="2392" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="2399" href="Tactic.Derive.html#2320" class="Function">trueIndices</a> <a id="2411" class="Symbol">(</a><a id="2412" href="Tactic.Derive.html#2412" class="Bound">x</a> <a id="2414" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2416" href="Tactic.Derive.html#2416" class="Bound">l</a><a id="2417" class="Symbol">)</a> <a id="2419" class="Symbol">=</a> <a id="2421" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2424" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="2430" href="Tactic.Derive.html#2412" class="Bound">x</a> <a id="2432" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2437" href="Data.List.Base.html#4864" class="Function">length</a> <a id="2444" href="Tactic.Derive.html#2416" class="Bound">l</a> <a id="2446" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2448" href="Tactic.Derive.html#2320" class="Function">trueIndices</a> <a id="2460" href="Tactic.Derive.html#2416" class="Bound">l</a> <a id="2462" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2467" href="Tactic.Derive.html#2320" class="Function">trueIndices</a> <a id="2479" href="Tactic.Derive.html#2416" class="Bound">l</a>

    <a id="2486" href="Tactic.Derive.html#2486" class="Function">modifyClassType</a> <a id="2502" class="Symbol">:</a> <a id="2504" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2510" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="2515" class="Symbol">→</a> <a id="2517" href="Generics.Utils.html#2505" class="Function">TypeView</a> <a id="2526" class="Symbol">→</a> <a id="2528" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a>
    <a id="2537" href="Tactic.Derive.html#2486" class="Function">modifyClassType</a> <a id="2553" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>  <a id="2562" class="Symbol">(</a><a id="2563" href="Tactic.Derive.html#2563" class="Bound">tel</a> <a id="2567" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2569" href="Tactic.Derive.html#2569" class="Bound">ty</a><a id="2571" class="Symbol">)</a> <a id="2573" class="Symbol">=</a> <a id="2575" href="Generics.Utils.html#2662" class="Function">tyView</a> <a id="2582" class="Symbol">(</a><a id="2583" href="Tactic.Derive.html#2563" class="Bound">tel</a> <a id="2587" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2589" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2599" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2602" href="Tactic.Derive.html#2569" class="Bound">ty</a> <a id="2605" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2606" class="Symbol">)</a>
    <a id="2612" href="Tactic.Derive.html#2486" class="Function">modifyClassType</a> <a id="2628" class="Symbol">(</a><a id="2629" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2634" href="Tactic.Derive.html#2634" class="Bound">n</a><a id="2635" class="Symbol">)</a> <a id="2637" class="Symbol">(</a><a id="2638" href="Tactic.Derive.html#2638" class="Bound">tel</a> <a id="2642" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2644" href="Tactic.Derive.html#2644" class="Bound">ty</a><a id="2646" class="Symbol">)</a> <a id="2648" class="Symbol">=</a> <a id="2650" href="Generics.Utils.html#2662" class="Function">tyView</a> <a id="2657" class="Symbol">(</a><a id="2658" href="Tactic.Derive.html#2638" class="Bound">tel</a> <a id="2662" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2664" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="2674" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2677" href="Tactic.Derive.html#2634" class="Bound">n</a> <a id="2679" href="Generics.Core.html#1843" class="InductiveConstructor Operator">∙⟦</a> <a id="2682" href="Tactic.Derive.html#2644" class="Bound">ty</a> <a id="2685" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a> <a id="2687" href="Generics.Core.html#1843" class="InductiveConstructor Operator">⟧</a><a id="2688" class="Symbol">)</a>

<a id="lookupName"></a><a id="2691" href="Tactic.Derive.html#2691" class="Function">lookupName</a> <a id="2702" class="Symbol">:</a> <a id="2704" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2709" class="Symbol">(</a><a id="2710" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="2715" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2717" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="2721" class="Symbol">)</a> <a id="2723" class="Symbol">→</a> <a id="2725" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="2730" class="Symbol">→</a> <a id="2732" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2738" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a>
<a id="2743" href="Tactic.Derive.html#2691" class="Function">lookupName</a> <a id="2754" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2757" href="Tactic.Derive.html#2757" class="Bound">n</a> <a id="2759" class="Symbol">=</a> <a id="2761" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="2769" href="Tactic.Derive.html#2691" class="Function">lookupName</a> <a id="2780" class="Symbol">((</a><a id="2782" href="Tactic.Derive.html#2782" class="Bound">k</a> <a id="2784" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2786" href="Tactic.Derive.html#2786" class="Bound">v</a><a id="2787" class="Symbol">)</a> <a id="2789" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2791" href="Tactic.Derive.html#2791" class="Bound">l</a><a id="2792" class="Symbol">)</a> <a id="2794" href="Tactic.Derive.html#2794" class="Bound">n</a> <a id="2796" class="Symbol">=</a> <a id="2798" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2801" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="2803" href="Tactic.Derive.html#2782" class="Bound">k</a> <a id="2805" href="Tactic.Derive.html#881" class="Function Operator">≟-Name</a> <a id="2812" href="Tactic.Derive.html#2794" class="Bound">n</a> <a id="2814" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a> <a id="2816" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2821" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2826" href="Tactic.Derive.html#2786" class="Bound">v</a> <a id="2828" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2833" href="Tactic.Derive.html#2691" class="Function">lookupName</a> <a id="2844" href="Tactic.Derive.html#2791" class="Bound">l</a> <a id="2846" href="Tactic.Derive.html#2794" class="Bound">n</a>

<a id="2849" class="Comment">-- Look at the constructors of the argument and return all types that</a>
<a id="2919" class="Comment">-- recursively contain it. This isn&#39;t very clever right now.</a>
<a id="genMutualHelpers"></a><a id="2980" href="Tactic.Derive.html#2980" class="Function">genMutualHelpers</a> <a id="2997" class="Symbol">:</a> <a id="2999" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3004" class="Symbol">→</a> <a id="3006" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="3009" class="Symbol">(</a><a id="3010" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3015" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="3019" class="Symbol">)</a>
<a id="3021" href="Tactic.Derive.html#2980" class="Function">genMutualHelpers</a> <a id="3038" href="Tactic.Derive.html#3038" class="Bound">n</a> <a id="3040" class="Symbol">=</a> <a id="3042" class="Keyword">do</a>
  <a id="3047" href="Tactic.Derive.html#3047" class="Bound">tys</a> <a id="3051" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="3053" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="3059" class="Symbol">(</a><a id="3060" href="Reflection.Argument.html#2521" class="Function">unArg</a> <a id="3066" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3068" href="Reflection.Abstraction.html#1729" class="Function">unAbs</a><a id="3073" class="Symbol">)</a> <a id="3075" href="Interface.Monad.html#627" class="Function Operator">&lt;$&gt;</a> <a id="3079" class="Symbol">(</a><a id="3080" href="Data.List.Base.html#4450" class="Function">L.concatMap</a> <a id="3092" class="Symbol">(</a><a id="3093" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3099" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3101" href="Generics.Utils.html#2546" class="Function">viewTy</a> <a id="3108" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3110" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="3115" class="Symbol">)</a> <a id="3117" href="Interface.Monad.html#627" class="Function Operator">&lt;$&gt;</a> <a id="3121" href="Interface.MonadTC.html#9378" class="Function">getConstrs</a> <a id="3132" href="Tactic.Derive.html#3038" class="Bound">n</a><a id="3133" class="Symbol">)</a>
  <a id="3137" href="Interface.Monad.html#286" class="Field">return</a> <a id="3144" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3146" href="Data.List.Base.html#9017" class="Function">deduplicate</a> <a id="3158" href="Tactic.Derive.html#881" class="Function Operator">_≟-Name_</a> <a id="3167" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3169" href="Data.List.Base.html#1629" class="Function">L.mapMaybe</a> <a id="3180" href="Tactic.Derive.html#3203" class="Function">helper</a> <a id="3187" href="Tactic.Derive.html#3047" class="Bound">tys</a>
  <a id="3193" class="Keyword">where</a>
    <a id="3203" href="Tactic.Derive.html#3203" class="Function">helper</a> <a id="3210" class="Symbol">:</a> <a id="3212" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="3217" class="Symbol">→</a> <a id="3219" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3225" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a>
    <a id="3234" href="Tactic.Derive.html#3203" class="Function">helper</a> <a id="3241" class="Symbol">(</a><a id="3242" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="3246" href="Tactic.Derive.html#3246" class="Bound">n&#39;</a> <a id="3249" href="Tactic.Derive.html#3249" class="Bound">args</a><a id="3253" class="Symbol">)</a> <a id="3255" class="Symbol">=</a>
      <a id="3263" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="3266" href="Data.List.Base.html#4677" class="Function">L.any</a> <a id="3272" class="Symbol">(λ</a> <a id="3275" class="Keyword">where</a> <a id="3281" class="Symbol">(</a><a id="3282" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="3286" class="Symbol">_</a> <a id="3288" class="Symbol">(</a><a id="3289" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="3293" href="Tactic.Derive.html#3293" class="Bound">n&#39;&#39;</a> <a id="3297" class="Symbol">_))</a> <a id="3301" class="Symbol">→</a> <a id="3303" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="3305" href="Tactic.Derive.html#3038" class="Bound">n</a> <a id="3307" href="Tactic.Derive.html#881" class="Function Operator">≟-Name</a> <a id="3314" href="Tactic.Derive.html#3293" class="Bound">n&#39;&#39;</a> <a id="3318" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a> <a id="3320" class="Symbol">;</a> <a id="3322" class="CatchallClause Symbol">_</a> <a id="3324" class="Symbol">→</a> <a id="3326" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="3331" class="Symbol">)</a> <a id="3333" href="Tactic.Derive.html#3249" class="Bound">args</a>
      <a id="3344" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="3349" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3354" href="Tactic.Derive.html#3246" class="Bound">n&#39;</a> <a id="3357" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="3362" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="3374" href="Tactic.Derive.html#3203" class="CatchallClause Function">helper</a><a id="3380" class="CatchallClause"> </a><a id="3381" class="CatchallClause Symbol">_</a> <a id="3383" class="Symbol">=</a> <a id="3385" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="3394" class="Keyword">module</a> <a id="3401" href="Tactic.Derive.html#3401" class="Module">_</a> <a id="3403" class="Symbol">(</a><a id="3404" href="Tactic.Derive.html#3404" class="Bound">arity</a> <a id="3410" class="Symbol">:</a> <a id="3412" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3413" class="Symbol">)</a> <a id="3415" class="Symbol">(</a><a id="3416" href="Tactic.Derive.html#3416" class="Bound">genCe</a> <a id="3422" class="Symbol">:</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3430" class="Symbol">→</a> <a id="3432" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3438" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="3442" class="Symbol">)</a> <a id="3444" class="Symbol">→</a> <a id="3446" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3451" href="Tactic.ClauseBuilder.html#1162" class="Function">SinglePattern</a> <a id="3465" class="Symbol">→</a> <a id="3467" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3472" class="Symbol">(</a><a id="3473" href="Data.List.NonEmpty.Base.html#1079" class="Record">NE.List⁺</a> <a id="3482" href="Tactic.ClauseBuilder.html#1162" class="Function">SinglePattern</a> <a id="3496" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3498" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="3501" class="Symbol">(</a><a id="3502" href="Tactic.ClauseBuilder.html#5652" class="Datatype">ClauseExpr</a> <a id="3513" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="3515" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3521" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a><a id="3525" class="Symbol">)))</a> <a id="3529" class="Keyword">where</a>
  <a id="3537" class="Comment">-- Generate the declaration &amp; definition of a particular derivation.</a>
  <a id="3608" class="Comment">--</a>
  <a id="3613" class="Comment">-- Takes a dictionary (for mutual recursion), a wrapper (also for</a>
  <a id="3681" class="Comment">-- mutual recursion), the name of the original type we want to derive</a>
  <a id="3753" class="Comment">-- Show for and the name we want to define Show originally at.</a>
  <a id="3818" href="Tactic.Derive.html#3818" class="Function">deriveSingle</a> <a id="3831" class="Symbol">:</a> <a id="3833" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3838" class="Symbol">(</a><a id="3839" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3844" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3846" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="3850" class="Symbol">)</a> <a id="3852" class="Symbol">→</a> <a id="3854" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3859" class="Symbol">→</a> <a id="3861" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3866" class="Symbol">→</a> <a id="3868" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3874" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3879" class="Symbol">→</a> <a id="3881" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="3884" class="Symbol">(</a><a id="3885" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="3889" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="3894" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3896" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="3901" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3903" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3908" href="Agda.Builtin.Reflection.html#4745" class="Datatype">Clause</a><a id="3914" class="Symbol">)</a>
  <a id="3918" href="Tactic.Derive.html#3818" class="Function">deriveSingle</a> <a id="3931" href="Tactic.Derive.html#3931" class="Bound">transName</a> <a id="3941" href="Tactic.Derive.html#3941" class="Bound">dName</a> <a id="3947" href="Tactic.Derive.html#3947" class="Bound">iName</a> <a id="3953" href="Tactic.Derive.html#3953" class="Bound">wName</a> <a id="3959" class="Symbol">=</a> <a id="3961" href="Tactic.Helpers.html#2505" class="Function">inDebugPath</a> <a id="3973" class="String">&quot;DeriveSingle&quot;</a> <a id="3988" class="Keyword">do</a>
    <a id="3995" href="Interface.MonadTC.html#5534" class="Function">debugLog</a> <a id="4004" class="Symbol">(</a><a id="4005" class="String">&quot;For: &quot;</a> <a id="4013" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="4016" href="Tactic.Derive.html#3941" class="Bound">dName</a> <a id="4022" href="Reflection.Debug.html#992" class="Function Operator">∷ᵈ</a> <a id="4025" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4027" class="Symbol">)</a>
    <a id="4033" href="Tactic.Derive.html#4033" class="Bound">goalTy</a> <a id="4040" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="4042" href="Tactic.Derive.html#1392" class="Function">genClassType</a> <a id="4055" href="Tactic.Derive.html#3404" class="Bound">arity</a> <a id="4061" href="Tactic.Derive.html#3941" class="Bound">dName</a> <a id="4067" href="Tactic.Derive.html#3953" class="Bound">wName</a>
    <a id="4077" href="Tactic.Derive.html#4077" class="Bound">ps</a> <a id="4080" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="4082" href="Tactic.ClauseBuilder.html#5146" class="Function">constructorPatterns&#39;</a> <a id="4103" class="Symbol">(</a><a id="4104" href="Data.Maybe.Base.html#1632" class="Function">fromMaybe</a> <a id="4114" href="Tactic.Derive.html#3941" class="Bound">dName</a> <a id="4120" href="Tactic.Derive.html#3953" class="Bound">wName</a> <a id="4126" href="Generics.Core.html#1819" class="InductiveConstructor Operator">∙</a><a id="4127" class="Symbol">)</a>
    <a id="4133" class="Comment">-- TODO: find a good way of printing this</a>
    <a id="4179" class="Comment">--debugLogᵐ (&quot;Constrs: &quot; ∷ᵈᵐ ps ᵛⁿ ∷ᵈᵐ []ᵐ)</a>
    <a id="4227" href="Tactic.Derive.html#4227" class="Bound">cs</a> <a id="4230" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="4232" href="Interface.MonadReader.html#338" class="Field">local</a> <a id="4238" class="Symbol">(λ</a> <a id="4241" href="Tactic.Derive.html#4241" class="Bound">c</a> <a id="4243" class="Symbol">→</a> <a id="4245" class="Keyword">record</a> <a id="4252" href="Tactic.Derive.html#4241" class="Bound">c</a> <a id="4254" class="Symbol">{</a> <a id="4256" href="Interface.MonadTC.html#866" class="Field">goal</a> <a id="4261" class="Symbol">=</a> <a id="4263" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="4268" href="Tactic.Derive.html#4033" class="Bound">goalTy</a> <a id="4275" class="Symbol">})</a> <a id="4278" href="Function.Base.html#1919" class="Function Operator">$</a>
      <a id="4286" href="Tactic.ClauseBuilder.html#11731" class="Function">singleMatchExpr</a> <a id="4302" class="Symbol">(</a><a id="4303" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4306" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4308" href="Reflection.Argument.html#1333" class="InductiveConstructor">iArg</a> <a id="4313" class="Symbol">(</a><a id="4314" href="Agda.Builtin.Reflection.html#5629" class="InductiveConstructor">Pattern.proj</a> <a id="4327" href="Tactic.Derive.html#782" class="Bound">projName</a><a id="4335" class="Symbol">))</a> <a id="4338" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4340" href="Tactic.ClauseBuilder.html#12688" class="Function">contMatch</a> <a id="4350" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4352" href="Tactic.ClauseBuilder.html#11196" class="Function">multiMatchExprM</a> <a id="4368" href="Function.Base.html#1919" class="Function Operator">$</a>
        <a id="4378" href="Tactic.Derive.html#3416" class="Bound">genCe</a> <a id="4384" class="Symbol">(</a><a id="4385" href="Tactic.Derive.html#2691" class="Function">lookupName</a> <a id="4396" href="Tactic.Derive.html#3931" class="Bound">transName</a><a id="4405" class="Symbol">)</a> <a id="4407" href="Tactic.Derive.html#4077" class="Bound">ps</a>
    <a id="4414" class="Keyword">let</a> <a id="4418" href="Tactic.Derive.html#4418" class="Bound">defName</a> <a id="4426" class="Symbol">=</a> <a id="4428" href="Data.Maybe.Base.html#1362" class="Function">maybe</a> <a id="4434" class="Symbol">(</a><a id="4435" href="Data.Maybe.Base.html#1362" class="Function">maybe</a> <a id="4441" href="Reflection.Argument.html#1209" class="InductiveConstructor">vArg</a> <a id="4446" class="Symbol">(</a><a id="4447" href="Reflection.Argument.html#1333" class="InductiveConstructor">iArg</a> <a id="4452" href="Tactic.Derive.html#3947" class="Bound">iName</a><a id="4457" class="Symbol">)</a> <a id="4459" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4461" href="Tactic.Derive.html#2691" class="Function">lookupName</a> <a id="4472" href="Tactic.Derive.html#3931" class="Bound">transName</a><a id="4481" class="Symbol">)</a> <a id="4483" class="Symbol">(</a><a id="4484" href="Reflection.Argument.html#1333" class="InductiveConstructor">iArg</a> <a id="4489" href="Tactic.Derive.html#3947" class="Bound">iName</a><a id="4494" class="Symbol">)</a> <a id="4496" href="Tactic.Derive.html#3953" class="Bound">wName</a>
    <a id="4506" href="Interface.Monad.html#286" class="Field">return</a> <a id="4513" class="Symbol">(</a><a id="4514" href="Tactic.Derive.html#4418" class="Bound">defName</a> <a id="4522" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4524" href="Tactic.Derive.html#4033" class="Bound">goalTy</a> <a id="4531" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4533" href="Tactic.ClauseBuilder.html#7271" class="Function">clauseExprToClauses</a> <a id="4553" href="Tactic.Derive.html#4227" class="Bound">cs</a><a id="4555" class="Symbol">)</a>

  <a id="4560" href="Tactic.Derive.html#4560" class="Function">deriveMulti</a> <a id="4572" class="Symbol">:</a> <a id="4574" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4579" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4581" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4586" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4588" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4593" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4598" class="Symbol">→</a> <a id="4600" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="4603" class="Symbol">(</a><a id="4604" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4609" class="Symbol">(</a><a id="4610" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="4614" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4619" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4621" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="4626" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4628" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4633" href="Agda.Builtin.Reflection.html#4745" class="Datatype">Clause</a><a id="4639" class="Symbol">))</a>
  <a id="4644" href="Tactic.Derive.html#4560" class="Function">deriveMulti</a> <a id="4656" class="Symbol">(</a><a id="4657" href="Tactic.Derive.html#4657" class="Bound">dName</a> <a id="4663" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4665" href="Tactic.Derive.html#4665" class="Bound">iName</a> <a id="4671" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4673" href="Tactic.Derive.html#4673" class="Bound">hClasses</a><a id="4681" class="Symbol">)</a> <a id="4683" class="Symbol">=</a> <a id="4685" class="Keyword">do</a>
    <a id="4692" href="Tactic.Derive.html#4692" class="Bound">hClassNames</a> <a id="4704" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="4706" href="Interface.Monad.html#820" class="Function">traverseList</a>
      <a id="4725" class="Symbol">(λ</a> <a id="4728" href="Tactic.Derive.html#4728" class="Bound">cn</a> <a id="4731" class="Symbol">→</a> <a id="4733" href="Interface.MonadTC.html#1851" class="Field">freshName</a> <a id="4743" class="Symbol">(</a><a id="4744" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4753" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="4763" href="Data.String.Base.html#2366" class="Function Operator">S.++</a> <a id="4768" class="String">&quot;-&quot;</a> <a id="4772" href="Data.String.Base.html#2366" class="Function Operator">S.++</a> <a id="4777" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4786" href="Tactic.Derive.html#4728" class="Bound">cn</a> <a id="4789" href="Data.String.Base.html#2366" class="Function Operator">S.++</a> <a id="4794" href="Tactic.Derive.html#963" class="Primitive">showName</a> <a id="4803" href="Tactic.Derive.html#4657" class="Bound">dName</a><a id="4808" class="Symbol">))</a> <a id="4811" href="Tactic.Derive.html#4673" class="Bound">hClasses</a>
    <a id="4824" href="Interface.Monad.html#820" class="Function">traverseList</a> <a id="4837" class="Symbol">(</a><a id="4838" href="Tactic.Derive.html#3818" class="Function">deriveSingle</a> <a id="4851" class="Symbol">(</a><a id="4852" href="Data.List.Base.html#3570" class="Function">L.zip</a> <a id="4858" href="Tactic.Derive.html#4673" class="Bound">hClasses</a> <a id="4867" href="Tactic.Derive.html#4692" class="Bound">hClassNames</a><a id="4878" class="Symbol">)</a> <a id="4880" href="Tactic.Derive.html#4657" class="Bound">dName</a> <a id="4886" href="Tactic.Derive.html#4665" class="Bound">iName</a><a id="4891" class="Symbol">)</a> <a id="4893" class="Symbol">(</a><a id="4894" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4902" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4904" href="Data.List.Base.html#1544" class="Function">L.map</a> <a id="4910" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4915" href="Tactic.Derive.html#4673" class="Bound">hClasses</a><a id="4923" class="Symbol">)</a>

  <a id="4928" href="Tactic.Derive.html#4928" class="Function">derive-Class</a> <a id="4941" class="Symbol">:</a> <a id="4943" class="Symbol">⦃</a> <a id="4945" href="Tactic.Derive.html#4945" class="Symbol">_</a> <a id="4947" class="Symbol">:</a> <a id="4949" href="Reflection.Debug.html#2340" class="Record">DebugOptions</a> <a id="4962" class="Symbol">⦄</a> <a id="4964" class="Symbol">→</a> <a id="4966" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4971" class="Symbol">(</a><a id="4972" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="4977" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4979" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a><a id="4983" class="Symbol">)</a> <a id="4985" class="Symbol">→</a> <a id="4987" href="Generics.Core.html#2480" class="Function">UnquoteDecl</a>
  <a id="5001" href="Tactic.Derive.html#4928" class="Function">derive-Class</a> <a id="5014" href="Tactic.Derive.html#5014" class="Bound">l</a> <a id="5016" class="Symbol">=</a> <a id="5018" href="Tactic.Helpers.html#5957" class="Function">initUnquoteWithGoal</a> <a id="5038" class="Symbol">(</a><a id="5039" href="Tactic.Derive.html#763" class="Bound">className</a> <a id="5049" href="Generics.Core.html#1819" class="InductiveConstructor Operator">∙</a><a id="5050" class="Symbol">)</a> <a id="5052" href="Function.Base.html#1919" class="Function Operator">$</a>
    <a id="5058" href="Interface.MonadTC.html#3602" class="Function">declareAndDefineFuns</a> <a id="5079" href="Interface.Monad.html#396" class="Function Operator">=&lt;&lt;</a> <a id="5083" href="Data.List.Base.html#4394" class="Function">concat</a> <a id="5090" href="Interface.Monad.html#627" class="Function Operator">&lt;$&gt;</a> <a id="5094" href="Interface.Monad.html#820" class="Function">traverseList</a> <a id="5107" href="Tactic.Derive.html#5132" class="Function">helper</a> <a id="5114" href="Tactic.Derive.html#5014" class="Bound">l</a>
    <a id="5120" class="Keyword">where</a>
      <a id="5132" href="Tactic.Derive.html#5132" class="Function">helper</a> <a id="5139" class="Symbol">:</a> <a id="5141" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="5146" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5148" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="5153" class="Symbol">→</a> <a id="5155" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="5158" class="Symbol">(</a><a id="5159" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5164" class="Symbol">(</a><a id="5165" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="5169" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="5174" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5176" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="5181" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5183" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5188" href="Agda.Builtin.Reflection.html#4745" class="Datatype">Clause</a><a id="5194" class="Symbol">))</a>
      <a id="5203" href="Tactic.Derive.html#5132" class="Function">helper</a> <a id="5210" class="Symbol">(</a><a id="5211" href="Tactic.Derive.html#5211" class="Bound">a</a> <a id="5213" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5215" href="Tactic.Derive.html#5215" class="Bound">b</a><a id="5216" class="Symbol">)</a> <a id="5218" class="Symbol">=</a> <a id="5220" class="Keyword">do</a> <a id="5223" href="Tactic.Derive.html#5223" class="Bound">hs</a> <a id="5226" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="5228" href="Tactic.Derive.html#2980" class="Function">genMutualHelpers</a> <a id="5245" href="Tactic.Derive.html#5211" class="Bound">a</a> <a id="5247" class="Symbol">;</a> <a id="5249" href="Tactic.Derive.html#4560" class="Function">deriveMulti</a> <a id="5261" class="Symbol">(</a><a id="5262" href="Tactic.Derive.html#5211" class="Bound">a</a> <a id="5264" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5266" href="Tactic.Derive.html#5215" class="Bound">b</a> <a id="5268" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5270" href="Tactic.Derive.html#5223" class="Bound">hs</a><a id="5272" class="Symbol">)</a>
</pre></body></html>