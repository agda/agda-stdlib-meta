<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.HsType</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/agda/agda-stdlib-meta/tree/upstream/hs-type-additions///Tactic/Derive/HsType.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Tactic.Derive.HsType.html" class="Module">Tactic.Derive.HsType</a> <a id="29" class="Keyword">where</a>

<a id="36" class="Keyword">open</a> <a id="41" class="Keyword">import</a> <a id="48" href="Meta.Init.html" class="Module">Meta.Init</a> <a id="58" class="Keyword">hiding</a> <a id="65" class="Symbol">(</a><a id="66" href="Reflection.TCI.html#554" class="Function">TC</a><a id="68" class="Symbol">;</a> <a id="70" href="Reflection.TCI.html#598" class="Function">Monad-TC</a><a id="78" class="Symbol">;</a> <a id="80" href="Reflection.TCI.html#783" class="Function">MonadError-TC</a><a id="93" class="Symbol">)</a>
<a id="95" class="Keyword">open</a> <a id="100" class="Keyword">import</a> <a id="107" href="Meta.Prelude.html" class="Module">Meta.Prelude</a> <a id="120" class="Keyword">hiding</a> <a id="127" class="Symbol">(</a><a id="128" href="Data.List.Base.html#6561" class="Function">lookup</a><a id="134" class="Symbol">)</a>

<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="173" class="Keyword">using</a>
  <a id="181" class="Symbol">(</a><a id="182" href="Agda.Builtin.Reflection.html#9556" class="Postulate">declareData</a><a id="193" class="Symbol">;</a> <a id="195" href="Agda.Builtin.Reflection.html#9602" class="Postulate">defineData</a><a id="205" class="Symbol">;</a> <a id="207" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a><a id="220" class="Symbol">;</a> <a id="222" href="Agda.Builtin.Reflection.html#9970" class="Postulate">pragmaCompile</a><a id="235" class="Symbol">;</a> <a id="237" href="Agda.Builtin.Reflection.html#12129" class="Postulate">solveInstanceConstraints</a><a id="261" class="Symbol">)</a>
<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Reflection.html" class="Module">Reflection</a> <a id="286" class="Symbol">as</a> <a id="289" class="Module">R</a> <a id="291" class="Keyword">hiding</a> <a id="298" class="Symbol">(</a><a id="299" href="Reflection.AST.Show.html#1581" class="Primitive">showName</a><a id="307" class="Symbol">;</a> <a id="309" href="Reflection.TCM.Syntax.html#623" class="Function Operator">_&gt;&gt;=_</a><a id="314" class="Symbol">;</a> <a id="316" href="Reflection.TCM.Syntax.html#693" class="Function Operator">_&gt;&gt;_</a><a id="320" class="Symbol">;</a> <a id="322" href="Reflection.html#5116" class="Function Operator">_≟_</a><a id="325" class="Symbol">)</a>
<a id="327" class="Keyword">open</a> <a id="332" class="Keyword">import</a> <a id="339" href="Reflection.AST.DeBruijn.html" class="Module">Reflection.AST.DeBruijn</a>

<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="387" class="Keyword">using</a> <a id="393" class="Symbol">(</a><a id="394" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a><a id="403" class="Symbol">;</a> <a id="405" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a><a id="411" class="Symbol">;</a> <a id="413" href="Data.Maybe.Base.html#2264" class="Function Operator">_&lt;∣&gt;_</a><a id="418" class="Symbol">)</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="Data.Integer.Base.html" class="Module">Data.Integer.Base</a> <a id="450" class="Keyword">using</a> <a id="456" class="Symbol">(</a><a id="457" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="458" class="Symbol">)</a>
<a id="460" class="Keyword">open</a> <a id="465" class="Keyword">import</a> <a id="472" href="Data.String.html" class="Module">Data.String</a> <a id="484" class="Keyword">using</a> <a id="490" class="Symbol">()</a> <a id="493" class="Keyword">renaming</a> <a id="502" class="Symbol">(</a><a id="503" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="508" class="Symbol">to</a> <a id="511" class="Function Operator">_&amp;_</a><a id="514" class="Symbol">)</a>
<a id="516" class="Keyword">import</a> <a id="523" href="Data.String.html" class="Module">Data.String</a> <a id="535" class="Symbol">as</a> <a id="538" class="Module">String</a>
<a id="545" class="Keyword">open</a> <a id="550" class="Keyword">import</a> <a id="557" href="Data.List.html" class="Module">Data.List</a> <a id="567" class="Keyword">using</a> <a id="573" class="Symbol">(</a><a id="574" href="Data.List.Base.html#1634" class="Function">map</a><a id="577" class="Symbol">;</a> <a id="579" href="Data.List.Base.html#3506" class="Function">zip</a><a id="582" class="Symbol">;</a> <a id="584" href="Data.List.Base.html#2734" class="Function">zipWith</a><a id="591" class="Symbol">)</a>
<a id="593" class="Keyword">open</a> <a id="598" class="Keyword">import</a> <a id="605" href="Data.Char.html" class="Module">Data.Char</a> <a id="615" class="Keyword">using</a> <a id="621" class="Symbol">(</a><a id="622" href="Data.Char.Base.html#1060" class="Primitive">toUpper</a><a id="629" class="Symbol">;</a> <a id="631" href="Data.Char.Base.html#1087" class="Primitive">toLower</a><a id="638" class="Symbol">)</a>
<a id="640" class="Keyword">open</a> <a id="645" class="Keyword">import</a> <a id="652" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="679" class="Keyword">using</a> <a id="685" class="Symbol">(</a><a id="686" href="Relation.Nullary.Decidable.Core.html#3011" class="Function">¬?</a><a id="688" class="Symbol">)</a>

<a id="691" class="Keyword">open</a> <a id="696" class="Keyword">import</a> <a id="703" href="Function.html" class="Module">Function</a>
<a id="712" class="Keyword">open</a> <a id="717" class="Keyword">import</a> <a id="724" href="Text.Printf.html" class="Module">Text.Printf</a>
<a id="736" class="Keyword">open</a> <a id="741" class="Keyword">import</a> <a id="748" href="Foreign.Haskell.html" class="Module">Foreign.Haskell</a>
<a id="764" class="Keyword">open</a> <a id="769" class="Keyword">import</a> <a id="776" href="Foreign.Haskell.Pair.html" class="Module">Foreign.Haskell.Pair</a> <a id="797" class="Keyword">using</a> <a id="803" class="Symbol">(</a><a id="804" href="Foreign.Haskell.Pair.html#534" class="Record">Pair</a><a id="808" class="Symbol">)</a>

<a id="811" class="Keyword">open</a> <a id="816" class="Keyword">import</a> <a id="823" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="835" class="Keyword">open</a> <a id="840" class="Keyword">import</a> <a id="847" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="861" class="Keyword">open</a> <a id="866" class="Keyword">import</a> <a id="873" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="885" class="Keyword">open</a> <a id="890" class="Keyword">import</a> <a id="897" href="Class.MonadError.html" class="Module">Class.MonadError</a>
<a id="914" class="Keyword">open</a> <a id="919" class="Keyword">import</a> <a id="926" href="Class.MonadReader.html" class="Module">Class.MonadReader</a>
<a id="944" class="Keyword">open</a> <a id="949" class="Keyword">import</a> <a id="956" href="Class.Show.html" class="Module">Class.Show</a>
<a id="967" class="Keyword">open</a> <a id="972" class="Keyword">import</a> <a id="979" href="Class.Show.Instances.html" class="Module">Class.Show.Instances</a>
<a id="1000" class="Keyword">open</a> <a id="1005" class="Keyword">import</a> <a id="1012" href="Class.MonadTC.html" class="Module">Class.MonadTC</a> <a id="1026" class="Keyword">using</a> <a id="1032" class="Symbol">(</a><a id="1033" href="Class.MonadTC.html#818" class="Record">TCEnv</a><a id="1038" class="Symbol">;</a> <a id="1040" href="Class.MonadTC.html#514" class="InductiveConstructor">dontReduce</a><a id="1050" class="Symbol">;</a> <a id="1052" href="Class.MonadTC.html#706" class="Function">defaultTCOptions</a><a id="1068" class="Symbol">)</a>
<a id="1070" class="Keyword">open</a> <a id="1075" class="Keyword">import</a> <a id="1082" href="Tactic.Derive.Show.html" class="Module">Tactic.Derive.Show</a> <a id="1101" class="Keyword">using</a> <a id="1107" class="Symbol">(</a><a id="1108" href="Tactic.Derive.Show.html#820" class="Function">showName</a><a id="1116" class="Symbol">)</a>

<a id="1119" class="Keyword">open</a> <a id="1124" class="Keyword">import</a> <a id="1131" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="1148" class="Keyword">open</a> <a id="1153" class="Keyword">import</a> <a id="1160" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>

<a id="1182" class="Keyword">open</a> <a id="1187" class="Keyword">import</a> <a id="1194" href="Class.HasHsType.html" class="Module">Class.HasHsType</a>

<a id="1211" class="Comment">{-
Need to generate:
  - a data type that can be compiled to a Haskell data type
  - the corresponding Haskell type (in a FOREIGN pragma)
  - the COMPILE pragma binding them together
-}</a>

<a id="1398" class="Comment">-- TODO: This breaks with:</a>
<a id="1425" class="Comment">-- - mutual data types</a>
<a id="1448" class="Comment">-- - parametrised data types</a>
<a id="1477" class="Comment">-- - maybe more</a>

<a id="1494" class="Comment">-- * Controlling the names of the generated types</a>

<a id="1545" class="Keyword">record</a> <a id="NameEnv"></a><a id="1552" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="1560" class="Symbol">:</a> <a id="1562" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1566" class="Keyword">where</a>
  <a id="1574" class="Keyword">field</a>
    <a id="NameEnv.customNames"></a><a id="1584" href="Tactic.Derive.HsType.html#1584" class="Field">customNames</a> <a id="1596" class="Symbol">:</a> <a id="1598" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1603" class="Symbol">(</a><a id="1604" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1609" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1611" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1617" class="Symbol">)</a>
    <a id="NameEnv.tName"></a><a id="1623" href="Tactic.Derive.HsType.html#1623" class="Field">tName</a>       <a id="1635" class="Symbol">:</a> <a id="1637" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1642" class="Symbol">→</a> <a id="1644" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1650" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="NameEnv.cName"></a><a id="1661" href="Tactic.Derive.HsType.html#1661" class="Field">cName</a>       <a id="1673" class="Symbol">:</a> <a id="1675" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1680" class="Symbol">→</a> <a id="1682" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1688" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="NameEnv.fName"></a><a id="1699" href="Tactic.Derive.HsType.html#1699" class="Field">fName</a>       <a id="1711" class="Symbol">:</a> <a id="1713" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1718" class="Symbol">→</a> <a id="1720" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1726" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="1734" class="Keyword">private</a>
  <a id="mapHead"></a><a id="1744" href="Tactic.Derive.HsType.html#1744" class="Function">mapHead</a> <a id="1752" class="Symbol">:</a> <a id="1754" class="Symbol">(</a><a id="1755" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="1757" class="Symbol">→</a> <a id="1759" href="Meta.Prelude.html#1418" class="Generalizable">A</a><a id="1760" class="Symbol">)</a> <a id="1762" class="Symbol">→</a> <a id="1764" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1769" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="1771" class="Symbol">→</a> <a id="1773" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1778" href="Meta.Prelude.html#1418" class="Generalizable">A</a>
  <a id="1782" href="Tactic.Derive.HsType.html#1744" class="Function">mapHead</a> <a id="1790" href="Tactic.Derive.HsType.html#1790" class="Bound">f</a> <a id="1792" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="1801" class="Symbol">=</a> <a id="1803" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="1808" href="Tactic.Derive.HsType.html#1744" class="Function">mapHead</a> <a id="1816" href="Tactic.Derive.HsType.html#1816" class="Bound">f</a> <a id="1818" class="Symbol">(</a><a id="1819" href="Tactic.Derive.HsType.html#1819" class="Bound">x</a> <a id="1821" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1823" href="Tactic.Derive.HsType.html#1823" class="Bound">xs</a><a id="1825" class="Symbol">)</a> <a id="1827" class="Symbol">=</a> <a id="1829" href="Tactic.Derive.HsType.html#1816" class="Bound">f</a> <a id="1831" href="Tactic.Derive.HsType.html#1819" class="Bound">x</a> <a id="1833" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1835" href="Tactic.Derive.HsType.html#1823" class="Bound">xs</a>

<a id="capitalize"></a><a id="1839" href="Tactic.Derive.HsType.html#1839" class="Function">capitalize</a> <a id="1850" class="Symbol">:</a> <a id="1852" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1859" class="Symbol">→</a> <a id="1861" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1868" href="Tactic.Derive.HsType.html#1839" class="Function">capitalize</a> <a id="1879" class="Symbol">=</a> <a id="1881" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="1897" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1899" href="Tactic.Derive.HsType.html#1744" class="Function">mapHead</a> <a id="1907" href="Data.Char.Base.html#1060" class="Primitive">toUpper</a> <a id="1915" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1917" href="Data.String.Base.html#1558" class="Primitive">String.toList</a>

<a id="uncapitalize"></a><a id="1932" href="Tactic.Derive.HsType.html#1932" class="Function">uncapitalize</a> <a id="1945" class="Symbol">:</a> <a id="1947" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1954" class="Symbol">→</a> <a id="1956" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1963" href="Tactic.Derive.HsType.html#1932" class="Function">uncapitalize</a> <a id="1976" class="Symbol">=</a> <a id="1978" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="1994" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1996" href="Tactic.Derive.HsType.html#1744" class="Function">mapHead</a> <a id="2004" href="Data.Char.Base.html#1087" class="Primitive">toLower</a> <a id="2012" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2014" href="Data.String.Base.html#1558" class="Primitive">String.toList</a>

<a id="2029" class="Keyword">private</a>
  <a id="lookup"></a><a id="2039" href="Tactic.Derive.HsType.html#2039" class="Function">lookup</a> <a id="2046" class="Symbol">:</a> <a id="2048" class="Symbol">⦃</a> <a id="2050" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="2056" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="2058" class="Symbol">⦄</a> <a id="2060" class="Symbol">→</a> <a id="2062" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="2064" class="Symbol">→</a> <a id="2066" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2071" class="Symbol">(</a><a id="2072" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="2074" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2076" href="Meta.Prelude.html#1420" class="Generalizable">B</a><a id="2077" class="Symbol">)</a> <a id="2079" class="Symbol">→</a> <a id="2081" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2087" href="Meta.Prelude.html#1420" class="Generalizable">B</a>
  <a id="2091" href="Tactic.Derive.HsType.html#2039" class="Function">lookup</a> <a id="2098" href="Tactic.Derive.HsType.html#2098" class="Bound">x</a> <a id="2100" href="Tactic.Derive.HsType.html#2100" class="Bound">xs</a> <a id="2103" class="Symbol">=</a> <a id="2105" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2111" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="2115" href="Data.List.Base.html#13772" class="Function">findᵇ</a> <a id="2121" class="Symbol">((</a><a id="2123" href="Tactic.Derive.HsType.html#2098" class="Bound">x</a> <a id="2125" href="Class.DecEq.Core.html#188" class="Function Operator">==_</a><a id="2128" class="Symbol">)</a> <a id="2130" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2132" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="2137" class="Symbol">)</a> <a id="2139" href="Tactic.Derive.HsType.html#2100" class="Bound">xs</a>

  <a id="lookupEnv"></a><a id="2145" href="Tactic.Derive.HsType.html#2145" class="Function">lookupEnv</a> <a id="2155" class="Symbol">:</a> <a id="2157" class="Symbol">(</a><a id="2158" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="2166" class="Symbol">→</a> <a id="2168" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2173" class="Symbol">→</a> <a id="2175" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2181" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2187" class="Symbol">)</a> <a id="2189" class="Symbol">→</a> <a id="2191" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="2199" class="Symbol">→</a> <a id="2201" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2206" class="Symbol">→</a> <a id="2208" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2214" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="2223" href="Tactic.Derive.HsType.html#2145" class="Function">lookupEnv</a> <a id="2233" href="Tactic.Derive.HsType.html#2233" class="Bound">fn</a> <a id="2236" href="Tactic.Derive.HsType.html#2236" class="Bound">env</a> <a id="2240" href="Tactic.Derive.HsType.html#2240" class="Bound">x</a> <a id="2242" class="Symbol">=</a> <a id="2244" href="Tactic.Derive.HsType.html#2039" class="Function">lookup</a> <a id="2251" href="Tactic.Derive.HsType.html#2240" class="Bound">x</a> <a id="2253" class="Symbol">(</a><a id="2254" href="Tactic.Derive.HsType.html#1584" class="Field">NameEnv.customNames</a> <a id="2274" href="Tactic.Derive.HsType.html#2236" class="Bound">env</a><a id="2277" class="Symbol">)</a> <a id="2279" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="2283" href="Tactic.Derive.HsType.html#2233" class="Bound">fn</a> <a id="2286" href="Tactic.Derive.HsType.html#2236" class="Bound">env</a> <a id="2290" href="Tactic.Derive.HsType.html#2240" class="Bound">x</a>

  <a id="lookupTypeName"></a><a id="2295" href="Tactic.Derive.HsType.html#2295" class="Function">lookupTypeName</a>  <a id="2311" class="Symbol">=</a> <a id="2313" href="Tactic.Derive.HsType.html#2145" class="Function">lookupEnv</a> <a id="2323" href="Tactic.Derive.HsType.html#1623" class="Field">NameEnv.tName</a>
  <a id="lookupConName"></a><a id="2339" href="Tactic.Derive.HsType.html#2339" class="Function">lookupConName</a>   <a id="2355" class="Symbol">=</a> <a id="2357" href="Tactic.Derive.HsType.html#2145" class="Function">lookupEnv</a> <a id="2367" href="Tactic.Derive.HsType.html#1661" class="Field">NameEnv.cName</a>
  <a id="lookupFieldName"></a><a id="2383" href="Tactic.Derive.HsType.html#2383" class="Function">lookupFieldName</a> <a id="2399" class="Symbol">=</a> <a id="2401" href="Tactic.Derive.HsType.html#2145" class="Function">lookupEnv</a> <a id="2411" href="Tactic.Derive.HsType.html#1699" class="Field">NameEnv.fName</a>

  <a id="emptyEnv"></a><a id="2428" href="Tactic.Derive.HsType.html#2428" class="Function">emptyEnv</a> <a id="2437" class="Symbol">:</a> <a id="2439" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
  <a id="2449" href="Tactic.Derive.HsType.html#2428" class="Function">emptyEnv</a> <a id="2458" class="Symbol">=</a> <a id="2460" class="Keyword">record</a><a id="2466" class="Symbol">{</a> <a id="2468" href="Tactic.Derive.HsType.html#1584" class="Field">customNames</a> <a id="2480" class="Symbol">=</a> <a id="2482" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                   <a id="2504" class="Symbol">;</a> <a id="2506" href="Tactic.Derive.HsType.html#1623" class="Field">tName</a> <a id="2512" class="Symbol">=</a> <a id="2514" href="Function.Base.html#725" class="Function">const</a> <a id="2520" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2547" class="Symbol">;</a> <a id="2549" href="Tactic.Derive.HsType.html#1661" class="Field">cName</a> <a id="2555" class="Symbol">=</a> <a id="2557" href="Function.Base.html#725" class="Function">const</a> <a id="2563" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2590" class="Symbol">;</a> <a id="2592" href="Tactic.Derive.HsType.html#1699" class="Field">fName</a> <a id="2598" class="Symbol">=</a> <a id="2600" href="Function.Base.html#725" class="Function">const</a> <a id="2606" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2614" class="Symbol">}</a>

  <a id="customName"></a><a id="2619" href="Tactic.Derive.HsType.html#2619" class="Function">customName</a> <a id="2630" class="Symbol">:</a> <a id="2632" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2637" class="Symbol">→</a> <a id="2639" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2646" class="Symbol">→</a> <a id="2648" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
  <a id="2658" href="Tactic.Derive.HsType.html#2619" class="Function">customName</a> <a id="2669" href="Tactic.Derive.HsType.html#2669" class="Bound">x</a> <a id="2671" href="Tactic.Derive.HsType.html#2671" class="Bound">s</a> <a id="2673" class="Symbol">=</a> <a id="2675" class="Keyword">record</a> <a id="2682" href="Tactic.Derive.HsType.html#2428" class="Function">emptyEnv</a> <a id="2691" class="Symbol">{</a> <a id="2693" href="Tactic.Derive.HsType.html#1584" class="Field">customNames</a> <a id="2705" class="Symbol">=</a> <a id="2707" class="Symbol">(</a><a id="2708" href="Tactic.Derive.HsType.html#2669" class="Bound">x</a> <a id="2710" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2712" href="Tactic.Derive.HsType.html#2671" class="Bound">s</a><a id="2713" class="Symbol">)</a> <a id="2715" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2717" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2720" class="Symbol">}</a>

<a id="onTypes"></a><a id="2723" href="Tactic.Derive.HsType.html#2723" class="Function">onTypes</a> <a id="2731" class="Symbol">:</a> <a id="2733" class="Symbol">(</a><a id="2734" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2741" class="Symbol">→</a> <a id="2743" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2749" class="Symbol">)</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
<a id="2761" href="Tactic.Derive.HsType.html#2723" class="Function">onTypes</a> <a id="2769" href="Tactic.Derive.HsType.html#2769" class="Bound">f</a> <a id="2771" class="Symbol">=</a> <a id="2773" class="Keyword">record</a> <a id="2780" href="Tactic.Derive.HsType.html#2428" class="Function">emptyEnv</a> <a id="2789" class="Symbol">{</a> <a id="2791" href="Tactic.Derive.HsType.html#1623" class="Field">tName</a> <a id="2797" class="Symbol">=</a> <a id="2799" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2804" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2806" href="Tactic.Derive.HsType.html#2769" class="Bound">f</a> <a id="2808" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2810" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="2819" class="Symbol">}</a>

<a id="onConstructors"></a><a id="2822" href="Tactic.Derive.HsType.html#2822" class="Function">onConstructors</a> <a id="2837" class="Symbol">:</a> <a id="2839" class="Symbol">(</a><a id="2840" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2847" class="Symbol">→</a> <a id="2849" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2855" class="Symbol">)</a> <a id="2857" class="Symbol">→</a> <a id="2859" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
<a id="2867" href="Tactic.Derive.HsType.html#2822" class="Function">onConstructors</a> <a id="2882" href="Tactic.Derive.HsType.html#2882" class="Bound">f</a> <a id="2884" class="Symbol">=</a> <a id="2886" class="Keyword">record</a> <a id="2893" href="Tactic.Derive.HsType.html#2428" class="Function">emptyEnv</a> <a id="2902" class="Symbol">{</a> <a id="2904" href="Tactic.Derive.HsType.html#1661" class="Field">cName</a> <a id="2910" class="Symbol">=</a> <a id="2912" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2917" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2919" href="Tactic.Derive.HsType.html#2882" class="Bound">f</a> <a id="2921" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2923" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="2932" class="Symbol">}</a>

<a id="withName"></a><a id="2935" href="Tactic.Derive.HsType.html#2935" class="Function">withName</a> <a id="2944" class="Symbol">:</a> <a id="2946" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2953" class="Symbol">→</a> <a id="2955" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
<a id="2963" href="Tactic.Derive.HsType.html#2935" class="Function">withName</a> <a id="2972" href="Tactic.Derive.HsType.html#2972" class="Bound">t</a> <a id="2974" class="Symbol">=</a> <a id="2976" href="Tactic.Derive.HsType.html#2723" class="Function">onTypes</a> <a id="2984" class="Symbol">(</a><a id="2985" href="Function.Base.html#725" class="Function">const</a> <a id="2991" href="Tactic.Derive.HsType.html#2972" class="Bound">t</a><a id="2992" class="Symbol">)</a>

<a id="2995" class="Comment">-- Only use for single constructor types obviously</a>
<a id="withConstructor"></a><a id="3046" href="Tactic.Derive.HsType.html#3046" class="Function">withConstructor</a> <a id="3062" class="Symbol">:</a> <a id="3064" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3071" class="Symbol">→</a> <a id="3073" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
<a id="3081" href="Tactic.Derive.HsType.html#3046" class="Function">withConstructor</a> <a id="3097" href="Tactic.Derive.HsType.html#3097" class="Bound">c</a> <a id="3099" class="Symbol">=</a> <a id="3101" href="Tactic.Derive.HsType.html#2822" class="Function">onConstructors</a> <a id="3116" class="Symbol">(</a><a id="3117" href="Function.Base.html#725" class="Function">const</a> <a id="3123" href="Tactic.Derive.HsType.html#3097" class="Bound">c</a><a id="3124" class="Symbol">)</a>

<a id="onFields"></a><a id="3127" href="Tactic.Derive.HsType.html#3127" class="Function">onFields</a> <a id="3136" class="Symbol">:</a> <a id="3138" class="Symbol">(</a><a id="3139" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3146" class="Symbol">→</a> <a id="3148" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3154" class="Symbol">)</a> <a id="3156" class="Symbol">→</a> <a id="3158" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
<a id="3166" href="Tactic.Derive.HsType.html#3127" class="Function">onFields</a> <a id="3175" href="Tactic.Derive.HsType.html#3175" class="Bound">f</a> <a id="3177" class="Symbol">=</a> <a id="3179" class="Keyword">record</a> <a id="3186" href="Tactic.Derive.HsType.html#2428" class="Function">emptyEnv</a> <a id="3195" class="Symbol">{</a> <a id="3197" href="Tactic.Derive.HsType.html#1699" class="Field">fName</a> <a id="3203" class="Symbol">=</a> <a id="3205" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3210" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3212" href="Tactic.Derive.HsType.html#3175" class="Bound">f</a> <a id="3214" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3216" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="3225" class="Symbol">}</a>

<a id="fieldPrefix"></a><a id="3228" href="Tactic.Derive.HsType.html#3228" class="Function">fieldPrefix</a> <a id="3240" class="Symbol">:</a> <a id="3242" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3249" class="Symbol">→</a> <a id="3251" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
<a id="3259" href="Tactic.Derive.HsType.html#3228" class="Function">fieldPrefix</a> <a id="3271" href="Tactic.Derive.HsType.html#3271" class="Bound">pre</a> <a id="3275" class="Symbol">=</a> <a id="3277" href="Tactic.Derive.HsType.html#3127" class="Function">onFields</a> <a id="3286" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3288" class="Symbol">(</a><a id="3289" href="Tactic.Derive.HsType.html#3271" class="Bound">pre</a> <a id="3293" href="Data.String.Base.html#2425" class="Function Operator">String.++_</a><a id="3303" class="Symbol">)</a> <a id="3305" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3307" href="Tactic.Derive.HsType.html#1839" class="Function">capitalize</a>

<a id="3319" class="Keyword">infixr</a> <a id="3326" class="Number">5</a> <a id="3328" href="Tactic.Derive.HsType.html#3332" class="Function Operator">_•_</a>
<a id="_•_"></a><a id="3332" href="Tactic.Derive.HsType.html#3332" class="Function Operator">_•_</a> <a id="3336" class="Symbol">:</a> <a id="3338" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="3346" class="Symbol">→</a> <a id="3348" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="3356" class="Symbol">→</a> <a id="3358" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a>
<a id="3366" href="Tactic.Derive.HsType.html#3366" class="Bound">env</a> <a id="3370" href="Tactic.Derive.HsType.html#3332" class="Function Operator">•</a> <a id="3372" href="Tactic.Derive.HsType.html#3372" class="Bound">env₁</a> <a id="3377" class="Symbol">=</a> <a id="3379" class="Keyword">record</a>
  <a id="3388" class="Symbol">{</a> <a id="3390" href="Tactic.Derive.HsType.html#1584" class="Field">customNames</a> <a id="3402" class="Symbol">=</a> <a id="3404" href="Tactic.Derive.HsType.html#1584" class="Function">env.customNames</a> <a id="3420" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="3423" href="Tactic.Derive.HsType.html#1584" class="Field">env₁.customNames</a>
  <a id="3442" class="Symbol">;</a> <a id="3444" href="Tactic.Derive.HsType.html#1623" class="Field">tName</a>       <a id="3456" class="Symbol">=</a> <a id="3458" class="Symbol">λ</a> <a id="3460" href="Tactic.Derive.HsType.html#3460" class="Bound">x</a> <a id="3462" class="Symbol">→</a> <a id="3464" href="Tactic.Derive.HsType.html#1623" class="Function">env.tName</a> <a id="3474" href="Tactic.Derive.HsType.html#3460" class="Bound">x</a> <a id="3476" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3480" href="Tactic.Derive.HsType.html#1623" class="Field">env₁.tName</a> <a id="3491" href="Tactic.Derive.HsType.html#3460" class="Bound">x</a>
  <a id="3495" class="Symbol">;</a> <a id="3497" href="Tactic.Derive.HsType.html#1661" class="Field">cName</a>       <a id="3509" class="Symbol">=</a> <a id="3511" class="Symbol">λ</a> <a id="3513" href="Tactic.Derive.HsType.html#3513" class="Bound">x</a> <a id="3515" class="Symbol">→</a> <a id="3517" href="Tactic.Derive.HsType.html#1661" class="Function">env.cName</a> <a id="3527" href="Tactic.Derive.HsType.html#3513" class="Bound">x</a> <a id="3529" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3533" href="Tactic.Derive.HsType.html#1661" class="Field">env₁.cName</a> <a id="3544" href="Tactic.Derive.HsType.html#3513" class="Bound">x</a>
  <a id="3548" class="Symbol">;</a> <a id="3550" href="Tactic.Derive.HsType.html#1699" class="Field">fName</a>       <a id="3562" class="Symbol">=</a> <a id="3564" class="Symbol">λ</a> <a id="3566" href="Tactic.Derive.HsType.html#3566" class="Bound">x</a> <a id="3568" class="Symbol">→</a> <a id="3570" href="Tactic.Derive.HsType.html#1699" class="Function">env.fName</a> <a id="3580" href="Tactic.Derive.HsType.html#3566" class="Bound">x</a> <a id="3582" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3586" href="Tactic.Derive.HsType.html#1699" class="Field">env₁.fName</a> <a id="3597" href="Tactic.Derive.HsType.html#3566" class="Bound">x</a>
  <a id="3601" class="Symbol">}</a>
  <a id="3605" class="Keyword">where</a>
    <a id="3615" class="Keyword">module</a> <a id="3622" href="Tactic.Derive.HsType.html#3622" class="Module">env</a>  <a id="3627" class="Symbol">=</a> <a id="3629" href="Tactic.Derive.HsType.html#1552" class="Module">NameEnv</a> <a id="3637" href="Tactic.Derive.HsType.html#3366" class="Bound">env</a>
    <a id="3645" class="Keyword">module</a> <a id="3652" href="Tactic.Derive.HsType.html#3652" class="Module">env₁</a> <a id="3657" class="Symbol">=</a> <a id="3659" href="Tactic.Derive.HsType.html#1552" class="Module">NameEnv</a> <a id="3667" href="Tactic.Derive.HsType.html#3372" class="Bound">env₁</a>


<a id="3674" class="Comment">-- * The inner workings</a>

<a id="solveHsType"></a><a id="3699" href="Tactic.Derive.HsType.html#3699" class="Function">solveHsType</a> <a id="3711" class="Symbol">:</a> <a id="3713" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3718" class="Symbol">→</a> <a id="3720" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="3723" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="3728" href="Tactic.Derive.HsType.html#3699" class="Function">solveHsType</a> <a id="3740" href="Tactic.Derive.HsType.html#3740" class="Bound">tm</a> <a id="3743" class="Symbol">=</a> <a id="3745" class="Keyword">do</a>
  <a id="3750" href="Tactic.Derive.HsType.html#3750" class="Bound">hsTy</a> <a id="3755" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="3757" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="3767" class="Symbol">(</a><a id="3768" class="Keyword">quote</a> <a id="3774" href="Class.HasHsType.Core.html#263" class="Function">HsType</a> <a id="3781" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="3784" href="Tactic.Derive.HsType.html#3740" class="Bound">tm</a> <a id="3787" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="3788" class="Symbol">)</a> <a id="3790" href="Reflection.Syntax.html#3423" class="InductiveConstructor">`Set</a>
  <a id="3797" href="Agda.Builtin.Reflection.html#12129" class="Postulate">solveInstanceConstraints</a>
  <a id="3824" href="Agda.Builtin.Reflection.html#8972" class="Postulate">normalise</a> <a id="3834" href="Tactic.Derive.HsType.html#3750" class="Bound">hsTy</a> <a id="3839" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="3843" class="Symbol">λ</a> <a id="3845" class="Keyword">where</a>
    <a id="3855" class="Symbol">(</a><a id="3856" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="3860" class="Symbol">(</a><a id="3861" class="Keyword">quote</a> <a id="3867" href="Class.HasHsType.Core.html#263" class="Function">HsType</a><a id="3873" class="Symbol">)</a> <a id="3875" class="Symbol">_)</a> <a id="3878" class="Symbol">→</a> <a id="3880" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="3893" class="String">&quot;Failed to solve HsType %t&quot;</a> <a id="3921" href="Tactic.Derive.HsType.html#3740" class="Bound">tm</a>
    <a id="3928" href="Tactic.Derive.HsType.html#3928" class="CatchallClause Bound">hsTy</a>                   <a id="3951" class="Symbol">→</a> <a id="3953" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="3960" href="Tactic.Derive.HsType.html#3928" class="Bound">hsTy</a>

<a id="3966" class="Keyword">private</a>
  <a id="debug"></a><a id="3976" href="Tactic.Derive.HsType.html#3976" class="Function">debug</a> <a id="3982" class="Symbol">=</a> <a id="3984" href="Reflection.TCM.Format.html#2726" class="Function">debugPrintFmt</a> <a id="3998" class="String">&quot;tactic.hs-types&quot;</a>

  <a id="_‼_"></a><a id="4019" href="Tactic.Derive.HsType.html#4019" class="Function Operator">_‼_</a> <a id="4023" class="Symbol">:</a> <a id="4025" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4030" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="4032" class="Symbol">→</a> <a id="4034" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4036" class="Symbol">→</a> <a id="4038" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4044" href="Meta.Prelude.html#1418" class="Generalizable">A</a>
  <a id="4048" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="4057" href="Tactic.Derive.HsType.html#4019" class="Function Operator">‼</a> <a id="4059" href="Tactic.Derive.HsType.html#4059" class="Bound">i</a>     <a id="4065" class="Symbol">=</a> <a id="4067" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
  <a id="4077" class="Symbol">(</a><a id="4078" href="Tactic.Derive.HsType.html#4078" class="Bound">x</a> <a id="4080" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4082" href="Tactic.Derive.HsType.html#4082" class="Bound">xs</a><a id="4084" class="Symbol">)</a> <a id="4086" href="Tactic.Derive.HsType.html#4019" class="Function Operator">‼</a> <a id="4088" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>  <a id="4094" class="Symbol">=</a> <a id="4096" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4101" href="Tactic.Derive.HsType.html#4078" class="Bound">x</a>
  <a id="4105" class="Symbol">(</a><a id="4106" href="Tactic.Derive.HsType.html#4106" class="Bound">x</a> <a id="4108" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4110" href="Tactic.Derive.HsType.html#4110" class="Bound">xs</a><a id="4112" class="Symbol">)</a> <a id="4114" href="Tactic.Derive.HsType.html#4019" class="Function Operator">‼</a> <a id="4116" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4120" href="Tactic.Derive.HsType.html#4120" class="Bound">i</a> <a id="4122" class="Symbol">=</a> <a id="4124" href="Tactic.Derive.HsType.html#4110" class="Bound">xs</a> <a id="4127" href="Tactic.Derive.HsType.html#4019" class="Function Operator">‼</a> <a id="4129" href="Tactic.Derive.HsType.html#4120" class="Bound">i</a>

  <a id="specialHsTypes"></a><a id="4134" href="Tactic.Derive.HsType.html#4134" class="Function">specialHsTypes</a> <a id="4149" class="Symbol">:</a> <a id="4151" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4156" class="Symbol">(</a><a id="4157" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4162" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4164" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="4170" class="Symbol">)</a>
  <a id="4174" href="Tactic.Derive.HsType.html#4134" class="Function">specialHsTypes</a> <a id="4189" class="Symbol">=</a> <a id="4191" class="Symbol">(</a><a id="4192" class="Keyword">quote</a> <a id="4198" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>      <a id="4205" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4207" class="String">&quot;()&quot;</a><a id="4211" class="Symbol">)</a>
                 <a id="4230" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4232" class="Symbol">(</a><a id="4233" class="Keyword">quote</a> <a id="4239" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>      <a id="4246" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4248" class="String">&quot;Integer&quot;</a><a id="4257" class="Symbol">)</a>
                 <a id="4276" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4278" class="Symbol">(</a><a id="4279" class="Keyword">quote</a> <a id="4285" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>      <a id="4292" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4294" class="String">&quot;Integer&quot;</a><a id="4303" class="Symbol">)</a>
                 <a id="4322" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4324" class="Symbol">(</a><a id="4325" class="Keyword">quote</a> <a id="4331" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>   <a id="4338" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4340" class="String">&quot;Bool&quot;</a><a id="4346" class="Symbol">)</a>
                 <a id="4365" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4367" class="Symbol">(</a><a id="4368" class="Keyword">quote</a> <a id="4374" href="Agda.Builtin.List.html#147" class="Datatype">List</a>   <a id="4381" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4383" class="String">&quot;[]&quot;</a><a id="4387" class="Symbol">)</a>
                 <a id="4406" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4408" class="Symbol">(</a><a id="4409" class="Keyword">quote</a> <a id="4415" href="Foreign.Haskell.Pair.html#534" class="Record">Pair</a>   <a id="4422" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4424" class="String">&quot;(,)&quot;</a><a id="4429" class="Symbol">)</a>
                 <a id="4448" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4450" class="Symbol">(</a><a id="4451" class="Keyword">quote</a> <a id="4457" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="4464" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4466" class="String">&quot;Maybe&quot;</a><a id="4473" class="Symbol">)</a>
                 <a id="4492" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4494" class="Symbol">(</a><a id="4495" class="Keyword">quote</a> <a id="4501" href="Foreign.Haskell.Either.html#539" class="Datatype">Either</a> <a id="4508" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4510" class="String">&quot;Either&quot;</a><a id="4518" class="Symbol">)</a>
                 <a id="4537" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4539" class="Symbol">(</a><a id="4540" class="Keyword">quote</a> <a id="4546" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4553" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4555" class="String">&quot;Data.Text.Text&quot;</a><a id="4571" class="Symbol">)</a>
                 <a id="4590" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4592" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="hsTypeName"></a><a id="4598" href="Tactic.Derive.HsType.html#4598" class="Function">hsTypeName</a> <a id="4609" class="Symbol">:</a> <a id="4611" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="4619" class="Symbol">→</a> <a id="4621" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4626" class="Symbol">→</a> <a id="4628" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="4637" href="Tactic.Derive.HsType.html#4598" class="Function">hsTypeName</a> <a id="4648" href="Tactic.Derive.HsType.html#4648" class="Bound">env</a> <a id="4652" href="Tactic.Derive.HsType.html#4652" class="Bound">d</a> <a id="4654" class="Symbol">=</a> <a id="4656" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="4666" class="Symbol">(</a><a id="4667" href="Tactic.Derive.HsType.html#1839" class="Function">capitalize</a> <a id="4678" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4680" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="4689" href="Tactic.Derive.HsType.html#4652" class="Bound">d</a><a id="4690" class="Symbol">)</a> <a id="4692" class="Symbol">(</a><a id="4693" href="Tactic.Derive.HsType.html#2295" class="Function">lookupTypeName</a> <a id="4708" href="Tactic.Derive.HsType.html#4648" class="Bound">env</a> <a id="4712" href="Tactic.Derive.HsType.html#4652" class="Bound">d</a><a id="4713" class="Symbol">)</a>

  <a id="freshHsTypeName"></a><a id="4718" href="Tactic.Derive.HsType.html#4718" class="Function">freshHsTypeName</a> <a id="4734" class="Symbol">:</a> <a id="4736" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="4744" class="Symbol">→</a> <a id="4746" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4751" class="Symbol">→</a> <a id="4753" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="4756" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="4763" href="Tactic.Derive.HsType.html#4718" class="Function">freshHsTypeName</a> <a id="4779" href="Tactic.Derive.HsType.html#4779" class="Bound">env</a> <a id="4783" href="Tactic.Derive.HsType.html#4783" class="Bound">d</a> <a id="4785" class="Symbol">=</a> <a id="4787" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="4797" class="Symbol">(</a><a id="4798" href="Tactic.Derive.HsType.html#4598" class="Function">hsTypeName</a> <a id="4809" href="Tactic.Derive.HsType.html#4779" class="Bound">env</a> <a id="4813" href="Tactic.Derive.HsType.html#4783" class="Bound">d</a><a id="4814" class="Symbol">)</a>

  <a id="hsConName"></a><a id="4819" href="Tactic.Derive.HsType.html#4819" class="Function">hsConName</a> <a id="4829" class="Symbol">:</a> <a id="4831" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="4839" class="Symbol">→</a> <a id="4841" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4846" class="Symbol">→</a> <a id="4848" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="4857" href="Tactic.Derive.HsType.html#4819" class="Function">hsConName</a> <a id="4867" href="Tactic.Derive.HsType.html#4867" class="Bound">env</a> <a id="4871" href="Tactic.Derive.HsType.html#4871" class="Bound">c</a> <a id="4873" class="Symbol">=</a> <a id="4875" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="4885" class="Symbol">(</a><a id="4886" href="Tactic.Derive.HsType.html#1839" class="Function">capitalize</a> <a id="4897" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4899" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="4908" href="Tactic.Derive.HsType.html#4871" class="Bound">c</a><a id="4909" class="Symbol">)</a> <a id="4911" class="Symbol">(</a><a id="4912" href="Tactic.Derive.HsType.html#2339" class="Function">lookupConName</a> <a id="4926" href="Tactic.Derive.HsType.html#4867" class="Bound">env</a> <a id="4930" href="Tactic.Derive.HsType.html#4871" class="Bound">c</a><a id="4931" class="Symbol">)</a>

  <a id="hsFieldName"></a><a id="4936" href="Tactic.Derive.HsType.html#4936" class="Function">hsFieldName</a> <a id="4948" class="Symbol">:</a> <a id="4950" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="4958" class="Symbol">→</a> <a id="4960" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4965" class="Symbol">→</a> <a id="4967" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="4976" href="Tactic.Derive.HsType.html#4936" class="Function">hsFieldName</a> <a id="4988" href="Tactic.Derive.HsType.html#4988" class="Bound">env</a> <a id="4992" href="Tactic.Derive.HsType.html#4992" class="Bound">f</a> <a id="4994" class="Symbol">=</a> <a id="4996" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="5006" class="Symbol">(</a><a id="5007" href="Tactic.Derive.HsType.html#1932" class="Function">uncapitalize</a> <a id="5020" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5022" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="5031" href="Tactic.Derive.HsType.html#4992" class="Bound">f</a><a id="5032" class="Symbol">)</a> <a id="5034" class="Symbol">(</a><a id="5035" href="Tactic.Derive.HsType.html#2383" class="Function">lookupFieldName</a> <a id="5051" href="Tactic.Derive.HsType.html#4988" class="Bound">env</a> <a id="5055" href="Tactic.Derive.HsType.html#4992" class="Bound">f</a><a id="5056" class="Symbol">)</a>

  <a id="freshHsConName"></a><a id="5061" href="Tactic.Derive.HsType.html#5061" class="Function">freshHsConName</a> <a id="5076" class="Symbol">:</a> <a id="5078" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="5086" class="Symbol">→</a> <a id="5088" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5093" class="Symbol">→</a> <a id="5095" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5100" class="Symbol">→</a> <a id="5102" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5105" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="5112" href="Tactic.Derive.HsType.html#5061" class="Function">freshHsConName</a> <a id="5127" href="Tactic.Derive.HsType.html#5127" class="Bound">env</a> <a id="5131" href="Tactic.Derive.HsType.html#5131" class="Bound">tyName</a> <a id="5138" href="Tactic.Derive.HsType.html#5138" class="Bound">c</a> <a id="5140" class="Symbol">=</a>
    <a id="5146" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="5149" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="5158" href="Tactic.Derive.HsType.html#5138" class="Bound">c</a> <a id="5160" href="Class.DecEq.Core.html#188" class="Function Operator">==</a> <a id="5163" class="String">&quot;constructor&quot;</a>
    <a id="5181" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="5186" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5196" class="Symbol">(</a><a id="5197" href="Tactic.Derive.HsType.html#4819" class="Function">hsConName</a> <a id="5207" href="Tactic.Derive.HsType.html#5127" class="Bound">env</a> <a id="5211" href="Tactic.Derive.HsType.html#5131" class="Bound">tyName</a><a id="5217" class="Symbol">)</a> <a id="5219" class="Comment">-- Unnamed record constructor: use type name</a>
    <a id="5268" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="5273" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5283" class="Symbol">(</a><a id="5284" href="Tactic.Derive.HsType.html#4819" class="Function">hsConName</a> <a id="5294" href="Tactic.Derive.HsType.html#5127" class="Bound">env</a> <a id="5298" href="Tactic.Derive.HsType.html#5138" class="Bound">c</a><a id="5299" class="Symbol">)</a>

  <a id="isThis"></a><a id="5304" href="Tactic.Derive.HsType.html#5304" class="Function">isThis</a> <a id="5311" class="Symbol">:</a> <a id="5313" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5318" class="Symbol">→</a> <a id="5320" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5325" class="Symbol">→</a> <a id="5327" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="5334" href="Tactic.Derive.HsType.html#5304" class="Function">isThis</a> <a id="5341" href="Tactic.Derive.HsType.html#5341" class="Bound">f</a> <a id="5343" class="Symbol">(</a><a id="5344" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="5348" href="Tactic.Derive.HsType.html#5348" class="Bound">g</a> <a id="5350" class="Symbol">_)</a> <a id="5353" class="Symbol">=</a> <a id="5355" href="Tactic.Derive.HsType.html#5341" class="Bound">f</a> <a id="5357" href="Class.DecEq.Core.html#188" class="Function Operator">==</a> <a id="5360" href="Tactic.Derive.HsType.html#5348" class="Bound">g</a>
  <a id="5364" href="Tactic.Derive.HsType.html#5304" class="CatchallClause Function">isThis</a><a id="5370" class="CatchallClause"> </a><a id="5371" class="CatchallClause Symbol">_</a><a id="5372" class="CatchallClause"> </a><a id="5373" class="CatchallClause Symbol">_</a> <a id="5375" class="Symbol">=</a> <a id="5377" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

  <a id="computeHsType"></a><a id="5386" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="5400" class="Symbol">:</a> <a id="5402" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5407" class="Symbol">→</a> <a id="5409" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5414" class="Symbol">→</a> <a id="5416" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5421" class="Symbol">→</a> <a id="5423" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5426" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="5433" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="5447" href="Tactic.Derive.HsType.html#5447" class="Bound">aThis</a> <a id="5453" href="Tactic.Derive.HsType.html#5453" class="Bound">hThis</a> <a id="5459" href="Tactic.Derive.HsType.html#5459" class="Bound">tm</a> <a id="5462" class="Keyword">with</a> <a id="5467" href="Tactic.Derive.HsType.html#5304" class="Function">isThis</a> <a id="5474" href="Tactic.Derive.HsType.html#5447" class="Bound">aThis</a> <a id="5480" href="Tactic.Derive.HsType.html#5459" class="Bound">tm</a>
  <a id="5485" class="Symbol">...</a> <a id="5489" class="Symbol">|</a> <a id="5491" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="5496" class="Symbol">=</a> <a id="5498" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5503" class="Symbol">(</a><a id="5504" class="Bound">hThis</a> <a id="5510" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a><a id="5511" class="Symbol">)</a>
  <a id="5515" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="5529" href="Tactic.Derive.HsType.html#5529" class="Bound">aThis</a> <a id="5535" href="Tactic.Derive.HsType.html#5535" class="Bound">hThis</a> <a id="5541" class="Symbol">(</a><a id="5542" href="Reflection.AST.Term.html#2283" class="InductiveConstructor Operator">Π[</a> <a id="5545" href="Tactic.Derive.HsType.html#5545" class="Bound">x</a> <a id="5547" href="Reflection.AST.Term.html#2283" class="InductiveConstructor Operator">∶</a> <a id="5549" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="5553" class="Symbol">(</a><a id="5554" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">arg-info</a> <a id="5563" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="5571" class="Symbol">_)</a> <a id="5574" href="Tactic.Derive.HsType.html#5574" class="Bound">a</a> <a id="5576" href="Reflection.AST.Term.html#2283" class="InductiveConstructor Operator">]</a> <a id="5578" href="Tactic.Derive.HsType.html#5578" class="Bound">b</a><a id="5579" class="Symbol">)</a> <a id="5581" class="Symbol">|</a> <a id="5583" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="5589" class="Symbol">=</a> <a id="5591" class="Keyword">do</a>
    <a id="5598" href="Tactic.Derive.HsType.html#5598" class="Bound">dom</a> <a id="5602" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="5604" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="5618" href="Tactic.Derive.HsType.html#5529" class="Bound">aThis</a> <a id="5624" href="Tactic.Derive.HsType.html#5535" class="Bound">hThis</a> <a id="5630" href="Tactic.Derive.HsType.html#5574" class="Bound">a</a>
    <a id="5636" href="Tactic.Derive.HsType.html#5636" class="Bound">rng</a> <a id="5640" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="5642" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="5656" href="Tactic.Derive.HsType.html#5545" class="Bound">x</a> <a id="5658" class="Symbol">(</a><a id="5659" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="5664" href="Tactic.Derive.HsType.html#5574" class="Bound">a</a><a id="5665" class="Symbol">)</a> <a id="5667" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5669" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="5683" href="Tactic.Derive.HsType.html#5529" class="Bound">aThis</a> <a id="5689" href="Tactic.Derive.HsType.html#5535" class="Bound">hThis</a> <a id="5695" href="Tactic.Derive.HsType.html#5578" class="Bound">b</a>
    <a id="5701" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5706" class="Symbol">(</a><a id="5707" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">vΠ[</a> <a id="5711" href="Tactic.Derive.HsType.html#5545" class="Bound">x</a> <a id="5713" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">∶</a> <a id="5715" href="Tactic.Derive.HsType.html#5598" class="Bound">dom</a> <a id="5719" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">]</a> <a id="5721" href="Tactic.Derive.HsType.html#5636" class="Bound">rng</a><a id="5724" class="Symbol">)</a>
  <a id="5728" href="Tactic.Derive.HsType.html#5386" class="CatchallClause Function">computeHsType</a><a id="5741" class="CatchallClause"> </a><a id="5742" href="Tactic.Derive.HsType.html#5742" class="CatchallClause Bound">aThis</a><a id="5747" class="CatchallClause"> </a><a id="5748" href="Tactic.Derive.HsType.html#5748" class="CatchallClause Bound">hThis</a><a id="5753" class="CatchallClause"> </a><a id="5754" class="CatchallClause Symbol">(</a><a id="5755" href="Reflection.AST.Term.html#2283" class="CatchallClause InductiveConstructor Operator">Π[</a><a id="5757" class="CatchallClause"> </a><a id="5758" href="Tactic.Derive.HsType.html#5758" class="CatchallClause Bound">x</a><a id="5759" class="CatchallClause"> </a><a id="5760" href="Reflection.AST.Term.html#2283" class="CatchallClause InductiveConstructor Operator">∶</a><a id="5761" class="CatchallClause"> </a><a id="5762" href="Tactic.Derive.HsType.html#5762" class="CatchallClause Bound">a</a><a id="5763" class="CatchallClause"> </a><a id="5764" href="Reflection.AST.Term.html#2283" class="CatchallClause InductiveConstructor Operator">]</a><a id="5765" class="CatchallClause"> </a><a id="5766" href="Tactic.Derive.HsType.html#5766" class="CatchallClause Bound">b</a><a id="5767" class="CatchallClause Symbol">)</a><a id="5768" class="CatchallClause"> </a><a id="5769" class="CatchallClause Symbol">|</a><a id="5770" class="CatchallClause"> </a><a id="5771" href="Agda.Builtin.Bool.html#192" class="CatchallClause InductiveConstructor">false</a> <a id="5777" class="Symbol">=</a> <a id="5779" class="Keyword">do</a>
    <a id="5786" href="Tactic.Derive.HsType.html#5786" class="Bound">ty</a> <a id="5789" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="5791" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="5805" href="Tactic.Derive.HsType.html#5758" class="Bound">x</a> <a id="5807" href="Tactic.Derive.HsType.html#5762" class="Bound">a</a> <a id="5809" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5811" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="5825" href="Tactic.Derive.HsType.html#5742" class="Bound">aThis</a> <a id="5831" href="Tactic.Derive.HsType.html#5748" class="Bound">hThis</a> <a id="5837" href="Tactic.Derive.HsType.html#5766" class="Bound">b</a>
    <a id="5843" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5848" href="Tactic.Derive.HsType.html#5848" class="Bound">ty′</a> <a id="5852" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="5854" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5859" class="Symbol">(</a><a id="5860" href="Reflection.AST.DeBruijn.html#3415" class="Function">strengthen</a> <a id="5871" href="Tactic.Derive.HsType.html#5786" class="Bound">ty</a><a id="5873" class="Symbol">)</a>
      <a id="5881" class="Keyword">where</a> <a id="5887" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5895" class="Symbol">→</a> <a id="5897" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="5911" href="Tactic.Derive.HsType.html#5758" class="Bound">x</a> <a id="5913" href="Tactic.Derive.HsType.html#5762" class="Bound">a</a> <a id="5915" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5917" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="5930" class="String">&quot;%s free in computed HsType %t&quot;</a> <a id="5962" href="Tactic.Derive.HsType.html#5758" class="Bound">x</a> <a id="5964" href="Tactic.Derive.HsType.html#5786" class="Bound">ty</a>
    <a id="5971" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5976" href="Tactic.Derive.HsType.html#5848" class="Bound">ty′</a>
  <a id="5982" class="Comment">-- Hack to get recursive occurrences under lists to work</a>
  <a id="6041" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="6055" href="Tactic.Derive.HsType.html#6055" class="Bound">aThis</a> <a id="6061" href="Tactic.Derive.HsType.html#6061" class="Bound">hThis</a> <a id="6067" class="Symbol">(</a><a id="6068" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6072" class="Symbol">(</a><a id="6073" class="Keyword">quote</a> <a id="6079" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="6083" class="Symbol">)</a> <a id="6085" class="Symbol">(_</a> <a id="6088" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6090" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="6095" href="Tactic.Derive.HsType.html#6095" class="Bound">a</a> <a id="6097" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6099" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6101" class="Symbol">))</a> <a id="6104" class="Symbol">|</a> <a id="6106" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="6112" class="Symbol">=</a> <a id="6114" class="Keyword">do</a>
    <a id="6121" href="Tactic.Derive.HsType.html#6121" class="Bound">ty</a> <a id="6124" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6126" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="6140" href="Tactic.Derive.HsType.html#6055" class="Bound">aThis</a> <a id="6146" href="Tactic.Derive.HsType.html#6061" class="Bound">hThis</a> <a id="6152" href="Tactic.Derive.HsType.html#6095" class="Bound">a</a>
    <a id="6158" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6163" class="Symbol">(</a><a id="6164" class="Keyword">quote</a> <a id="6170" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6175" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="6178" href="Tactic.Derive.HsType.html#6121" class="Bound">ty</a> <a id="6181" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="6182" class="Symbol">)</a>
  <a id="6186" href="Tactic.Derive.HsType.html#5386" class="CatchallClause Function">computeHsType</a><a id="6199" class="CatchallClause"> </a><a id="6200" class="CatchallClause Symbol">_</a><a id="6201" class="CatchallClause"> </a><a id="6202" class="CatchallClause Symbol">_</a><a id="6203" class="CatchallClause"> </a><a id="6204" href="Tactic.Derive.HsType.html#6204" class="CatchallClause Bound">tm</a><a id="6206" class="CatchallClause"> </a><a id="6207" class="CatchallClause Symbol">|</a><a id="6208" class="CatchallClause"> </a><a id="6209" href="Agda.Builtin.Bool.html#192" class="CatchallClause InductiveConstructor">false</a> <a id="6215" class="Symbol">=</a> <a id="6217" class="Keyword">do</a>
    <a id="6224" href="Tactic.Derive.HsType.html#3976" class="Function">debug</a> <a id="6230" class="Number">10</a> <a id="6233" class="String">&quot;solving HsType %t&quot;</a> <a id="6253" href="Tactic.Derive.HsType.html#6204" class="Bound">tm</a>
    <a id="6260" href="Tactic.Derive.HsType.html#6260" class="Bound">ty</a> <a id="6263" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6265" href="Tactic.Derive.HsType.html#3699" class="Function">solveHsType</a> <a id="6277" href="Tactic.Derive.HsType.html#6204" class="Bound">tm</a>
    <a id="6284" href="Tactic.Derive.HsType.html#3976" class="Function">debug</a> <a id="6290" class="Number">10</a> <a id="6293" class="String">&quot;HsType %t = %t&quot;</a> <a id="6310" href="Tactic.Derive.HsType.html#6204" class="Bound">tm</a> <a id="6313" href="Tactic.Derive.HsType.html#6260" class="Bound">ty</a>
    <a id="6320" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6325" href="Tactic.Derive.HsType.html#6260" class="Bound">ty</a>

  <a id="makeHsCon"></a><a id="6331" href="Tactic.Derive.HsType.html#6331" class="Function">makeHsCon</a> <a id="6341" class="Symbol">:</a> <a id="6343" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="6351" class="Symbol">→</a> <a id="6353" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6358" class="Symbol">→</a> <a id="6360" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6365" class="Symbol">→</a> <a id="6367" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6372" class="Symbol">→</a> <a id="6374" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="6377" class="Symbol">(</a><a id="6378" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6383" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6385" href="Agda.Builtin.Reflection.html#3207" class="Datatype">Agda.Builtin.Reflection.Quantity</a> <a id="6418" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6420" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="6424" class="Symbol">)</a>
  <a id="6428" href="Tactic.Derive.HsType.html#6331" class="Function">makeHsCon</a> <a id="6438" href="Tactic.Derive.HsType.html#6438" class="Bound">env</a> <a id="6442" href="Tactic.Derive.HsType.html#6442" class="Bound">agdaName</a> <a id="6451" href="Tactic.Derive.HsType.html#6451" class="Bound">hsName</a> <a id="6458" href="Tactic.Derive.HsType.html#6458" class="Bound">c</a> <a id="6460" class="Symbol">=</a> <a id="6462" class="Keyword">do</a>
    <a id="6469" href="Tactic.Derive.HsType.html#3976" class="Function">debug</a> <a id="6475" class="Number">10</a> <a id="6478" class="String">&quot;Making constructor %q : %q&quot;</a> <a id="6507" href="Tactic.Derive.HsType.html#6458" class="Bound">c</a> <a id="6509" href="Tactic.Derive.HsType.html#6442" class="Bound">agdaName</a>
    <a id="6522" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6526" href="Tactic.Derive.HsType.html#6526" class="Bound">agdaName&#39;</a> <a id="6536" class="Symbol">_</a> <a id="6538" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6540" href="Agda.Builtin.Reflection.html#8972" class="Postulate">normalise</a> <a id="6550" class="Symbol">(</a><a id="6551" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6555" href="Tactic.Derive.HsType.html#6442" class="Bound">agdaName</a> <a id="6564" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6566" class="Symbol">)</a>
      <a id="6574" class="Keyword">where</a> <a id="6580" class="CatchallClause Symbol">_</a> <a id="6582" class="Symbol">→</a> <a id="6584" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="6597" class="String">&quot;Failed to compute source type for %q&quot;</a> <a id="6636" href="Tactic.Derive.HsType.html#6442" class="Bound">agdaName</a>
    <a id="6649" href="Tactic.Derive.HsType.html#6649" class="Bound">hsC</a>  <a id="6654" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6656" href="Tactic.Derive.HsType.html#5061" class="Function">freshHsConName</a> <a id="6671" href="Tactic.Derive.HsType.html#6438" class="Bound">env</a> <a id="6675" href="Tactic.Derive.HsType.html#6451" class="Bound">hsName</a> <a id="6682" href="Tactic.Derive.HsType.html#6458" class="Bound">c</a>
    <a id="6688" href="Tactic.Derive.HsType.html#6688" class="Bound">cTy</a>  <a id="6693" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6695" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="6703" href="Tactic.Derive.HsType.html#6458" class="Bound">c</a>
    <a id="6709" href="Tactic.Derive.HsType.html#3976" class="Function">debug</a> <a id="6715" class="Number">10</a> <a id="6718" class="String">&quot;cTy = %t&quot;</a> <a id="6729" href="Tactic.Derive.HsType.html#6688" class="Bound">cTy</a>
    <a id="6737" href="Tactic.Derive.HsType.html#6737" class="Bound">hsTy</a> <a id="6742" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6744" href="Tactic.Derive.HsType.html#5386" class="Function">computeHsType</a> <a id="6758" href="Tactic.Derive.HsType.html#6526" class="Bound">agdaName&#39;</a> <a id="6768" href="Tactic.Derive.HsType.html#6451" class="Bound">hsName</a> <a id="6775" href="Tactic.Derive.HsType.html#6688" class="Bound">cTy</a>
    <a id="6783" href="Tactic.Derive.HsType.html#3976" class="Function">debug</a> <a id="6789" class="Number">10</a> <a id="6792" class="String">&quot;hsTy = %t&quot;</a> <a id="6804" href="Tactic.Derive.HsType.html#6737" class="Bound">hsTy</a>
    <a id="6813" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6818" class="Symbol">(</a><a id="6819" href="Tactic.Derive.HsType.html#6649" class="Bound">hsC</a> <a id="6823" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6825" href="Agda.Builtin.Reflection.html#3241" class="InductiveConstructor">quantity-ω</a> <a id="6836" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6838" href="Tactic.Derive.HsType.html#6737" class="Bound">hsTy</a><a id="6842" class="Symbol">)</a>

  <a id="makeHsData"></a><a id="6847" href="Tactic.Derive.HsType.html#6847" class="Function">makeHsData</a> <a id="6858" class="Symbol">:</a> <a id="6860" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="6868" class="Symbol">→</a> <a id="6870" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6875" class="Symbol">→</a> <a id="6877" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6879" class="Symbol">→</a> <a id="6881" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6886" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6891" class="Symbol">→</a> <a id="6893" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="6896" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="6903" href="Tactic.Derive.HsType.html#6847" class="Function">makeHsData</a> <a id="6914" href="Tactic.Derive.HsType.html#6914" class="Bound">env</a> <a id="6918" href="Tactic.Derive.HsType.html#6918" class="Bound">agdaName</a> <a id="6927" href="Tactic.Derive.HsType.html#6927" class="Bound">nPars</a> <a id="6933" href="Tactic.Derive.HsType.html#6933" class="Bound">constrs</a> <a id="6941" class="Symbol">=</a> <a id="6943" class="Keyword">do</a>
    <a id="6950" href="Tactic.Derive.HsType.html#6950" class="Bound">hsName</a> <a id="6957" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6959" href="Tactic.Derive.HsType.html#4718" class="Function">freshHsTypeName</a> <a id="6975" href="Tactic.Derive.HsType.html#6914" class="Bound">env</a> <a id="6979" href="Tactic.Derive.HsType.html#6918" class="Bound">agdaName</a>
    <a id="6992" href="Agda.Builtin.Reflection.html#9556" class="Postulate">declareData</a> <a id="7004" href="Tactic.Derive.HsType.html#6950" class="Bound">hsName</a> <a id="7011" class="Number">0</a> <a id="7013" href="Reflection.Syntax.html#3423" class="InductiveConstructor">`Set</a>
    <a id="7022" href="Tactic.Derive.HsType.html#7022" class="Bound">hsCons</a> <a id="7029" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="7031" href="Class.Monad.Core.html#713" class="Function">mapM</a> <a id="7036" class="Symbol">(</a><a id="7037" href="Tactic.Derive.HsType.html#6331" class="Function">makeHsCon</a> <a id="7047" href="Tactic.Derive.HsType.html#6914" class="Bound">env</a> <a id="7051" href="Tactic.Derive.HsType.html#6918" class="Bound">agdaName</a> <a id="7060" href="Tactic.Derive.HsType.html#6950" class="Bound">hsName</a><a id="7066" class="Symbol">)</a> <a id="7068" href="Tactic.Derive.HsType.html#6933" class="Bound">constrs</a>
    <a id="7080" href="Agda.Builtin.Reflection.html#9602" class="Postulate">defineData</a> <a id="7091" href="Tactic.Derive.HsType.html#6950" class="Bound">hsName</a> <a id="7098" href="Tactic.Derive.HsType.html#7022" class="Bound">hsCons</a>
    <a id="7109" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="7114" href="Tactic.Derive.HsType.html#6950" class="Bound">hsName</a>

  <a id="makeHsType"></a><a id="7124" href="Tactic.Derive.HsType.html#7124" class="Function">makeHsType</a> <a id="7135" class="Symbol">:</a> <a id="7137" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="7145" class="Symbol">→</a> <a id="7147" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7152" class="Symbol">→</a> <a id="7154" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="7157" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="7164" href="Tactic.Derive.HsType.html#7124" class="Function">makeHsType</a> <a id="7175" href="Tactic.Derive.HsType.html#7175" class="Bound">env</a> <a id="7179" href="Tactic.Derive.HsType.html#7179" class="Bound">d</a> <a id="7181" class="Symbol">=</a> <a id="7183" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="7197" href="Tactic.Derive.HsType.html#7179" class="Bound">d</a> <a id="7199" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="7203" class="Symbol">λ</a> <a id="7205" class="Keyword">where</a>
      <a id="7217" class="Symbol">(</a><a id="7218" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="7228" href="Tactic.Derive.HsType.html#7228" class="Bound">pars</a> <a id="7233" href="Tactic.Derive.HsType.html#7233" class="Bound">cs</a><a id="7235" class="Symbol">)</a> <a id="7237" class="Symbol">→</a> <a id="7239" href="Tactic.Derive.HsType.html#6847" class="Function">makeHsData</a> <a id="7250" href="Tactic.Derive.HsType.html#7175" class="Bound">env</a> <a id="7254" href="Tactic.Derive.HsType.html#7179" class="Bound">d</a> <a id="7256" href="Tactic.Derive.HsType.html#7228" class="Bound">pars</a> <a id="7261" href="Tactic.Derive.HsType.html#7233" class="Bound">cs</a>
      <a id="7270" class="Symbol">(</a><a id="7271" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="7283" href="Tactic.Derive.HsType.html#7283" class="Bound">c</a> <a id="7285" href="Tactic.Derive.HsType.html#7285" class="Bound">fs</a><a id="7287" class="Symbol">)</a>  <a id="7290" class="Symbol">→</a> <a id="7292" href="Tactic.Derive.HsType.html#6847" class="Function">makeHsData</a> <a id="7303" href="Tactic.Derive.HsType.html#7175" class="Bound">env</a> <a id="7307" href="Tactic.Derive.HsType.html#7179" class="Bound">d</a> <a id="7309" class="Number">0</a> <a id="7311" class="Symbol">(</a><a id="7312" href="Tactic.Derive.HsType.html#7283" class="Bound">c</a> <a id="7314" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7316" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7318" class="Symbol">)</a>
      <a id="7326" class="CatchallClause Symbol">_</a>                   <a id="7346" class="Symbol">→</a> <a id="7348" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="7361" class="String">&quot;%q is not a data or record type&quot;</a> <a id="7395" href="Tactic.Derive.HsType.html#7179" class="Bound">d</a>

  <a id="joinStrings"></a><a id="7400" href="Tactic.Derive.HsType.html#7400" class="Function">joinStrings</a> <a id="7412" class="Symbol">:</a> <a id="7414" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7421" class="Symbol">→</a> <a id="7423" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7428" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7435" class="Symbol">→</a> <a id="7437" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7446" href="Tactic.Derive.HsType.html#7400" class="Function">joinStrings</a> <a id="7458" href="Tactic.Derive.HsType.html#7458" class="Bound">sep</a> <a id="7462" href="Tactic.Derive.HsType.html#7462" class="Bound">ss</a> <a id="7465" class="Symbol">=</a> <a id="7467" href="Data.List.Base.html#4148" class="Function">foldr</a> <a id="7473" href="Tactic.Derive.HsType.html#511" class="Function Operator">_&amp;_</a> <a id="7477" class="String">&quot;&quot;</a> <a id="7480" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7482" href="Data.List.Base.html#1819" class="Function">intersperse</a> <a id="7494" href="Tactic.Derive.HsType.html#7458" class="Bound">sep</a> <a id="7498" href="Tactic.Derive.HsType.html#7462" class="Bound">ss</a>

  <a id="removeUnderscore"></a><a id="7504" href="Tactic.Derive.HsType.html#7504" class="Function">removeUnderscore</a> <a id="7521" class="Symbol">:</a> <a id="7523" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7530" class="Symbol">→</a> <a id="7532" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7541" href="Tactic.Derive.HsType.html#7504" class="Function">removeUnderscore</a> <a id="7558" href="Tactic.Derive.HsType.html#7558" class="Bound">s</a> <a id="7560" class="Symbol">=</a> <a id="7562" href="Tactic.Derive.HsType.html#7400" class="Function">joinStrings</a> <a id="7574" class="String">&quot;.&quot;</a> <a id="7578" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7580" href="Data.List.Base.html#10687" class="Function">filter</a> <a id="7587" class="Symbol">(</a><a id="7588" href="Relation.Nullary.Decidable.Core.html#3011" class="Function">¬?</a> <a id="7591" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="7593" class="Symbol">(</a><a id="7594" class="String">&quot;_&quot;</a> <a id="7598" href="Class.DecEq.Core.html#159" class="Field Operator">≟_</a><a id="7600" class="Symbol">))</a>
                        <a id="7627" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7629" href="Data.List.Base.html#1634" class="Function">map</a> <a id="7633" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="7649" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7651" href="Data.List.Base.html#12599" class="Function">wordsBy</a> <a id="7659" class="Symbol">(</a><a id="7660" class="String">&#39;.&#39;</a> <a id="7664" href="Class.DecEq.Core.html#159" class="Field Operator">≟_</a><a id="7666" class="Symbol">)</a> <a id="7668" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7670" href="Data.String.Base.html#1558" class="Primitive">String.toList</a> <a id="7684" href="Tactic.Derive.HsType.html#7558" class="Bound">s</a>

  <a id="compilePragma"></a><a id="7689" href="Tactic.Derive.HsType.html#7689" class="Function">compilePragma</a> <a id="7703" class="Symbol">:</a> <a id="7705" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7710" class="Symbol">→</a> <a id="7712" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7717" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7722" class="Symbol">→</a> <a id="7724" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7733" href="Tactic.Derive.HsType.html#7689" class="Function">compilePragma</a> <a id="7747" href="Tactic.Derive.HsType.html#7747" class="Bound">d</a> <a id="7749" href="Tactic.Derive.HsType.html#7749" class="Bound">cs</a> <a id="7752" class="Symbol">=</a> <a id="7754" href="Text.Printf.html#1015" class="Function">printf</a> <a id="7761" class="String">&quot;= data %s (%s)&quot;</a> <a id="7778" class="Symbol">(</a><a id="7779" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="7788" href="Tactic.Derive.HsType.html#7747" class="Bound">d</a><a id="7789" class="Symbol">)</a> <a id="7791" class="Symbol">(</a><a id="7792" href="Tactic.Derive.HsType.html#7400" class="Function">joinStrings</a> <a id="7804" class="String">&quot; | &quot;</a> <a id="7810" class="Symbol">(</a><a id="7811" href="Data.List.Base.html#1634" class="Function">map</a> <a id="7815" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="7824" href="Tactic.Derive.HsType.html#7749" class="Bound">cs</a><a id="7826" class="Symbol">))</a>

  <a id="renderHsTypeName"></a><a id="7832" href="Tactic.Derive.HsType.html#7832" class="Function">renderHsTypeName</a> <a id="7849" class="Symbol">:</a> <a id="7851" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7856" class="Symbol">→</a> <a id="7858" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7867" href="Tactic.Derive.HsType.html#7832" class="Function">renderHsTypeName</a> <a id="7884" href="Tactic.Derive.HsType.html#7884" class="Bound">d</a> <a id="7886" class="Symbol">=</a> <a id="7888" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="7898" class="Symbol">(</a><a id="7899" class="String">&quot;MAlonzo.Code.&quot;</a> <a id="7915" href="Data.String.Base.html#2425" class="Function Operator">String.++</a> <a id="7925" href="Tactic.Derive.HsType.html#7504" class="Function">removeUnderscore</a> <a id="7942" class="Symbol">(</a><a id="7943" href="Reflection.AST.Show.html#1581" class="Primitive">R.showName</a> <a id="7954" href="Tactic.Derive.HsType.html#7884" class="Bound">d</a><a id="7955" class="Symbol">))</a> <a id="7958" class="Symbol">(</a><a id="7959" href="Tactic.Derive.HsType.html#2039" class="Function">lookup</a> <a id="7966" href="Tactic.Derive.HsType.html#7884" class="Bound">d</a> <a id="7968" href="Tactic.Derive.HsType.html#4134" class="Function">specialHsTypes</a><a id="7982" class="Symbol">)</a>

  <a id="renderHsType"></a><a id="7987" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8000" class="Symbol">:</a> <a id="8002" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8007" class="Symbol">→</a> <a id="8009" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="renderHsArgs"></a><a id="8018" href="Tactic.Derive.HsType.html#8018" class="Function">renderHsArgs</a> <a id="8031" class="Symbol">:</a> <a id="8033" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8038" class="Symbol">(</a><a id="8039" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="8043" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="8047" class="Symbol">)</a> <a id="8049" class="Symbol">→</a> <a id="8051" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8056" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

  <a id="8066" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8079" class="Symbol">(</a><a id="8080" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8084" class="Symbol">(</a><a id="8085" class="Keyword">quote</a> <a id="8091" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="8095" class="Symbol">)</a> <a id="8097" class="Symbol">(_</a> <a id="8100" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8102" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="8107" href="Tactic.Derive.HsType.html#8107" class="Bound">a</a> <a id="8109" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8111" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8113" class="Symbol">))</a> <a id="8116" class="Symbol">=</a> <a id="8118" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8125" class="String">&quot;[%s]&quot;</a> <a id="8132" class="Symbol">(</a><a id="8133" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8146" href="Tactic.Derive.HsType.html#8107" class="Bound">a</a><a id="8147" class="Symbol">)</a>
  <a id="8151" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8164" class="Symbol">(</a><a id="8165" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8169" class="Symbol">(</a><a id="8170" class="Keyword">quote</a> <a id="8176" href="Foreign.Haskell.Pair.html#534" class="Record">Pair</a><a id="8180" class="Symbol">)</a> <a id="8182" class="Symbol">(_</a> <a id="8185" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8187" class="Symbol">_</a> <a id="8189" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8191" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="8196" href="Tactic.Derive.HsType.html#8196" class="Bound">a</a> <a id="8198" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8200" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="8205" href="Tactic.Derive.HsType.html#8205" class="Bound">b</a> <a id="8207" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8209" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8211" class="Symbol">))</a> <a id="8214" class="Symbol">=</a> <a id="8216" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8223" class="String">&quot;(%s, %s)&quot;</a> <a id="8234" class="Symbol">(</a><a id="8235" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8248" href="Tactic.Derive.HsType.html#8196" class="Bound">a</a><a id="8249" class="Symbol">)</a> <a id="8251" class="Symbol">(</a><a id="8252" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8265" href="Tactic.Derive.HsType.html#8205" class="Bound">b</a><a id="8266" class="Symbol">)</a>
  <a id="8270" href="Tactic.Derive.HsType.html#7987" class="CatchallClause Function">renderHsType</a><a id="8282" class="CatchallClause"> </a><a id="8283" class="CatchallClause Symbol">(</a><a id="8284" href="Agda.Builtin.Reflection.html#5251" class="CatchallClause InductiveConstructor">def</a><a id="8287" class="CatchallClause"> </a><a id="8288" href="Tactic.Derive.HsType.html#8288" class="CatchallClause Bound">d</a><a id="8289" class="CatchallClause"> </a><a id="8290" href="Agda.Builtin.List.html#184" class="CatchallClause InductiveConstructor">[]</a><a id="8292" class="CatchallClause Symbol">)</a> <a id="8294" class="Symbol">=</a> <a id="8296" href="Tactic.Derive.HsType.html#7832" class="Function">renderHsTypeName</a> <a id="8313" href="Tactic.Derive.HsType.html#8288" class="Bound">d</a>
  <a id="8317" href="Tactic.Derive.HsType.html#7987" class="CatchallClause Function">renderHsType</a><a id="8329" class="CatchallClause"> </a><a id="8330" class="CatchallClause Symbol">(</a><a id="8331" href="Agda.Builtin.Reflection.html#5251" class="CatchallClause InductiveConstructor">def</a><a id="8334" class="CatchallClause"> </a><a id="8335" href="Tactic.Derive.HsType.html#8335" class="CatchallClause Bound">d</a><a id="8336" class="CatchallClause"> </a><a id="8337" href="Tactic.Derive.HsType.html#8337" class="CatchallClause Bound">vs</a><a id="8339" class="CatchallClause Symbol">)</a> <a id="8341" class="Symbol">=</a> <a id="8343" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8350" class="String">&quot;(%s %s)&quot;</a> <a id="8360" class="Symbol">(</a><a id="8361" href="Tactic.Derive.HsType.html#7832" class="Function">renderHsTypeName</a> <a id="8378" href="Tactic.Derive.HsType.html#8335" class="Bound">d</a><a id="8379" class="Symbol">)</a> <a id="8381" class="Symbol">(</a><a id="8382" href="Tactic.Derive.HsType.html#7400" class="Function">joinStrings</a> <a id="8394" class="String">&quot; &quot;</a> <a id="8398" class="Symbol">(</a><a id="8399" href="Tactic.Derive.HsType.html#8018" class="Function">renderHsArgs</a> <a id="8412" href="Tactic.Derive.HsType.html#8337" class="Bound">vs</a><a id="8414" class="Symbol">))</a>
  <a id="8419" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8432" class="Symbol">(</a><a id="8433" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">vΠ[</a> <a id="8437" href="Tactic.Derive.HsType.html#8437" class="Bound">s</a> <a id="8439" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">∶</a> <a id="8441" href="Tactic.Derive.HsType.html#8441" class="Bound">a</a> <a id="8443" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">]</a> <a id="8445" href="Tactic.Derive.HsType.html#8445" class="Bound">x</a><a id="8446" class="Symbol">)</a> <a id="8448" class="Symbol">=</a> <a id="8450" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8457" class="String">&quot;(%s -&gt; %s)&quot;</a> <a id="8470" class="Symbol">(</a><a id="8471" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8484" href="Tactic.Derive.HsType.html#8441" class="Bound">a</a><a id="8485" class="Symbol">)</a> <a id="8487" class="Symbol">(</a><a id="8488" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8501" href="Tactic.Derive.HsType.html#8445" class="Bound">x</a><a id="8502" class="Symbol">)</a>
  <a id="8506" href="Tactic.Derive.HsType.html#7987" class="CatchallClause Function">renderHsType</a><a id="8518" class="CatchallClause"> </a><a id="8519" href="Tactic.Derive.HsType.html#8519" class="CatchallClause Bound">t</a> <a id="8521" class="Symbol">=</a> <a id="8523" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8530" class="String">&quot;(TODO: renderHsType %s)&quot;</a> <a id="8556" class="Symbol">(</a><a id="8557" href="Class.Show.Core.html#178" class="Field">show</a> <a id="8562" href="Tactic.Derive.HsType.html#8519" class="Bound">t</a><a id="8563" class="Symbol">)</a>

  <a id="8568" href="Tactic.Derive.HsType.html#8018" class="Function">renderHsArgs</a> <a id="8581" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8584" class="Symbol">=</a> <a id="8586" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="8591" href="Tactic.Derive.HsType.html#8018" class="Function">renderHsArgs</a> <a id="8604" class="Symbol">(</a><a id="8605" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="8610" href="Tactic.Derive.HsType.html#8610" class="Bound">a</a> <a id="8612" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8614" href="Tactic.Derive.HsType.html#8614" class="Bound">as</a><a id="8616" class="Symbol">)</a> <a id="8618" class="Symbol">=</a> <a id="8620" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="8633" href="Tactic.Derive.HsType.html#8610" class="Bound">a</a> <a id="8635" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8637" href="Tactic.Derive.HsType.html#8018" class="Function">renderHsArgs</a> <a id="8650" href="Tactic.Derive.HsType.html#8614" class="Bound">as</a>
  <a id="8655" href="Tactic.Derive.HsType.html#8018" class="CatchallClause Function">renderHsArgs</a><a id="8667" class="CatchallClause"> </a><a id="8668" class="CatchallClause Symbol">(_</a><a id="8670" class="CatchallClause"> </a><a id="8671" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="8672" class="CatchallClause"> </a><a id="8673" href="Tactic.Derive.HsType.html#8673" class="CatchallClause Bound">as</a><a id="8675" class="CatchallClause Symbol">)</a> <a id="8677" class="Symbol">=</a> <a id="8679" href="Tactic.Derive.HsType.html#8018" class="Function">renderHsArgs</a> <a id="8692" href="Tactic.Derive.HsType.html#8673" class="Bound">as</a>

  <a id="canDeriveInstancesT"></a><a id="8698" href="Tactic.Derive.HsType.html#8698" class="Function">canDeriveInstancesT</a> <a id="8718" class="Symbol">:</a> <a id="8720" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8725" class="Symbol">→</a> <a id="8727" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="canDeriveInstancesA"></a><a id="8734" href="Tactic.Derive.HsType.html#8734" class="Function">canDeriveInstancesA</a> <a id="8754" class="Symbol">:</a> <a id="8756" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8761" class="Symbol">(</a><a id="8762" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="8766" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="8770" class="Symbol">)</a> <a id="8772" class="Symbol">→</a> <a id="8774" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>

  <a id="8782" href="Tactic.Derive.HsType.html#8698" class="Function">canDeriveInstancesT</a> <a id="8802" class="Symbol">(</a><a id="8803" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8807" href="Tactic.Derive.HsType.html#8807" class="Bound">d</a> <a id="8809" href="Tactic.Derive.HsType.html#8809" class="Bound">vs</a><a id="8811" class="Symbol">)</a> <a id="8813" class="Symbol">=</a> <a id="8815" href="Tactic.Derive.HsType.html#8734" class="Function">canDeriveInstancesA</a> <a id="8835" href="Tactic.Derive.HsType.html#8809" class="Bound">vs</a>
  <a id="8840" href="Tactic.Derive.HsType.html#8698" class="Function">canDeriveInstancesT</a> <a id="8860" class="Symbol">(</a><a id="8861" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">vΠ[</a> <a id="8865" href="Tactic.Derive.HsType.html#8865" class="Bound">s</a> <a id="8867" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">∶</a> <a id="8869" href="Tactic.Derive.HsType.html#8869" class="Bound">a</a> <a id="8871" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">]</a> <a id="8873" href="Tactic.Derive.HsType.html#8873" class="Bound">x</a><a id="8874" class="Symbol">)</a> <a id="8876" class="Symbol">=</a> <a id="8878" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
  <a id="8886" href="Tactic.Derive.HsType.html#8698" class="CatchallClause Function">canDeriveInstancesT</a><a id="8905" class="CatchallClause"> </a><a id="8906" href="Tactic.Derive.HsType.html#8906" class="CatchallClause Bound">t</a> <a id="8908" class="Symbol">=</a> <a id="8910" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

  <a id="8919" href="Tactic.Derive.HsType.html#8734" class="Function">canDeriveInstancesA</a> <a id="8939" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8942" class="Symbol">=</a> <a id="8944" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
  <a id="8951" href="Tactic.Derive.HsType.html#8734" class="Function">canDeriveInstancesA</a> <a id="8971" class="Symbol">(</a><a id="8972" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="8977" href="Tactic.Derive.HsType.html#8977" class="Bound">a</a> <a id="8979" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8981" href="Tactic.Derive.HsType.html#8981" class="Bound">as</a><a id="8983" class="Symbol">)</a> <a id="8985" class="Symbol">=</a> <a id="8987" href="Tactic.Derive.HsType.html#8698" class="Function">canDeriveInstancesT</a> <a id="9007" href="Tactic.Derive.HsType.html#8977" class="Bound">a</a> <a id="9009" href="Data.Bool.Base.html#995" class="Function Operator">∧</a> <a id="9011" href="Tactic.Derive.HsType.html#8734" class="Function">canDeriveInstancesA</a> <a id="9031" href="Tactic.Derive.HsType.html#8981" class="Bound">as</a>
  <a id="9036" href="Tactic.Derive.HsType.html#8734" class="CatchallClause Function">canDeriveInstancesA</a><a id="9055" class="CatchallClause"> </a><a id="9056" class="CatchallClause Symbol">(_</a><a id="9058" class="CatchallClause"> </a><a id="9059" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="9060" class="CatchallClause"> </a><a id="9061" href="Tactic.Derive.HsType.html#9061" class="CatchallClause Bound">as</a><a id="9063" class="CatchallClause Symbol">)</a> <a id="9065" class="Symbol">=</a> <a id="9067" href="Tactic.Derive.HsType.html#8734" class="Function">canDeriveInstancesA</a> <a id="9087" href="Tactic.Derive.HsType.html#9061" class="Bound">as</a>

  <a id="foreignPragma"></a><a id="9093" href="Tactic.Derive.HsType.html#9093" class="Function">foreignPragma</a> <a id="9107" class="Symbol">:</a> <a id="9109" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9114" class="Symbol">→</a> <a id="9116" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9121" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9126" class="Symbol">→</a> <a id="9128" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="9131" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="9140" href="Tactic.Derive.HsType.html#9093" class="Function">foreignPragma</a> <a id="9154" href="Tactic.Derive.HsType.html#9154" class="Bound">d</a> <a id="9156" href="Tactic.Derive.HsType.html#9156" class="Bound">cs</a> <a id="9159" class="Symbol">=</a> <a id="9161" class="Keyword">do</a>
    <a id="9168" href="Tactic.Derive.HsType.html#9168" class="Bound">cons&#39;</a> <a id="9174" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="9176" href="Class.Monad.Core.html#932" class="Function">forM</a> <a id="9181" href="Tactic.Derive.HsType.html#9156" class="Bound">cs</a> <a id="9184" class="Symbol">λ</a> <a id="9186" href="Tactic.Derive.HsType.html#9186" class="Bound">c</a> <a id="9188" class="Symbol">→</a> <a id="9190" class="Keyword">do</a>
            <a id="9205" href="Tactic.Derive.HsType.html#9205" class="Bound">tel</a> <a id="9209" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9211" class="Symbol">_</a> <a id="9213" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="9215" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="9222" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="9226" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="9234" href="Tactic.Derive.HsType.html#9186" class="Bound">c</a>
            <a id="9248" class="Keyword">let</a> <a id="9252" href="Tactic.Derive.HsType.html#9252" class="Bound">args</a> <a id="9257" class="Symbol">=</a> <a id="9259" href="Data.List.Base.html#1634" class="Function">map</a> <a id="9263" href="Reflection.AST.Abstraction.html#1816" class="Function">unAbs</a> <a id="9269" href="Tactic.Derive.HsType.html#9205" class="Bound">tel</a>
            <a id="9285" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="9290" class="Symbol">(</a>  <a id="9293" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9300" class="String">&quot;%s %s&quot;</a> <a id="9308" class="Symbol">(</a><a id="9309" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="9318" href="Tactic.Derive.HsType.html#9186" class="Bound">c</a><a id="9319" class="Symbol">)</a> <a id="9321" class="Symbol">(</a><a id="9322" href="Tactic.Derive.HsType.html#7400" class="Function">joinStrings</a> <a id="9334" class="String">&quot; &quot;</a> <a id="9338" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="9340" href="Tactic.Derive.HsType.html#8018" class="Function">renderHsArgs</a> <a id="9353" href="Tactic.Derive.HsType.html#9252" class="Bound">args</a><a id="9357" class="Symbol">)</a>
                 <a id="9376" href="Data.Product.Base.html#1686" class="Function Operator">,′</a> <a id="9379" href="Tactic.Derive.HsType.html#8734" class="Function">canDeriveInstancesA</a> <a id="9399" href="Tactic.Derive.HsType.html#9252" class="Bound">args</a> <a id="9404" class="Symbol">)</a>
    <a id="9410" class="Keyword">let</a> <a id="9414" class="Symbol">(</a><a id="9415" href="Tactic.Derive.HsType.html#9415" class="Bound">cons</a> <a id="9420" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9422" href="Tactic.Derive.HsType.html#9422" class="Bound">bs</a><a id="9424" class="Symbol">)</a> <a id="9426" class="Symbol">=</a> <a id="9428" href="Data.List.Base.html#3635" class="Function">unzip</a> <a id="9434" href="Tactic.Derive.HsType.html#9168" class="Bound">cons&#39;</a>
    <a id="9444" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="9449" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="9451" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9458" class="String">&quot;data %s = %s\n  deriving (%sGeneric)&quot;</a>
                  <a id="9515" class="Symbol">(</a><a id="9516" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="9525" href="Tactic.Derive.HsType.html#9154" class="Bound">d</a><a id="9526" class="Symbol">)</a> <a id="9528" class="Symbol">(</a><a id="9529" href="Tactic.Derive.HsType.html#7400" class="Function">joinStrings</a> <a id="9541" class="String">&quot; | &quot;</a> <a id="9547" href="Tactic.Derive.HsType.html#9415" class="Bound">cons</a><a id="9551" class="Symbol">)</a>
                  <a id="9571" class="Symbol">(</a><a id="9572" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="9575" href="Data.List.Base.html#4249" class="Function">foldl</a> <a id="9581" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="9585" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="9590" href="Tactic.Derive.HsType.html#9422" class="Bound">bs</a> <a id="9593" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="9598" class="String">&quot;Show, Eq, &quot;</a> <a id="9611" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="9616" class="String">&quot;&quot;</a> <a id="9619" class="Symbol">)</a>

  <a id="9624" class="Comment">-- Record types</a>
  <a id="foreignPragmaRec"></a><a id="9642" href="Tactic.Derive.HsType.html#9642" class="Function">foreignPragmaRec</a> <a id="9659" class="Symbol">:</a> <a id="9661" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="9669" class="Symbol">→</a> <a id="9671" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9676" class="Symbol">→</a> <a id="9678" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9683" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9688" class="Symbol">→</a> <a id="9690" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9695" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9700" class="Symbol">→</a> <a id="9702" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="9705" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="9714" href="Tactic.Derive.HsType.html#9642" class="Function">foreignPragmaRec</a> <a id="9731" class="Symbol">_</a> <a id="9733" href="Tactic.Derive.HsType.html#9733" class="Bound">d</a> <a id="9735" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="9738" class="Symbol">_</a> <a id="9740" class="Symbol">=</a> <a id="9742" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="9755" class="String">&quot;impossible: %q is a record type with no constructors&quot;</a> <a id="9810" href="Tactic.Derive.HsType.html#9733" class="Bound">d</a>
  <a id="9814" href="Tactic.Derive.HsType.html#9642" class="Function">foreignPragmaRec</a> <a id="9831" href="Tactic.Derive.HsType.html#9831" class="Bound">env</a> <a id="9835" href="Tactic.Derive.HsType.html#9835" class="Bound">d</a> <a id="9837" class="Symbol">(</a><a id="9838" href="Tactic.Derive.HsType.html#9838" class="Bound">c</a> <a id="9840" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="9842" class="Symbol">_)</a> <a id="9845" href="Tactic.Derive.HsType.html#9845" class="Bound">fs</a> <a id="9848" class="Symbol">=</a> <a id="9850" class="Keyword">do</a>
    <a id="9857" href="Tactic.Derive.HsType.html#9857" class="Bound">tel</a> <a id="9861" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9863" class="Symbol">_</a> <a id="9865" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="9867" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="9874" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="9878" href="Agda.Builtin.Reflection.html#10159" class="Postulate">withNormalisation</a> <a id="9896" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="9901" class="Symbol">(</a><a id="9902" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="9910" href="Tactic.Derive.HsType.html#9838" class="Bound">c</a><a id="9911" class="Symbol">)</a>
    <a id="9917" class="Keyword">let</a> <a id="9921" href="Tactic.Derive.HsType.html#9921" class="Bound">fNames</a> <a id="9928" class="Symbol">=</a> <a id="9930" href="Data.List.Base.html#1634" class="Function">map</a> <a id="9934" class="Symbol">(</a><a id="9935" href="Tactic.Derive.HsType.html#4936" class="Function">hsFieldName</a> <a id="9947" href="Tactic.Derive.HsType.html#9831" class="Bound">env</a><a id="9950" class="Symbol">)</a> <a id="9952" href="Tactic.Derive.HsType.html#9845" class="Bound">fs</a>
    <a id="9959" class="Keyword">let</a> <a id="9963" href="Tactic.Derive.HsType.html#9963" class="Bound">args</a> <a id="9968" class="Symbol">=</a> <a id="9970" href="Data.List.Base.html#1634" class="Function">map</a> <a id="9974" href="Reflection.AST.Abstraction.html#1816" class="Function">unAbs</a> <a id="9980" href="Tactic.Derive.HsType.html#9857" class="Bound">tel</a>
        <a id="9992" href="Tactic.Derive.HsType.html#9992" class="Bound">renderField</a> <a id="10004" href="Tactic.Derive.HsType.html#10004" class="Bound">f</a> <a id="10006" href="Tactic.Derive.HsType.html#10006" class="Bound">ty</a> <a id="10009" class="Symbol">=</a> <a id="10011" href="Text.Printf.html#1015" class="Function">printf</a> <a id="10018" class="String">&quot;%s :: %s&quot;</a> <a id="10029" href="Tactic.Derive.HsType.html#10004" class="Bound">f</a> <a id="10031" class="Symbol">(</a><a id="10032" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="10045" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="10047" href="Reflection.AST.Argument.html#2658" class="Function">unArg</a> <a id="10053" href="Tactic.Derive.HsType.html#10006" class="Bound">ty</a><a id="10055" class="Symbol">)</a>
        <a id="10065" href="Tactic.Derive.HsType.html#10065" class="Bound">con</a> <a id="10069" class="Symbol">=</a> <a id="10071" href="Text.Printf.html#1015" class="Function">printf</a> <a id="10078" class="String">&quot;%s {%s}&quot;</a> <a id="10088" class="Symbol">(</a><a id="10089" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="10098" href="Tactic.Derive.HsType.html#9838" class="Bound">c</a><a id="10099" class="Symbol">)</a> <a id="10101" class="Symbol">(</a><a id="10102" href="Tactic.Derive.HsType.html#7400" class="Function">joinStrings</a> <a id="10114" class="String">&quot;, &quot;</a> <a id="10119" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="10121" href="Data.List.Base.html#2734" class="Function">zipWith</a> <a id="10129" href="Tactic.Derive.HsType.html#9992" class="Bound">renderField</a> <a id="10141" href="Tactic.Derive.HsType.html#9921" class="Bound">fNames</a> <a id="10148" href="Tactic.Derive.HsType.html#9963" class="Bound">args</a><a id="10152" class="Symbol">)</a>
    <a id="10158" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="10163" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="10165" href="Text.Printf.html#1015" class="Function">printf</a> <a id="10172" class="String">&quot;data %s = %s\n  deriving (%sGeneric)&quot;</a>
                  <a id="10229" class="Symbol">(</a><a id="10230" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="10239" href="Tactic.Derive.HsType.html#9835" class="Bound">d</a><a id="10240" class="Symbol">)</a> <a id="10242" href="Tactic.Derive.HsType.html#10065" class="Bound">con</a>
                  <a id="10264" class="Symbol">(</a><a id="10265" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="10268" href="Tactic.Derive.HsType.html#8734" class="Function">canDeriveInstancesA</a> <a id="10288" href="Tactic.Derive.HsType.html#9963" class="Bound">args</a> <a id="10293" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="10298" class="String">&quot;Show, Eq, &quot;</a> <a id="10311" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="10316" class="String">&quot;&quot;</a><a id="10318" class="Symbol">)</a>

  <a id="hsImports"></a><a id="10323" href="Tactic.Derive.HsType.html#10323" class="Function">hsImports</a> <a id="10333" class="Symbol">:</a> <a id="10335" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="10344" href="Tactic.Derive.HsType.html#10323" class="Function">hsImports</a> <a id="10354" class="Symbol">=</a> <a id="10356" class="String">&quot;import GHC.Generics (Generic)&quot;</a>

  <a id="10391" class="Comment">-- Take the name of a simple data type and generate the COMPILE and</a>
  <a id="10461" class="Comment">-- FOREIGN pragmas to bind to Haskell.</a>
  <a id="bindHsType"></a><a id="10502" href="Tactic.Derive.HsType.html#10502" class="Function">bindHsType</a> <a id="10513" class="Symbol">:</a> <a id="10515" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="10523" class="Symbol">→</a> <a id="10525" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10530" class="Symbol">→</a> <a id="10532" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10537" class="Symbol">→</a> <a id="10539" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="10542" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="10546" href="Tactic.Derive.HsType.html#10502" class="Function">bindHsType</a> <a id="10557" href="Tactic.Derive.HsType.html#10557" class="Bound">env</a> <a id="10561" href="Tactic.Derive.HsType.html#10561" class="Bound">agdaName</a> <a id="10570" href="Tactic.Derive.HsType.html#10570" class="Bound">hsName</a> <a id="10577" class="Symbol">=</a> <a id="10579" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="10593" href="Tactic.Derive.HsType.html#10570" class="Bound">hsName</a> <a id="10600" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="10604" class="Symbol">λ</a> <a id="10606" class="Keyword">where</a>
    <a id="10616" class="Symbol">(</a><a id="10617" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="10627" href="Tactic.Derive.HsType.html#10627" class="Bound">pars</a> <a id="10632" href="Tactic.Derive.HsType.html#10632" class="Bound">cs</a><a id="10634" class="Symbol">)</a> <a id="10636" class="Symbol">→</a> <a id="10638" class="Keyword">do</a>
      <a id="10647" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10661" class="String">&quot;GHC&quot;</a> <a id="10667" href="Tactic.Derive.HsType.html#10323" class="Function">hsImports</a>
      <a id="10683" href="Agda.Builtin.Reflection.html#9970" class="Postulate">pragmaCompile</a> <a id="10697" class="String">&quot;GHC&quot;</a> <a id="10703" href="Tactic.Derive.HsType.html#10570" class="Bound">hsName</a> <a id="10710" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="10712" href="Tactic.Derive.HsType.html#7689" class="Function">compilePragma</a> <a id="10726" href="Tactic.Derive.HsType.html#10570" class="Bound">hsName</a> <a id="10733" href="Tactic.Derive.HsType.html#10632" class="Bound">cs</a>
      <a id="10742" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="10756" href="Tactic.Derive.HsType.html#10561" class="Bound">agdaName</a> <a id="10765" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="10769" class="Symbol">λ</a> <a id="10771" class="Keyword">where</a>
        <a id="10785" class="Symbol">(</a><a id="10786" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="10796" class="Symbol">_</a> <a id="10798" class="Symbol">_)</a>    <a id="10804" class="Symbol">→</a> <a id="10806" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10820" class="String">&quot;GHC&quot;</a> <a id="10826" href="Class.Monad.Core.html#379" class="Function Operator">=&lt;&lt;</a> <a id="10830" href="Tactic.Derive.HsType.html#9093" class="Function">foreignPragma</a> <a id="10844" href="Tactic.Derive.HsType.html#10570" class="Bound">hsName</a> <a id="10851" href="Tactic.Derive.HsType.html#10632" class="Bound">cs</a>
        <a id="10862" class="Symbol">(</a><a id="10863" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="10875" class="Symbol">_</a> <a id="10877" href="Tactic.Derive.HsType.html#10877" class="Bound">fs</a><a id="10879" class="Symbol">)</a> <a id="10881" class="Symbol">→</a> <a id="10883" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10897" class="String">&quot;GHC&quot;</a> <a id="10903" href="Class.Monad.Core.html#379" class="Function Operator">=&lt;&lt;</a> <a id="10907" href="Tactic.Derive.HsType.html#9642" class="Function">foreignPragmaRec</a> <a id="10924" href="Tactic.Derive.HsType.html#10557" class="Bound">env</a> <a id="10928" href="Tactic.Derive.HsType.html#10570" class="Bound">hsName</a> <a id="10935" href="Tactic.Derive.HsType.html#10632" class="Bound">cs</a> <a id="10938" class="Symbol">(</a><a id="10939" href="Data.List.Base.html#1634" class="Function">map</a> <a id="10943" href="Reflection.AST.Argument.html#2658" class="Function">unArg</a> <a id="10949" href="Tactic.Derive.HsType.html#10877" class="Bound">fs</a><a id="10951" class="Symbol">)</a>
        <a id="10961" class="CatchallClause Symbol">_</a> <a id="10963" class="Symbol">→</a> <a id="10965" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="10978" class="String">&quot;%q is not a data or record type&quot;</a> <a id="11012" href="Tactic.Derive.HsType.html#10561" class="Bound">agdaName</a>
    <a id="11025" class="CatchallClause Symbol">_</a> <a id="11027" class="Symbol">→</a> <a id="11029" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="11042" class="String">&quot;%q is not a data type (impossible)&quot;</a> <a id="11079" href="Tactic.Derive.HsType.html#10570" class="Bound">hsName</a>

  <a id="computeProjections"></a><a id="11089" href="Tactic.Derive.HsType.html#11089" class="Function">computeProjections</a> <a id="11108" class="Symbol">:</a> <a id="11110" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="11112" class="Symbol">→</a> <a id="11114" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11119" class="Symbol">→</a> <a id="11121" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11124" class="Symbol">(</a><a id="11125" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="11130" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="11134" class="Symbol">)</a>
  <a id="11138" href="Tactic.Derive.HsType.html#11089" class="Function">computeProjections</a> <a id="11157" href="Tactic.Derive.HsType.html#11157" class="Bound">npars</a> <a id="11163" href="Tactic.Derive.HsType.html#11163" class="Bound">c</a> <a id="11165" class="Symbol">=</a> <a id="11167" class="Keyword">do</a>
    <a id="11174" href="Tactic.Derive.HsType.html#11174" class="Bound">argTys</a> <a id="11181" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="11183" class="Symbol">_</a> <a id="11185" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="11187" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="11194" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="11198" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="11206" href="Tactic.Derive.HsType.html#11163" class="Bound">c</a>
    <a id="11212" class="Keyword">let</a> <a id="11216" href="Tactic.Derive.HsType.html#11216" class="Bound">is</a>  <a id="11220" class="Symbol">=</a> <a id="11222" href="Data.List.Base.html#6728" class="Function">downFrom</a> <a id="11231" class="Symbol">(</a><a id="11232" href="Data.List.Base.html#5044" class="Function">length</a> <a id="11239" href="Tactic.Derive.HsType.html#11174" class="Bound">argTys</a><a id="11245" class="Symbol">)</a>
        <a id="11255" href="Tactic.Derive.HsType.html#11255" class="Bound">tel</a> <a id="11259" class="Symbol">=</a> <a id="11261" href="Data.List.Base.html#1634" class="Function">map</a> <a id="11265" class="Symbol">(λ</a> <a id="11268" class="Keyword">where</a> <a id="11274" class="Symbol">(</a><a id="11275" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="11279" href="Tactic.Derive.HsType.html#11279" class="Bound">x</a> <a id="11281" href="Tactic.Derive.HsType.html#11281" class="Bound">ty</a><a id="11283" class="Symbol">)</a> <a id="11285" class="Symbol">→</a> <a id="11287" href="Tactic.Derive.HsType.html#11279" class="Bound">x</a> <a id="11289" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="11291" href="Tactic.Derive.HsType.html#11281" class="Bound">ty</a><a id="11293" class="Symbol">)</a> <a id="11295" href="Tactic.Derive.HsType.html#11174" class="Bound">argTys</a>
        <a id="11310" href="Tactic.Derive.HsType.html#11310" class="Bound">lhs</a> <a id="11314" class="Symbol">=</a> <a id="11316" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="11321" class="Symbol">(</a><a id="11322" href="Agda.Builtin.Reflection.html#5814" class="InductiveConstructor">con</a> <a id="11326" href="Tactic.Derive.HsType.html#11163" class="Bound">c</a> <a id="11328" class="Symbol">(</a><a id="11329" href="Data.List.Base.html#1634" class="Function">map</a> <a id="11333" class="Symbol">(λ</a> <a id="11336" class="Keyword">where</a> <a id="11342" class="Symbol">(</a><a id="11343" href="Tactic.Derive.HsType.html#11343" class="Bound">i</a> <a id="11345" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="11347" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="11351" href="Tactic.Derive.HsType.html#11351" class="Bound">x</a> <a id="11353" class="Symbol">(</a><a id="11354" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="11358" href="Tactic.Derive.HsType.html#11358" class="Bound">info</a> <a id="11363" class="Symbol">_))</a> <a id="11367" class="Symbol">→</a> <a id="11369" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="11373" href="Tactic.Derive.HsType.html#11358" class="Bound">info</a> <a id="11378" class="Symbol">(</a><a id="11379" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">var</a> <a id="11383" href="Tactic.Derive.HsType.html#11343" class="Bound">i</a><a id="11384" class="Symbol">))</a>
                               <a id="11418" class="Symbol">(</a><a id="11419" href="Data.List.Base.html#8807" class="Function">drop</a> <a id="11424" href="Tactic.Derive.HsType.html#11157" class="Bound">npars</a> <a id="11430" class="Symbol">(</a><a id="11431" href="Data.List.Base.html#3506" class="Function">zip</a> <a id="11435" href="Tactic.Derive.HsType.html#11216" class="Bound">is</a> <a id="11438" href="Tactic.Derive.HsType.html#11174" class="Bound">argTys</a><a id="11444" class="Symbol">))))</a> <a id="11449" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="11451" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="11458" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="11465" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="11467" href="Data.List.Base.html#1634" class="Function">map</a> <a id="11471" class="Symbol">(λ</a> <a id="11474" href="Tactic.Derive.HsType.html#11474" class="Bound">i</a> <a id="11476" class="Symbol">→</a> <a id="11478" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="11486" class="Symbol">(</a><a id="11487" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="11494" href="Tactic.Derive.HsType.html#11255" class="Bound">tel</a> <a id="11498" href="Tactic.Derive.HsType.html#11310" class="Bound">lhs</a> <a id="11502" class="Symbol">(</a><a id="11503" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="11507" href="Tactic.Derive.HsType.html#11474" class="Bound">i</a> <a id="11509" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="11511" class="Symbol">)</a> <a id="11513" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="11515" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="11517" class="Symbol">)</a> <a id="11519" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="11521" class="Symbol">)</a> <a id="11523" class="Symbol">(</a><a id="11524" href="Data.List.Base.html#8807" class="Function">drop</a> <a id="11529" href="Tactic.Derive.HsType.html#11157" class="Bound">npars</a> <a id="11535" href="Tactic.Derive.HsType.html#11216" class="Bound">is</a><a id="11537" class="Symbol">)</a>

  <a id="makeTypeAlias"></a><a id="11542" href="Tactic.Derive.HsType.html#11542" class="Function">makeTypeAlias</a> <a id="11556" class="Symbol">:</a> <a id="11558" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11563" class="Symbol">→</a> <a id="11565" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="11573" class="Symbol">→</a> <a id="11575" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11580" class="Symbol">→</a> <a id="11582" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11585" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11589" href="Tactic.Derive.HsType.html#11542" class="Function">makeTypeAlias</a> <a id="11603" href="Tactic.Derive.HsType.html#11603" class="Bound">agdaName</a> <a id="11612" href="Tactic.Derive.HsType.html#11612" class="Bound">env</a> <a id="11616" href="Tactic.Derive.HsType.html#11616" class="Bound">hole</a> <a id="11621" class="Symbol">=</a> <a id="11623" class="Keyword">do</a>
    <a id="11630" href="Tactic.Derive.HsType.html#11630" class="Bound">hsTy</a> <a id="11635" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="11637" href="Tactic.Derive.HsType.html#3699" class="Function">solveHsType</a> <a id="11649" class="Symbol">(</a><a id="11650" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="11654" href="Tactic.Derive.HsType.html#11603" class="Bound">agdaName</a> <a id="11663" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="11665" class="Symbol">)</a>
    <a id="11671" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="11685" class="String">&quot;GHC&quot;</a> <a id="11691" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="11693" href="Text.Printf.html#1015" class="Function">printf</a> <a id="11700" class="String">&quot;type %s = %s&quot;</a> <a id="11715" class="Symbol">(</a><a id="11716" href="Tactic.Derive.HsType.html#4598" class="Function">hsTypeName</a> <a id="11727" href="Tactic.Derive.HsType.html#11612" class="Bound">env</a> <a id="11731" href="Tactic.Derive.HsType.html#11603" class="Bound">agdaName</a><a id="11739" class="Symbol">)</a> <a id="11741" class="Symbol">(</a><a id="11742" href="Tactic.Derive.HsType.html#7987" class="Function">renderHsType</a> <a id="11755" href="Tactic.Derive.HsType.html#11630" class="Bound">hsTy</a><a id="11759" class="Symbol">)</a>
    <a id="11765" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="11771" href="Tactic.Derive.HsType.html#11616" class="Bound">hole</a> <a id="11776" class="Symbol">(</a><a id="11777" class="Keyword">quote</a> <a id="11783" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="11790" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="11793" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="11797" class="Symbol">(</a><a id="11798" class="Keyword">quote</a> <a id="11804" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="11806" class="Symbol">)</a> <a id="11808" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="11811" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="11812" class="Symbol">)</a>

<a id="11815" class="Comment">-- * Exported macros</a>

<a id="doAutoHsType"></a><a id="11837" href="Tactic.Derive.HsType.html#11837" class="Function">doAutoHsType</a> <a id="11850" class="Symbol">:</a> <a id="11852" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="11860" class="Symbol">→</a> <a id="11862" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11867" class="Symbol">→</a> <a id="11869" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11874" class="Symbol">→</a> <a id="11876" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11879" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="11884" href="Tactic.Derive.HsType.html#11837" class="Function">doAutoHsType</a> <a id="11897" href="Tactic.Derive.HsType.html#11897" class="Bound">env</a> <a id="11901" href="Tactic.Derive.HsType.html#11901" class="Bound">d</a> <a id="11903" href="Tactic.Derive.HsType.html#11903" class="Bound">hole</a> <a id="11908" class="Symbol">=</a> <a id="11910" class="Keyword">do</a>
  <a id="11915" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="11925" href="Tactic.Derive.HsType.html#11903" class="Bound">hole</a> <a id="11930" class="Symbol">(</a><a id="11931" class="Keyword">quote</a> <a id="11937" href="Class.HasHsType.Core.html#69" class="Record">HasHsType</a> <a id="11947" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="11950" href="Tactic.Derive.HsType.html#11901" class="Bound">d</a> <a id="11952" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a> <a id="11954" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="11955" class="Symbol">)</a>
  <a id="11959" href="Tactic.Derive.HsType.html#11959" class="Bound">hs</a> <a id="11962" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="11964" href="Tactic.Derive.HsType.html#7124" class="Function">makeHsType</a> <a id="11975" href="Tactic.Derive.HsType.html#11897" class="Bound">env</a> <a id="11979" href="Tactic.Derive.HsType.html#11901" class="Bound">d</a>
  <a id="11983" href="Tactic.Derive.HsType.html#3976" class="Function">debug</a> <a id="11989" class="Number">50</a> <a id="11992" class="String">&quot;  HsType %q = %q&quot;</a> <a id="12011" href="Tactic.Derive.HsType.html#11901" class="Bound">d</a> <a id="12013" href="Tactic.Derive.HsType.html#11959" class="Bound">hs</a>
  <a id="12018" href="Tactic.Derive.HsType.html#10502" class="Function">bindHsType</a> <a id="12029" href="Tactic.Derive.HsType.html#11897" class="Bound">env</a> <a id="12033" href="Tactic.Derive.HsType.html#11901" class="Bound">d</a> <a id="12035" href="Tactic.Derive.HsType.html#11959" class="Bound">hs</a>
  <a id="12040" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="12046" href="Tactic.Derive.HsType.html#11903" class="Bound">hole</a> <a id="12051" class="Symbol">(</a><a id="12052" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">`λ⟦</a> <a id="12056" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="12061" class="Symbol">(</a><a id="12062" class="Keyword">quote</a> <a id="12068" href="Class.HasHsType.Core.html#112" class="Field">HasHsType.HsType</a><a id="12084" class="Symbol">)</a> <a id="12086" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⇒</a> <a id="12088" href="Tactic.Derive.HsType.html#11959" class="Bound">hs</a> <a id="12091" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a> <a id="12093" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⟧</a><a id="12094" class="Symbol">)</a>
  <a id="12098" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="12103" class="Symbol">(</a><a id="12104" href="Tactic.Derive.HsType.html#11959" class="Bound">hs</a> <a id="12107" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a><a id="12108" class="Symbol">)</a>

<a id="12111" class="Keyword">macro</a>
  <a id="autoHsType"></a><a id="12119" href="Tactic.Derive.HsType.html#12119" class="Function">autoHsType</a> <a id="12130" class="Symbol">:</a> <a id="12132" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12137" class="Symbol">→</a> <a id="12139" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12144" class="Symbol">→</a> <a id="12146" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12149" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12153" href="Tactic.Derive.HsType.html#12119" class="Function">autoHsType</a> <a id="12164" href="Tactic.Derive.HsType.html#12164" class="Bound">d</a> <a id="12166" href="Tactic.Derive.HsType.html#12166" class="Bound">hole</a> <a id="12171" class="Symbol">=</a> <a id="12173" class="Symbol">_</a> <a id="12175" href="Class.Functor.Core.html#279" class="Function Operator">&lt;$</a> <a id="12178" href="Tactic.Derive.HsType.html#11837" class="Function">doAutoHsType</a> <a id="12191" href="Tactic.Derive.HsType.html#2428" class="Function">emptyEnv</a> <a id="12200" href="Tactic.Derive.HsType.html#12164" class="Bound">d</a> <a id="12202" href="Tactic.Derive.HsType.html#12166" class="Bound">hole</a>

  <a id="12210" class="Keyword">infix</a> <a id="12216" class="Number">0</a> <a id="12218" href="Tactic.Derive.HsType.html#12234" class="Function Operator">autoHsType_⊣_</a>
  <a id="autoHsType_⊣_"></a><a id="12234" href="Tactic.Derive.HsType.html#12234" class="Function Operator">autoHsType_⊣_</a> <a id="12248" class="Symbol">:</a> <a id="12250" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12255" class="Symbol">→</a> <a id="12257" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="12265" class="Symbol">→</a> <a id="12267" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12272" class="Symbol">→</a> <a id="12274" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12277" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12281" href="Tactic.Derive.HsType.html#12234" class="Function Operator">autoHsType_⊣_</a> <a id="12295" href="Tactic.Derive.HsType.html#12295" class="Bound">d</a> <a id="12297" href="Tactic.Derive.HsType.html#12297" class="Bound">env</a> <a id="12301" href="Tactic.Derive.HsType.html#12301" class="Bound">hole</a> <a id="12306" class="Symbol">=</a> <a id="12308" class="Symbol">_</a> <a id="12310" href="Class.Functor.Core.html#279" class="Function Operator">&lt;$</a> <a id="12313" href="Tactic.Derive.HsType.html#11837" class="Function">doAutoHsType</a> <a id="12326" href="Tactic.Derive.HsType.html#12297" class="Bound">env</a> <a id="12330" href="Tactic.Derive.HsType.html#12295" class="Bound">d</a> <a id="12332" href="Tactic.Derive.HsType.html#12301" class="Bound">hole</a>

  <a id="12340" class="Keyword">infix</a> <a id="12346" class="Number">9</a> <a id="12348" href="Tactic.Derive.HsType.html#12354" class="Function Operator">_↦_</a>
  <a id="_↦_"></a><a id="12354" href="Tactic.Derive.HsType.html#12354" class="Function Operator">_↦_</a> <a id="12358" class="Symbol">:</a> <a id="12360" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12365" class="Symbol">→</a> <a id="12367" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="12374" class="Symbol">→</a> <a id="12376" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12381" class="Symbol">→</a> <a id="12383" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12386" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12390" href="Tactic.Derive.HsType.html#12390" class="Bound">x</a> <a id="12392" href="Tactic.Derive.HsType.html#12354" class="Function Operator">↦</a> <a id="12394" href="Tactic.Derive.HsType.html#12394" class="Bound">s</a> <a id="12396" class="Symbol">=</a> <a id="12398" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="12404" class="Symbol">(</a><a id="12405" class="Keyword">quote</a> <a id="12411" href="Tactic.Derive.HsType.html#2619" class="Function">customName</a> <a id="12422" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="12425" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="12429" class="Symbol">(</a><a id="12430" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="12435" href="Tactic.Derive.HsType.html#12390" class="Bound">x</a><a id="12436" class="Symbol">)</a> <a id="12438" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="12440" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="12444" class="Symbol">(</a><a id="12445" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">string</a> <a id="12452" href="Tactic.Derive.HsType.html#12394" class="Bound">s</a><a id="12453" class="Symbol">)</a> <a id="12455" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a><a id="12456" class="Symbol">)</a>

  <a id="12461" class="Comment">-- Generate a Haskell type synonym for the HsType of the given type</a>
  <a id="12531" class="Comment">-- Usage `unquoteDecl = do hsTypeSynonym Foo; hsTypeSynonym Bar`</a>
  <a id="hsTypeAlias"></a><a id="12598" href="Tactic.Derive.HsType.html#12598" class="Function">hsTypeAlias</a> <a id="12610" class="Symbol">:</a> <a id="12612" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12617" class="Symbol">→</a> <a id="12619" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12624" class="Symbol">→</a> <a id="12626" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12629" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12633" href="Tactic.Derive.HsType.html#12598" class="Function">hsTypeAlias</a> <a id="12645" href="Tactic.Derive.HsType.html#12645" class="Bound">agdaName</a> <a id="12654" class="Symbol">=</a> <a id="12656" href="Tactic.Derive.HsType.html#11542" class="Function">makeTypeAlias</a> <a id="12670" href="Tactic.Derive.HsType.html#12645" class="Bound">agdaName</a> <a id="12679" href="Tactic.Derive.HsType.html#2428" class="Function">emptyEnv</a>

  <a id="12691" class="Comment">-- The only NameEnv that&#39;s useful here is `withName`.</a>
  <a id="hsTypeAlias_⊣_"></a><a id="12747" href="Tactic.Derive.HsType.html#12747" class="Function Operator">hsTypeAlias_⊣_</a> <a id="12762" class="Symbol">:</a> <a id="12764" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12769" class="Symbol">→</a> <a id="12771" href="Tactic.Derive.HsType.html#1552" class="Record">NameEnv</a> <a id="12779" class="Symbol">→</a> <a id="12781" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12786" class="Symbol">→</a> <a id="12788" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12791" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12795" href="Tactic.Derive.HsType.html#12747" class="Function Operator">hsTypeAlias</a> <a id="12807" href="Tactic.Derive.HsType.html#12807" class="Bound">agdaName</a> <a id="12816" href="Tactic.Derive.HsType.html#12747" class="Function Operator">⊣</a> <a id="12818" href="Tactic.Derive.HsType.html#12818" class="Bound">env</a> <a id="12822" class="Symbol">=</a> <a id="12824" href="Tactic.Derive.HsType.html#11542" class="Function">makeTypeAlias</a> <a id="12838" href="Tactic.Derive.HsType.html#12807" class="Bound">agdaName</a> <a id="12847" href="Tactic.Derive.HsType.html#12818" class="Bound">env</a>

  <a id="12854" class="Comment">-- * Macros for constructing and deconstructing generated types</a>

  <a id="hsCon"></a><a id="12921" href="Tactic.Derive.HsType.html#12921" class="Function">hsCon</a> <a id="12927" class="Symbol">:</a> <a id="12929" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12934" class="Symbol">→</a> <a id="12936" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="12938" class="Symbol">→</a> <a id="12940" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12945" class="Symbol">→</a> <a id="12947" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12950" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12954" href="Tactic.Derive.HsType.html#12921" class="Function">hsCon</a> <a id="12960" href="Tactic.Derive.HsType.html#12960" class="Bound">agdaTy</a> <a id="12967" href="Tactic.Derive.HsType.html#12967" class="Bound">i</a> <a id="12969" href="Tactic.Derive.HsType.html#12969" class="Bound">hole</a> <a id="12974" class="Symbol">=</a> <a id="12976" class="Keyword">do</a>
    <a id="12983" href="Tactic.Derive.HsType.html#12983" class="Bound">hsTy</a><a id="12987" class="Symbol">@(</a><a id="12989" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="12993" href="Tactic.Derive.HsType.html#12993" class="Bound">hsName</a> <a id="13000" class="Symbol">_)</a> <a id="13003" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="13005" href="Tactic.Derive.HsType.html#3699" class="Function">solveHsType</a> <a id="13017" href="Tactic.Derive.HsType.html#12960" class="Bound">agdaTy</a>
      <a id="13030" class="Keyword">where</a> <a id="13036" class="CatchallClause Symbol">_</a> <a id="13038" class="Symbol">→</a> <a id="13040" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13053" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="13086" href="Tactic.Derive.HsType.html#12960" class="Bound">agdaTy</a>
    <a id="13097" href="Tactic.Derive.HsType.html#13097" class="Bound">cs</a> <a id="13100" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="13102" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="13116" href="Tactic.Derive.HsType.html#12993" class="Bound">hsName</a> <a id="13123" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="13127" class="Symbol">λ</a> <a id="13129" class="Keyword">where</a>
      <a id="13141" class="Symbol">(</a><a id="13142" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="13152" class="Symbol">_</a> <a id="13154" href="Tactic.Derive.HsType.html#13154" class="Bound">cs</a><a id="13156" class="Symbol">)</a>  <a id="13159" class="Symbol">→</a> <a id="13161" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="13168" href="Tactic.Derive.HsType.html#13154" class="Bound">cs</a>
      <a id="13177" class="CatchallClause Symbol">_</a> <a id="13179" class="Symbol">→</a> <a id="13181" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13194" class="String">&quot;Expected HsType %t to be a data type, but got %t&quot;</a> <a id="13245" href="Tactic.Derive.HsType.html#12960" class="Bound">agdaTy</a> <a id="13252" href="Tactic.Derive.HsType.html#12983" class="Bound">hsTy</a>
    <a id="13261" href="Tactic.Derive.HsType.html#13261" class="Bound">c</a> <a id="13263" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="13265" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a> <a id="13272" href="Class.Monad.Core.html#269" class="Field">return</a>  <a id="13280" class="Symbol">(</a><a id="13281" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13294" class="String">&quot;%q has only %u constructors&quot;</a> <a id="13324" href="Tactic.Derive.HsType.html#12993" class="Bound">hsName</a> <a id="13331" class="Symbol">(</a><a id="13332" href="Data.List.Base.html#5044" class="Function">length</a> <a id="13339" href="Tactic.Derive.HsType.html#13097" class="Bound">cs</a><a id="13341" class="Symbol">))</a> <a id="13344" class="Symbol">(</a><a id="13345" href="Tactic.Derive.HsType.html#13097" class="Bound">cs</a> <a id="13348" href="Tactic.Derive.HsType.html#4019" class="Function Operator">‼</a> <a id="13350" href="Tactic.Derive.HsType.html#12967" class="Bound">i</a><a id="13351" class="Symbol">)</a>
    <a id="13357" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="13363" href="Tactic.Derive.HsType.html#12969" class="Bound">hole</a> <a id="13368" class="Symbol">(</a><a id="13369" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="13373" href="Tactic.Derive.HsType.html#13261" class="Bound">c</a> <a id="13375" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="13377" class="Symbol">)</a>

  <a id="hsProj"></a><a id="13382" href="Tactic.Derive.HsType.html#13382" class="Function">hsProj</a> <a id="13389" class="Symbol">:</a> <a id="13391" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13396" class="Symbol">→</a> <a id="13398" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="13400" class="Symbol">→</a> <a id="13402" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13407" class="Symbol">→</a> <a id="13409" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="13412" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="13416" href="Tactic.Derive.HsType.html#13382" class="Function">hsProj</a> <a id="13423" href="Tactic.Derive.HsType.html#13423" class="Bound">agdaTy</a> <a id="13430" href="Tactic.Derive.HsType.html#13430" class="Bound">i</a> <a id="13432" href="Tactic.Derive.HsType.html#13432" class="Bound">hole</a> <a id="13437" class="Symbol">=</a> <a id="13439" class="Keyword">do</a>
    <a id="13446" href="Tactic.Derive.HsType.html#13446" class="Bound">hsTy</a><a id="13450" class="Symbol">@(</a><a id="13452" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="13456" href="Tactic.Derive.HsType.html#13456" class="Bound">hsName</a> <a id="13463" class="Symbol">_)</a> <a id="13466" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="13468" href="Tactic.Derive.HsType.html#3699" class="Function">solveHsType</a> <a id="13480" href="Tactic.Derive.HsType.html#13423" class="Bound">agdaTy</a>
      <a id="13493" class="Keyword">where</a> <a id="13499" class="CatchallClause Symbol">_</a> <a id="13501" class="Symbol">→</a> <a id="13503" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13516" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="13549" href="Tactic.Derive.HsType.html#13423" class="Bound">agdaTy</a>
    <a id="13560" href="Tactic.Derive.HsType.html#13560" class="Bound">prjs</a> <a id="13565" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="13567" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="13581" href="Tactic.Derive.HsType.html#13456" class="Bound">hsName</a> <a id="13588" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="13592" class="Symbol">λ</a> <a id="13594" class="Keyword">where</a>
      <a id="13606" class="Symbol">(</a><a id="13607" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="13617" href="Tactic.Derive.HsType.html#13617" class="Bound">npars</a> <a id="13623" class="Symbol">(</a><a id="13624" href="Tactic.Derive.HsType.html#13624" class="Bound">c</a> <a id="13626" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="13628" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="13630" class="Symbol">))</a> <a id="13633" class="Symbol">→</a> <a id="13635" href="Tactic.Derive.HsType.html#11089" class="Function">computeProjections</a> <a id="13654" href="Tactic.Derive.HsType.html#13617" class="Bound">npars</a> <a id="13660" href="Tactic.Derive.HsType.html#13624" class="Bound">c</a>
      <a id="13668" class="CatchallClause Symbol">_</a> <a id="13670" class="Symbol">→</a> <a id="13672" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13685" class="String">&quot;Expected HsType %t to be a single constructor data type, but got %t&quot;</a> <a id="13755" href="Tactic.Derive.HsType.html#13423" class="Bound">agdaTy</a> <a id="13762" href="Tactic.Derive.HsType.html#13446" class="Bound">hsTy</a>
    <a id="13771" href="Tactic.Derive.HsType.html#13771" class="Bound">prj</a> <a id="13775" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="13777" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a> <a id="13784" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="13791" class="Symbol">(</a><a id="13792" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13805" class="String">&quot;%q has only %u fields&quot;</a> <a id="13829" href="Tactic.Derive.HsType.html#13456" class="Bound">hsName</a> <a id="13836" class="Symbol">(</a><a id="13837" href="Data.List.Base.html#5044" class="Function">length</a> <a id="13844" href="Tactic.Derive.HsType.html#13560" class="Bound">prjs</a><a id="13848" class="Symbol">))</a> <a id="13851" class="Symbol">(</a><a id="13852" href="Tactic.Derive.HsType.html#13560" class="Bound">prjs</a> <a id="13857" href="Tactic.Derive.HsType.html#4019" class="Function Operator">‼</a> <a id="13859" href="Tactic.Derive.HsType.html#13430" class="Bound">i</a><a id="13860" class="Symbol">)</a>
    <a id="13866" href="Tactic.Derive.HsType.html#13866" class="Bound">target</a> <a id="13873" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="13875" href="Reflection.TCM.html#1261" class="Function">newMeta</a> <a id="13883" href="Reflection.Syntax.html#3423" class="InductiveConstructor">`Set</a>
    <a id="13892" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="13902" href="Tactic.Derive.HsType.html#13432" class="Bound">hole</a> <a id="13907" class="Symbol">(</a><a id="13908" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="13911" class="Symbol">(</a><a id="13912" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="13917" href="Tactic.Derive.HsType.html#13446" class="Bound">hsTy</a><a id="13921" class="Symbol">)</a> <a id="13923" class="Symbol">(</a><a id="13924" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="13928" class="String">&quot;_&quot;</a> <a id="13932" href="Tactic.Derive.HsType.html#13866" class="Bound">target</a><a id="13938" class="Symbol">))</a>
    <a id="13945" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="13951" href="Tactic.Derive.HsType.html#13432" class="Bound">hole</a> <a id="13956" href="Tactic.Derive.HsType.html#13771" class="Bound">prj</a>

  <a id="hsTyName"></a><a id="13963" href="Tactic.Derive.HsType.html#13963" class="Function">hsTyName</a> <a id="13972" class="Symbol">:</a> <a id="13974" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13979" class="Symbol">→</a> <a id="13981" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13986" class="Symbol">→</a> <a id="13988" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="13991" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="13995" href="Tactic.Derive.HsType.html#13963" class="Function">hsTyName</a> <a id="14004" href="Tactic.Derive.HsType.html#14004" class="Bound">agdaTy</a> <a id="14011" href="Tactic.Derive.HsType.html#14011" class="Bound">hole</a> <a id="14016" class="Symbol">=</a> <a id="14018" class="Keyword">do</a>
    <a id="14025" href="Tactic.Derive.HsType.html#14025" class="Bound">hsTy</a><a id="14029" class="Symbol">@(</a><a id="14031" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="14035" href="Tactic.Derive.HsType.html#14035" class="Bound">hsName</a> <a id="14042" class="Symbol">_)</a> <a id="14045" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="14047" href="Tactic.Derive.HsType.html#3699" class="Function">solveHsType</a> <a id="14059" href="Tactic.Derive.HsType.html#14004" class="Bound">agdaTy</a>
      <a id="14072" class="Keyword">where</a> <a id="14078" class="CatchallClause Symbol">_</a> <a id="14080" class="Symbol">→</a> <a id="14082" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="14095" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="14128" href="Tactic.Derive.HsType.html#14004" class="Bound">agdaTy</a>
    <a id="14139" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="14145" href="Tactic.Derive.HsType.html#14011" class="Bound">hole</a> <a id="14150" class="Symbol">(</a><a id="14151" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="14155" class="Symbol">(</a><a id="14156" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="14161" href="Tactic.Derive.HsType.html#14035" class="Bound">hsName</a><a id="14167" class="Symbol">))</a>
</pre></body></html>