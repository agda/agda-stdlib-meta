<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.HsType</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/agda/agda-stdlib-meta/tree/master///Tactic/Derive/HsType.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Tactic.Derive.HsType.html" class="Module">Tactic.Derive.HsType</a> <a id="29" class="Keyword">where</a>

<a id="36" class="Keyword">open</a> <a id="41" class="Keyword">import</a> <a id="48" href="Meta.Init.html" class="Module">Meta.Init</a> <a id="58" class="Keyword">hiding</a> <a id="65" class="Symbol">(</a><a id="66" href="Reflection.TCI.html#554" class="Function">TC</a><a id="68" class="Symbol">;</a> <a id="70" href="Reflection.TCI.html#598" class="Function">Monad-TC</a><a id="78" class="Symbol">;</a> <a id="80" href="Reflection.TCI.html#783" class="Function">MonadError-TC</a><a id="93" class="Symbol">)</a>
<a id="95" class="Keyword">open</a> <a id="100" class="Keyword">import</a> <a id="107" href="Meta.Prelude.html" class="Module">Meta.Prelude</a> <a id="120" class="Keyword">hiding</a> <a id="127" class="Symbol">(</a><a id="128" href="Data.List.Base.html#6561" class="Function">lookup</a><a id="134" class="Symbol">)</a>

<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="173" class="Keyword">using</a>
  <a id="181" class="Symbol">(</a><a id="182" href="Agda.Builtin.Reflection.html#9556" class="Postulate">declareData</a><a id="193" class="Symbol">;</a> <a id="195" href="Agda.Builtin.Reflection.html#9602" class="Postulate">defineData</a><a id="205" class="Symbol">;</a> <a id="207" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a><a id="220" class="Symbol">;</a> <a id="222" href="Agda.Builtin.Reflection.html#9970" class="Postulate">pragmaCompile</a><a id="235" class="Symbol">;</a> <a id="237" href="Agda.Builtin.Reflection.html#12129" class="Postulate">solveInstanceConstraints</a><a id="261" class="Symbol">)</a>
<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Reflection.html" class="Module">Reflection</a> <a id="286" class="Symbol">as</a> <a id="289" class="Module">R</a> <a id="291" class="Keyword">hiding</a> <a id="298" class="Symbol">(</a><a id="299" href="Reflection.AST.Show.html#1581" class="Primitive">showName</a><a id="307" class="Symbol">;</a> <a id="309" href="Reflection.TCM.Syntax.html#623" class="Function Operator">_&gt;&gt;=_</a><a id="314" class="Symbol">;</a> <a id="316" href="Reflection.TCM.Syntax.html#693" class="Function Operator">_&gt;&gt;_</a><a id="320" class="Symbol">)</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Reflection.AST.DeBruijn.html" class="Module">Reflection.AST.DeBruijn</a>

<a id="359" class="Keyword">open</a> <a id="364" class="Keyword">import</a> <a id="371" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="382" class="Keyword">using</a> <a id="388" class="Symbol">(</a><a id="389" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a><a id="398" class="Symbol">;</a> <a id="400" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a><a id="406" class="Symbol">;</a> <a id="408" href="Data.Maybe.Base.html#2264" class="Function Operator">_&lt;∣&gt;_</a><a id="413" class="Symbol">)</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Data.Integer.Base.html" class="Module">Data.Integer.Base</a> <a id="445" class="Keyword">using</a> <a id="451" class="Symbol">(</a><a id="452" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="453" class="Symbol">)</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Data.String.html" class="Module">Data.String</a> <a id="479" class="Keyword">using</a> <a id="485" class="Symbol">()</a> <a id="488" class="Keyword">renaming</a> <a id="497" class="Symbol">(</a><a id="498" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="503" class="Symbol">to</a> <a id="506" class="Function Operator">_&amp;_</a><a id="509" class="Symbol">)</a>
<a id="511" class="Keyword">import</a> <a id="518" href="Data.String.html" class="Module">Data.String</a> <a id="530" class="Symbol">as</a> <a id="533" class="Module">String</a>
<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="Data.List.html" class="Module">Data.List</a> <a id="562" class="Keyword">using</a> <a id="568" class="Symbol">(</a><a id="569" href="Data.List.Base.html#1634" class="Function">map</a><a id="572" class="Symbol">;</a> <a id="574" href="Data.List.Base.html#3506" class="Function">zip</a><a id="577" class="Symbol">;</a> <a id="579" href="Data.List.Base.html#2734" class="Function">zipWith</a><a id="586" class="Symbol">)</a>
<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="Data.Char.html" class="Module">Data.Char</a> <a id="610" class="Keyword">using</a> <a id="616" class="Symbol">(</a><a id="617" href="Data.Char.Base.html#1060" class="Primitive">toUpper</a><a id="624" class="Symbol">;</a> <a id="626" href="Data.Char.Base.html#1087" class="Primitive">toLower</a><a id="633" class="Symbol">)</a>

<a id="636" class="Keyword">open</a> <a id="641" class="Keyword">import</a> <a id="648" href="Function.html" class="Module">Function</a>
<a id="657" class="Keyword">open</a> <a id="662" class="Keyword">import</a> <a id="669" href="Text.Printf.html" class="Module">Text.Printf</a>
<a id="681" class="Keyword">open</a> <a id="686" class="Keyword">import</a> <a id="693" href="Foreign.Haskell.html" class="Module">Foreign.Haskell</a>
<a id="709" class="Keyword">open</a> <a id="714" class="Keyword">import</a> <a id="721" href="Foreign.Haskell.Pair.html" class="Module">Foreign.Haskell.Pair</a> <a id="742" class="Keyword">using</a> <a id="748" class="Symbol">(</a><a id="749" href="Foreign.Haskell.Pair.html#534" class="Record">Pair</a><a id="753" class="Symbol">)</a>

<a id="756" class="Keyword">open</a> <a id="761" class="Keyword">import</a> <a id="768" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="780" class="Keyword">open</a> <a id="785" class="Keyword">import</a> <a id="792" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="830" class="Keyword">open</a> <a id="835" class="Keyword">import</a> <a id="842" href="Class.MonadError.html" class="Module">Class.MonadError</a>
<a id="859" class="Keyword">open</a> <a id="864" class="Keyword">import</a> <a id="871" href="Class.MonadReader.html" class="Module">Class.MonadReader</a>
<a id="889" class="Keyword">open</a> <a id="894" class="Keyword">import</a> <a id="901" href="Class.Show.html" class="Module">Class.Show</a>
<a id="912" class="Keyword">open</a> <a id="917" class="Keyword">import</a> <a id="924" href="Class.Show.Instances.html" class="Module">Class.Show.Instances</a>
<a id="945" class="Keyword">open</a> <a id="950" class="Keyword">import</a> <a id="957" href="Class.MonadTC.html" class="Module">Class.MonadTC</a> <a id="971" class="Keyword">using</a> <a id="977" class="Symbol">(</a><a id="978" href="Class.MonadTC.html#818" class="Record">TCEnv</a><a id="983" class="Symbol">;</a> <a id="985" href="Class.MonadTC.html#514" class="InductiveConstructor">dontReduce</a><a id="995" class="Symbol">;</a> <a id="997" href="Class.MonadTC.html#706" class="Function">defaultTCOptions</a><a id="1013" class="Symbol">)</a>
<a id="1015" class="Keyword">open</a> <a id="1020" class="Keyword">import</a> <a id="1027" href="Tactic.Derive.Show.html" class="Module">Tactic.Derive.Show</a> <a id="1046" class="Keyword">using</a> <a id="1052" class="Symbol">(</a><a id="1053" href="Tactic.Derive.Show.html#820" class="Function">showName</a><a id="1061" class="Symbol">)</a>

<a id="1064" class="Keyword">open</a> <a id="1069" class="Keyword">import</a> <a id="1076" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="1093" class="Keyword">open</a> <a id="1098" class="Keyword">import</a> <a id="1105" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>

<a id="1127" class="Keyword">open</a> <a id="1132" class="Keyword">import</a> <a id="1139" href="Class.HasHsType.html" class="Module">Class.HasHsType</a>

<a id="1156" class="Comment">{-
Need to generate:
  - a data type that can be compiled to a Haskell data type
  - the corresponding Haskell type (in a FOREIGN pragma)
  - the COMPILE pragma binding them together
-}</a>

<a id="1343" class="Comment">-- TODO: somewhere else</a>
<a id="`Set"></a><a id="1367" href="Tactic.Derive.HsType.html#1367" class="Function">`Set</a> <a id="1372" class="Symbol">=</a> <a id="1374" href="Agda.Builtin.Reflection.html#5477" class="InductiveConstructor">agda-sort</a> <a id="1384" class="Symbol">(</a><a id="1385" href="Agda.Builtin.Reflection.html#5630" class="InductiveConstructor">Sort.set</a> <a id="1394" class="Symbol">(</a><a id="1395" class="Keyword">quote</a> <a id="1401" href="Level.html#521" class="Function">0ℓ</a> <a id="1404" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a><a id="1405" class="Symbol">))</a>

<a id="1409" class="Comment">-- * Controlling the names of the generated types</a>

<a id="1460" class="Keyword">record</a> <a id="NameEnv"></a><a id="1467" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="1475" class="Symbol">:</a> <a id="1477" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1481" class="Keyword">where</a>
  <a id="1489" class="Keyword">field</a>
    <a id="NameEnv.customNames"></a><a id="1499" href="Tactic.Derive.HsType.html#1499" class="Field">customNames</a> <a id="1511" class="Symbol">:</a> <a id="1513" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1518" class="Symbol">(</a><a id="1519" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1524" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1526" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1532" class="Symbol">)</a>
    <a id="NameEnv.tName"></a><a id="1538" href="Tactic.Derive.HsType.html#1538" class="Field">tName</a>       <a id="1550" class="Symbol">:</a> <a id="1552" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1557" class="Symbol">→</a> <a id="1559" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1565" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="NameEnv.cName"></a><a id="1576" href="Tactic.Derive.HsType.html#1576" class="Field">cName</a>       <a id="1588" class="Symbol">:</a> <a id="1590" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1595" class="Symbol">→</a> <a id="1597" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1603" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="NameEnv.fName"></a><a id="1614" href="Tactic.Derive.HsType.html#1614" class="Field">fName</a>       <a id="1626" class="Symbol">:</a> <a id="1628" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1633" class="Symbol">→</a> <a id="1635" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1641" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="1649" class="Keyword">private</a>
  <a id="mapHead"></a><a id="1659" href="Tactic.Derive.HsType.html#1659" class="Function">mapHead</a> <a id="1667" class="Symbol">:</a> <a id="1669" class="Symbol">(</a><a id="1670" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="1672" class="Symbol">→</a> <a id="1674" href="Meta.Prelude.html#1418" class="Generalizable">A</a><a id="1675" class="Symbol">)</a> <a id="1677" class="Symbol">→</a> <a id="1679" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1684" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="1686" class="Symbol">→</a> <a id="1688" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1693" href="Meta.Prelude.html#1418" class="Generalizable">A</a>
  <a id="1697" href="Tactic.Derive.HsType.html#1659" class="Function">mapHead</a> <a id="1705" href="Tactic.Derive.HsType.html#1705" class="Bound">f</a> <a id="1707" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="1716" class="Symbol">=</a> <a id="1718" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="1723" href="Tactic.Derive.HsType.html#1659" class="Function">mapHead</a> <a id="1731" href="Tactic.Derive.HsType.html#1731" class="Bound">f</a> <a id="1733" class="Symbol">(</a><a id="1734" href="Tactic.Derive.HsType.html#1734" class="Bound">x</a> <a id="1736" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1738" href="Tactic.Derive.HsType.html#1738" class="Bound">xs</a><a id="1740" class="Symbol">)</a> <a id="1742" class="Symbol">=</a> <a id="1744" href="Tactic.Derive.HsType.html#1731" class="Bound">f</a> <a id="1746" href="Tactic.Derive.HsType.html#1734" class="Bound">x</a> <a id="1748" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1750" href="Tactic.Derive.HsType.html#1738" class="Bound">xs</a>

<a id="capitalize"></a><a id="1754" href="Tactic.Derive.HsType.html#1754" class="Function">capitalize</a> <a id="1765" class="Symbol">:</a> <a id="1767" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1774" class="Symbol">→</a> <a id="1776" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1783" href="Tactic.Derive.HsType.html#1754" class="Function">capitalize</a> <a id="1794" class="Symbol">=</a> <a id="1796" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="1812" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1814" href="Tactic.Derive.HsType.html#1659" class="Function">mapHead</a> <a id="1822" href="Data.Char.Base.html#1060" class="Primitive">toUpper</a> <a id="1830" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1832" href="Data.String.Base.html#1558" class="Primitive">String.toList</a>

<a id="uncapitalize"></a><a id="1847" href="Tactic.Derive.HsType.html#1847" class="Function">uncapitalize</a> <a id="1860" class="Symbol">:</a> <a id="1862" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1869" class="Symbol">→</a> <a id="1871" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1878" href="Tactic.Derive.HsType.html#1847" class="Function">uncapitalize</a> <a id="1891" class="Symbol">=</a> <a id="1893" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="1909" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1911" href="Tactic.Derive.HsType.html#1659" class="Function">mapHead</a> <a id="1919" href="Data.Char.Base.html#1087" class="Primitive">toLower</a> <a id="1927" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1929" href="Data.String.Base.html#1558" class="Primitive">String.toList</a>

<a id="1944" class="Keyword">private</a>
  <a id="lookup"></a><a id="1954" href="Tactic.Derive.HsType.html#1954" class="Function">lookup</a> <a id="1961" class="Symbol">:</a> <a id="1963" class="Symbol">⦃</a> <a id="1965" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1971" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="1973" class="Symbol">⦄</a> <a id="1975" class="Symbol">→</a> <a id="1977" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="1979" class="Symbol">→</a> <a id="1981" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1986" class="Symbol">(</a><a id="1987" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="1989" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1991" href="Meta.Prelude.html#1420" class="Generalizable">B</a><a id="1992" class="Symbol">)</a> <a id="1994" class="Symbol">→</a> <a id="1996" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2002" href="Meta.Prelude.html#1420" class="Generalizable">B</a>
  <a id="2006" href="Tactic.Derive.HsType.html#1954" class="Function">lookup</a> <a id="2013" href="Tactic.Derive.HsType.html#2013" class="Bound">x</a> <a id="2015" href="Tactic.Derive.HsType.html#2015" class="Bound">xs</a> <a id="2018" class="Symbol">=</a> <a id="2020" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2026" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="2030" href="Data.List.Base.html#13772" class="Function">findᵇ</a> <a id="2036" class="Symbol">((</a><a id="2038" href="Tactic.Derive.HsType.html#2013" class="Bound">x</a> <a id="2040" href="Class.DecEq.Core.html#188" class="Function Operator">==_</a><a id="2043" class="Symbol">)</a> <a id="2045" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2047" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="2052" class="Symbol">)</a> <a id="2054" href="Tactic.Derive.HsType.html#2015" class="Bound">xs</a>

  <a id="lookupEnv"></a><a id="2060" href="Tactic.Derive.HsType.html#2060" class="Function">lookupEnv</a> <a id="2070" class="Symbol">:</a> <a id="2072" class="Symbol">(</a><a id="2073" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="2081" class="Symbol">→</a> <a id="2083" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2088" class="Symbol">→</a> <a id="2090" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2096" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2102" class="Symbol">)</a> <a id="2104" class="Symbol">→</a> <a id="2106" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="2114" class="Symbol">→</a> <a id="2116" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2121" class="Symbol">→</a> <a id="2123" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2129" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="2138" href="Tactic.Derive.HsType.html#2060" class="Function">lookupEnv</a> <a id="2148" href="Tactic.Derive.HsType.html#2148" class="Bound">fn</a> <a id="2151" href="Tactic.Derive.HsType.html#2151" class="Bound">env</a> <a id="2155" href="Tactic.Derive.HsType.html#2155" class="Bound">x</a> <a id="2157" class="Symbol">=</a> <a id="2159" href="Tactic.Derive.HsType.html#1954" class="Function">lookup</a> <a id="2166" href="Tactic.Derive.HsType.html#2155" class="Bound">x</a> <a id="2168" class="Symbol">(</a><a id="2169" href="Tactic.Derive.HsType.html#1499" class="Field">NameEnv.customNames</a> <a id="2189" href="Tactic.Derive.HsType.html#2151" class="Bound">env</a><a id="2192" class="Symbol">)</a> <a id="2194" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="2198" href="Tactic.Derive.HsType.html#2148" class="Bound">fn</a> <a id="2201" href="Tactic.Derive.HsType.html#2151" class="Bound">env</a> <a id="2205" href="Tactic.Derive.HsType.html#2155" class="Bound">x</a>

  <a id="lookupTypeName"></a><a id="2210" href="Tactic.Derive.HsType.html#2210" class="Function">lookupTypeName</a>  <a id="2226" class="Symbol">=</a> <a id="2228" href="Tactic.Derive.HsType.html#2060" class="Function">lookupEnv</a> <a id="2238" href="Tactic.Derive.HsType.html#1538" class="Field">NameEnv.tName</a>
  <a id="lookupConName"></a><a id="2254" href="Tactic.Derive.HsType.html#2254" class="Function">lookupConName</a>   <a id="2270" class="Symbol">=</a> <a id="2272" href="Tactic.Derive.HsType.html#2060" class="Function">lookupEnv</a> <a id="2282" href="Tactic.Derive.HsType.html#1576" class="Field">NameEnv.cName</a>
  <a id="lookupFieldName"></a><a id="2298" href="Tactic.Derive.HsType.html#2298" class="Function">lookupFieldName</a> <a id="2314" class="Symbol">=</a> <a id="2316" href="Tactic.Derive.HsType.html#2060" class="Function">lookupEnv</a> <a id="2326" href="Tactic.Derive.HsType.html#1614" class="Field">NameEnv.fName</a>

  <a id="emptyEnv"></a><a id="2343" href="Tactic.Derive.HsType.html#2343" class="Function">emptyEnv</a> <a id="2352" class="Symbol">:</a> <a id="2354" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
  <a id="2364" href="Tactic.Derive.HsType.html#2343" class="Function">emptyEnv</a> <a id="2373" class="Symbol">=</a> <a id="2375" class="Keyword">record</a><a id="2381" class="Symbol">{</a> <a id="2383" href="Tactic.Derive.HsType.html#1499" class="Field">customNames</a> <a id="2395" class="Symbol">=</a> <a id="2397" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                   <a id="2419" class="Symbol">;</a> <a id="2421" href="Tactic.Derive.HsType.html#1538" class="Field">tName</a> <a id="2427" class="Symbol">=</a> <a id="2429" href="Function.Base.html#725" class="Function">const</a> <a id="2435" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2462" class="Symbol">;</a> <a id="2464" href="Tactic.Derive.HsType.html#1576" class="Field">cName</a> <a id="2470" class="Symbol">=</a> <a id="2472" href="Function.Base.html#725" class="Function">const</a> <a id="2478" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2505" class="Symbol">;</a> <a id="2507" href="Tactic.Derive.HsType.html#1614" class="Field">fName</a> <a id="2513" class="Symbol">=</a> <a id="2515" href="Function.Base.html#725" class="Function">const</a> <a id="2521" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2529" class="Symbol">}</a>

  <a id="customName"></a><a id="2534" href="Tactic.Derive.HsType.html#2534" class="Function">customName</a> <a id="2545" class="Symbol">:</a> <a id="2547" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2552" class="Symbol">→</a> <a id="2554" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2561" class="Symbol">→</a> <a id="2563" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
  <a id="2573" href="Tactic.Derive.HsType.html#2534" class="Function">customName</a> <a id="2584" href="Tactic.Derive.HsType.html#2584" class="Bound">x</a> <a id="2586" href="Tactic.Derive.HsType.html#2586" class="Bound">s</a> <a id="2588" class="Symbol">=</a> <a id="2590" class="Keyword">record</a> <a id="2597" href="Tactic.Derive.HsType.html#2343" class="Function">emptyEnv</a> <a id="2606" class="Symbol">{</a> <a id="2608" href="Tactic.Derive.HsType.html#1499" class="Field">customNames</a> <a id="2620" class="Symbol">=</a> <a id="2622" class="Symbol">(</a><a id="2623" href="Tactic.Derive.HsType.html#2584" class="Bound">x</a> <a id="2625" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2627" href="Tactic.Derive.HsType.html#2586" class="Bound">s</a><a id="2628" class="Symbol">)</a> <a id="2630" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2632" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2635" class="Symbol">}</a>

<a id="onTypes"></a><a id="2638" href="Tactic.Derive.HsType.html#2638" class="Function">onTypes</a> <a id="2646" class="Symbol">:</a> <a id="2648" class="Symbol">(</a><a id="2649" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2656" class="Symbol">→</a> <a id="2658" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2664" class="Symbol">)</a> <a id="2666" class="Symbol">→</a> <a id="2668" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
<a id="2676" href="Tactic.Derive.HsType.html#2638" class="Function">onTypes</a> <a id="2684" href="Tactic.Derive.HsType.html#2684" class="Bound">f</a> <a id="2686" class="Symbol">=</a> <a id="2688" class="Keyword">record</a> <a id="2695" href="Tactic.Derive.HsType.html#2343" class="Function">emptyEnv</a> <a id="2704" class="Symbol">{</a> <a id="2706" href="Tactic.Derive.HsType.html#1538" class="Field">tName</a> <a id="2712" class="Symbol">=</a> <a id="2714" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2719" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2721" href="Tactic.Derive.HsType.html#2684" class="Bound">f</a> <a id="2723" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2725" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="2734" class="Symbol">}</a>

<a id="onConstructors"></a><a id="2737" href="Tactic.Derive.HsType.html#2737" class="Function">onConstructors</a> <a id="2752" class="Symbol">:</a> <a id="2754" class="Symbol">(</a><a id="2755" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2762" class="Symbol">→</a> <a id="2764" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2770" class="Symbol">)</a> <a id="2772" class="Symbol">→</a> <a id="2774" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
<a id="2782" href="Tactic.Derive.HsType.html#2737" class="Function">onConstructors</a> <a id="2797" href="Tactic.Derive.HsType.html#2797" class="Bound">f</a> <a id="2799" class="Symbol">=</a> <a id="2801" class="Keyword">record</a> <a id="2808" href="Tactic.Derive.HsType.html#2343" class="Function">emptyEnv</a> <a id="2817" class="Symbol">{</a> <a id="2819" href="Tactic.Derive.HsType.html#1576" class="Field">cName</a> <a id="2825" class="Symbol">=</a> <a id="2827" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2832" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2834" href="Tactic.Derive.HsType.html#2797" class="Bound">f</a> <a id="2836" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2838" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="2847" class="Symbol">}</a>

<a id="withName"></a><a id="2850" href="Tactic.Derive.HsType.html#2850" class="Function">withName</a> <a id="2859" class="Symbol">:</a> <a id="2861" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2868" class="Symbol">→</a> <a id="2870" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
<a id="2878" href="Tactic.Derive.HsType.html#2850" class="Function">withName</a> <a id="2887" href="Tactic.Derive.HsType.html#2887" class="Bound">t</a> <a id="2889" class="Symbol">=</a> <a id="2891" href="Tactic.Derive.HsType.html#2638" class="Function">onTypes</a> <a id="2899" class="Symbol">(</a><a id="2900" href="Function.Base.html#725" class="Function">const</a> <a id="2906" href="Tactic.Derive.HsType.html#2887" class="Bound">t</a><a id="2907" class="Symbol">)</a>

<a id="2910" class="Comment">-- Only use for single constructor types obviously</a>
<a id="withConstructor"></a><a id="2961" href="Tactic.Derive.HsType.html#2961" class="Function">withConstructor</a> <a id="2977" class="Symbol">:</a> <a id="2979" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2986" class="Symbol">→</a> <a id="2988" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
<a id="2996" href="Tactic.Derive.HsType.html#2961" class="Function">withConstructor</a> <a id="3012" href="Tactic.Derive.HsType.html#3012" class="Bound">c</a> <a id="3014" class="Symbol">=</a> <a id="3016" href="Tactic.Derive.HsType.html#2737" class="Function">onConstructors</a> <a id="3031" class="Symbol">(</a><a id="3032" href="Function.Base.html#725" class="Function">const</a> <a id="3038" href="Tactic.Derive.HsType.html#3012" class="Bound">c</a><a id="3039" class="Symbol">)</a>

<a id="onFields"></a><a id="3042" href="Tactic.Derive.HsType.html#3042" class="Function">onFields</a> <a id="3051" class="Symbol">:</a> <a id="3053" class="Symbol">(</a><a id="3054" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3061" class="Symbol">→</a> <a id="3063" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3069" class="Symbol">)</a> <a id="3071" class="Symbol">→</a> <a id="3073" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
<a id="3081" href="Tactic.Derive.HsType.html#3042" class="Function">onFields</a> <a id="3090" href="Tactic.Derive.HsType.html#3090" class="Bound">f</a> <a id="3092" class="Symbol">=</a> <a id="3094" class="Keyword">record</a> <a id="3101" href="Tactic.Derive.HsType.html#2343" class="Function">emptyEnv</a> <a id="3110" class="Symbol">{</a> <a id="3112" href="Tactic.Derive.HsType.html#1614" class="Field">fName</a> <a id="3118" class="Symbol">=</a> <a id="3120" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3125" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3127" href="Tactic.Derive.HsType.html#3090" class="Bound">f</a> <a id="3129" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3131" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="3140" class="Symbol">}</a>

<a id="fieldPrefix"></a><a id="3143" href="Tactic.Derive.HsType.html#3143" class="Function">fieldPrefix</a> <a id="3155" class="Symbol">:</a> <a id="3157" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3164" class="Symbol">→</a> <a id="3166" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
<a id="3174" href="Tactic.Derive.HsType.html#3143" class="Function">fieldPrefix</a> <a id="3186" href="Tactic.Derive.HsType.html#3186" class="Bound">pre</a> <a id="3190" class="Symbol">=</a> <a id="3192" href="Tactic.Derive.HsType.html#3042" class="Function">onFields</a> <a id="3201" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3203" class="Symbol">(</a><a id="3204" href="Tactic.Derive.HsType.html#3186" class="Bound">pre</a> <a id="3208" href="Data.String.Base.html#2425" class="Function Operator">String.++_</a><a id="3218" class="Symbol">)</a> <a id="3220" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3222" href="Tactic.Derive.HsType.html#1754" class="Function">capitalize</a>

<a id="3234" class="Keyword">infixr</a> <a id="3241" class="Number">5</a> <a id="3243" href="Tactic.Derive.HsType.html#3247" class="Function Operator">_•_</a>
<a id="_•_"></a><a id="3247" href="Tactic.Derive.HsType.html#3247" class="Function Operator">_•_</a> <a id="3251" class="Symbol">:</a> <a id="3253" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="3261" class="Symbol">→</a> <a id="3263" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="3271" class="Symbol">→</a> <a id="3273" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a>
<a id="3281" href="Tactic.Derive.HsType.html#3281" class="Bound">env</a> <a id="3285" href="Tactic.Derive.HsType.html#3247" class="Function Operator">•</a> <a id="3287" href="Tactic.Derive.HsType.html#3287" class="Bound">env₁</a> <a id="3292" class="Symbol">=</a> <a id="3294" class="Keyword">record</a>
  <a id="3303" class="Symbol">{</a> <a id="3305" href="Tactic.Derive.HsType.html#1499" class="Field">customNames</a> <a id="3317" class="Symbol">=</a> <a id="3319" href="Tactic.Derive.HsType.html#1499" class="Function">env.customNames</a> <a id="3335" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="3338" href="Tactic.Derive.HsType.html#1499" class="Field">env₁.customNames</a>
  <a id="3357" class="Symbol">;</a> <a id="3359" href="Tactic.Derive.HsType.html#1538" class="Field">tName</a>       <a id="3371" class="Symbol">=</a> <a id="3373" class="Symbol">λ</a> <a id="3375" href="Tactic.Derive.HsType.html#3375" class="Bound">x</a> <a id="3377" class="Symbol">→</a> <a id="3379" href="Tactic.Derive.HsType.html#1538" class="Function">env.tName</a> <a id="3389" href="Tactic.Derive.HsType.html#3375" class="Bound">x</a> <a id="3391" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3395" href="Tactic.Derive.HsType.html#1538" class="Field">env₁.tName</a> <a id="3406" href="Tactic.Derive.HsType.html#3375" class="Bound">x</a>
  <a id="3410" class="Symbol">;</a> <a id="3412" href="Tactic.Derive.HsType.html#1576" class="Field">cName</a>       <a id="3424" class="Symbol">=</a> <a id="3426" class="Symbol">λ</a> <a id="3428" href="Tactic.Derive.HsType.html#3428" class="Bound">x</a> <a id="3430" class="Symbol">→</a> <a id="3432" href="Tactic.Derive.HsType.html#1576" class="Function">env.cName</a> <a id="3442" href="Tactic.Derive.HsType.html#3428" class="Bound">x</a> <a id="3444" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3448" href="Tactic.Derive.HsType.html#1576" class="Field">env₁.cName</a> <a id="3459" href="Tactic.Derive.HsType.html#3428" class="Bound">x</a>
  <a id="3463" class="Symbol">;</a> <a id="3465" href="Tactic.Derive.HsType.html#1614" class="Field">fName</a>       <a id="3477" class="Symbol">=</a> <a id="3479" class="Symbol">λ</a> <a id="3481" href="Tactic.Derive.HsType.html#3481" class="Bound">x</a> <a id="3483" class="Symbol">→</a> <a id="3485" href="Tactic.Derive.HsType.html#1614" class="Function">env.fName</a> <a id="3495" href="Tactic.Derive.HsType.html#3481" class="Bound">x</a> <a id="3497" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3501" href="Tactic.Derive.HsType.html#1614" class="Field">env₁.fName</a> <a id="3512" href="Tactic.Derive.HsType.html#3481" class="Bound">x</a>
  <a id="3516" class="Symbol">}</a>
  <a id="3520" class="Keyword">where</a>
    <a id="3530" class="Keyword">module</a> <a id="3537" href="Tactic.Derive.HsType.html#3537" class="Module">env</a>  <a id="3542" class="Symbol">=</a> <a id="3544" href="Tactic.Derive.HsType.html#1467" class="Module">NameEnv</a> <a id="3552" href="Tactic.Derive.HsType.html#3281" class="Bound">env</a>
    <a id="3560" class="Keyword">module</a> <a id="3567" href="Tactic.Derive.HsType.html#3567" class="Module">env₁</a> <a id="3572" class="Symbol">=</a> <a id="3574" href="Tactic.Derive.HsType.html#1467" class="Module">NameEnv</a> <a id="3582" href="Tactic.Derive.HsType.html#3287" class="Bound">env₁</a>


<a id="3589" class="Comment">-- * The inner workings</a>

<a id="solveHsType"></a><a id="3614" href="Tactic.Derive.HsType.html#3614" class="Function">solveHsType</a> <a id="3626" class="Symbol">:</a> <a id="3628" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3633" class="Symbol">→</a> <a id="3635" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="3638" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="3643" href="Tactic.Derive.HsType.html#3614" class="Function">solveHsType</a> <a id="3655" href="Tactic.Derive.HsType.html#3655" class="Bound">tm</a> <a id="3658" class="Symbol">=</a> <a id="3660" class="Keyword">do</a>
  <a id="3665" href="Tactic.Derive.HsType.html#3665" class="Bound">hsTy</a> <a id="3670" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="3672" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="3682" class="Symbol">(</a><a id="3683" class="Keyword">quote</a> <a id="3689" href="Class.HasHsType.Core.html#263" class="Function">HsType</a> <a id="3696" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="3699" href="Tactic.Derive.HsType.html#3655" class="Bound">tm</a> <a id="3702" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="3703" class="Symbol">)</a> <a id="3705" href="Tactic.Derive.HsType.html#1367" class="Function">`Set</a>
  <a id="3712" href="Agda.Builtin.Reflection.html#12129" class="Postulate">solveInstanceConstraints</a>
  <a id="3739" href="Agda.Builtin.Reflection.html#8972" class="Postulate">normalise</a> <a id="3749" href="Tactic.Derive.HsType.html#3665" class="Bound">hsTy</a> <a id="3754" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="3758" class="Symbol">λ</a> <a id="3760" class="Keyword">where</a>
    <a id="3770" class="Symbol">(</a><a id="3771" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="3775" class="Symbol">(</a><a id="3776" class="Keyword">quote</a> <a id="3782" href="Class.HasHsType.Core.html#263" class="Function">HsType</a><a id="3788" class="Symbol">)</a> <a id="3790" class="Symbol">_)</a> <a id="3793" class="Symbol">→</a> <a id="3795" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="3808" class="String">&quot;Failed to solve HsType %t&quot;</a> <a id="3836" href="Tactic.Derive.HsType.html#3655" class="Bound">tm</a>
    <a id="3843" href="Tactic.Derive.HsType.html#3843" class="CatchallClause Bound">hsTy</a>                   <a id="3866" class="Symbol">→</a> <a id="3868" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="3875" href="Tactic.Derive.HsType.html#3843" class="Bound">hsTy</a>

<a id="3881" class="Keyword">private</a>
  <a id="debug"></a><a id="3891" href="Tactic.Derive.HsType.html#3891" class="Function">debug</a> <a id="3897" class="Symbol">=</a> <a id="3899" href="Reflection.TCM.Format.html#2726" class="Function">debugPrintFmt</a> <a id="3913" class="String">&quot;tactic.hs-types&quot;</a>

  <a id="_‼_"></a><a id="3934" href="Tactic.Derive.HsType.html#3934" class="Function Operator">_‼_</a> <a id="3938" class="Symbol">:</a> <a id="3940" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3945" href="Meta.Prelude.html#1418" class="Generalizable">A</a> <a id="3947" class="Symbol">→</a> <a id="3949" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3951" class="Symbol">→</a> <a id="3953" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3959" href="Meta.Prelude.html#1418" class="Generalizable">A</a>
  <a id="3963" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="3972" href="Tactic.Derive.HsType.html#3934" class="Function Operator">‼</a> <a id="3974" href="Tactic.Derive.HsType.html#3974" class="Bound">i</a>     <a id="3980" class="Symbol">=</a> <a id="3982" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
  <a id="3992" class="Symbol">(</a><a id="3993" href="Tactic.Derive.HsType.html#3993" class="Bound">x</a> <a id="3995" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3997" href="Tactic.Derive.HsType.html#3997" class="Bound">xs</a><a id="3999" class="Symbol">)</a> <a id="4001" href="Tactic.Derive.HsType.html#3934" class="Function Operator">‼</a> <a id="4003" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>  <a id="4009" class="Symbol">=</a> <a id="4011" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4016" href="Tactic.Derive.HsType.html#3993" class="Bound">x</a>
  <a id="4020" class="Symbol">(</a><a id="4021" href="Tactic.Derive.HsType.html#4021" class="Bound">x</a> <a id="4023" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4025" href="Tactic.Derive.HsType.html#4025" class="Bound">xs</a><a id="4027" class="Symbol">)</a> <a id="4029" href="Tactic.Derive.HsType.html#3934" class="Function Operator">‼</a> <a id="4031" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4035" href="Tactic.Derive.HsType.html#4035" class="Bound">i</a> <a id="4037" class="Symbol">=</a> <a id="4039" href="Tactic.Derive.HsType.html#4025" class="Bound">xs</a> <a id="4042" href="Tactic.Derive.HsType.html#3934" class="Function Operator">‼</a> <a id="4044" href="Tactic.Derive.HsType.html#4035" class="Bound">i</a>

  <a id="specialHsTypes"></a><a id="4049" href="Tactic.Derive.HsType.html#4049" class="Function">specialHsTypes</a> <a id="4064" class="Symbol">:</a> <a id="4066" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4071" class="Symbol">(</a><a id="4072" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4077" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4079" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="4085" class="Symbol">)</a>
  <a id="4089" href="Tactic.Derive.HsType.html#4049" class="Function">specialHsTypes</a> <a id="4104" class="Symbol">=</a> <a id="4106" class="Symbol">(</a><a id="4107" class="Keyword">quote</a> <a id="4113" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>      <a id="4120" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4122" class="String">&quot;()&quot;</a><a id="4126" class="Symbol">)</a>
                 <a id="4145" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4147" class="Symbol">(</a><a id="4148" class="Keyword">quote</a> <a id="4154" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>      <a id="4161" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4163" class="String">&quot;Integer&quot;</a><a id="4172" class="Symbol">)</a>
                 <a id="4191" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4193" class="Symbol">(</a><a id="4194" class="Keyword">quote</a> <a id="4200" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>      <a id="4207" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4209" class="String">&quot;Integer&quot;</a><a id="4218" class="Symbol">)</a>
                 <a id="4237" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4239" class="Symbol">(</a><a id="4240" class="Keyword">quote</a> <a id="4246" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>   <a id="4253" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4255" class="String">&quot;Bool&quot;</a><a id="4261" class="Symbol">)</a>
                 <a id="4280" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4282" class="Symbol">(</a><a id="4283" class="Keyword">quote</a> <a id="4289" href="Agda.Builtin.List.html#147" class="Datatype">List</a>   <a id="4296" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4298" class="String">&quot;[]&quot;</a><a id="4302" class="Symbol">)</a>
                 <a id="4321" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4323" class="Symbol">(</a><a id="4324" class="Keyword">quote</a> <a id="4330" href="Foreign.Haskell.Pair.html#534" class="Record">Pair</a>   <a id="4337" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4339" class="String">&quot;(,)&quot;</a><a id="4344" class="Symbol">)</a>
                 <a id="4363" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4365" class="Symbol">(</a><a id="4366" class="Keyword">quote</a> <a id="4372" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="4379" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4381" class="String">&quot;Maybe&quot;</a><a id="4388" class="Symbol">)</a>
                 <a id="4407" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4409" class="Symbol">(</a><a id="4410" class="Keyword">quote</a> <a id="4416" href="Foreign.Haskell.Either.html#539" class="Datatype">Either</a> <a id="4423" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4425" class="String">&quot;Either&quot;</a><a id="4433" class="Symbol">)</a>
                 <a id="4452" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4454" class="Symbol">(</a><a id="4455" class="Keyword">quote</a> <a id="4461" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4468" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4470" class="String">&quot;Data.Text.Text&quot;</a><a id="4486" class="Symbol">)</a>
                 <a id="4505" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4507" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="hsTypeName"></a><a id="4513" href="Tactic.Derive.HsType.html#4513" class="Function">hsTypeName</a> <a id="4524" class="Symbol">:</a> <a id="4526" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="4534" class="Symbol">→</a> <a id="4536" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4541" class="Symbol">→</a> <a id="4543" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="4552" href="Tactic.Derive.HsType.html#4513" class="Function">hsTypeName</a> <a id="4563" href="Tactic.Derive.HsType.html#4563" class="Bound">env</a> <a id="4567" href="Tactic.Derive.HsType.html#4567" class="Bound">d</a> <a id="4569" class="Symbol">=</a> <a id="4571" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="4581" class="Symbol">(</a><a id="4582" href="Tactic.Derive.HsType.html#1754" class="Function">capitalize</a> <a id="4593" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4595" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="4604" href="Tactic.Derive.HsType.html#4567" class="Bound">d</a><a id="4605" class="Symbol">)</a> <a id="4607" class="Symbol">(</a><a id="4608" href="Tactic.Derive.HsType.html#2210" class="Function">lookupTypeName</a> <a id="4623" href="Tactic.Derive.HsType.html#4563" class="Bound">env</a> <a id="4627" href="Tactic.Derive.HsType.html#4567" class="Bound">d</a><a id="4628" class="Symbol">)</a>

  <a id="freshHsTypeName"></a><a id="4633" href="Tactic.Derive.HsType.html#4633" class="Function">freshHsTypeName</a> <a id="4649" class="Symbol">:</a> <a id="4651" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="4659" class="Symbol">→</a> <a id="4661" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4666" class="Symbol">→</a> <a id="4668" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="4671" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="4678" href="Tactic.Derive.HsType.html#4633" class="Function">freshHsTypeName</a> <a id="4694" href="Tactic.Derive.HsType.html#4694" class="Bound">env</a> <a id="4698" href="Tactic.Derive.HsType.html#4698" class="Bound">d</a> <a id="4700" class="Symbol">=</a> <a id="4702" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="4712" class="Symbol">(</a><a id="4713" href="Tactic.Derive.HsType.html#4513" class="Function">hsTypeName</a> <a id="4724" href="Tactic.Derive.HsType.html#4694" class="Bound">env</a> <a id="4728" href="Tactic.Derive.HsType.html#4698" class="Bound">d</a><a id="4729" class="Symbol">)</a>

  <a id="hsConName"></a><a id="4734" href="Tactic.Derive.HsType.html#4734" class="Function">hsConName</a> <a id="4744" class="Symbol">:</a> <a id="4746" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="4754" class="Symbol">→</a> <a id="4756" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4761" class="Symbol">→</a> <a id="4763" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="4772" href="Tactic.Derive.HsType.html#4734" class="Function">hsConName</a> <a id="4782" href="Tactic.Derive.HsType.html#4782" class="Bound">env</a> <a id="4786" href="Tactic.Derive.HsType.html#4786" class="Bound">c</a> <a id="4788" class="Symbol">=</a> <a id="4790" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="4800" class="Symbol">(</a><a id="4801" href="Tactic.Derive.HsType.html#1754" class="Function">capitalize</a> <a id="4812" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4814" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="4823" href="Tactic.Derive.HsType.html#4786" class="Bound">c</a><a id="4824" class="Symbol">)</a> <a id="4826" class="Symbol">(</a><a id="4827" href="Tactic.Derive.HsType.html#2254" class="Function">lookupConName</a> <a id="4841" href="Tactic.Derive.HsType.html#4782" class="Bound">env</a> <a id="4845" href="Tactic.Derive.HsType.html#4786" class="Bound">c</a><a id="4846" class="Symbol">)</a>

  <a id="hsFieldName"></a><a id="4851" href="Tactic.Derive.HsType.html#4851" class="Function">hsFieldName</a> <a id="4863" class="Symbol">:</a> <a id="4865" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="4873" class="Symbol">→</a> <a id="4875" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4880" class="Symbol">→</a> <a id="4882" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="4891" href="Tactic.Derive.HsType.html#4851" class="Function">hsFieldName</a> <a id="4903" href="Tactic.Derive.HsType.html#4903" class="Bound">env</a> <a id="4907" href="Tactic.Derive.HsType.html#4907" class="Bound">f</a> <a id="4909" class="Symbol">=</a> <a id="4911" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="4921" class="Symbol">(</a><a id="4922" href="Tactic.Derive.HsType.html#1847" class="Function">uncapitalize</a> <a id="4935" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4937" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="4946" href="Tactic.Derive.HsType.html#4907" class="Bound">f</a><a id="4947" class="Symbol">)</a> <a id="4949" class="Symbol">(</a><a id="4950" href="Tactic.Derive.HsType.html#2298" class="Function">lookupFieldName</a> <a id="4966" href="Tactic.Derive.HsType.html#4903" class="Bound">env</a> <a id="4970" href="Tactic.Derive.HsType.html#4907" class="Bound">f</a><a id="4971" class="Symbol">)</a>

  <a id="freshHsConName"></a><a id="4976" href="Tactic.Derive.HsType.html#4976" class="Function">freshHsConName</a> <a id="4991" class="Symbol">:</a> <a id="4993" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="5001" class="Symbol">→</a> <a id="5003" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5008" class="Symbol">→</a> <a id="5010" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5015" class="Symbol">→</a> <a id="5017" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5020" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="5027" href="Tactic.Derive.HsType.html#4976" class="Function">freshHsConName</a> <a id="5042" href="Tactic.Derive.HsType.html#5042" class="Bound">env</a> <a id="5046" href="Tactic.Derive.HsType.html#5046" class="Bound">tyName</a> <a id="5053" href="Tactic.Derive.HsType.html#5053" class="Bound">c</a> <a id="5055" class="Symbol">=</a>
    <a id="5061" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="5064" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="5073" href="Tactic.Derive.HsType.html#5053" class="Bound">c</a> <a id="5075" href="Class.DecEq.Core.html#188" class="Function Operator">==</a> <a id="5078" class="String">&quot;constructor&quot;</a>
    <a id="5096" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="5101" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5111" class="Symbol">(</a><a id="5112" href="Tactic.Derive.HsType.html#4734" class="Function">hsConName</a> <a id="5122" href="Tactic.Derive.HsType.html#5042" class="Bound">env</a> <a id="5126" href="Tactic.Derive.HsType.html#5046" class="Bound">tyName</a><a id="5132" class="Symbol">)</a> <a id="5134" class="Comment">-- Unnamed record constructor: use type name</a>
    <a id="5183" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="5188" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5198" class="Symbol">(</a><a id="5199" href="Tactic.Derive.HsType.html#4734" class="Function">hsConName</a> <a id="5209" href="Tactic.Derive.HsType.html#5042" class="Bound">env</a> <a id="5213" href="Tactic.Derive.HsType.html#5053" class="Bound">c</a><a id="5214" class="Symbol">)</a>

  <a id="isThis"></a><a id="5219" href="Tactic.Derive.HsType.html#5219" class="Function">isThis</a> <a id="5226" class="Symbol">:</a> <a id="5228" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5233" class="Symbol">→</a> <a id="5235" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5240" class="Symbol">→</a> <a id="5242" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="5249" href="Tactic.Derive.HsType.html#5219" class="Function">isThis</a> <a id="5256" href="Tactic.Derive.HsType.html#5256" class="Bound">f</a> <a id="5258" class="Symbol">(</a><a id="5259" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="5263" href="Tactic.Derive.HsType.html#5263" class="Bound">g</a> <a id="5265" class="Symbol">_)</a> <a id="5268" class="Symbol">=</a> <a id="5270" href="Tactic.Derive.HsType.html#5256" class="Bound">f</a> <a id="5272" href="Class.DecEq.Core.html#188" class="Function Operator">==</a> <a id="5275" href="Tactic.Derive.HsType.html#5263" class="Bound">g</a>
  <a id="5279" href="Tactic.Derive.HsType.html#5219" class="CatchallClause Function">isThis</a><a id="5285" class="CatchallClause"> </a><a id="5286" class="CatchallClause Symbol">_</a><a id="5287" class="CatchallClause"> </a><a id="5288" class="CatchallClause Symbol">_</a> <a id="5290" class="Symbol">=</a> <a id="5292" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

  <a id="computeHsType"></a><a id="5301" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="5315" class="Symbol">:</a> <a id="5317" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5322" class="Symbol">→</a> <a id="5324" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5329" class="Symbol">→</a> <a id="5331" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5336" class="Symbol">→</a> <a id="5338" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5341" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="5348" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="5362" href="Tactic.Derive.HsType.html#5362" class="Bound">aThis</a> <a id="5368" href="Tactic.Derive.HsType.html#5368" class="Bound">hThis</a> <a id="5374" href="Tactic.Derive.HsType.html#5374" class="Bound">tm</a> <a id="5377" class="Keyword">with</a> <a id="5382" href="Tactic.Derive.HsType.html#5219" class="Function">isThis</a> <a id="5389" href="Tactic.Derive.HsType.html#5362" class="Bound">aThis</a> <a id="5395" href="Tactic.Derive.HsType.html#5374" class="Bound">tm</a>
  <a id="5400" class="Symbol">...</a> <a id="5404" class="Symbol">|</a> <a id="5406" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="5411" class="Symbol">=</a> <a id="5413" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5418" class="Symbol">(</a><a id="5419" class="Bound">hThis</a> <a id="5425" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a><a id="5426" class="Symbol">)</a>
  <a id="5430" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="5444" href="Tactic.Derive.HsType.html#5444" class="Bound">aThis</a> <a id="5450" href="Tactic.Derive.HsType.html#5450" class="Bound">hThis</a> <a id="5456" class="Symbol">(</a><a id="5457" href="Reflection.AST.Term.html#2283" class="InductiveConstructor Operator">Π[</a> <a id="5460" href="Tactic.Derive.HsType.html#5460" class="Bound">x</a> <a id="5462" href="Reflection.AST.Term.html#2283" class="InductiveConstructor Operator">∶</a> <a id="5464" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="5468" class="Symbol">(</a><a id="5469" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">arg-info</a> <a id="5478" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="5486" class="Symbol">_)</a> <a id="5489" href="Tactic.Derive.HsType.html#5489" class="Bound">a</a> <a id="5491" href="Reflection.AST.Term.html#2283" class="InductiveConstructor Operator">]</a> <a id="5493" href="Tactic.Derive.HsType.html#5493" class="Bound">b</a><a id="5494" class="Symbol">)</a> <a id="5496" class="Symbol">|</a> <a id="5498" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="5504" class="Symbol">=</a> <a id="5506" class="Keyword">do</a>
    <a id="5513" href="Tactic.Derive.HsType.html#5513" class="Bound">dom</a> <a id="5517" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="5519" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="5533" href="Tactic.Derive.HsType.html#5444" class="Bound">aThis</a> <a id="5539" href="Tactic.Derive.HsType.html#5450" class="Bound">hThis</a> <a id="5545" href="Tactic.Derive.HsType.html#5489" class="Bound">a</a>
    <a id="5551" href="Tactic.Derive.HsType.html#5551" class="Bound">rng</a> <a id="5555" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="5557" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="5571" href="Tactic.Derive.HsType.html#5460" class="Bound">x</a> <a id="5573" class="Symbol">(</a><a id="5574" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="5579" href="Tactic.Derive.HsType.html#5489" class="Bound">a</a><a id="5580" class="Symbol">)</a> <a id="5582" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5584" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="5598" href="Tactic.Derive.HsType.html#5444" class="Bound">aThis</a> <a id="5604" href="Tactic.Derive.HsType.html#5450" class="Bound">hThis</a> <a id="5610" href="Tactic.Derive.HsType.html#5493" class="Bound">b</a>
    <a id="5616" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5621" class="Symbol">(</a><a id="5622" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">vΠ[</a> <a id="5626" href="Tactic.Derive.HsType.html#5460" class="Bound">x</a> <a id="5628" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">∶</a> <a id="5630" href="Tactic.Derive.HsType.html#5513" class="Bound">dom</a> <a id="5634" href="Reflection.AST.Term.html#2328" class="InductiveConstructor Operator">]</a> <a id="5636" href="Tactic.Derive.HsType.html#5551" class="Bound">rng</a><a id="5639" class="Symbol">)</a>
  <a id="5643" href="Tactic.Derive.HsType.html#5301" class="CatchallClause Function">computeHsType</a><a id="5656" class="CatchallClause"> </a><a id="5657" href="Tactic.Derive.HsType.html#5657" class="CatchallClause Bound">aThis</a><a id="5662" class="CatchallClause"> </a><a id="5663" href="Tactic.Derive.HsType.html#5663" class="CatchallClause Bound">hThis</a><a id="5668" class="CatchallClause"> </a><a id="5669" class="CatchallClause Symbol">(</a><a id="5670" href="Reflection.AST.Term.html#2283" class="CatchallClause InductiveConstructor Operator">Π[</a><a id="5672" class="CatchallClause"> </a><a id="5673" href="Tactic.Derive.HsType.html#5673" class="CatchallClause Bound">x</a><a id="5674" class="CatchallClause"> </a><a id="5675" href="Reflection.AST.Term.html#2283" class="CatchallClause InductiveConstructor Operator">∶</a><a id="5676" class="CatchallClause"> </a><a id="5677" href="Tactic.Derive.HsType.html#5677" class="CatchallClause Bound">a</a><a id="5678" class="CatchallClause"> </a><a id="5679" href="Reflection.AST.Term.html#2283" class="CatchallClause InductiveConstructor Operator">]</a><a id="5680" class="CatchallClause"> </a><a id="5681" href="Tactic.Derive.HsType.html#5681" class="CatchallClause Bound">b</a><a id="5682" class="CatchallClause Symbol">)</a><a id="5683" class="CatchallClause"> </a><a id="5684" class="CatchallClause Symbol">|</a><a id="5685" class="CatchallClause"> </a><a id="5686" href="Agda.Builtin.Bool.html#192" class="CatchallClause InductiveConstructor">false</a> <a id="5692" class="Symbol">=</a> <a id="5694" class="Keyword">do</a>
    <a id="5701" href="Tactic.Derive.HsType.html#5701" class="Bound">ty</a> <a id="5704" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="5706" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="5720" href="Tactic.Derive.HsType.html#5673" class="Bound">x</a> <a id="5722" href="Tactic.Derive.HsType.html#5677" class="Bound">a</a> <a id="5724" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5726" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="5740" href="Tactic.Derive.HsType.html#5657" class="Bound">aThis</a> <a id="5746" href="Tactic.Derive.HsType.html#5663" class="Bound">hThis</a> <a id="5752" href="Tactic.Derive.HsType.html#5681" class="Bound">b</a>
    <a id="5758" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5763" href="Tactic.Derive.HsType.html#5763" class="Bound">ty′</a> <a id="5767" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="5769" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5774" class="Symbol">(</a><a id="5775" href="Reflection.AST.DeBruijn.html#3415" class="Function">strengthen</a> <a id="5786" href="Tactic.Derive.HsType.html#5701" class="Bound">ty</a><a id="5788" class="Symbol">)</a>
      <a id="5796" class="Keyword">where</a> <a id="5802" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5810" class="Symbol">→</a> <a id="5812" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="5826" href="Tactic.Derive.HsType.html#5673" class="Bound">x</a> <a id="5828" href="Tactic.Derive.HsType.html#5677" class="Bound">a</a> <a id="5830" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5832" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="5845" class="String">&quot;%s free in computed HsType %t&quot;</a> <a id="5877" href="Tactic.Derive.HsType.html#5673" class="Bound">x</a> <a id="5879" href="Tactic.Derive.HsType.html#5701" class="Bound">ty</a>
    <a id="5886" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5891" href="Tactic.Derive.HsType.html#5763" class="Bound">ty′</a>
  <a id="5897" class="Comment">-- Hack to get recursive occurrences under lists to work</a>
  <a id="5956" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="5970" href="Tactic.Derive.HsType.html#5970" class="Bound">aThis</a> <a id="5976" href="Tactic.Derive.HsType.html#5976" class="Bound">hThis</a> <a id="5982" class="Symbol">(</a><a id="5983" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="5987" class="Symbol">(</a><a id="5988" class="Keyword">quote</a> <a id="5994" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="5998" class="Symbol">)</a> <a id="6000" class="Symbol">(_</a> <a id="6003" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6005" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="6010" href="Tactic.Derive.HsType.html#6010" class="Bound">a</a> <a id="6012" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6014" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6016" class="Symbol">))</a> <a id="6019" class="Symbol">|</a> <a id="6021" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="6027" class="Symbol">=</a> <a id="6029" class="Keyword">do</a>
    <a id="6036" href="Tactic.Derive.HsType.html#6036" class="Bound">ty</a> <a id="6039" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6041" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="6055" href="Tactic.Derive.HsType.html#5970" class="Bound">aThis</a> <a id="6061" href="Tactic.Derive.HsType.html#5976" class="Bound">hThis</a> <a id="6067" href="Tactic.Derive.HsType.html#6010" class="Bound">a</a>
    <a id="6073" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6078" class="Symbol">(</a><a id="6079" class="Keyword">quote</a> <a id="6085" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6090" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="6093" href="Tactic.Derive.HsType.html#6036" class="Bound">ty</a> <a id="6096" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="6097" class="Symbol">)</a>
  <a id="6101" href="Tactic.Derive.HsType.html#5301" class="CatchallClause Function">computeHsType</a><a id="6114" class="CatchallClause"> </a><a id="6115" class="CatchallClause Symbol">_</a><a id="6116" class="CatchallClause"> </a><a id="6117" class="CatchallClause Symbol">_</a><a id="6118" class="CatchallClause"> </a><a id="6119" href="Tactic.Derive.HsType.html#6119" class="CatchallClause Bound">tm</a><a id="6121" class="CatchallClause"> </a><a id="6122" class="CatchallClause Symbol">|</a><a id="6123" class="CatchallClause"> </a><a id="6124" href="Agda.Builtin.Bool.html#192" class="CatchallClause InductiveConstructor">false</a> <a id="6130" class="Symbol">=</a> <a id="6132" class="Keyword">do</a>
    <a id="6139" href="Tactic.Derive.HsType.html#3891" class="Function">debug</a> <a id="6145" class="Number">10</a> <a id="6148" class="String">&quot;solving HsType %t&quot;</a> <a id="6168" href="Tactic.Derive.HsType.html#6119" class="Bound">tm</a>
    <a id="6175" href="Tactic.Derive.HsType.html#6175" class="Bound">ty</a> <a id="6178" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6180" href="Tactic.Derive.HsType.html#3614" class="Function">solveHsType</a> <a id="6192" href="Tactic.Derive.HsType.html#6119" class="Bound">tm</a>
    <a id="6199" href="Tactic.Derive.HsType.html#3891" class="Function">debug</a> <a id="6205" class="Number">10</a> <a id="6208" class="String">&quot;HsType %t = %t&quot;</a> <a id="6225" href="Tactic.Derive.HsType.html#6119" class="Bound">tm</a> <a id="6228" href="Tactic.Derive.HsType.html#6175" class="Bound">ty</a>
    <a id="6235" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6240" href="Tactic.Derive.HsType.html#6175" class="Bound">ty</a>

  <a id="makeHsCon"></a><a id="6246" href="Tactic.Derive.HsType.html#6246" class="Function">makeHsCon</a> <a id="6256" class="Symbol">:</a> <a id="6258" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="6266" class="Symbol">→</a> <a id="6268" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6273" class="Symbol">→</a> <a id="6275" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6280" class="Symbol">→</a> <a id="6282" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6287" class="Symbol">→</a> <a id="6289" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="6292" class="Symbol">(</a><a id="6293" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6298" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6300" href="Agda.Builtin.Reflection.html#3207" class="Datatype">Agda.Builtin.Reflection.Quantity</a> <a id="6333" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6335" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="6339" class="Symbol">)</a>
  <a id="6343" href="Tactic.Derive.HsType.html#6246" class="Function">makeHsCon</a> <a id="6353" href="Tactic.Derive.HsType.html#6353" class="Bound">env</a> <a id="6357" href="Tactic.Derive.HsType.html#6357" class="Bound">agdaName</a> <a id="6366" href="Tactic.Derive.HsType.html#6366" class="Bound">hsName</a> <a id="6373" href="Tactic.Derive.HsType.html#6373" class="Bound">c</a> <a id="6375" class="Symbol">=</a> <a id="6377" class="Keyword">do</a>
    <a id="6384" href="Tactic.Derive.HsType.html#3891" class="Function">debug</a> <a id="6390" class="Number">10</a> <a id="6393" class="String">&quot;Making constructor %q : %q&quot;</a> <a id="6422" href="Tactic.Derive.HsType.html#6373" class="Bound">c</a> <a id="6424" href="Tactic.Derive.HsType.html#6357" class="Bound">agdaName</a>
    <a id="6437" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6441" href="Tactic.Derive.HsType.html#6441" class="Bound">agdaName&#39;</a> <a id="6451" class="Symbol">_</a> <a id="6453" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6455" href="Agda.Builtin.Reflection.html#8972" class="Postulate">normalise</a> <a id="6465" class="Symbol">(</a><a id="6466" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6470" href="Tactic.Derive.HsType.html#6357" class="Bound">agdaName</a> <a id="6479" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6481" class="Symbol">)</a>
      <a id="6489" class="Keyword">where</a> <a id="6495" class="CatchallClause Symbol">_</a> <a id="6497" class="Symbol">→</a> <a id="6499" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="6512" class="String">&quot;Failed to compute source type for %q&quot;</a> <a id="6551" href="Tactic.Derive.HsType.html#6357" class="Bound">agdaName</a>
    <a id="6564" href="Tactic.Derive.HsType.html#6564" class="Bound">hsC</a>  <a id="6569" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6571" href="Tactic.Derive.HsType.html#4976" class="Function">freshHsConName</a> <a id="6586" href="Tactic.Derive.HsType.html#6353" class="Bound">env</a> <a id="6590" href="Tactic.Derive.HsType.html#6366" class="Bound">hsName</a> <a id="6597" href="Tactic.Derive.HsType.html#6373" class="Bound">c</a>
    <a id="6603" href="Tactic.Derive.HsType.html#6603" class="Bound">cTy</a>  <a id="6608" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6610" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="6618" href="Tactic.Derive.HsType.html#6373" class="Bound">c</a>
    <a id="6624" href="Tactic.Derive.HsType.html#3891" class="Function">debug</a> <a id="6630" class="Number">10</a> <a id="6633" class="String">&quot;cTy = %t&quot;</a> <a id="6644" href="Tactic.Derive.HsType.html#6603" class="Bound">cTy</a>
    <a id="6652" href="Tactic.Derive.HsType.html#6652" class="Bound">hsTy</a> <a id="6657" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6659" href="Tactic.Derive.HsType.html#5301" class="Function">computeHsType</a> <a id="6673" href="Tactic.Derive.HsType.html#6441" class="Bound">agdaName&#39;</a> <a id="6683" href="Tactic.Derive.HsType.html#6366" class="Bound">hsName</a> <a id="6690" href="Tactic.Derive.HsType.html#6603" class="Bound">cTy</a>
    <a id="6698" href="Tactic.Derive.HsType.html#3891" class="Function">debug</a> <a id="6704" class="Number">10</a> <a id="6707" class="String">&quot;hsTy = %t&quot;</a> <a id="6719" href="Tactic.Derive.HsType.html#6652" class="Bound">hsTy</a>
    <a id="6728" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6733" class="Symbol">(</a><a id="6734" href="Tactic.Derive.HsType.html#6564" class="Bound">hsC</a> <a id="6738" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6740" href="Agda.Builtin.Reflection.html#3241" class="InductiveConstructor">quantity-ω</a> <a id="6751" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6753" href="Tactic.Derive.HsType.html#6652" class="Bound">hsTy</a><a id="6757" class="Symbol">)</a>

  <a id="makeHsData"></a><a id="6762" href="Tactic.Derive.HsType.html#6762" class="Function">makeHsData</a> <a id="6773" class="Symbol">:</a> <a id="6775" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="6783" class="Symbol">→</a> <a id="6785" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6790" class="Symbol">→</a> <a id="6792" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6794" class="Symbol">→</a> <a id="6796" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6801" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6806" class="Symbol">→</a> <a id="6808" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="6811" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="6818" href="Tactic.Derive.HsType.html#6762" class="Function">makeHsData</a> <a id="6829" href="Tactic.Derive.HsType.html#6829" class="Bound">env</a> <a id="6833" href="Tactic.Derive.HsType.html#6833" class="Bound">agdaName</a> <a id="6842" href="Tactic.Derive.HsType.html#6842" class="Bound">nPars</a> <a id="6848" href="Tactic.Derive.HsType.html#6848" class="Bound">constrs</a> <a id="6856" class="Symbol">=</a> <a id="6858" class="Keyword">do</a>
    <a id="6865" href="Tactic.Derive.HsType.html#6865" class="Bound">hsName</a> <a id="6872" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6874" href="Tactic.Derive.HsType.html#4633" class="Function">freshHsTypeName</a> <a id="6890" href="Tactic.Derive.HsType.html#6829" class="Bound">env</a> <a id="6894" href="Tactic.Derive.HsType.html#6833" class="Bound">agdaName</a>
    <a id="6907" href="Agda.Builtin.Reflection.html#9556" class="Postulate">declareData</a> <a id="6919" href="Tactic.Derive.HsType.html#6865" class="Bound">hsName</a> <a id="6926" class="Number">0</a> <a id="6928" href="Tactic.Derive.HsType.html#1367" class="Function">`Set</a>
    <a id="6937" href="Tactic.Derive.HsType.html#6937" class="Bound">hsCons</a> <a id="6944" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="6946" href="Class.Monad.Core.html#713" class="Function">mapM</a> <a id="6951" class="Symbol">(</a><a id="6952" href="Tactic.Derive.HsType.html#6246" class="Function">makeHsCon</a> <a id="6962" href="Tactic.Derive.HsType.html#6829" class="Bound">env</a> <a id="6966" href="Tactic.Derive.HsType.html#6833" class="Bound">agdaName</a> <a id="6975" href="Tactic.Derive.HsType.html#6865" class="Bound">hsName</a><a id="6981" class="Symbol">)</a> <a id="6983" href="Tactic.Derive.HsType.html#6848" class="Bound">constrs</a>
    <a id="6995" href="Agda.Builtin.Reflection.html#9602" class="Postulate">defineData</a> <a id="7006" href="Tactic.Derive.HsType.html#6865" class="Bound">hsName</a> <a id="7013" href="Tactic.Derive.HsType.html#6937" class="Bound">hsCons</a>
    <a id="7024" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="7029" href="Tactic.Derive.HsType.html#6865" class="Bound">hsName</a>

  <a id="makeHsType"></a><a id="7039" href="Tactic.Derive.HsType.html#7039" class="Function">makeHsType</a> <a id="7050" class="Symbol">:</a> <a id="7052" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="7060" class="Symbol">→</a> <a id="7062" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7067" class="Symbol">→</a> <a id="7069" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="7072" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="7079" href="Tactic.Derive.HsType.html#7039" class="Function">makeHsType</a> <a id="7090" href="Tactic.Derive.HsType.html#7090" class="Bound">env</a> <a id="7094" href="Tactic.Derive.HsType.html#7094" class="Bound">d</a> <a id="7096" class="Symbol">=</a> <a id="7098" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="7112" href="Tactic.Derive.HsType.html#7094" class="Bound">d</a> <a id="7114" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="7118" class="Symbol">λ</a> <a id="7120" class="Keyword">where</a>
      <a id="7132" class="Symbol">(</a><a id="7133" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="7143" href="Tactic.Derive.HsType.html#7143" class="Bound">pars</a> <a id="7148" href="Tactic.Derive.HsType.html#7148" class="Bound">cs</a><a id="7150" class="Symbol">)</a> <a id="7152" class="Symbol">→</a> <a id="7154" href="Tactic.Derive.HsType.html#6762" class="Function">makeHsData</a> <a id="7165" href="Tactic.Derive.HsType.html#7090" class="Bound">env</a> <a id="7169" href="Tactic.Derive.HsType.html#7094" class="Bound">d</a> <a id="7171" href="Tactic.Derive.HsType.html#7143" class="Bound">pars</a> <a id="7176" href="Tactic.Derive.HsType.html#7148" class="Bound">cs</a>
      <a id="7185" class="Symbol">(</a><a id="7186" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="7198" href="Tactic.Derive.HsType.html#7198" class="Bound">c</a> <a id="7200" href="Tactic.Derive.HsType.html#7200" class="Bound">fs</a><a id="7202" class="Symbol">)</a>  <a id="7205" class="Symbol">→</a> <a id="7207" href="Tactic.Derive.HsType.html#6762" class="Function">makeHsData</a> <a id="7218" href="Tactic.Derive.HsType.html#7090" class="Bound">env</a> <a id="7222" href="Tactic.Derive.HsType.html#7094" class="Bound">d</a> <a id="7224" class="Number">0</a> <a id="7226" class="Symbol">(</a><a id="7227" href="Tactic.Derive.HsType.html#7198" class="Bound">c</a> <a id="7229" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7231" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7233" class="Symbol">)</a>
      <a id="7241" class="CatchallClause Symbol">_</a>                   <a id="7261" class="Symbol">→</a> <a id="7263" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="7276" class="String">&quot;%q is not a data or record type&quot;</a> <a id="7310" href="Tactic.Derive.HsType.html#7094" class="Bound">d</a>

  <a id="joinStrings"></a><a id="7315" href="Tactic.Derive.HsType.html#7315" class="Function">joinStrings</a> <a id="7327" class="Symbol">:</a> <a id="7329" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7336" class="Symbol">→</a> <a id="7338" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7343" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7350" class="Symbol">→</a> <a id="7352" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7361" href="Tactic.Derive.HsType.html#7315" class="Function">joinStrings</a> <a id="7373" href="Tactic.Derive.HsType.html#7373" class="Bound">sep</a> <a id="7377" href="Tactic.Derive.HsType.html#7377" class="Bound">ss</a> <a id="7380" class="Symbol">=</a> <a id="7382" href="Data.List.Base.html#4148" class="Function">foldr</a> <a id="7388" href="Tactic.Derive.HsType.html#506" class="Function Operator">_&amp;_</a> <a id="7392" class="String">&quot;&quot;</a> <a id="7395" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7397" href="Data.List.Base.html#1819" class="Function">intersperse</a> <a id="7409" href="Tactic.Derive.HsType.html#7373" class="Bound">sep</a> <a id="7413" href="Tactic.Derive.HsType.html#7377" class="Bound">ss</a>

  <a id="compilePragma"></a><a id="7419" href="Tactic.Derive.HsType.html#7419" class="Function">compilePragma</a> <a id="7433" class="Symbol">:</a> <a id="7435" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7440" class="Symbol">→</a> <a id="7442" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7447" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7452" class="Symbol">→</a> <a id="7454" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7463" href="Tactic.Derive.HsType.html#7419" class="Function">compilePragma</a> <a id="7477" href="Tactic.Derive.HsType.html#7477" class="Bound">d</a> <a id="7479" href="Tactic.Derive.HsType.html#7479" class="Bound">cs</a> <a id="7482" class="Symbol">=</a> <a id="7484" href="Text.Printf.html#1015" class="Function">printf</a> <a id="7491" class="String">&quot;= data %s (%s)&quot;</a> <a id="7508" class="Symbol">(</a><a id="7509" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="7518" href="Tactic.Derive.HsType.html#7477" class="Bound">d</a><a id="7519" class="Symbol">)</a> <a id="7521" class="Symbol">(</a><a id="7522" href="Tactic.Derive.HsType.html#7315" class="Function">joinStrings</a> <a id="7534" class="String">&quot; | &quot;</a> <a id="7540" class="Symbol">(</a><a id="7541" href="Data.List.Base.html#1634" class="Function">map</a> <a id="7545" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="7554" href="Tactic.Derive.HsType.html#7479" class="Bound">cs</a><a id="7556" class="Symbol">))</a>

  <a id="renderHsTypeName"></a><a id="7562" href="Tactic.Derive.HsType.html#7562" class="Function">renderHsTypeName</a> <a id="7579" class="Symbol">:</a> <a id="7581" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7586" class="Symbol">→</a> <a id="7588" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7597" href="Tactic.Derive.HsType.html#7562" class="Function">renderHsTypeName</a> <a id="7614" href="Tactic.Derive.HsType.html#7614" class="Bound">d</a> <a id="7616" class="Symbol">=</a> <a id="7618" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="7628" class="Symbol">(</a><a id="7629" class="String">&quot;MAlonzo.Code.&quot;</a> <a id="7645" href="Data.String.Base.html#2425" class="Function Operator">String.++</a> <a id="7655" href="Reflection.AST.Show.html#1581" class="Primitive">R.showName</a> <a id="7666" href="Tactic.Derive.HsType.html#7614" class="Bound">d</a><a id="7667" class="Symbol">)</a> <a id="7669" class="Symbol">(</a><a id="7670" href="Tactic.Derive.HsType.html#1954" class="Function">lookup</a> <a id="7677" href="Tactic.Derive.HsType.html#7614" class="Bound">d</a> <a id="7679" href="Tactic.Derive.HsType.html#4049" class="Function">specialHsTypes</a><a id="7693" class="Symbol">)</a>

  <a id="renderHsType"></a><a id="7698" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="7711" class="Symbol">:</a> <a id="7713" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="7718" class="Symbol">→</a> <a id="7720" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="renderHsArgs"></a><a id="7729" href="Tactic.Derive.HsType.html#7729" class="Function">renderHsArgs</a> <a id="7742" class="Symbol">:</a> <a id="7744" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7749" class="Symbol">(</a><a id="7750" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="7754" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="7758" class="Symbol">)</a> <a id="7760" class="Symbol">→</a> <a id="7762" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7767" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

  <a id="7777" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="7790" class="Symbol">(</a><a id="7791" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="7795" class="Symbol">(</a><a id="7796" class="Keyword">quote</a> <a id="7802" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="7806" class="Symbol">)</a> <a id="7808" class="Symbol">(_</a> <a id="7811" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7813" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="7818" href="Tactic.Derive.HsType.html#7818" class="Bound">a</a> <a id="7820" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7822" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7824" class="Symbol">))</a> <a id="7827" class="Symbol">=</a> <a id="7829" href="Text.Printf.html#1015" class="Function">printf</a> <a id="7836" class="String">&quot;[%s]&quot;</a> <a id="7843" class="Symbol">(</a><a id="7844" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="7857" href="Tactic.Derive.HsType.html#7818" class="Bound">a</a><a id="7858" class="Symbol">)</a>
  <a id="7862" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="7875" class="Symbol">(</a><a id="7876" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="7880" class="Symbol">(</a><a id="7881" class="Keyword">quote</a> <a id="7887" href="Foreign.Haskell.Pair.html#534" class="Record">Pair</a><a id="7891" class="Symbol">)</a> <a id="7893" class="Symbol">(_</a> <a id="7896" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7898" class="Symbol">_</a> <a id="7900" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7902" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="7907" href="Tactic.Derive.HsType.html#7907" class="Bound">a</a> <a id="7909" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7911" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="7916" href="Tactic.Derive.HsType.html#7916" class="Bound">b</a> <a id="7918" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7920" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7922" class="Symbol">))</a> <a id="7925" class="Symbol">=</a> <a id="7927" href="Text.Printf.html#1015" class="Function">printf</a> <a id="7934" class="String">&quot;(%s, %s)&quot;</a> <a id="7945" class="Symbol">(</a><a id="7946" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="7959" href="Tactic.Derive.HsType.html#7907" class="Bound">a</a><a id="7960" class="Symbol">)</a> <a id="7962" class="Symbol">(</a><a id="7963" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="7976" href="Tactic.Derive.HsType.html#7916" class="Bound">b</a><a id="7977" class="Symbol">)</a>
  <a id="7981" href="Tactic.Derive.HsType.html#7698" class="CatchallClause Function">renderHsType</a><a id="7993" class="CatchallClause"> </a><a id="7994" class="CatchallClause Symbol">(</a><a id="7995" href="Agda.Builtin.Reflection.html#5251" class="CatchallClause InductiveConstructor">def</a><a id="7998" class="CatchallClause"> </a><a id="7999" href="Tactic.Derive.HsType.html#7999" class="CatchallClause Bound">d</a><a id="8000" class="CatchallClause"> </a><a id="8001" href="Agda.Builtin.List.html#184" class="CatchallClause InductiveConstructor">[]</a><a id="8003" class="CatchallClause Symbol">)</a> <a id="8005" class="Symbol">=</a> <a id="8007" href="Tactic.Derive.HsType.html#7562" class="Function">renderHsTypeName</a> <a id="8024" href="Tactic.Derive.HsType.html#7999" class="Bound">d</a>
  <a id="8028" href="Tactic.Derive.HsType.html#7698" class="CatchallClause Function">renderHsType</a><a id="8040" class="CatchallClause"> </a><a id="8041" class="CatchallClause Symbol">(</a><a id="8042" href="Agda.Builtin.Reflection.html#5251" class="CatchallClause InductiveConstructor">def</a><a id="8045" class="CatchallClause"> </a><a id="8046" href="Tactic.Derive.HsType.html#8046" class="CatchallClause Bound">d</a><a id="8047" class="CatchallClause"> </a><a id="8048" href="Tactic.Derive.HsType.html#8048" class="CatchallClause Bound">vs</a><a id="8050" class="CatchallClause Symbol">)</a> <a id="8052" class="Symbol">=</a> <a id="8054" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8061" class="String">&quot;(%s %s)&quot;</a> <a id="8071" class="Symbol">(</a><a id="8072" href="Tactic.Derive.HsType.html#7562" class="Function">renderHsTypeName</a> <a id="8089" href="Tactic.Derive.HsType.html#8046" class="Bound">d</a><a id="8090" class="Symbol">)</a> <a id="8092" class="Symbol">(</a><a id="8093" href="Tactic.Derive.HsType.html#7315" class="Function">joinStrings</a> <a id="8105" class="String">&quot; &quot;</a> <a id="8109" class="Symbol">(</a><a id="8110" href="Tactic.Derive.HsType.html#7729" class="Function">renderHsArgs</a> <a id="8123" href="Tactic.Derive.HsType.html#8048" class="Bound">vs</a><a id="8125" class="Symbol">))</a>
  <a id="8130" href="Tactic.Derive.HsType.html#7698" class="CatchallClause Function">renderHsType</a><a id="8142" class="CatchallClause"> </a><a id="8143" href="Tactic.Derive.HsType.html#8143" class="CatchallClause Bound">t</a> <a id="8145" class="Symbol">=</a> <a id="8147" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8154" class="String">&quot;(TODO: renderHsType %s)&quot;</a> <a id="8180" class="Symbol">(</a><a id="8181" href="Class.Show.Core.html#178" class="Field">show</a> <a id="8186" href="Tactic.Derive.HsType.html#8143" class="Bound">t</a><a id="8187" class="Symbol">)</a>

  <a id="8192" href="Tactic.Derive.HsType.html#7729" class="Function">renderHsArgs</a> <a id="8205" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8208" class="Symbol">=</a> <a id="8210" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="8215" href="Tactic.Derive.HsType.html#7729" class="Function">renderHsArgs</a> <a id="8228" class="Symbol">(</a><a id="8229" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="8234" href="Tactic.Derive.HsType.html#8234" class="Bound">a</a> <a id="8236" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8238" href="Tactic.Derive.HsType.html#8238" class="Bound">as</a><a id="8240" class="Symbol">)</a> <a id="8242" class="Symbol">=</a> <a id="8244" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="8257" href="Tactic.Derive.HsType.html#8234" class="Bound">a</a> <a id="8259" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8261" href="Tactic.Derive.HsType.html#7729" class="Function">renderHsArgs</a> <a id="8274" href="Tactic.Derive.HsType.html#8238" class="Bound">as</a>
  <a id="8279" href="Tactic.Derive.HsType.html#7729" class="CatchallClause Function">renderHsArgs</a><a id="8291" class="CatchallClause"> </a><a id="8292" class="CatchallClause Symbol">(_</a><a id="8294" class="CatchallClause"> </a><a id="8295" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="8296" class="CatchallClause"> </a><a id="8297" href="Tactic.Derive.HsType.html#8297" class="CatchallClause Bound">as</a><a id="8299" class="CatchallClause Symbol">)</a> <a id="8301" class="Symbol">=</a> <a id="8303" href="Tactic.Derive.HsType.html#7729" class="Function">renderHsArgs</a> <a id="8316" href="Tactic.Derive.HsType.html#8297" class="Bound">as</a>

  <a id="foreignPragma"></a><a id="8322" href="Tactic.Derive.HsType.html#8322" class="Function">foreignPragma</a> <a id="8336" class="Symbol">:</a> <a id="8338" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8343" class="Symbol">→</a> <a id="8345" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8350" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8355" class="Symbol">→</a> <a id="8357" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="8360" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="8369" href="Tactic.Derive.HsType.html#8322" class="Function">foreignPragma</a> <a id="8383" href="Tactic.Derive.HsType.html#8383" class="Bound">d</a> <a id="8385" href="Tactic.Derive.HsType.html#8385" class="Bound">cs</a> <a id="8388" class="Symbol">=</a> <a id="8390" class="Keyword">do</a>
    <a id="8397" href="Tactic.Derive.HsType.html#8397" class="Bound">cons</a> <a id="8402" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="8404" href="Class.Monad.Core.html#932" class="Function">forM</a> <a id="8409" href="Tactic.Derive.HsType.html#8385" class="Bound">cs</a> <a id="8412" class="Symbol">λ</a> <a id="8414" href="Tactic.Derive.HsType.html#8414" class="Bound">c</a> <a id="8416" class="Symbol">→</a> <a id="8418" class="Keyword">do</a>
            <a id="8433" href="Tactic.Derive.HsType.html#8433" class="Bound">tel</a> <a id="8437" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8439" class="Symbol">_</a> <a id="8441" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="8443" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="8450" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="8454" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="8462" href="Tactic.Derive.HsType.html#8414" class="Bound">c</a>
            <a id="8476" class="Keyword">let</a> <a id="8480" href="Tactic.Derive.HsType.html#8480" class="Bound">args</a> <a id="8485" class="Symbol">=</a> <a id="8487" href="Data.List.Base.html#1634" class="Function">map</a> <a id="8491" href="Reflection.AST.Abstraction.html#1816" class="Function">unAbs</a> <a id="8497" href="Tactic.Derive.HsType.html#8433" class="Bound">tel</a>
            <a id="8513" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="8518" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="8520" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8527" class="String">&quot;%s %s&quot;</a> <a id="8535" class="Symbol">(</a><a id="8536" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="8545" href="Tactic.Derive.HsType.html#8414" class="Bound">c</a><a id="8546" class="Symbol">)</a> <a id="8548" class="Symbol">(</a><a id="8549" href="Tactic.Derive.HsType.html#7315" class="Function">joinStrings</a> <a id="8561" class="String">&quot; &quot;</a> <a id="8565" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="8567" href="Tactic.Derive.HsType.html#7729" class="Function">renderHsArgs</a> <a id="8580" href="Tactic.Derive.HsType.html#8480" class="Bound">args</a><a id="8584" class="Symbol">)</a>
    <a id="8590" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="8595" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="8597" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8604" class="String">&quot;data %s = %s\n  deriving (Show, Eq, Generic)&quot;</a>
                  <a id="8669" class="Symbol">(</a><a id="8670" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="8679" href="Tactic.Derive.HsType.html#8383" class="Bound">d</a><a id="8680" class="Symbol">)</a> <a id="8682" class="Symbol">(</a><a id="8683" href="Tactic.Derive.HsType.html#7315" class="Function">joinStrings</a> <a id="8695" class="String">&quot; | &quot;</a> <a id="8701" href="Tactic.Derive.HsType.html#8397" class="Bound">cons</a><a id="8705" class="Symbol">)</a>

  <a id="8710" class="Comment">-- Record types</a>
  <a id="foreignPragmaRec"></a><a id="8728" href="Tactic.Derive.HsType.html#8728" class="Function">foreignPragmaRec</a> <a id="8745" class="Symbol">:</a> <a id="8747" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="8755" class="Symbol">→</a> <a id="8757" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8762" class="Symbol">→</a> <a id="8764" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8769" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8774" class="Symbol">→</a> <a id="8776" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8781" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8786" class="Symbol">→</a> <a id="8788" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="8791" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="8800" href="Tactic.Derive.HsType.html#8728" class="Function">foreignPragmaRec</a> <a id="8817" class="Symbol">_</a> <a id="8819" href="Tactic.Derive.HsType.html#8819" class="Bound">d</a> <a id="8821" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8824" class="Symbol">_</a> <a id="8826" class="Symbol">=</a> <a id="8828" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="8841" class="String">&quot;impossible: %q is a record type with no constructors&quot;</a> <a id="8896" href="Tactic.Derive.HsType.html#8819" class="Bound">d</a>
  <a id="8900" href="Tactic.Derive.HsType.html#8728" class="Function">foreignPragmaRec</a> <a id="8917" href="Tactic.Derive.HsType.html#8917" class="Bound">env</a> <a id="8921" href="Tactic.Derive.HsType.html#8921" class="Bound">d</a> <a id="8923" class="Symbol">(</a><a id="8924" href="Tactic.Derive.HsType.html#8924" class="Bound">c</a> <a id="8926" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8928" class="Symbol">_)</a> <a id="8931" href="Tactic.Derive.HsType.html#8931" class="Bound">fs</a> <a id="8934" class="Symbol">=</a> <a id="8936" class="Keyword">do</a>
    <a id="8943" href="Tactic.Derive.HsType.html#8943" class="Bound">tel</a> <a id="8947" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8949" class="Symbol">_</a> <a id="8951" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="8953" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="8960" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="8964" href="Agda.Builtin.Reflection.html#10159" class="Postulate">withNormalisation</a> <a id="8982" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="8987" class="Symbol">(</a><a id="8988" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="8996" href="Tactic.Derive.HsType.html#8924" class="Bound">c</a><a id="8997" class="Symbol">)</a>
    <a id="9003" class="Keyword">let</a> <a id="9007" href="Tactic.Derive.HsType.html#9007" class="Bound">fNames</a> <a id="9014" class="Symbol">=</a> <a id="9016" href="Data.List.Base.html#1634" class="Function">map</a> <a id="9020" class="Symbol">(</a><a id="9021" href="Tactic.Derive.HsType.html#4851" class="Function">hsFieldName</a> <a id="9033" href="Tactic.Derive.HsType.html#8917" class="Bound">env</a><a id="9036" class="Symbol">)</a> <a id="9038" href="Tactic.Derive.HsType.html#8931" class="Bound">fs</a>
    <a id="9045" class="Keyword">let</a> <a id="9049" href="Tactic.Derive.HsType.html#9049" class="Bound">args</a> <a id="9054" class="Symbol">=</a> <a id="9056" href="Data.List.Base.html#1634" class="Function">map</a> <a id="9060" href="Reflection.AST.Abstraction.html#1816" class="Function">unAbs</a> <a id="9066" href="Tactic.Derive.HsType.html#8943" class="Bound">tel</a>
        <a id="9078" href="Tactic.Derive.HsType.html#9078" class="Bound">renderField</a> <a id="9090" href="Tactic.Derive.HsType.html#9090" class="Bound">f</a> <a id="9092" href="Tactic.Derive.HsType.html#9092" class="Bound">ty</a> <a id="9095" class="Symbol">=</a> <a id="9097" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9104" class="String">&quot;%s :: %s&quot;</a> <a id="9115" href="Tactic.Derive.HsType.html#9090" class="Bound">f</a> <a id="9117" class="Symbol">(</a><a id="9118" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="9131" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="9133" href="Reflection.AST.Argument.html#2658" class="Function">unArg</a> <a id="9139" href="Tactic.Derive.HsType.html#9092" class="Bound">ty</a><a id="9141" class="Symbol">)</a>
        <a id="9151" href="Tactic.Derive.HsType.html#9151" class="Bound">con</a> <a id="9155" class="Symbol">=</a> <a id="9157" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9164" class="String">&quot;%s {%s}&quot;</a> <a id="9174" class="Symbol">(</a><a id="9175" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="9184" href="Tactic.Derive.HsType.html#8924" class="Bound">c</a><a id="9185" class="Symbol">)</a> <a id="9187" class="Symbol">(</a><a id="9188" href="Tactic.Derive.HsType.html#7315" class="Function">joinStrings</a> <a id="9200" class="String">&quot;, &quot;</a> <a id="9205" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="9207" href="Data.List.Base.html#2734" class="Function">zipWith</a> <a id="9215" href="Tactic.Derive.HsType.html#9078" class="Bound">renderField</a> <a id="9227" href="Tactic.Derive.HsType.html#9007" class="Bound">fNames</a> <a id="9234" href="Tactic.Derive.HsType.html#9049" class="Bound">args</a><a id="9238" class="Symbol">)</a>
    <a id="9244" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="9249" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="9251" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9258" class="String">&quot;data %s = %s\n  deriving (Show, Eq, Generic)&quot;</a>
                  <a id="9323" class="Symbol">(</a><a id="9324" href="Tactic.Derive.Show.html#820" class="Function">showName</a> <a id="9333" href="Tactic.Derive.HsType.html#8921" class="Bound">d</a><a id="9334" class="Symbol">)</a> <a id="9336" href="Tactic.Derive.HsType.html#9151" class="Bound">con</a>

  <a id="hsImports"></a><a id="9343" href="Tactic.Derive.HsType.html#9343" class="Function">hsImports</a> <a id="9353" class="Symbol">:</a> <a id="9355" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="9364" href="Tactic.Derive.HsType.html#9343" class="Function">hsImports</a> <a id="9374" class="Symbol">=</a> <a id="9376" class="String">&quot;import GHC.Generics (Generic)&quot;</a>

  <a id="9411" class="Comment">-- Take the name of a simple data type and generate the COMPILE and</a>
  <a id="9481" class="Comment">-- FOREIGN pragmas to bind to Haskell.</a>
  <a id="bindHsType"></a><a id="9522" href="Tactic.Derive.HsType.html#9522" class="Function">bindHsType</a> <a id="9533" class="Symbol">:</a> <a id="9535" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="9543" class="Symbol">→</a> <a id="9545" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9550" class="Symbol">→</a> <a id="9552" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9557" class="Symbol">→</a> <a id="9559" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="9562" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="9566" href="Tactic.Derive.HsType.html#9522" class="Function">bindHsType</a> <a id="9577" href="Tactic.Derive.HsType.html#9577" class="Bound">env</a> <a id="9581" href="Tactic.Derive.HsType.html#9581" class="Bound">agdaName</a> <a id="9590" href="Tactic.Derive.HsType.html#9590" class="Bound">hsName</a> <a id="9597" class="Symbol">=</a> <a id="9599" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="9613" href="Tactic.Derive.HsType.html#9590" class="Bound">hsName</a> <a id="9620" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="9624" class="Symbol">λ</a> <a id="9626" class="Keyword">where</a>
    <a id="9636" class="Symbol">(</a><a id="9637" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="9647" href="Tactic.Derive.HsType.html#9647" class="Bound">pars</a> <a id="9652" href="Tactic.Derive.HsType.html#9652" class="Bound">cs</a><a id="9654" class="Symbol">)</a> <a id="9656" class="Symbol">→</a> <a id="9658" class="Keyword">do</a>
      <a id="9667" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="9681" class="String">&quot;GHC&quot;</a> <a id="9687" href="Tactic.Derive.HsType.html#9343" class="Function">hsImports</a>
      <a id="9703" href="Agda.Builtin.Reflection.html#9970" class="Postulate">pragmaCompile</a> <a id="9717" class="String">&quot;GHC&quot;</a> <a id="9723" href="Tactic.Derive.HsType.html#9590" class="Bound">hsName</a> <a id="9730" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="9732" href="Tactic.Derive.HsType.html#7419" class="Function">compilePragma</a> <a id="9746" href="Tactic.Derive.HsType.html#9590" class="Bound">hsName</a> <a id="9753" href="Tactic.Derive.HsType.html#9652" class="Bound">cs</a>
      <a id="9762" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="9776" href="Tactic.Derive.HsType.html#9581" class="Bound">agdaName</a> <a id="9785" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="9789" class="Symbol">λ</a> <a id="9791" class="Keyword">where</a>
        <a id="9805" class="Symbol">(</a><a id="9806" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="9816" class="Symbol">_</a> <a id="9818" class="Symbol">_)</a>    <a id="9824" class="Symbol">→</a> <a id="9826" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="9840" class="String">&quot;GHC&quot;</a> <a id="9846" href="Class.Monad.Core.html#379" class="Function Operator">=&lt;&lt;</a> <a id="9850" href="Tactic.Derive.HsType.html#8322" class="Function">foreignPragma</a> <a id="9864" href="Tactic.Derive.HsType.html#9590" class="Bound">hsName</a> <a id="9871" href="Tactic.Derive.HsType.html#9652" class="Bound">cs</a>
        <a id="9882" class="Symbol">(</a><a id="9883" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="9895" class="Symbol">_</a> <a id="9897" href="Tactic.Derive.HsType.html#9897" class="Bound">fs</a><a id="9899" class="Symbol">)</a> <a id="9901" class="Symbol">→</a> <a id="9903" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="9917" class="String">&quot;GHC&quot;</a> <a id="9923" href="Class.Monad.Core.html#379" class="Function Operator">=&lt;&lt;</a> <a id="9927" href="Tactic.Derive.HsType.html#8728" class="Function">foreignPragmaRec</a> <a id="9944" href="Tactic.Derive.HsType.html#9577" class="Bound">env</a> <a id="9948" href="Tactic.Derive.HsType.html#9590" class="Bound">hsName</a> <a id="9955" href="Tactic.Derive.HsType.html#9652" class="Bound">cs</a> <a id="9958" class="Symbol">(</a><a id="9959" href="Data.List.Base.html#1634" class="Function">map</a> <a id="9963" href="Reflection.AST.Argument.html#2658" class="Function">unArg</a> <a id="9969" href="Tactic.Derive.HsType.html#9897" class="Bound">fs</a><a id="9971" class="Symbol">)</a>
        <a id="9981" class="CatchallClause Symbol">_</a> <a id="9983" class="Symbol">→</a> <a id="9985" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="9998" class="String">&quot;%q is not a data or record type&quot;</a> <a id="10032" href="Tactic.Derive.HsType.html#9581" class="Bound">agdaName</a>
    <a id="10045" class="CatchallClause Symbol">_</a> <a id="10047" class="Symbol">→</a> <a id="10049" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="10062" class="String">&quot;%q is not a data type (impossible)&quot;</a> <a id="10099" href="Tactic.Derive.HsType.html#9590" class="Bound">hsName</a>

  <a id="computeProjections"></a><a id="10109" href="Tactic.Derive.HsType.html#10109" class="Function">computeProjections</a> <a id="10128" class="Symbol">:</a> <a id="10130" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="10132" class="Symbol">→</a> <a id="10134" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10139" class="Symbol">→</a> <a id="10141" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="10144" class="Symbol">(</a><a id="10145" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="10150" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="10154" class="Symbol">)</a>
  <a id="10158" href="Tactic.Derive.HsType.html#10109" class="Function">computeProjections</a> <a id="10177" href="Tactic.Derive.HsType.html#10177" class="Bound">npars</a> <a id="10183" href="Tactic.Derive.HsType.html#10183" class="Bound">c</a> <a id="10185" class="Symbol">=</a> <a id="10187" class="Keyword">do</a>
    <a id="10194" href="Tactic.Derive.HsType.html#10194" class="Bound">argTys</a> <a id="10201" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10203" class="Symbol">_</a> <a id="10205" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="10207" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="10214" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="10218" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="10226" href="Tactic.Derive.HsType.html#10183" class="Bound">c</a>
    <a id="10232" class="Keyword">let</a> <a id="10236" href="Tactic.Derive.HsType.html#10236" class="Bound">is</a>  <a id="10240" class="Symbol">=</a> <a id="10242" href="Data.List.Base.html#6728" class="Function">downFrom</a> <a id="10251" class="Symbol">(</a><a id="10252" href="Data.List.Base.html#5044" class="Function">length</a> <a id="10259" href="Tactic.Derive.HsType.html#10194" class="Bound">argTys</a><a id="10265" class="Symbol">)</a>
        <a id="10275" href="Tactic.Derive.HsType.html#10275" class="Bound">tel</a> <a id="10279" class="Symbol">=</a> <a id="10281" href="Data.List.Base.html#1634" class="Function">map</a> <a id="10285" class="Symbol">(λ</a> <a id="10288" class="Keyword">where</a> <a id="10294" class="Symbol">(</a><a id="10295" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="10299" href="Tactic.Derive.HsType.html#10299" class="Bound">x</a> <a id="10301" href="Tactic.Derive.HsType.html#10301" class="Bound">ty</a><a id="10303" class="Symbol">)</a> <a id="10305" class="Symbol">→</a> <a id="10307" href="Tactic.Derive.HsType.html#10299" class="Bound">x</a> <a id="10309" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10311" href="Tactic.Derive.HsType.html#10301" class="Bound">ty</a><a id="10313" class="Symbol">)</a> <a id="10315" href="Tactic.Derive.HsType.html#10194" class="Bound">argTys</a>
        <a id="10330" href="Tactic.Derive.HsType.html#10330" class="Bound">lhs</a> <a id="10334" class="Symbol">=</a> <a id="10336" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="10341" class="Symbol">(</a><a id="10342" href="Agda.Builtin.Reflection.html#5814" class="InductiveConstructor">con</a> <a id="10346" href="Tactic.Derive.HsType.html#10183" class="Bound">c</a> <a id="10348" class="Symbol">(</a><a id="10349" href="Data.List.Base.html#1634" class="Function">map</a> <a id="10353" class="Symbol">(λ</a> <a id="10356" class="Keyword">where</a> <a id="10362" class="Symbol">(</a><a id="10363" href="Tactic.Derive.HsType.html#10363" class="Bound">i</a> <a id="10365" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10367" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="10371" href="Tactic.Derive.HsType.html#10371" class="Bound">x</a> <a id="10373" class="Symbol">(</a><a id="10374" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="10378" href="Tactic.Derive.HsType.html#10378" class="Bound">info</a> <a id="10383" class="Symbol">_))</a> <a id="10387" class="Symbol">→</a> <a id="10389" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="10393" href="Tactic.Derive.HsType.html#10378" class="Bound">info</a> <a id="10398" class="Symbol">(</a><a id="10399" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">var</a> <a id="10403" href="Tactic.Derive.HsType.html#10363" class="Bound">i</a><a id="10404" class="Symbol">))</a>
                               <a id="10438" class="Symbol">(</a><a id="10439" href="Data.List.Base.html#8807" class="Function">drop</a> <a id="10444" href="Tactic.Derive.HsType.html#10177" class="Bound">npars</a> <a id="10450" class="Symbol">(</a><a id="10451" href="Data.List.Base.html#3506" class="Function">zip</a> <a id="10455" href="Tactic.Derive.HsType.html#10236" class="Bound">is</a> <a id="10458" href="Tactic.Derive.HsType.html#10194" class="Bound">argTys</a><a id="10464" class="Symbol">))))</a> <a id="10469" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="10471" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="10478" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="10485" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="10487" href="Data.List.Base.html#1634" class="Function">map</a> <a id="10491" class="Symbol">(λ</a> <a id="10494" href="Tactic.Derive.HsType.html#10494" class="Bound">i</a> <a id="10496" class="Symbol">→</a> <a id="10498" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="10506" class="Symbol">(</a><a id="10507" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="10514" href="Tactic.Derive.HsType.html#10275" class="Bound">tel</a> <a id="10518" href="Tactic.Derive.HsType.html#10330" class="Bound">lhs</a> <a id="10522" class="Symbol">(</a><a id="10523" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="10527" href="Tactic.Derive.HsType.html#10494" class="Bound">i</a> <a id="10529" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10531" class="Symbol">)</a> <a id="10533" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="10535" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10537" class="Symbol">)</a> <a id="10539" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10541" class="Symbol">)</a> <a id="10543" class="Symbol">(</a><a id="10544" href="Data.List.Base.html#8807" class="Function">drop</a> <a id="10549" href="Tactic.Derive.HsType.html#10177" class="Bound">npars</a> <a id="10555" href="Tactic.Derive.HsType.html#10236" class="Bound">is</a><a id="10557" class="Symbol">)</a>

  <a id="makeTypeAlias"></a><a id="10562" href="Tactic.Derive.HsType.html#10562" class="Function">makeTypeAlias</a> <a id="10576" class="Symbol">:</a> <a id="10578" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10583" class="Symbol">→</a> <a id="10585" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="10593" class="Symbol">→</a> <a id="10595" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="10600" class="Symbol">→</a> <a id="10602" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="10605" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="10609" href="Tactic.Derive.HsType.html#10562" class="Function">makeTypeAlias</a> <a id="10623" href="Tactic.Derive.HsType.html#10623" class="Bound">agdaName</a> <a id="10632" href="Tactic.Derive.HsType.html#10632" class="Bound">env</a> <a id="10636" href="Tactic.Derive.HsType.html#10636" class="Bound">hole</a> <a id="10641" class="Symbol">=</a> <a id="10643" class="Keyword">do</a>
    <a id="10650" href="Tactic.Derive.HsType.html#10650" class="Bound">hsTy</a> <a id="10655" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="10657" href="Tactic.Derive.HsType.html#3614" class="Function">solveHsType</a> <a id="10669" class="Symbol">(</a><a id="10670" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="10674" href="Tactic.Derive.HsType.html#10623" class="Bound">agdaName</a> <a id="10683" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10685" class="Symbol">)</a>
    <a id="10691" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10705" class="String">&quot;GHC&quot;</a> <a id="10711" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="10713" href="Text.Printf.html#1015" class="Function">printf</a> <a id="10720" class="String">&quot;type %s = %s&quot;</a> <a id="10735" class="Symbol">(</a><a id="10736" href="Tactic.Derive.HsType.html#4513" class="Function">hsTypeName</a> <a id="10747" href="Tactic.Derive.HsType.html#10632" class="Bound">env</a> <a id="10751" href="Tactic.Derive.HsType.html#10623" class="Bound">agdaName</a><a id="10759" class="Symbol">)</a> <a id="10761" class="Symbol">(</a><a id="10762" href="Tactic.Derive.HsType.html#7698" class="Function">renderHsType</a> <a id="10775" href="Tactic.Derive.HsType.html#10650" class="Bound">hsTy</a><a id="10779" class="Symbol">)</a>
    <a id="10785" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="10791" href="Tactic.Derive.HsType.html#10636" class="Bound">hole</a> <a id="10796" class="Symbol">(</a><a id="10797" class="Keyword">quote</a> <a id="10803" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="10810" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="10813" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="10817" class="Symbol">(</a><a id="10818" class="Keyword">quote</a> <a id="10824" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="10826" class="Symbol">)</a> <a id="10828" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="10831" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="10832" class="Symbol">)</a>

<a id="10835" class="Comment">-- * Exported macros</a>

<a id="doAutoHsType"></a><a id="10857" href="Tactic.Derive.HsType.html#10857" class="Function">doAutoHsType</a> <a id="10870" class="Symbol">:</a> <a id="10872" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="10880" class="Symbol">→</a> <a id="10882" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10887" class="Symbol">→</a> <a id="10889" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="10894" class="Symbol">→</a> <a id="10896" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="10899" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="10904" href="Tactic.Derive.HsType.html#10857" class="Function">doAutoHsType</a> <a id="10917" href="Tactic.Derive.HsType.html#10917" class="Bound">env</a> <a id="10921" href="Tactic.Derive.HsType.html#10921" class="Bound">d</a> <a id="10923" href="Tactic.Derive.HsType.html#10923" class="Bound">hole</a> <a id="10928" class="Symbol">=</a> <a id="10930" class="Keyword">do</a>
  <a id="10935" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="10945" href="Tactic.Derive.HsType.html#10923" class="Bound">hole</a> <a id="10950" class="Symbol">(</a><a id="10951" class="Keyword">quote</a> <a id="10957" href="Class.HasHsType.Core.html#69" class="Record">HasHsType</a> <a id="10967" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">∙⟦</a> <a id="10970" href="Tactic.Derive.HsType.html#10921" class="Bound">d</a> <a id="10972" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a> <a id="10974" href="Reflection.Syntax.html#2924" class="InductiveConstructor Operator">⟧</a><a id="10975" class="Symbol">)</a>
  <a id="10979" href="Tactic.Derive.HsType.html#10979" class="Bound">hs</a> <a id="10982" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="10984" href="Tactic.Derive.HsType.html#7039" class="Function">makeHsType</a> <a id="10995" href="Tactic.Derive.HsType.html#10917" class="Bound">env</a> <a id="10999" href="Tactic.Derive.HsType.html#10921" class="Bound">d</a>
  <a id="11003" href="Tactic.Derive.HsType.html#3891" class="Function">debug</a> <a id="11009" class="Number">50</a> <a id="11012" class="String">&quot;  HsType %q = %q&quot;</a> <a id="11031" href="Tactic.Derive.HsType.html#10921" class="Bound">d</a> <a id="11033" href="Tactic.Derive.HsType.html#10979" class="Bound">hs</a>
  <a id="11038" href="Tactic.Derive.HsType.html#9522" class="Function">bindHsType</a> <a id="11049" href="Tactic.Derive.HsType.html#10917" class="Bound">env</a> <a id="11053" href="Tactic.Derive.HsType.html#10921" class="Bound">d</a> <a id="11055" href="Tactic.Derive.HsType.html#10979" class="Bound">hs</a>
  <a id="11060" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="11066" href="Tactic.Derive.HsType.html#10923" class="Bound">hole</a> <a id="11071" class="Symbol">(</a><a id="11072" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">`λ⟦</a> <a id="11076" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="11081" class="Symbol">(</a><a id="11082" class="Keyword">quote</a> <a id="11088" href="Class.HasHsType.Core.html#112" class="Field">HasHsType.HsType</a><a id="11104" class="Symbol">)</a> <a id="11106" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⇒</a> <a id="11108" href="Tactic.Derive.HsType.html#10979" class="Bound">hs</a> <a id="11111" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a> <a id="11113" href="Reflection.Syntax.html#2572" class="InductiveConstructor Operator">⟧</a><a id="11114" class="Symbol">)</a>
  <a id="11118" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="11123" class="Symbol">(</a><a id="11124" href="Tactic.Derive.HsType.html#10979" class="Bound">hs</a> <a id="11127" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a><a id="11128" class="Symbol">)</a>

<a id="11131" class="Keyword">macro</a>
  <a id="autoHsType"></a><a id="11139" href="Tactic.Derive.HsType.html#11139" class="Function">autoHsType</a> <a id="11150" class="Symbol">:</a> <a id="11152" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11157" class="Symbol">→</a> <a id="11159" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11164" class="Symbol">→</a> <a id="11166" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11169" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11173" href="Tactic.Derive.HsType.html#11139" class="Function">autoHsType</a> <a id="11184" href="Tactic.Derive.HsType.html#11184" class="Bound">d</a> <a id="11186" href="Tactic.Derive.HsType.html#11186" class="Bound">hole</a> <a id="11191" class="Symbol">=</a> <a id="11193" class="Symbol">_</a> <a id="11195" href="Class.Functor.Core.html#279" class="Function Operator">&lt;$</a> <a id="11198" href="Tactic.Derive.HsType.html#10857" class="Function">doAutoHsType</a> <a id="11211" href="Tactic.Derive.HsType.html#2343" class="Function">emptyEnv</a> <a id="11220" href="Tactic.Derive.HsType.html#11184" class="Bound">d</a> <a id="11222" href="Tactic.Derive.HsType.html#11186" class="Bound">hole</a>

  <a id="11230" class="Keyword">infix</a> <a id="11236" class="Number">0</a> <a id="11238" href="Tactic.Derive.HsType.html#11254" class="Function Operator">autoHsType_⊣_</a>
  <a id="autoHsType_⊣_"></a><a id="11254" href="Tactic.Derive.HsType.html#11254" class="Function Operator">autoHsType_⊣_</a> <a id="11268" class="Symbol">:</a> <a id="11270" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11275" class="Symbol">→</a> <a id="11277" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="11285" class="Symbol">→</a> <a id="11287" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11292" class="Symbol">→</a> <a id="11294" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11297" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11301" href="Tactic.Derive.HsType.html#11254" class="Function Operator">autoHsType_⊣_</a> <a id="11315" href="Tactic.Derive.HsType.html#11315" class="Bound">d</a> <a id="11317" href="Tactic.Derive.HsType.html#11317" class="Bound">env</a> <a id="11321" href="Tactic.Derive.HsType.html#11321" class="Bound">hole</a> <a id="11326" class="Symbol">=</a> <a id="11328" class="Symbol">_</a> <a id="11330" href="Class.Functor.Core.html#279" class="Function Operator">&lt;$</a> <a id="11333" href="Tactic.Derive.HsType.html#10857" class="Function">doAutoHsType</a> <a id="11346" href="Tactic.Derive.HsType.html#11317" class="Bound">env</a> <a id="11350" href="Tactic.Derive.HsType.html#11315" class="Bound">d</a> <a id="11352" href="Tactic.Derive.HsType.html#11321" class="Bound">hole</a>

  <a id="11360" class="Keyword">infix</a> <a id="11366" class="Number">9</a> <a id="11368" href="Tactic.Derive.HsType.html#11374" class="Function Operator">_↦_</a>
  <a id="_↦_"></a><a id="11374" href="Tactic.Derive.HsType.html#11374" class="Function Operator">_↦_</a> <a id="11378" class="Symbol">:</a> <a id="11380" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11385" class="Symbol">→</a> <a id="11387" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="11394" class="Symbol">→</a> <a id="11396" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11401" class="Symbol">→</a> <a id="11403" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11406" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11410" href="Tactic.Derive.HsType.html#11410" class="Bound">x</a> <a id="11412" href="Tactic.Derive.HsType.html#11374" class="Function Operator">↦</a> <a id="11414" href="Tactic.Derive.HsType.html#11414" class="Bound">s</a> <a id="11416" class="Symbol">=</a> <a id="11418" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="11424" class="Symbol">(</a><a id="11425" class="Keyword">quote</a> <a id="11431" href="Tactic.Derive.HsType.html#2534" class="Function">customName</a> <a id="11442" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∙⟦</a> <a id="11445" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="11449" class="Symbol">(</a><a id="11450" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="11455" href="Tactic.Derive.HsType.html#11410" class="Bound">x</a><a id="11456" class="Symbol">)</a> <a id="11458" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">∣</a> <a id="11460" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="11464" class="Symbol">(</a><a id="11465" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">string</a> <a id="11472" href="Tactic.Derive.HsType.html#11414" class="Bound">s</a><a id="11473" class="Symbol">)</a> <a id="11475" href="Reflection.Syntax.html#2964" class="InductiveConstructor Operator">⟧</a><a id="11476" class="Symbol">)</a>

  <a id="11481" class="Comment">-- Generate a Haskell type synonym for the HsType of the given type</a>
  <a id="11551" class="Comment">-- Usage `unquoteDecl = do hsTypeSynonym Foo; hsTypeSynonym Bar`</a>
  <a id="hsTypeAlias"></a><a id="11618" href="Tactic.Derive.HsType.html#11618" class="Function">hsTypeAlias</a> <a id="11630" class="Symbol">:</a> <a id="11632" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11637" class="Symbol">→</a> <a id="11639" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11644" class="Symbol">→</a> <a id="11646" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11649" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11653" href="Tactic.Derive.HsType.html#11618" class="Function">hsTypeAlias</a> <a id="11665" href="Tactic.Derive.HsType.html#11665" class="Bound">agdaName</a> <a id="11674" class="Symbol">=</a> <a id="11676" href="Tactic.Derive.HsType.html#10562" class="Function">makeTypeAlias</a> <a id="11690" href="Tactic.Derive.HsType.html#11665" class="Bound">agdaName</a> <a id="11699" href="Tactic.Derive.HsType.html#2343" class="Function">emptyEnv</a>

  <a id="11711" class="Comment">-- The only NameEnv that&#39;s useful here is `withName`.</a>
  <a id="hsTypeAlias_⊣_"></a><a id="11767" href="Tactic.Derive.HsType.html#11767" class="Function Operator">hsTypeAlias_⊣_</a> <a id="11782" class="Symbol">:</a> <a id="11784" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11789" class="Symbol">→</a> <a id="11791" href="Tactic.Derive.HsType.html#1467" class="Record">NameEnv</a> <a id="11799" class="Symbol">→</a> <a id="11801" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11806" class="Symbol">→</a> <a id="11808" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11811" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11815" href="Tactic.Derive.HsType.html#11767" class="Function Operator">hsTypeAlias</a> <a id="11827" href="Tactic.Derive.HsType.html#11827" class="Bound">agdaName</a> <a id="11836" href="Tactic.Derive.HsType.html#11767" class="Function Operator">⊣</a> <a id="11838" href="Tactic.Derive.HsType.html#11838" class="Bound">env</a> <a id="11842" class="Symbol">=</a> <a id="11844" href="Tactic.Derive.HsType.html#10562" class="Function">makeTypeAlias</a> <a id="11858" href="Tactic.Derive.HsType.html#11827" class="Bound">agdaName</a> <a id="11867" href="Tactic.Derive.HsType.html#11838" class="Bound">env</a>

  <a id="11874" class="Comment">-- * Macros for constructing and deconstructing generated types</a>

  <a id="hsCon"></a><a id="11941" href="Tactic.Derive.HsType.html#11941" class="Function">hsCon</a> <a id="11947" class="Symbol">:</a> <a id="11949" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11954" class="Symbol">→</a> <a id="11956" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="11958" class="Symbol">→</a> <a id="11960" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11965" class="Symbol">→</a> <a id="11967" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11970" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11974" href="Tactic.Derive.HsType.html#11941" class="Function">hsCon</a> <a id="11980" href="Tactic.Derive.HsType.html#11980" class="Bound">agdaTy</a> <a id="11987" href="Tactic.Derive.HsType.html#11987" class="Bound">i</a> <a id="11989" href="Tactic.Derive.HsType.html#11989" class="Bound">hole</a> <a id="11994" class="Symbol">=</a> <a id="11996" class="Keyword">do</a>
    <a id="12003" href="Tactic.Derive.HsType.html#12003" class="Bound">hsTy</a><a id="12007" class="Symbol">@(</a><a id="12009" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="12013" href="Tactic.Derive.HsType.html#12013" class="Bound">hsName</a> <a id="12020" class="Symbol">_)</a> <a id="12023" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="12025" href="Tactic.Derive.HsType.html#3614" class="Function">solveHsType</a> <a id="12037" href="Tactic.Derive.HsType.html#11980" class="Bound">agdaTy</a>
      <a id="12050" class="Keyword">where</a> <a id="12056" class="CatchallClause Symbol">_</a> <a id="12058" class="Symbol">→</a> <a id="12060" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12073" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="12106" href="Tactic.Derive.HsType.html#11980" class="Bound">agdaTy</a>
    <a id="12117" href="Tactic.Derive.HsType.html#12117" class="Bound">cs</a> <a id="12120" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="12122" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="12136" href="Tactic.Derive.HsType.html#12013" class="Bound">hsName</a> <a id="12143" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="12147" class="Symbol">λ</a> <a id="12149" class="Keyword">where</a>
      <a id="12161" class="Symbol">(</a><a id="12162" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="12172" class="Symbol">_</a> <a id="12174" href="Tactic.Derive.HsType.html#12174" class="Bound">cs</a><a id="12176" class="Symbol">)</a>  <a id="12179" class="Symbol">→</a> <a id="12181" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="12188" href="Tactic.Derive.HsType.html#12174" class="Bound">cs</a>
      <a id="12197" class="CatchallClause Symbol">_</a> <a id="12199" class="Symbol">→</a> <a id="12201" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12214" class="String">&quot;Expected HsType %t to be a data type, but got %t&quot;</a> <a id="12265" href="Tactic.Derive.HsType.html#11980" class="Bound">agdaTy</a> <a id="12272" href="Tactic.Derive.HsType.html#12003" class="Bound">hsTy</a>
    <a id="12281" href="Tactic.Derive.HsType.html#12281" class="Bound">c</a> <a id="12283" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="12285" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a> <a id="12292" href="Class.Monad.Core.html#269" class="Field">return</a>  <a id="12300" class="Symbol">(</a><a id="12301" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12314" class="String">&quot;%q has only %u constructors&quot;</a> <a id="12344" href="Tactic.Derive.HsType.html#12013" class="Bound">hsName</a> <a id="12351" class="Symbol">(</a><a id="12352" href="Data.List.Base.html#5044" class="Function">length</a> <a id="12359" href="Tactic.Derive.HsType.html#12117" class="Bound">cs</a><a id="12361" class="Symbol">))</a> <a id="12364" class="Symbol">(</a><a id="12365" href="Tactic.Derive.HsType.html#12117" class="Bound">cs</a> <a id="12368" href="Tactic.Derive.HsType.html#3934" class="Function Operator">‼</a> <a id="12370" href="Tactic.Derive.HsType.html#11987" class="Bound">i</a><a id="12371" class="Symbol">)</a>
    <a id="12377" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="12383" href="Tactic.Derive.HsType.html#11989" class="Bound">hole</a> <a id="12388" class="Symbol">(</a><a id="12389" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="12393" href="Tactic.Derive.HsType.html#12281" class="Bound">c</a> <a id="12395" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="12397" class="Symbol">)</a>

  <a id="hsProj"></a><a id="12402" href="Tactic.Derive.HsType.html#12402" class="Function">hsProj</a> <a id="12409" class="Symbol">:</a> <a id="12411" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12416" class="Symbol">→</a> <a id="12418" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="12420" class="Symbol">→</a> <a id="12422" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12427" class="Symbol">→</a> <a id="12429" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12432" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12436" href="Tactic.Derive.HsType.html#12402" class="Function">hsProj</a> <a id="12443" href="Tactic.Derive.HsType.html#12443" class="Bound">agdaTy</a> <a id="12450" href="Tactic.Derive.HsType.html#12450" class="Bound">i</a> <a id="12452" href="Tactic.Derive.HsType.html#12452" class="Bound">hole</a> <a id="12457" class="Symbol">=</a> <a id="12459" class="Keyword">do</a>
    <a id="12466" href="Tactic.Derive.HsType.html#12466" class="Bound">hsTy</a><a id="12470" class="Symbol">@(</a><a id="12472" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="12476" href="Tactic.Derive.HsType.html#12476" class="Bound">hsName</a> <a id="12483" class="Symbol">_)</a> <a id="12486" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="12488" href="Tactic.Derive.HsType.html#3614" class="Function">solveHsType</a> <a id="12500" href="Tactic.Derive.HsType.html#12443" class="Bound">agdaTy</a>
      <a id="12513" class="Keyword">where</a> <a id="12519" class="CatchallClause Symbol">_</a> <a id="12521" class="Symbol">→</a> <a id="12523" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12536" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="12569" href="Tactic.Derive.HsType.html#12443" class="Bound">agdaTy</a>
    <a id="12580" href="Tactic.Derive.HsType.html#12580" class="Bound">prjs</a> <a id="12585" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="12587" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="12601" href="Tactic.Derive.HsType.html#12476" class="Bound">hsName</a> <a id="12608" href="Class.Monad.Core.html#290" class="Field Operator">&gt;&gt;=</a> <a id="12612" class="Symbol">λ</a> <a id="12614" class="Keyword">where</a>
      <a id="12626" class="Symbol">(</a><a id="12627" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="12637" href="Tactic.Derive.HsType.html#12637" class="Bound">npars</a> <a id="12643" class="Symbol">(</a><a id="12644" href="Tactic.Derive.HsType.html#12644" class="Bound">c</a> <a id="12646" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="12648" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="12650" class="Symbol">))</a> <a id="12653" class="Symbol">→</a> <a id="12655" href="Tactic.Derive.HsType.html#10109" class="Function">computeProjections</a> <a id="12674" href="Tactic.Derive.HsType.html#12637" class="Bound">npars</a> <a id="12680" href="Tactic.Derive.HsType.html#12644" class="Bound">c</a>
      <a id="12688" class="CatchallClause Symbol">_</a> <a id="12690" class="Symbol">→</a> <a id="12692" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12705" class="String">&quot;Expected HsType %t to be a single constructor data type, but got %t&quot;</a> <a id="12775" href="Tactic.Derive.HsType.html#12443" class="Bound">agdaTy</a> <a id="12782" href="Tactic.Derive.HsType.html#12466" class="Bound">hsTy</a>
    <a id="12791" href="Tactic.Derive.HsType.html#12791" class="Bound">prj</a> <a id="12795" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="12797" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a> <a id="12804" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="12811" class="Symbol">(</a><a id="12812" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12825" class="String">&quot;%q has only %u fields&quot;</a> <a id="12849" href="Tactic.Derive.HsType.html#12476" class="Bound">hsName</a> <a id="12856" class="Symbol">(</a><a id="12857" href="Data.List.Base.html#5044" class="Function">length</a> <a id="12864" href="Tactic.Derive.HsType.html#12580" class="Bound">prjs</a><a id="12868" class="Symbol">))</a> <a id="12871" class="Symbol">(</a><a id="12872" href="Tactic.Derive.HsType.html#12580" class="Bound">prjs</a> <a id="12877" href="Tactic.Derive.HsType.html#3934" class="Function Operator">‼</a> <a id="12879" href="Tactic.Derive.HsType.html#12450" class="Bound">i</a><a id="12880" class="Symbol">)</a>
    <a id="12886" href="Tactic.Derive.HsType.html#12886" class="Bound">target</a> <a id="12893" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="12895" href="Reflection.TCM.html#1261" class="Function">newMeta</a> <a id="12903" href="Tactic.Derive.HsType.html#1367" class="Function">`Set</a>
    <a id="12912" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="12922" href="Tactic.Derive.HsType.html#12452" class="Bound">hole</a> <a id="12927" class="Symbol">(</a><a id="12928" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="12931" class="Symbol">(</a><a id="12932" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="12937" href="Tactic.Derive.HsType.html#12466" class="Bound">hsTy</a><a id="12941" class="Symbol">)</a> <a id="12943" class="Symbol">(</a><a id="12944" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="12948" class="String">&quot;_&quot;</a> <a id="12952" href="Tactic.Derive.HsType.html#12886" class="Bound">target</a><a id="12958" class="Symbol">))</a>
    <a id="12965" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="12971" href="Tactic.Derive.HsType.html#12452" class="Bound">hole</a> <a id="12976" href="Tactic.Derive.HsType.html#12791" class="Bound">prj</a>

  <a id="hsTyName"></a><a id="12983" href="Tactic.Derive.HsType.html#12983" class="Function">hsTyName</a> <a id="12992" class="Symbol">:</a> <a id="12994" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12999" class="Symbol">→</a> <a id="13001" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13006" class="Symbol">→</a> <a id="13008" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="13011" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="13015" href="Tactic.Derive.HsType.html#12983" class="Function">hsTyName</a> <a id="13024" href="Tactic.Derive.HsType.html#13024" class="Bound">agdaTy</a> <a id="13031" href="Tactic.Derive.HsType.html#13031" class="Bound">hole</a> <a id="13036" class="Symbol">=</a> <a id="13038" class="Keyword">do</a>
    <a id="13045" href="Tactic.Derive.HsType.html#13045" class="Bound">hsTy</a><a id="13049" class="Symbol">@(</a><a id="13051" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="13055" href="Tactic.Derive.HsType.html#13055" class="Bound">hsName</a> <a id="13062" class="Symbol">_)</a> <a id="13065" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="13067" href="Tactic.Derive.HsType.html#3614" class="Function">solveHsType</a> <a id="13079" href="Tactic.Derive.HsType.html#13024" class="Bound">agdaTy</a>
      <a id="13092" class="Keyword">where</a> <a id="13098" class="CatchallClause Symbol">_</a> <a id="13100" class="Symbol">→</a> <a id="13102" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13115" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="13148" href="Tactic.Derive.HsType.html#13024" class="Bound">agdaTy</a>
    <a id="13159" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="13165" href="Tactic.Derive.HsType.html#13031" class="Bound">hole</a> <a id="13170" class="Symbol">(</a><a id="13171" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="13175" class="Symbol">(</a><a id="13176" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="13181" href="Tactic.Derive.HsType.html#13055" class="Bound">hsName</a><a id="13187" class="Symbol">))</a>
</pre></body></html>