<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Case</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/external-classes/Tactic/Case.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Comment">--------------------------------------------------------------------------------</a>
<a id="117" class="Comment">-- case: pattern-match on the first term, continue with the second tactic</a>
<a id="191" class="Comment">--------------------------------------------------------------------------------</a>

<a id="273" class="Keyword">module</a> <a id="280" href="Tactic.Case.html" class="Module">Tactic.Case</a> <a id="292" class="Keyword">where</a>

<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Prelude.html" class="Module">Prelude</a>
<a id="319" class="Keyword">open</a> <a id="324" class="Keyword">import</a> <a id="331" href="Meta.html" class="Module">Meta</a>

<a id="337" class="Keyword">open</a> <a id="342" class="Keyword">import</a> <a id="349" href="Data.List.html" class="Module">Data.List</a> <a id="359" class="Keyword">using</a> <a id="365" class="Symbol">(</a><a id="366" href="Data.List.Base.html#1553" class="Function">map</a><a id="369" class="Symbol">)</a>

<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>
<a id="435" class="Keyword">open</a> <a id="440" class="Keyword">import</a> <a id="447" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>

<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="495" class="Keyword">open</a> <a id="500" class="Keyword">import</a> <a id="507" href="Class.MonadTC.html" class="Module">Class.MonadTC</a>

<a id="522" class="Keyword">open</a> <a id="527" href="Class.MonadTC.html#1520" class="Module">MonadTC</a> <a id="535" class="Symbol">⦃...⦄</a>

<a id="542" class="Keyword">instance</a>
  <a id="553" href="Tactic.Case.html#553" class="Function">_</a> <a id="555" class="Symbol">=</a> <a id="557" href="Reflection.TCI.html#4259" class="Function">MonadTC-TCI</a>
  <a id="571" href="Tactic.Case.html#571" class="Function">_</a> <a id="573" class="Symbol">=</a> <a id="575" href="Tactic.ClauseBuilder.html#10741" class="Function">ContextMonad-MonadTC</a>
  <a id="598" href="Tactic.Case.html#598" class="Function">_</a> <a id="600" class="Symbol">=</a> <a id="602" href="Class.Monad.Core.html#582" class="Function">Functor-M</a>

<a id="613" class="Keyword">open</a> <a id="618" href="Tactic.ClauseBuilder.html#10971" class="Module">ClauseExprM</a>

<a id="matchInductive"></a><a id="631" href="Tactic.Case.html#631" class="Function">matchInductive</a> <a id="646" class="Symbol">:</a> <a id="648" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="653" class="Symbol">→</a> <a id="655" class="Symbol">(</a><a id="656" href="Tactic.ClauseBuilder.html#1322" class="Function">SinglePattern</a> <a id="670" class="Symbol">→</a> <a id="672" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="675" class="Symbol">(</a><a id="676" href="Tactic.ClauseBuilder.html#5826" class="Datatype">ClauseExpr</a> <a id="687" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="689" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="695" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="699" class="Symbol">))</a> <a id="702" class="Symbol">→</a> <a id="704" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="707" href="Tactic.ClauseBuilder.html#5826" class="Datatype">ClauseExpr</a>
<a id="718" href="Tactic.Case.html#631" class="Function">matchInductive</a> <a id="733" href="Tactic.Case.html#733" class="Bound">ty</a> <a id="736" href="Tactic.Case.html#736" class="Bound">rhs</a> <a id="740" class="Symbol">=</a> <a id="742" class="Keyword">do</a>
  <a id="747" href="Tactic.Case.html#747" class="Bound">ps</a> <a id="750" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="752" href="Tactic.ClauseBuilder.html#5328" class="Function">constructorPatterns&#39;</a> <a id="773" href="Tactic.Case.html#733" class="Bound">ty</a>
  <a id="778" href="Tactic.ClauseBuilder.html#11155" class="Function">matchExprM</a> <a id="789" class="Symbol">(</a><a id="790" href="Data.List.Base.html#1553" class="Function">map</a> <a id="794" class="Symbol">(λ</a> <a id="797" href="Tactic.Case.html#797" class="Bound">p</a> <a id="799" class="Symbol">→</a> <a id="801" href="Tactic.Case.html#797" class="Bound">p</a> <a id="803" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="805" href="Tactic.Case.html#736" class="Bound">rhs</a> <a id="809" href="Tactic.Case.html#797" class="Bound">p</a><a id="810" class="Symbol">)</a> <a id="812" href="Tactic.Case.html#747" class="Bound">ps</a><a id="814" class="Symbol">)</a>

<a id="genMatchingClauses"></a><a id="817" href="Tactic.Case.html#817" class="Function">genMatchingClauses</a> <a id="836" class="Symbol">:</a> <a id="838" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="843" class="Symbol">→</a> <a id="845" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="848" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="853" class="Symbol">→</a> <a id="855" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="858" href="Tactic.ClauseBuilder.html#5826" class="Datatype">ClauseExpr</a>
<a id="869" href="Tactic.Case.html#817" class="Function">genMatchingClauses</a> <a id="888" href="Tactic.Case.html#888" class="Bound">ty</a> <a id="891" href="Tactic.Case.html#891" class="Bound">x</a> <a id="893" class="Symbol">=</a> <a id="895" href="Tactic.Case.html#631" class="Function">matchInductive</a> <a id="910" href="Tactic.Case.html#888" class="Bound">ty</a> <a id="913" class="Symbol">(λ</a> <a id="916" href="Tactic.Case.html#916" class="Bound">_</a> <a id="918" class="Symbol">→</a> <a id="920" class="Symbol">(</a><a id="921" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="926" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="928" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a><a id="932" class="Symbol">)</a> <a id="934" href="Class.Functor.Core.html#205" class="Field Operator">&lt;$&gt;</a> <a id="938" href="Tactic.Case.html#891" class="Bound">x</a><a id="939" class="Symbol">)</a>

<a id="942" class="Comment">-- apply tac to all holes</a>
<a id="case"></a><a id="968" href="Tactic.Case.html#968" class="Function">case</a> <a id="973" class="Symbol">:</a> <a id="975" class="Symbol">∀</a> <a id="977" class="Symbol">{</a><a id="978" href="Tactic.Case.html#978" class="Bound">a</a><a id="979" class="Symbol">}</a> <a id="981" class="Symbol">{</a><a id="982" href="Tactic.Case.html#982" class="Bound">A</a> <a id="984" class="Symbol">:</a> <a id="986" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="990" href="Tactic.Case.html#978" class="Bound">a</a><a id="991" class="Symbol">}</a> <a id="993" class="Symbol">→</a> <a id="995" href="Tactic.Case.html#982" class="Bound">A</a> <a id="997" class="Symbol">→</a> <a id="999" href="Reflection.Tactic.html#530" class="Function">ITactic</a> <a id="1007" class="Symbol">→</a> <a id="1009" href="Reflection.Tactic.html#530" class="Function">ITactic</a>
<a id="1017" href="Tactic.Case.html#968" class="Function">case</a> <a id="1022" href="Tactic.Case.html#1022" class="Bound">a</a> <a id="1024" href="Tactic.Case.html#1024" class="Bound">tac</a> <a id="1028" class="Symbol">=</a> <a id="1030" href="Reflection.Utils.TCI.html#5941" class="Function">inDebugPath</a> <a id="1042" class="String">&quot;case&quot;</a> <a id="1049" class="Keyword">do</a>
  <a id="1054" href="Tactic.Case.html#1054" class="Bound">t</a> <a id="1056" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="1058" href="Class.MonadTC.html#1908" class="Field">quoteTC</a> <a id="1066" href="Tactic.Case.html#1022" class="Bound">a</a>
  <a id="1070" href="Tactic.Case.html#1070" class="Bound">ty</a> <a id="1073" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="1075" href="Class.MonadTC.html#1753" class="Field">inferType</a> <a id="1085" href="Tactic.Case.html#1054" class="Bound">t</a>
  <a id="1089" href="Class.MonadTC.html#10513" class="Function">unifyWithGoal</a> <a id="1103" href="Class.Monad.Core.html#351" class="Function Operator">=&lt;&lt;</a> <a id="1107" href="Tactic.ClauseBuilder.html#8594" class="Function">caseMatch</a> <a id="1117" href="Tactic.Case.html#1054" class="Bound">t</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Tactic.Case.html#817" class="Function">genMatchingClauses</a> <a id="1139" href="Tactic.Case.html#1070" class="Bound">ty</a> <a id="1142" class="Symbol">(</a><a id="1143" href="Class.MonadTC.html#10989" class="Function">withGoalHole</a> <a id="1156" href="Tactic.Case.html#1024" class="Bound">tac</a><a id="1159" class="Symbol">))</a>

<a id="1163" class="Keyword">private</a>
  <a id="1173" class="Keyword">module</a> <a id="Test"></a><a id="1180" href="Tactic.Case.html#1180" class="Module">Test</a> <a id="1185" class="Symbol">(</a><a id="1186" href="Tactic.Case.html#1186" class="Bound">A</a> <a id="1188" href="Tactic.Case.html#1188" class="Bound">B</a> <a id="1190" class="Symbol">:</a> <a id="1192" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="1195" class="Symbol">)</a> <a id="1197" class="Keyword">where</a>
    <a id="1207" class="Keyword">open</a> <a id="1212" class="Keyword">import</a> <a id="1219" href="Tactic.Assumption.html" class="Module">Tactic.Assumption</a>
    <a id="1241" class="Keyword">open</a> <a id="1246" class="Keyword">import</a> <a id="1253" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

    <a id="1274" class="Keyword">record</a> <a id="Test.TestType"></a><a id="1281" href="Tactic.Case.html#1281" class="Record">TestType</a> <a id="1290" class="Symbol">:</a> <a id="1292" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1296" class="Keyword">where</a>
      <a id="1308" class="Keyword">field</a>
        <a id="Test.TestType.a"></a><a id="1322" href="Tactic.Case.html#1322" class="Field">a</a> <a id="1324" class="Symbol">:</a> <a id="1326" href="Tactic.Case.html#1186" class="Bound">A</a>
        <a id="Test.TestType.b"></a><a id="1336" href="Tactic.Case.html#1336" class="Field">b</a> <a id="1338" class="Symbol">:</a> <a id="1340" href="Tactic.Case.html#1188" class="Bound">B</a>

    <a id="Test.test₁"></a><a id="1347" href="Tactic.Case.html#1347" class="Function">test₁</a> <a id="1353" class="Symbol">:</a> <a id="1355" href="Tactic.Case.html#1186" class="Bound">A</a> <a id="1357" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1359" href="Tactic.Case.html#1188" class="Bound">B</a> <a id="1361" class="Symbol">→</a> <a id="1363" href="Tactic.Case.html#1186" class="Bound">A</a>
    <a id="1369" href="Tactic.Case.html#1347" class="Function">test₁</a> <a id="1375" href="Tactic.Case.html#1375" class="Bound">x</a> <a id="1377" class="Symbol">=</a> <a id="1379" href="Reflection.Tactic.html#1270" class="Macro">by</a> <a id="1382" class="Symbol">(</a><a id="1383" href="Tactic.Case.html#968" class="Function">case</a> <a id="1388" href="Tactic.Case.html#1375" class="Bound">x</a> <a id="1390" href="Tactic.Assumption.html#951" class="Function">assumption&#39;</a><a id="1401" class="Symbol">)</a>

    <a id="Test.test₂"></a><a id="1408" href="Tactic.Case.html#1408" class="Function">test₂</a> <a id="1414" class="Symbol">:</a> <a id="1416" href="Tactic.Case.html#1186" class="Bound">A</a> <a id="1418" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1420" href="Tactic.Case.html#1188" class="Bound">B</a> <a id="1422" class="Symbol">→</a> <a id="1424" href="Tactic.Case.html#1188" class="Bound">B</a>
    <a id="1430" href="Tactic.Case.html#1408" class="Function">test₂</a> <a id="1436" href="Tactic.Case.html#1436" class="Bound">x</a> <a id="1438" class="Symbol">=</a> <a id="1440" href="Reflection.Tactic.html#1270" class="Macro">by</a> <a id="1443" class="Symbol">(</a><a id="1444" href="Tactic.Case.html#968" class="Function">case</a> <a id="1449" href="Tactic.Case.html#1436" class="Bound">x</a> <a id="1451" href="Tactic.Assumption.html#951" class="Function">assumption&#39;</a><a id="1462" class="Symbol">)</a>

    <a id="Test.test₃"></a><a id="1469" href="Tactic.Case.html#1469" class="Function">test₃</a> <a id="1475" class="Symbol">:</a> <a id="1477" href="Tactic.Case.html#1186" class="Bound">A</a> <a id="1479" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="1481" href="Tactic.Case.html#1186" class="Bound">A</a> <a id="1483" class="Symbol">→</a> <a id="1485" href="Tactic.Case.html#1186" class="Bound">A</a>
    <a id="1491" href="Tactic.Case.html#1469" class="Function">test₃</a> <a id="1497" href="Tactic.Case.html#1497" class="Bound">x</a> <a id="1499" class="Symbol">=</a> <a id="1501" href="Reflection.Tactic.html#1270" class="Macro">by</a> <a id="1504" class="Symbol">(</a><a id="1505" href="Tactic.Case.html#968" class="Function">case</a> <a id="1510" href="Tactic.Case.html#1497" class="Bound">x</a> <a id="1512" href="Tactic.Assumption.html#951" class="Function">assumption&#39;</a><a id="1523" class="Symbol">)</a>

    <a id="Test.test₄"></a><a id="1530" href="Tactic.Case.html#1530" class="Function">test₄</a> <a id="1536" class="Symbol">:</a> <a id="1538" href="Tactic.Case.html#1281" class="Record">TestType</a> <a id="1547" class="Symbol">→</a> <a id="1549" href="Tactic.Case.html#1186" class="Bound">A</a>
    <a id="1555" href="Tactic.Case.html#1530" class="Function">test₄</a> <a id="1561" href="Tactic.Case.html#1561" class="Bound">x</a> <a id="1563" class="Symbol">=</a> <a id="1565" href="Reflection.Tactic.html#1270" class="Macro">by</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Tactic.Case.html#968" class="Function">case</a> <a id="1574" href="Tactic.Case.html#1561" class="Bound">x</a> <a id="1576" href="Tactic.Assumption.html#951" class="Function">assumption&#39;</a><a id="1587" class="Symbol">)</a>

    <a id="Test.test₅"></a><a id="1594" href="Tactic.Case.html#1594" class="Function">test₅</a> <a id="1600" class="Symbol">:</a> <a id="1602" href="Tactic.Case.html#1281" class="Record">TestType</a> <a id="1611" class="Symbol">→</a> <a id="1613" href="Tactic.Case.html#1188" class="Bound">B</a>
    <a id="1619" href="Tactic.Case.html#1594" class="Function">test₅</a> <a id="1625" href="Tactic.Case.html#1625" class="Bound">x</a> <a id="1627" class="Symbol">=</a> <a id="1629" href="Reflection.Tactic.html#1270" class="Macro">by</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Tactic.Case.html#968" class="Function">case</a> <a id="1638" href="Tactic.Case.html#1625" class="Bound">x</a> <a id="1640" href="Tactic.Assumption.html#951" class="Function">assumption&#39;</a><a id="1651" class="Symbol">)</a>
</pre></body></html>