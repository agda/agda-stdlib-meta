<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Case</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/agda-stdlib-meta/tree/master///Tactic/Case.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Comment">--------------------------------------------------------------------------------</a>
<a id="117" class="Comment">-- case: pattern-match on the first term, continue with the second tactic</a>
<a id="191" class="Comment">--------------------------------------------------------------------------------</a>

<a id="273" class="Keyword">module</a> <a id="280" href="Tactic.Case.html" class="Module">Tactic.Case</a> <a id="292" class="Keyword">where</a>

<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="MetaPrelude.html" class="Module">MetaPrelude</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Meta.html" class="Module">Meta</a>

<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Data.List.html" class="Module">Data.List</a> <a id="363" class="Keyword">using</a> <a id="369" class="Symbol">(</a><a id="370" href="Data.List.Base.html#1631" class="Function">map</a><a id="373" class="Symbol">)</a>

<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a> <a id="418" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>
<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>

<a id="473" class="Keyword">open</a> <a id="478" class="Keyword">import</a> <a id="485" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="499" class="Keyword">open</a> <a id="504" class="Keyword">import</a> <a id="511" href="Class.MonadTC.html" class="Module">Class.MonadTC</a>

<a id="526" class="Keyword">open</a> <a id="531" href="Class.MonadTC.html#1517" class="Module">MonadTC</a> <a id="539" class="Symbol">⦃...⦄</a>

<a id="546" class="Keyword">instance</a>
  <a id="557" href="Tactic.Case.html#557" class="Function">_</a> <a id="559" class="Symbol">=</a> <a id="561" href="Reflection.TCI.html#4288" class="Function">MonadTC-TCI</a>
  <a id="575" href="Tactic.Case.html#575" class="Function">_</a> <a id="577" class="Symbol">=</a> <a id="579" href="Tactic.ClauseBuilder.html#10692" class="Function">ContextMonad-MonadTC</a>
  <a id="602" href="Tactic.Case.html#602" class="Function">_</a> <a id="604" class="Symbol">=</a> <a id="606" href="Class.Monad.Core.html#610" class="Function">Functor-M</a>

<a id="617" class="Keyword">open</a> <a id="622" href="Tactic.ClauseBuilder.html#10922" class="Module">ClauseExprM</a>

<a id="matchInductive"></a><a id="635" href="Tactic.Case.html#635" class="Function">matchInductive</a> <a id="650" class="Symbol">:</a> <a id="652" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="657" class="Symbol">→</a> <a id="659" class="Symbol">(</a><a id="660" href="Tactic.ClauseBuilder.html#1277" class="Function">SinglePattern</a> <a id="674" class="Symbol">→</a> <a id="676" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="679" class="Symbol">(</a><a id="680" href="Tactic.ClauseBuilder.html#5769" class="Datatype">ClauseExpr</a> <a id="691" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="693" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="699" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="703" class="Symbol">))</a> <a id="706" class="Symbol">→</a> <a id="708" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="711" href="Tactic.ClauseBuilder.html#5769" class="Datatype">ClauseExpr</a>
<a id="722" href="Tactic.Case.html#635" class="Function">matchInductive</a> <a id="737" href="Tactic.Case.html#737" class="Bound">ty</a> <a id="740" href="Tactic.Case.html#740" class="Bound">rhs</a> <a id="744" class="Symbol">=</a> <a id="746" class="Keyword">do</a>
  <a id="751" href="Tactic.Case.html#751" class="Bound">ps</a> <a id="754" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="756" href="Tactic.ClauseBuilder.html#5283" class="Function">constructorPatterns&#39;</a> <a id="777" href="Tactic.Case.html#737" class="Bound">ty</a>
  <a id="782" href="Tactic.ClauseBuilder.html#11114" class="Function">matchExprM</a> <a id="793" class="Symbol">(</a><a id="794" href="Data.List.Base.html#1631" class="Function">map</a> <a id="798" class="Symbol">(λ</a> <a id="801" href="Tactic.Case.html#801" class="Bound">p</a> <a id="803" class="Symbol">→</a> <a id="805" href="Tactic.Case.html#801" class="Bound">p</a> <a id="807" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="809" href="Tactic.Case.html#740" class="Bound">rhs</a> <a id="813" href="Tactic.Case.html#801" class="Bound">p</a><a id="814" class="Symbol">)</a> <a id="816" href="Tactic.Case.html#751" class="Bound">ps</a><a id="818" class="Symbol">)</a>

<a id="genMatchingClauses"></a><a id="821" href="Tactic.Case.html#821" class="Function">genMatchingClauses</a> <a id="840" class="Symbol">:</a> <a id="842" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="847" class="Symbol">→</a> <a id="849" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="852" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="857" class="Symbol">→</a> <a id="859" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="862" href="Tactic.ClauseBuilder.html#5769" class="Datatype">ClauseExpr</a>
<a id="873" href="Tactic.Case.html#821" class="Function">genMatchingClauses</a> <a id="892" href="Tactic.Case.html#892" class="Bound">ty</a> <a id="895" href="Tactic.Case.html#895" class="Bound">x</a> <a id="897" class="Symbol">=</a> <a id="899" href="Tactic.Case.html#635" class="Function">matchInductive</a> <a id="914" href="Tactic.Case.html#892" class="Bound">ty</a> <a id="917" class="Symbol">(λ</a> <a id="920" href="Tactic.Case.html#920" class="Bound">_</a> <a id="922" class="Symbol">→</a> <a id="924" class="Symbol">(</a><a id="925" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="930" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="932" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="936" class="Symbol">)</a> <a id="938" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="942" href="Tactic.Case.html#895" class="Bound">x</a><a id="943" class="Symbol">)</a>

<a id="946" class="Comment">-- apply tac to all holes</a>
<a id="case"></a><a id="972" href="Tactic.Case.html#972" class="Function">case</a> <a id="977" class="Symbol">:</a> <a id="979" class="Symbol">∀</a> <a id="981" class="Symbol">{</a><a id="982" href="Tactic.Case.html#982" class="Bound">a</a><a id="983" class="Symbol">}</a> <a id="985" class="Symbol">{</a><a id="986" href="Tactic.Case.html#986" class="Bound">A</a> <a id="988" class="Symbol">:</a> <a id="990" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="994" href="Tactic.Case.html#982" class="Bound">a</a><a id="995" class="Symbol">}</a> <a id="997" class="Symbol">→</a> <a id="999" href="Tactic.Case.html#986" class="Bound">A</a> <a id="1001" class="Symbol">→</a> <a id="1003" href="Reflection.Tactic.html#534" class="Function">ITactic</a> <a id="1011" class="Symbol">→</a> <a id="1013" href="Reflection.Tactic.html#534" class="Function">ITactic</a>
<a id="1021" href="Tactic.Case.html#972" class="Function">case</a> <a id="1026" href="Tactic.Case.html#1026" class="Bound">a</a> <a id="1028" href="Tactic.Case.html#1028" class="Bound">tac</a> <a id="1032" class="Symbol">=</a> <a id="1034" href="Reflection.Utils.TCI.html#5945" class="Function">inDebugPath</a> <a id="1046" class="String">&quot;case&quot;</a> <a id="1053" class="Keyword">do</a>
  <a id="1058" href="Tactic.Case.html#1058" class="Bound">t</a> <a id="1060" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="1062" href="Class.MonadTC.html#1905" class="Field">quoteTC</a> <a id="1070" href="Tactic.Case.html#1026" class="Bound">a</a>
  <a id="1074" href="Tactic.Case.html#1074" class="Bound">ty</a> <a id="1077" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="1079" href="Class.MonadTC.html#1750" class="Field">inferType</a> <a id="1089" href="Tactic.Case.html#1058" class="Bound">t</a>
  <a id="1093" href="Class.MonadTC.html#10517" class="Function">unifyWithGoal</a> <a id="1107" href="Class.Monad.Core.html#379" class="Function Operator">=&lt;&lt;</a> <a id="1111" href="Tactic.ClauseBuilder.html#8545" class="Function">caseMatch</a> <a id="1121" href="Tactic.Case.html#1058" class="Bound">t</a> <a id="1123" class="Symbol">(</a><a id="1124" href="Tactic.Case.html#821" class="Function">genMatchingClauses</a> <a id="1143" href="Tactic.Case.html#1074" class="Bound">ty</a> <a id="1146" class="Symbol">(</a><a id="1147" href="Class.MonadTC.html#10993" class="Function">withGoalHole</a> <a id="1160" href="Tactic.Case.html#1028" class="Bound">tac</a><a id="1163" class="Symbol">))</a>

<a id="1167" class="Keyword">private</a>
  <a id="1177" class="Keyword">module</a> <a id="Test"></a><a id="1184" href="Tactic.Case.html#1184" class="Module">Test</a> <a id="1189" class="Symbol">(</a><a id="1190" href="Tactic.Case.html#1190" class="Bound">A</a> <a id="1192" href="Tactic.Case.html#1192" class="Bound">B</a> <a id="1194" class="Symbol">:</a> <a id="1196" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1199" class="Symbol">)</a> <a id="1201" class="Keyword">where</a>
    <a id="1211" class="Keyword">open</a> <a id="1216" class="Keyword">import</a> <a id="1223" href="Tactic.Assumption.html" class="Module">Tactic.Assumption</a>
    <a id="1245" class="Keyword">open</a> <a id="1250" class="Keyword">import</a> <a id="1257" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

    <a id="1278" class="Keyword">record</a> <a id="Test.TestType"></a><a id="1285" href="Tactic.Case.html#1285" class="Record">TestType</a> <a id="1294" class="Symbol">:</a> <a id="1296" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1300" class="Keyword">where</a>
      <a id="1312" class="Keyword">field</a>
        <a id="Test.TestType.a"></a><a id="1326" href="Tactic.Case.html#1326" class="Field">a</a> <a id="1328" class="Symbol">:</a> <a id="1330" href="Tactic.Case.html#1190" class="Bound">A</a>
        <a id="Test.TestType.b"></a><a id="1340" href="Tactic.Case.html#1340" class="Field">b</a> <a id="1342" class="Symbol">:</a> <a id="1344" href="Tactic.Case.html#1192" class="Bound">B</a>

    <a id="Test.test₁"></a><a id="1351" href="Tactic.Case.html#1351" class="Function">test₁</a> <a id="1357" class="Symbol">:</a> <a id="1359" href="Tactic.Case.html#1190" class="Bound">A</a> <a id="1361" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1363" href="Tactic.Case.html#1192" class="Bound">B</a> <a id="1365" class="Symbol">→</a> <a id="1367" href="Tactic.Case.html#1190" class="Bound">A</a>
    <a id="1373" href="Tactic.Case.html#1351" class="Function">test₁</a> <a id="1379" href="Tactic.Case.html#1379" class="Bound">x</a> <a id="1381" class="Symbol">=</a> <a id="1383" href="Reflection.Tactic.html#1274" class="Macro">by</a> <a id="1386" class="Symbol">(</a><a id="1387" href="Tactic.Case.html#972" class="Function">case</a> <a id="1392" href="Tactic.Case.html#1379" class="Bound">x</a> <a id="1394" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a><a id="1405" class="Symbol">)</a>

    <a id="Test.test₂"></a><a id="1412" href="Tactic.Case.html#1412" class="Function">test₂</a> <a id="1418" class="Symbol">:</a> <a id="1420" href="Tactic.Case.html#1190" class="Bound">A</a> <a id="1422" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1424" href="Tactic.Case.html#1192" class="Bound">B</a> <a id="1426" class="Symbol">→</a> <a id="1428" href="Tactic.Case.html#1192" class="Bound">B</a>
    <a id="1434" href="Tactic.Case.html#1412" class="Function">test₂</a> <a id="1440" href="Tactic.Case.html#1440" class="Bound">x</a> <a id="1442" class="Symbol">=</a> <a id="1444" href="Reflection.Tactic.html#1274" class="Macro">by</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Tactic.Case.html#972" class="Function">case</a> <a id="1453" href="Tactic.Case.html#1440" class="Bound">x</a> <a id="1455" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a><a id="1466" class="Symbol">)</a>

    <a id="Test.test₃"></a><a id="1473" href="Tactic.Case.html#1473" class="Function">test₃</a> <a id="1479" class="Symbol">:</a> <a id="1481" href="Tactic.Case.html#1190" class="Bound">A</a> <a id="1483" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="1485" href="Tactic.Case.html#1190" class="Bound">A</a> <a id="1487" class="Symbol">→</a> <a id="1489" href="Tactic.Case.html#1190" class="Bound">A</a>
    <a id="1495" href="Tactic.Case.html#1473" class="Function">test₃</a> <a id="1501" href="Tactic.Case.html#1501" class="Bound">x</a> <a id="1503" class="Symbol">=</a> <a id="1505" href="Reflection.Tactic.html#1274" class="Macro">by</a> <a id="1508" class="Symbol">(</a><a id="1509" href="Tactic.Case.html#972" class="Function">case</a> <a id="1514" href="Tactic.Case.html#1501" class="Bound">x</a> <a id="1516" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a><a id="1527" class="Symbol">)</a>

    <a id="Test.test₄"></a><a id="1534" href="Tactic.Case.html#1534" class="Function">test₄</a> <a id="1540" class="Symbol">:</a> <a id="1542" href="Tactic.Case.html#1285" class="Record">TestType</a> <a id="1551" class="Symbol">→</a> <a id="1553" href="Tactic.Case.html#1190" class="Bound">A</a>
    <a id="1559" href="Tactic.Case.html#1534" class="Function">test₄</a> <a id="1565" href="Tactic.Case.html#1565" class="Bound">x</a> <a id="1567" class="Symbol">=</a> <a id="1569" href="Reflection.Tactic.html#1274" class="Macro">by</a> <a id="1572" class="Symbol">(</a><a id="1573" href="Tactic.Case.html#972" class="Function">case</a> <a id="1578" href="Tactic.Case.html#1565" class="Bound">x</a> <a id="1580" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a><a id="1591" class="Symbol">)</a>

    <a id="Test.test₅"></a><a id="1598" href="Tactic.Case.html#1598" class="Function">test₅</a> <a id="1604" class="Symbol">:</a> <a id="1606" href="Tactic.Case.html#1285" class="Record">TestType</a> <a id="1615" class="Symbol">→</a> <a id="1617" href="Tactic.Case.html#1192" class="Bound">B</a>
    <a id="1623" href="Tactic.Case.html#1598" class="Function">test₅</a> <a id="1629" href="Tactic.Case.html#1629" class="Bound">x</a> <a id="1631" class="Symbol">=</a> <a id="1633" href="Reflection.Tactic.html#1274" class="Macro">by</a> <a id="1636" class="Symbol">(</a><a id="1637" href="Tactic.Case.html#972" class="Function">case</a> <a id="1642" href="Tactic.Case.html#1629" class="Bound">x</a> <a id="1644" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a><a id="1655" class="Symbol">)</a>
</pre></body></html>