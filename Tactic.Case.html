<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Case</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactic/Case.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Symbol">{-#</a> <a id="40" class="Keyword">OPTIONS</a> <a id="48" class="Pragma">-v</a> <a id="51" class="Pragma">allTactics:100</a> <a id="66" class="Symbol">#-}</a>
<a id="70" class="Keyword">module</a> <a id="77" href="Tactic.Case.html" class="Module">Tactic.Case</a> <a id="89" class="Keyword">where</a>

<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="Data.List.html" class="Module">Data.List</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Product.html" class="Module">Data.Product</a>
<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Function.html" class="Module">Function</a>
<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="208" class="Keyword">using</a> <a id="214" class="Symbol">(</a><a id="215" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="220" class="Symbol">;</a> <a id="222" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="226" class="Symbol">;</a> <a id="228" href="Data.Maybe.Base.html#1906" class="Function">from-just</a><a id="237" class="Symbol">)</a>

<a id="240" class="Keyword">open</a> <a id="245" class="Keyword">import</a> <a id="252" href="Tactic.Helpers.html" class="Module">Tactic.Helpers</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>

<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Generics.html" class="Module">Generics</a>

<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Reflection.Syntax.html" class="Module">Reflection.Syntax</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="379" class="Keyword">open</a> <a id="384" class="Keyword">import</a> <a id="391" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="403" class="Keyword">open</a> <a id="408" class="Keyword">import</a> <a id="415" href="Class.MonadTC.html" class="Module">Class.MonadTC</a>
<a id="429" class="Keyword">open</a> <a id="434" class="Keyword">import</a> <a id="441" href="Reflection.TCI.html" class="Module">Reflection.TCI</a>

<a id="457" class="Keyword">open</a> <a id="462" class="Keyword">import</a> <a id="469" href="Meta.html" class="Module">Meta</a>

<a id="475" class="Keyword">open</a> <a id="480" href="Class.MonadTC.html#1349" class="Module">MonadTC</a> <a id="488" class="Symbol">⦃...⦄</a>

<a id="495" class="Keyword">instance</a>
  <a id="506" href="Tactic.Case.html#506" class="Function">_</a> <a id="508" class="Symbol">=</a> <a id="510" href="Reflection.TCI.html#4176" class="Function">MonadTC-TCI</a>
  <a id="524" href="Tactic.Case.html#524" class="Function">_</a> <a id="526" class="Symbol">=</a> <a id="528" href="Tactic.ClauseBuilder.html#10849" class="Function">ContextMonad-MonadTC</a>
  <a id="551" href="Tactic.Case.html#551" class="Function">_</a> <a id="553" class="Symbol">=</a> <a id="555" href="Class.Monad.Core.html#655" class="Function">Functor-M</a>

<a id="566" class="Keyword">open</a> <a id="571" href="Tactic.ClauseBuilder.html#11079" class="Module">ClauseExprM</a>

<a id="matchInductive"></a><a id="584" href="Tactic.Case.html#584" class="Function">matchInductive</a> <a id="599" class="Symbol">:</a> <a id="601" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="606" class="Symbol">→</a> <a id="608" class="Symbol">(</a><a id="609" href="Tactic.ClauseBuilder.html#1328" class="Function">SinglePattern</a> <a id="623" class="Symbol">→</a> <a id="625" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="628" class="Symbol">(</a><a id="629" href="Tactic.ClauseBuilder.html#5844" class="Datatype">ClauseExpr</a> <a id="640" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="642" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="648" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a><a id="652" class="Symbol">))</a> <a id="655" class="Symbol">→</a> <a id="657" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="660" href="Tactic.ClauseBuilder.html#5844" class="Datatype">ClauseExpr</a>
<a id="671" href="Tactic.Case.html#584" class="Function">matchInductive</a> <a id="686" href="Tactic.Case.html#686" class="Bound">ty</a> <a id="689" href="Tactic.Case.html#689" class="Bound">rhs</a> <a id="693" class="Symbol">=</a> <a id="695" class="Keyword">do</a>
  <a id="700" href="Tactic.Case.html#700" class="Bound">ps</a> <a id="703" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="705" href="Tactic.ClauseBuilder.html#5346" class="Function">constructorPatterns&#39;</a> <a id="726" href="Tactic.Case.html#686" class="Bound">ty</a>
  <a id="731" href="Tactic.ClauseBuilder.html#11263" class="Function">matchExprM</a> <a id="742" class="Symbol">(</a><a id="743" href="Data.List.Base.html#1544" class="Function">Data.List.map</a> <a id="757" class="Symbol">(λ</a> <a id="760" href="Tactic.Case.html#760" class="Bound">p</a> <a id="762" class="Symbol">→</a> <a id="764" href="Tactic.Case.html#760" class="Bound">p</a> <a id="766" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="768" href="Tactic.Case.html#689" class="Bound">rhs</a> <a id="772" href="Tactic.Case.html#760" class="Bound">p</a><a id="773" class="Symbol">)</a> <a id="775" href="Tactic.Case.html#700" class="Bound">ps</a><a id="777" class="Symbol">)</a>

<a id="genMatchingClauses"></a><a id="780" href="Tactic.Case.html#780" class="Function">genMatchingClauses</a> <a id="799" class="Symbol">:</a> <a id="801" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="806" class="Symbol">→</a> <a id="808" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="811" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="816" class="Symbol">→</a> <a id="818" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="821" href="Tactic.ClauseBuilder.html#5844" class="Datatype">ClauseExpr</a>
<a id="832" href="Tactic.Case.html#780" class="Function">genMatchingClauses</a> <a id="851" href="Tactic.Case.html#851" class="Bound">ty</a> <a id="854" href="Tactic.Case.html#854" class="Bound">x</a> <a id="856" class="Symbol">=</a> <a id="858" href="Tactic.Case.html#584" class="Function">matchInductive</a> <a id="873" href="Tactic.Case.html#851" class="Bound">ty</a> <a id="876" class="Symbol">(λ</a> <a id="879" href="Tactic.Case.html#879" class="Bound">_</a> <a id="881" class="Symbol">→</a> <a id="883" class="Symbol">(</a><a id="884" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="889" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="891" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="895" class="Symbol">)</a> <a id="897" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="901" href="Tactic.Case.html#854" class="Bound">x</a><a id="902" class="Symbol">)</a>

<a id="905" class="Comment">-- apply tac to all holes</a>
<a id="case"></a><a id="931" href="Tactic.Case.html#931" class="Function">case</a> <a id="936" class="Symbol">:</a> <a id="938" class="Symbol">∀</a> <a id="940" class="Symbol">{</a><a id="941" href="Tactic.Case.html#941" class="Bound">a</a><a id="942" class="Symbol">}</a> <a id="944" class="Symbol">{</a><a id="945" href="Tactic.Case.html#945" class="Bound">A</a> <a id="947" class="Symbol">:</a> <a id="949" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="953" href="Tactic.Case.html#941" class="Bound">a</a><a id="954" class="Symbol">}</a> <a id="956" class="Symbol">→</a> <a id="958" href="Tactic.Case.html#945" class="Bound">A</a> <a id="960" class="Symbol">→</a> <a id="962" href="Tactic.Helpers.html#5675" class="Function">ITactic</a> <a id="970" class="Symbol">→</a> <a id="972" href="Tactic.Helpers.html#5675" class="Function">ITactic</a>
<a id="980" href="Tactic.Case.html#931" class="Function">case</a> <a id="985" href="Tactic.Case.html#985" class="Bound">a</a> <a id="987" href="Tactic.Case.html#987" class="Bound">tac</a> <a id="991" class="Symbol">=</a> <a id="993" href="Tactic.Helpers.html#2592" class="Function">inDebugPath</a> <a id="1005" class="String">&quot;case&quot;</a> <a id="1012" class="Keyword">do</a>
  <a id="1017" href="Tactic.Case.html#1017" class="Bound">t</a> <a id="1019" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1021" href="Class.MonadTC.html#1737" class="Field">quoteTC</a> <a id="1029" href="Tactic.Case.html#985" class="Bound">a</a>
  <a id="1033" href="Tactic.Case.html#1033" class="Bound">ty</a> <a id="1036" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="1038" href="Class.MonadTC.html#1582" class="Field">inferType</a> <a id="1048" href="Tactic.Case.html#1017" class="Bound">t</a>
  <a id="1052" href="Class.MonadTC.html#10302" class="Function">unifyWithGoal</a> <a id="1066" href="Class.Monad.Core.html#424" class="Function Operator">=&lt;&lt;</a> <a id="1070" href="Tactic.ClauseBuilder.html#8612" class="Function">caseMatch</a> <a id="1080" href="Tactic.Case.html#1017" class="Bound">t</a> <a id="1082" class="Symbol">(</a><a id="1083" href="Tactic.Case.html#780" class="Function">genMatchingClauses</a> <a id="1102" href="Tactic.Case.html#1033" class="Bound">ty</a> <a id="1105" class="Symbol">(</a><a id="1106" href="Class.MonadTC.html#10778" class="Function">withGoalHole</a> <a id="1119" href="Tactic.Case.html#987" class="Bound">tac</a><a id="1122" class="Symbol">))</a>

<a id="1126" class="Keyword">private</a>
  <a id="1136" class="Keyword">module</a> <a id="Test"></a><a id="1143" href="Tactic.Case.html#1143" class="Module">Test</a> <a id="1148" class="Symbol">(</a><a id="1149" href="Tactic.Case.html#1149" class="Bound">A</a> <a id="1151" href="Tactic.Case.html#1151" class="Bound">B</a> <a id="1153" class="Symbol">:</a> <a id="1155" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1158" class="Symbol">)</a> <a id="1160" class="Keyword">where</a>
    <a id="1170" class="Keyword">open</a> <a id="1175" class="Keyword">import</a> <a id="1182" href="Tactic.Assumption.html" class="Module">Tactic.Assumption</a>
    <a id="1204" class="Keyword">open</a> <a id="1209" class="Keyword">import</a> <a id="1216" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

    <a id="1237" class="Keyword">record</a> <a id="Test.TestType"></a><a id="1244" href="Tactic.Case.html#1244" class="Record">TestType</a> <a id="1253" class="Symbol">:</a> <a id="1255" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1259" class="Keyword">where</a>
      <a id="1271" class="Keyword">field</a>
        <a id="Test.TestType.a"></a><a id="1285" href="Tactic.Case.html#1285" class="Field">a</a> <a id="1287" class="Symbol">:</a> <a id="1289" href="Tactic.Case.html#1149" class="Bound">A</a>
        <a id="Test.TestType.b"></a><a id="1299" href="Tactic.Case.html#1299" class="Field">b</a> <a id="1301" class="Symbol">:</a> <a id="1303" href="Tactic.Case.html#1151" class="Bound">B</a>

    <a id="Test.test₁"></a><a id="1310" href="Tactic.Case.html#1310" class="Function">test₁</a> <a id="1316" class="Symbol">:</a> <a id="1318" href="Tactic.Case.html#1149" class="Bound">A</a> <a id="1320" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1322" href="Tactic.Case.html#1151" class="Bound">B</a> <a id="1324" class="Symbol">→</a> <a id="1326" href="Tactic.Case.html#1149" class="Bound">A</a>
    <a id="1332" href="Tactic.Case.html#1310" class="Function">test₁</a> <a id="1338" href="Tactic.Case.html#1338" class="Bound">x</a> <a id="1340" class="Symbol">=</a> <a id="1342" href="Tactic.Helpers.html#6484" class="Macro">by</a> <a id="1345" class="Symbol">(</a><a id="1346" href="Tactic.Case.html#931" class="Function">case</a> <a id="1351" href="Tactic.Case.html#1338" class="Bound">x</a> <a id="1353" href="Tactic.Assumption.html#915" class="Function">assumption&#39;</a><a id="1364" class="Symbol">)</a>

    <a id="Test.test₂"></a><a id="1371" href="Tactic.Case.html#1371" class="Function">test₂</a> <a id="1377" class="Symbol">:</a> <a id="1379" href="Tactic.Case.html#1149" class="Bound">A</a> <a id="1381" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1383" href="Tactic.Case.html#1151" class="Bound">B</a> <a id="1385" class="Symbol">→</a> <a id="1387" href="Tactic.Case.html#1151" class="Bound">B</a>
    <a id="1393" href="Tactic.Case.html#1371" class="Function">test₂</a> <a id="1399" href="Tactic.Case.html#1399" class="Bound">x</a> <a id="1401" class="Symbol">=</a> <a id="1403" href="Tactic.Helpers.html#6484" class="Macro">by</a> <a id="1406" class="Symbol">(</a><a id="1407" href="Tactic.Case.html#931" class="Function">case</a> <a id="1412" href="Tactic.Case.html#1399" class="Bound">x</a> <a id="1414" href="Tactic.Assumption.html#915" class="Function">assumption&#39;</a><a id="1425" class="Symbol">)</a>

    <a id="Test.test₃"></a><a id="1432" href="Tactic.Case.html#1432" class="Function">test₃</a> <a id="1438" class="Symbol">:</a> <a id="1440" href="Tactic.Case.html#1149" class="Bound">A</a> <a id="1442" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1444" href="Tactic.Case.html#1149" class="Bound">A</a> <a id="1446" class="Symbol">→</a> <a id="1448" href="Tactic.Case.html#1149" class="Bound">A</a>
    <a id="1454" href="Tactic.Case.html#1432" class="Function">test₃</a> <a id="1460" href="Tactic.Case.html#1460" class="Bound">x</a> <a id="1462" class="Symbol">=</a> <a id="1464" href="Tactic.Helpers.html#6484" class="Macro">by</a> <a id="1467" class="Symbol">(</a><a id="1468" href="Tactic.Case.html#931" class="Function">case</a> <a id="1473" href="Tactic.Case.html#1460" class="Bound">x</a> <a id="1475" href="Tactic.Assumption.html#915" class="Function">assumption&#39;</a><a id="1486" class="Symbol">)</a>

    <a id="Test.test₄"></a><a id="1493" href="Tactic.Case.html#1493" class="Function">test₄</a> <a id="1499" class="Symbol">:</a> <a id="1501" href="Tactic.Case.html#1244" class="Record">TestType</a> <a id="1510" class="Symbol">→</a> <a id="1512" href="Tactic.Case.html#1149" class="Bound">A</a>
    <a id="1518" href="Tactic.Case.html#1493" class="Function">test₄</a> <a id="1524" href="Tactic.Case.html#1524" class="Bound">x</a> <a id="1526" class="Symbol">=</a> <a id="1528" href="Tactic.Helpers.html#6484" class="Macro">by</a> <a id="1531" class="Symbol">(</a><a id="1532" href="Tactic.Case.html#931" class="Function">case</a> <a id="1537" href="Tactic.Case.html#1524" class="Bound">x</a> <a id="1539" href="Tactic.Assumption.html#915" class="Function">assumption&#39;</a><a id="1550" class="Symbol">)</a>

    <a id="Test.test₅"></a><a id="1557" href="Tactic.Case.html#1557" class="Function">test₅</a> <a id="1563" class="Symbol">:</a> <a id="1565" href="Tactic.Case.html#1244" class="Record">TestType</a> <a id="1574" class="Symbol">→</a> <a id="1576" href="Tactic.Case.html#1151" class="Bound">B</a>
    <a id="1582" href="Tactic.Case.html#1557" class="Function">test₅</a> <a id="1588" href="Tactic.Case.html#1588" class="Bound">x</a> <a id="1590" class="Symbol">=</a> <a id="1592" href="Tactic.Helpers.html#6484" class="Macro">by</a> <a id="1595" class="Symbol">(</a><a id="1596" href="Tactic.Case.html#931" class="Function">case</a> <a id="1601" href="Tactic.Case.html#1588" class="Bound">x</a> <a id="1603" href="Tactic.Assumption.html#915" class="Function">assumption&#39;</a><a id="1614" class="Symbol">)</a>
</pre></body></html>