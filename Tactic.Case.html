<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Case</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/tactics-and-deriving/Tactic/Case.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Symbol">{-#</a> <a id="40" class="Keyword">OPTIONS</a> <a id="48" class="Pragma">-v</a> <a id="51" class="Pragma">allTactics:100</a> <a id="66" class="Symbol">#-}</a>
<a id="70" class="Keyword">module</a> <a id="77" href="Tactic.Case.html" class="Module">Tactic.Case</a> <a id="89" class="Keyword">where</a>

<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="Data.List.html" class="Module">Data.List</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Product.html" class="Module">Data.Product</a>
<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Function.html" class="Module">Function</a>
<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="208" class="Keyword">using</a> <a id="214" class="Symbol">(</a><a id="215" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="220" class="Symbol">;</a> <a id="222" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="226" class="Symbol">;</a> <a id="228" href="Data.Maybe.Base.html#1906" class="Function">from-just</a><a id="237" class="Symbol">)</a>

<a id="240" class="Keyword">open</a> <a id="245" class="Keyword">import</a> <a id="252" href="Tactic.Helpers.html" class="Module">Tactic.Helpers</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>

<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Generics.html" class="Module">Generics</a>

<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Reflection.Syntax.html" class="Module">Reflection.Syntax</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Interface.Monad.html" class="Module">Interface.Monad</a>
<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Interface.MonadTC.html" class="Module">Interface.MonadTC</a> <a id="411" class="Keyword">hiding</a> <a id="418" class="Symbol">(</a><a id="419" href="Interface.MonadTC.html#405" class="Function">Monad-TC</a><a id="427" class="Symbol">)</a>
<a id="429" class="Keyword">open</a> <a id="434" class="Keyword">import</a> <a id="441" href="Reflection.TCI.html" class="Module">Reflection.TCI</a>

<a id="457" class="Keyword">open</a> <a id="462" class="Keyword">import</a> <a id="469" href="Meta.html" class="Module">Meta</a>

<a id="475" class="Keyword">open</a> <a id="480" href="Interface.Monad.html#175" class="Module">Monad</a> <a id="486" class="Symbol">⦃...⦄</a>
<a id="492" class="Keyword">open</a> <a id="497" href="Interface.MonadTC.html#1361" class="Module">MonadTC</a> <a id="505" class="Symbol">⦃...⦄</a>

<a id="512" class="Keyword">instance</a>
  <a id="523" href="Tactic.Case.html#523" class="Function">_</a> <a id="525" class="Symbol">=</a> <a id="527" href="Reflection.TCI.html#672" class="Function">Monad-TC</a>
  <a id="538" href="Tactic.Case.html#538" class="Function">_</a> <a id="540" class="Symbol">=</a> <a id="542" href="Reflection.TCI.html#4214" class="Function">MonadTC-TCI</a>
  <a id="556" href="Tactic.Case.html#556" class="Function">_</a> <a id="558" class="Symbol">=</a> <a id="560" href="Tactic.ClauseBuilder.html#10631" class="Function">ContextMonad-MonadTC</a>

<a id="582" class="Keyword">open</a> <a id="587" href="Tactic.ClauseBuilder.html#10861" class="Module">ClauseExprM</a>

<a id="matchInductive"></a><a id="600" href="Tactic.Case.html#600" class="Function">matchInductive</a> <a id="615" class="Symbol">:</a> <a id="617" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="622" class="Symbol">→</a> <a id="624" class="Symbol">(</a><a id="625" href="Tactic.ClauseBuilder.html#1162" class="Function">SinglePattern</a> <a id="639" class="Symbol">→</a> <a id="641" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="644" class="Symbol">(</a><a id="645" href="Tactic.ClauseBuilder.html#5652" class="Datatype">ClauseExpr</a> <a id="656" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="658" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="664" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a><a id="668" class="Symbol">))</a> <a id="671" class="Symbol">→</a> <a id="673" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="676" href="Tactic.ClauseBuilder.html#5652" class="Datatype">ClauseExpr</a>
<a id="687" href="Tactic.Case.html#600" class="Function">matchInductive</a> <a id="702" href="Tactic.Case.html#702" class="Bound">ty</a> <a id="705" href="Tactic.Case.html#705" class="Bound">rhs</a> <a id="709" class="Symbol">=</a> <a id="711" class="Keyword">do</a>
  <a id="716" href="Tactic.Case.html#716" class="Bound">ps</a> <a id="719" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="721" href="Tactic.ClauseBuilder.html#5146" class="Function">constructorPatterns&#39;</a> <a id="742" href="Tactic.Case.html#702" class="Bound">ty</a>
  <a id="747" href="Tactic.ClauseBuilder.html#11019" class="Function">matchExprM</a> <a id="758" class="Symbol">(</a><a id="759" href="Data.List.Base.html#1544" class="Function">Data.List.map</a> <a id="773" class="Symbol">(λ</a> <a id="776" href="Tactic.Case.html#776" class="Bound">p</a> <a id="778" class="Symbol">→</a> <a id="780" href="Tactic.Case.html#776" class="Bound">p</a> <a id="782" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="784" href="Tactic.Case.html#705" class="Bound">rhs</a> <a id="788" href="Tactic.Case.html#776" class="Bound">p</a><a id="789" class="Symbol">)</a> <a id="791" href="Tactic.Case.html#716" class="Bound">ps</a><a id="793" class="Symbol">)</a>

<a id="genMatchingClauses"></a><a id="796" href="Tactic.Case.html#796" class="Function">genMatchingClauses</a> <a id="815" class="Symbol">:</a> <a id="817" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="822" class="Symbol">→</a> <a id="824" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="827" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="832" class="Symbol">→</a> <a id="834" href="Reflection.TCI.html#628" class="Function">TC</a> <a id="837" href="Tactic.ClauseBuilder.html#5652" class="Datatype">ClauseExpr</a>
<a id="848" href="Tactic.Case.html#796" class="Function">genMatchingClauses</a> <a id="867" href="Tactic.Case.html#867" class="Bound">ty</a> <a id="870" href="Tactic.Case.html#870" class="Bound">x</a> <a id="872" class="Symbol">=</a> <a id="874" href="Tactic.Case.html#600" class="Function">matchInductive</a> <a id="889" href="Tactic.Case.html#867" class="Bound">ty</a> <a id="892" class="Symbol">(λ</a> <a id="895" href="Tactic.Case.html#895" class="Bound">_</a> <a id="897" class="Symbol">→</a> <a id="899" class="Symbol">(</a><a id="900" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="905" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="907" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="911" class="Symbol">)</a> <a id="913" href="Interface.Monad.html#627" class="Function Operator">&lt;$&gt;</a> <a id="917" href="Tactic.Case.html#870" class="Bound">x</a><a id="918" class="Symbol">)</a>

<a id="921" class="Comment">-- apply tac to all holes</a>
<a id="case"></a><a id="947" href="Tactic.Case.html#947" class="Function">case</a> <a id="952" class="Symbol">:</a> <a id="954" class="Symbol">∀</a> <a id="956" class="Symbol">{</a><a id="957" href="Tactic.Case.html#957" class="Bound">a</a><a id="958" class="Symbol">}</a> <a id="960" class="Symbol">{</a><a id="961" href="Tactic.Case.html#961" class="Bound">A</a> <a id="963" class="Symbol">:</a> <a id="965" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="969" href="Tactic.Case.html#957" class="Bound">a</a><a id="970" class="Symbol">}</a> <a id="972" class="Symbol">→</a> <a id="974" href="Tactic.Case.html#961" class="Bound">A</a> <a id="976" class="Symbol">→</a> <a id="978" href="Tactic.Helpers.html#5592" class="Function">ITactic</a> <a id="986" class="Symbol">→</a> <a id="988" href="Tactic.Helpers.html#5592" class="Function">ITactic</a>
<a id="996" href="Tactic.Case.html#947" class="Function">case</a> <a id="1001" href="Tactic.Case.html#1001" class="Bound">a</a> <a id="1003" href="Tactic.Case.html#1003" class="Bound">tac</a> <a id="1007" class="Symbol">=</a> <a id="1009" href="Tactic.Helpers.html#2505" class="Function">inDebugPath</a> <a id="1021" class="String">&quot;case&quot;</a> <a id="1028" class="Keyword">do</a>
  <a id="1033" href="Tactic.Case.html#1033" class="Bound">t</a> <a id="1035" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="1037" href="Interface.MonadTC.html#1734" class="Field">quoteTC</a> <a id="1045" href="Tactic.Case.html#1001" class="Bound">a</a>
  <a id="1049" href="Tactic.Case.html#1049" class="Bound">ty</a> <a id="1052" href="Interface.Monad.html#307" class="Field Operator">←</a> <a id="1054" href="Interface.MonadTC.html#1579" class="Field">inferType</a> <a id="1064" href="Tactic.Case.html#1033" class="Bound">t</a>
  <a id="1068" href="Interface.MonadTC.html#10290" class="Function">unifyWithGoal</a> <a id="1082" href="Interface.Monad.html#396" class="Function Operator">=&lt;&lt;</a> <a id="1086" href="Tactic.ClauseBuilder.html#8394" class="Function">caseMatch</a> <a id="1096" href="Tactic.Case.html#1033" class="Bound">t</a> <a id="1098" class="Symbol">(</a><a id="1099" href="Tactic.Case.html#796" class="Function">genMatchingClauses</a> <a id="1118" href="Tactic.Case.html#1049" class="Bound">ty</a> <a id="1121" class="Symbol">(</a><a id="1122" href="Interface.MonadTC.html#10766" class="Function">withGoalHole</a> <a id="1135" href="Tactic.Case.html#1003" class="Bound">tac</a><a id="1138" class="Symbol">))</a>

<a id="1142" class="Keyword">private</a>
  <a id="1152" class="Keyword">module</a> <a id="Test"></a><a id="1159" href="Tactic.Case.html#1159" class="Module">Test</a> <a id="1164" class="Symbol">(</a><a id="1165" href="Tactic.Case.html#1165" class="Bound">A</a> <a id="1167" href="Tactic.Case.html#1167" class="Bound">B</a> <a id="1169" class="Symbol">:</a> <a id="1171" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1174" class="Symbol">)</a> <a id="1176" class="Keyword">where</a>
    <a id="1186" class="Keyword">open</a> <a id="1191" class="Keyword">import</a> <a id="1198" href="Tactic.Assumption.html" class="Module">Tactic.Assumption</a>
    <a id="1220" class="Keyword">open</a> <a id="1225" class="Keyword">import</a> <a id="1232" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

    <a id="1253" class="Keyword">record</a> <a id="Test.TestType"></a><a id="1260" href="Tactic.Case.html#1260" class="Record">TestType</a> <a id="1269" class="Symbol">:</a> <a id="1271" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1275" class="Keyword">where</a>
      <a id="1287" class="Keyword">field</a>
        <a id="Test.TestType.a"></a><a id="1301" href="Tactic.Case.html#1301" class="Field">a</a> <a id="1303" class="Symbol">:</a> <a id="1305" href="Tactic.Case.html#1165" class="Bound">A</a>
        <a id="Test.TestType.b"></a><a id="1315" href="Tactic.Case.html#1315" class="Field">b</a> <a id="1317" class="Symbol">:</a> <a id="1319" href="Tactic.Case.html#1167" class="Bound">B</a>

    <a id="Test.test₁"></a><a id="1326" href="Tactic.Case.html#1326" class="Function">test₁</a> <a id="1332" class="Symbol">:</a> <a id="1334" href="Tactic.Case.html#1165" class="Bound">A</a> <a id="1336" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1338" href="Tactic.Case.html#1167" class="Bound">B</a> <a id="1340" class="Symbol">→</a> <a id="1342" href="Tactic.Case.html#1165" class="Bound">A</a>
    <a id="1348" href="Tactic.Case.html#1326" class="Function">test₁</a> <a id="1354" href="Tactic.Case.html#1354" class="Bound">x</a> <a id="1356" class="Symbol">=</a> <a id="1358" href="Tactic.Helpers.html#6401" class="Macro">by</a> <a id="1361" class="Symbol">(</a><a id="1362" href="Tactic.Case.html#947" class="Function">case</a> <a id="1367" href="Tactic.Case.html#1354" class="Bound">x</a> <a id="1369" href="Tactic.Assumption.html#885" class="Function">assumption&#39;</a><a id="1380" class="Symbol">)</a>

    <a id="Test.test₂"></a><a id="1387" href="Tactic.Case.html#1387" class="Function">test₂</a> <a id="1393" class="Symbol">:</a> <a id="1395" href="Tactic.Case.html#1165" class="Bound">A</a> <a id="1397" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1399" href="Tactic.Case.html#1167" class="Bound">B</a> <a id="1401" class="Symbol">→</a> <a id="1403" href="Tactic.Case.html#1167" class="Bound">B</a>
    <a id="1409" href="Tactic.Case.html#1387" class="Function">test₂</a> <a id="1415" href="Tactic.Case.html#1415" class="Bound">x</a> <a id="1417" class="Symbol">=</a> <a id="1419" href="Tactic.Helpers.html#6401" class="Macro">by</a> <a id="1422" class="Symbol">(</a><a id="1423" href="Tactic.Case.html#947" class="Function">case</a> <a id="1428" href="Tactic.Case.html#1415" class="Bound">x</a> <a id="1430" href="Tactic.Assumption.html#885" class="Function">assumption&#39;</a><a id="1441" class="Symbol">)</a>

    <a id="Test.test₃"></a><a id="1448" href="Tactic.Case.html#1448" class="Function">test₃</a> <a id="1454" class="Symbol">:</a> <a id="1456" href="Tactic.Case.html#1165" class="Bound">A</a> <a id="1458" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1460" href="Tactic.Case.html#1165" class="Bound">A</a> <a id="1462" class="Symbol">→</a> <a id="1464" href="Tactic.Case.html#1165" class="Bound">A</a>
    <a id="1470" href="Tactic.Case.html#1448" class="Function">test₃</a> <a id="1476" href="Tactic.Case.html#1476" class="Bound">x</a> <a id="1478" class="Symbol">=</a> <a id="1480" href="Tactic.Helpers.html#6401" class="Macro">by</a> <a id="1483" class="Symbol">(</a><a id="1484" href="Tactic.Case.html#947" class="Function">case</a> <a id="1489" href="Tactic.Case.html#1476" class="Bound">x</a> <a id="1491" href="Tactic.Assumption.html#885" class="Function">assumption&#39;</a><a id="1502" class="Symbol">)</a>

    <a id="Test.test₄"></a><a id="1509" href="Tactic.Case.html#1509" class="Function">test₄</a> <a id="1515" class="Symbol">:</a> <a id="1517" href="Tactic.Case.html#1260" class="Record">TestType</a> <a id="1526" class="Symbol">→</a> <a id="1528" href="Tactic.Case.html#1165" class="Bound">A</a>
    <a id="1534" href="Tactic.Case.html#1509" class="Function">test₄</a> <a id="1540" href="Tactic.Case.html#1540" class="Bound">x</a> <a id="1542" class="Symbol">=</a> <a id="1544" href="Tactic.Helpers.html#6401" class="Macro">by</a> <a id="1547" class="Symbol">(</a><a id="1548" href="Tactic.Case.html#947" class="Function">case</a> <a id="1553" href="Tactic.Case.html#1540" class="Bound">x</a> <a id="1555" href="Tactic.Assumption.html#885" class="Function">assumption&#39;</a><a id="1566" class="Symbol">)</a>

    <a id="Test.test₅"></a><a id="1573" href="Tactic.Case.html#1573" class="Function">test₅</a> <a id="1579" class="Symbol">:</a> <a id="1581" href="Tactic.Case.html#1260" class="Record">TestType</a> <a id="1590" class="Symbol">→</a> <a id="1592" href="Tactic.Case.html#1167" class="Bound">B</a>
    <a id="1598" href="Tactic.Case.html#1573" class="Function">test₅</a> <a id="1604" href="Tactic.Case.html#1604" class="Bound">x</a> <a id="1606" class="Symbol">=</a> <a id="1608" href="Tactic.Helpers.html#6401" class="Macro">by</a> <a id="1611" class="Symbol">(</a><a id="1612" href="Tactic.Case.html#947" class="Function">case</a> <a id="1617" href="Tactic.Case.html#1604" class="Bound">x</a> <a id="1619" href="Tactic.Assumption.html#885" class="Function">assumption&#39;</a><a id="1630" class="Symbol">)</a>
</pre></body></html>