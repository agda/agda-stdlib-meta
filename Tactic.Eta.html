<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Eta</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactic/Eta.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Comment">--------------------------------------------------------------------------------</a>
<a id="117" class="Comment">-- eta: unify with an eta-expanded version of the argument</a>
<a id="176" class="Comment">--------------------------------------------------------------------------------</a>

<a id="258" class="Keyword">module</a> <a id="265" href="Tactic.Eta.html" class="Module">Tactic.Eta</a> <a id="276" class="Keyword">where</a>

<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Prelude.html" class="Module">Prelude</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Meta.html" class="Module">Meta</a>

<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Data.List.html" class="Module">Data.List</a>
<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Data.Fin.html" class="Module">Data.Fin</a>

<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Class.Semigroup.html" class="Module">Class.Semigroup</a>
<a id="453" class="Keyword">open</a> <a id="458" class="Keyword">import</a> <a id="465" href="Class.Show.html" class="Module">Class.Show</a>

<a id="477" class="Keyword">open</a> <a id="482" class="Keyword">import</a> <a id="489" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="507" class="Keyword">open</a> <a id="512" class="Keyword">import</a> <a id="519" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="536" class="Keyword">open</a> <a id="541" class="Keyword">import</a> <a id="548" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>

<a id="saturate"></a><a id="570" href="Tactic.Eta.html#570" class="Function">saturate</a> <a id="579" class="Symbol">:</a> <a id="581" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="586" class="Symbol">→</a> <a id="588" href="Reflection.Argument.html#1493" class="Function">Args</a> <a id="593" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="598" class="Symbol">→</a> <a id="600" href="Reflection.TCI.html#612" class="Function">TC</a> <a id="603" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="608" href="Tactic.Eta.html#570" class="Function">saturate</a> <a id="617" href="Tactic.Eta.html#617" class="Bound">f</a> <a id="619" href="Tactic.Eta.html#619" class="Bound">as</a> <a id="622" class="Symbol">=</a> <a id="624" href="Function.Base.html#4130" class="Function Operator">case</a> <a id="629" href="Tactic.Eta.html#617" class="Bound">f</a> <a id="631" href="Function.Base.html#4130" class="Function Operator">of</a> <a id="634" class="Symbol">λ</a> <a id="636" class="Keyword">where</a>
  <a id="644" class="Symbol">(</a><a id="645" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="649" href="Tactic.Eta.html#649" class="Bound">c</a> <a id="651" href="Tactic.Eta.html#651" class="Bound">as′</a><a id="654" class="Symbol">)</a> <a id="656" class="Symbol">→</a> <a id="658" href="Class.Monad.Core.html#241" class="Field">return</a> <a id="665" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="667" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="671" href="Tactic.Eta.html#649" class="Bound">c</a> <a id="673" class="Symbol">(</a><a id="674" href="Tactic.Eta.html#651" class="Bound">as′</a> <a id="678" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="681" href="Tactic.Eta.html#619" class="Bound">as</a><a id="683" class="Symbol">)</a>
  <a id="687" class="CatchallClause Symbol">_</a>           <a id="699" class="Symbol">→</a> <a id="701" href="Class.MonadTC.html#8763" class="Function">error1</a> <a id="708" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="710" class="String">&quot;cannot saturate arbitrary expressions, only definitions&quot;</a>

<a id="769" class="Keyword">macro</a>
  <a id="η"></a><a id="777" href="Tactic.Eta.html#777" class="Function">η</a> <a id="779" class="Symbol">:</a> <a id="781" class="Symbol">⦃</a> <a id="783" href="Class.MonadTC.html#621" class="Record">TCOptions</a> <a id="793" class="Symbol">⦄</a> <a id="795" class="Symbol">→</a> <a id="797" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="802" class="Symbol">→</a> <a id="804" href="Reflection.Tactic.html#485" class="Function">Tactic</a>
  <a id="813" href="Tactic.Eta.html#777" class="Function">η</a> <a id="815" href="Tactic.Eta.html#815" class="Bound">f</a> <a id="817" class="Symbol">=</a> <a id="819" href="Reflection.Tactic.html#833" class="Function">initTac</a> <a id="827" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="829" href="Reflection.Utils.TCI.html#5941" class="Function">inDebugPath</a> <a id="841" class="String">&quot;eta&quot;</a> <a id="847" class="Keyword">do</a>
    <a id="854" href="Class.MonadTC.html#5765" class="Function">debugLog</a> <a id="863" class="Symbol">(</a><a id="864" class="String">&quot;f: &quot;</a> <a id="870" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="873" href="Tactic.Eta.html#815" class="Bound">f</a> <a id="875" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="878" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="880" class="Symbol">)</a>
    <a id="886" href="Tactic.Eta.html#886" class="Bound">ty</a> <a id="889" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="891" href="Class.MonadTC.html#1753" class="Field">inferType</a> <a id="901" href="Tactic.Eta.html#815" class="Bound">f</a> <a id="903" class="Comment">-- =&lt;&lt; reduce f</a>
    <a id="923" href="Class.MonadTC.html#5765" class="Function">debugLog</a> <a id="932" class="Symbol">(</a><a id="933" class="String">&quot;ty: &quot;</a> <a id="940" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="943" href="Tactic.Eta.html#886" class="Bound">ty</a> <a id="946" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="949" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="951" class="Symbol">)</a>
    <a id="957" class="Keyword">let</a> <a id="961" href="Tactic.Eta.html#961" class="Bound">as</a> <a id="964" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="966" class="Symbol">_</a> <a id="968" class="Symbol">=</a> <a id="970" href="Reflection.Utils.html#2797" class="Function">viewTy′</a> <a id="978" href="Tactic.Eta.html#886" class="Bound">ty</a>
    <a id="985" href="Class.MonadTC.html#5765" class="Function">debugLog</a> <a id="994" class="Symbol">(</a><a id="995" class="String">&quot;as: &quot;</a> <a id="1002" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="1005" href="Class.Show.Core.html#162" class="Field">show</a> <a id="1010" href="Tactic.Eta.html#961" class="Bound">as</a> <a id="1013" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="1016" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1018" class="Symbol">)</a>
    <a id="1024" href="Tactic.Eta.html#1024" class="Bound">f′</a> <a id="1027" href="Class.Monad.Core.html#262" class="Field Operator">←</a> <a id="1029" href="Tactic.Eta.html#570" class="Function">saturate</a> <a id="1038" href="Tactic.Eta.html#815" class="Bound">f</a> <a id="1040" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1042" href="Function.Base.html#1563" class="Function">flip</a> <a id="1047" href="Data.List.Base.html#1553" class="Function">map</a> <a id="1051" class="Symbol">(</a><a id="1052" href="Prelude.html#1220" class="Function">enumerate</a> <a id="1062" href="Tactic.Eta.html#961" class="Bound">as</a><a id="1064" class="Symbol">)</a> <a id="1066" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1068" class="Symbol">λ</a> <a id="1070" class="Keyword">where</a>
      <a id="1082" class="Symbol">(</a><a id="1083" href="Tactic.Eta.html#1083" class="Bound">n</a> <a id="1085" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1087" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1091" href="Tactic.Eta.html#1091" class="Bound">i</a> <a id="1093" class="Symbol">_)</a> <a id="1096" class="Symbol">→</a> <a id="1098" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1102" href="Tactic.Eta.html#1091" class="Bound">i</a> <a id="1104" class="Symbol">(</a><a id="1105" href="Reflection.Syntax.html#1131" class="InductiveConstructor">♯</a> <a id="1107" class="Symbol">(</a><a id="1108" href="Data.List.Base.html#4873" class="Function">length</a> <a id="1115" href="Tactic.Eta.html#961" class="Bound">as</a> <a id="1118" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="1120" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1124" href="Tactic.Eta.html#1083" class="Bound">n</a><a id="1125" class="Symbol">))</a>
    <a id="1132" href="Class.MonadTC.html#5765" class="Function">debugLog</a> <a id="1141" class="Symbol">(</a><a id="1142" class="String">&quot;f′: &quot;</a> <a id="1149" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="1152" href="Class.Show.Core.html#162" class="Field">show</a> <a id="1157" href="Tactic.Eta.html#1024" class="Bound">f′</a> <a id="1160" href="Reflection.Debug.html#1010" class="Function Operator">∷ᵈ</a> <a id="1163" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1165" class="Symbol">)</a>
    <a id="1171" href="Class.MonadTC.html#10513" class="Function">unifyWithGoal</a> <a id="1185" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1187" href="Data.List.Base.html#4201" class="Function">foldr</a> <a id="1193" class="Symbol">(λ</a> <a id="1196" href="Tactic.Eta.html#1196" class="Bound">x</a> <a id="1198" href="Tactic.Eta.html#1198" class="Bound">t</a> <a id="1200" class="Symbol">→</a> <a id="1202" href="Reflection.Term.html#1852" class="InductiveConstructor Operator">Π[</a> <a id="1205" class="String">&quot;_&quot;</a> <a id="1209" href="Reflection.Term.html#1852" class="InductiveConstructor Operator">∶</a> <a id="1211" href="Tactic.Eta.html#1196" class="Bound">x</a> <a id="1213" href="Reflection.Term.html#1852" class="InductiveConstructor Operator">]</a> <a id="1215" href="Tactic.Eta.html#1198" class="Bound">t</a><a id="1216" class="Symbol">)</a> <a id="1218" href="Tactic.Eta.html#1024" class="Bound">f′</a> <a id="1221" href="Tactic.Eta.html#961" class="Bound">as</a>


<a id="1226" class="Keyword">private</a>
  <a id="1236" class="Keyword">module</a> <a id="Test"></a><a id="1243" href="Tactic.Eta.html#1243" class="Module">Test</a> <a id="1248" class="Keyword">where</a>
    <a id="1258" class="Keyword">open</a> <a id="1263" class="Keyword">import</a> <a id="1270" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

    <a id="Test.p"></a><a id="1291" href="Tactic.Eta.html#1291" class="Function">p</a> <a id="1293" class="Symbol">:</a> <a id="1295" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="1303" href="Tactic.Eta.html#1291" class="Function">p</a> <a id="1305" class="Symbol">=</a> <a id="1307" class="Symbol">∀</a> <a id="1309" class="Symbol">{</a><a id="1310" href="Tactic.Eta.html#1310" class="Bound">n</a><a id="1311" class="Symbol">}</a> <a id="1313" class="Symbol">→</a> <a id="1315" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1319" href="Tactic.Eta.html#1310" class="Bound">n</a>

    <a id="Test.∀p"></a><a id="1326" href="Tactic.Eta.html#1326" class="Function">∀p</a> <a id="1329" class="Symbol">:</a> <a id="1331" class="Symbol">∀</a> <a id="1333" class="Symbol">{</a><a id="1334" href="Tactic.Eta.html#1334" class="Bound">n</a><a id="1335" class="Symbol">}</a> <a id="1337" class="Symbol">→</a> <a id="1339" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="1347" href="Tactic.Eta.html#1326" class="Function">∀p</a> <a id="1350" class="Symbol">{</a><a id="1351" href="Tactic.Eta.html#1351" class="Bound">n</a><a id="1352" class="Symbol">}</a> <a id="1354" class="Symbol">=</a> <a id="1356" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1360" href="Tactic.Eta.html#1351" class="Bound">n</a>

    <a id="1367" href="Tactic.Eta.html#1367" class="Function">_</a> <a id="1369" class="Symbol">:</a> <a id="1371" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="1379" class="Symbol">_</a> <a id="1381" class="Symbol">=</a> <a id="1383" href="Tactic.Eta.html#777" class="Macro">η</a> <a id="1385" href="Tactic.Eta.html#1326" class="Function">∀p</a>

    <a id="Test.∀kp"></a><a id="1393" href="Tactic.Eta.html#1393" class="Function">∀kp</a> <a id="1397" class="Symbol">:</a> <a id="1399" class="Symbol">∀</a> <a id="1401" class="Symbol">(</a><a id="1402" href="Tactic.Eta.html#1402" class="Bound">m</a> <a id="1404" class="Symbol">:</a> <a id="1406" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1407" class="Symbol">)</a> <a id="1409" class="Symbol">{</a><a id="1410" href="Tactic.Eta.html#1410" class="Bound">n</a><a id="1411" class="Symbol">}</a> <a id="1413" class="Symbol">→</a> <a id="1415" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="1423" href="Tactic.Eta.html#1393" class="Function">∀kp</a> <a id="1427" class="Symbol">_</a> <a id="1429" class="Symbol">{</a><a id="1430" href="Tactic.Eta.html#1430" class="Bound">n</a><a id="1431" class="Symbol">}</a> <a id="1433" class="Symbol">=</a> <a id="1435" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1439" href="Tactic.Eta.html#1430" class="Bound">n</a>

    <a id="1446" href="Tactic.Eta.html#1446" class="Function">_</a> <a id="1448" class="Symbol">:</a> <a id="1450" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="1458" class="Symbol">_</a> <a id="1460" class="Symbol">=</a> <a id="1462" href="Tactic.Eta.html#777" class="Macro">η</a> <a id="1464" class="Symbol">(</a><a id="1465" href="Tactic.Eta.html#1393" class="Function">∀kp</a> <a id="1469" class="Number">0</a><a id="1470" class="Symbol">)</a>

    <a id="Test.∀k2p"></a><a id="1477" href="Tactic.Eta.html#1477" class="Function">∀k2p</a> <a id="1482" class="Symbol">:</a> <a id="1484" class="Symbol">∀</a> <a id="1486" class="Symbol">(</a><a id="1487" href="Tactic.Eta.html#1487" class="Bound">m</a> <a id="1489" class="Symbol">:</a> <a id="1491" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1492" class="Symbol">)</a> <a id="1494" class="Symbol">{</a><a id="1495" href="Tactic.Eta.html#1495" class="Bound">k</a> <a id="1497" class="Symbol">:</a> <a id="1499" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1500" class="Symbol">}</a> <a id="1502" class="Symbol">{</a><a id="1503" href="Tactic.Eta.html#1503" class="Bound">n</a><a id="1504" class="Symbol">}</a> <a id="1506" class="Symbol">→</a> <a id="1508" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="1516" href="Tactic.Eta.html#1477" class="Function">∀k2p</a> <a id="1521" class="Symbol">_</a> <a id="1523" class="Symbol">{</a><a id="1524" class="Argument">n</a> <a id="1526" class="Symbol">=</a> <a id="1528" href="Tactic.Eta.html#1528" class="Bound">n</a><a id="1529" class="Symbol">}</a> <a id="1531" class="Symbol">=</a> <a id="1533" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1537" href="Tactic.Eta.html#1528" class="Bound">n</a>

    <a id="1544" href="Tactic.Eta.html#1544" class="Function">_</a> <a id="1546" class="Symbol">:</a> <a id="1548" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="1556" class="Symbol">_</a> <a id="1558" class="Symbol">=</a> <a id="1560" href="Tactic.Eta.html#777" class="Macro">η</a> <a id="1562" class="Symbol">(</a><a id="1563" href="Tactic.Eta.html#1477" class="Function">∀k2p</a> <a id="1568" class="Number">0</a> <a id="1570" class="Symbol">{</a><a id="1571" class="Number">1</a><a id="1572" class="Symbol">})</a>
</pre></body></html>