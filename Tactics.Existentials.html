<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactics.Existentials</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/master/Tactics/Existentials.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Tactics.Existentials.html" class="Module">Tactics.Existentials</a> <a id="29" class="Keyword">where</a>

<a id="36" class="Keyword">open</a> <a id="41" class="Keyword">import</a> <a id="48" href="Prelude.html" class="Module">Prelude</a>

<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Reflection.html" class="Module">Reflection</a> <a id="80" class="Keyword">hiding</a> <a id="87" class="Symbol">(</a><a id="88" href="Agda.Builtin.Reflection.html#8322" class="Postulate">return</a><a id="94" class="Symbol">;</a> <a id="96" href="Reflection.TypeChecking.Monad.Syntax.html#691" class="Function Operator">_&gt;&gt;=_</a><a id="101" class="Symbol">;</a> <a id="103" href="Reflection.TypeChecking.Monad.Syntax.html#761" class="Function Operator">_&gt;&gt;_</a><a id="107" class="Symbol">;</a> <a id="109" href="Reflection.html#6244" class="Function Operator">_≟_</a><a id="112" class="Symbol">)</a>

<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Reflection.Syntax.html" class="Module">Reflection.Syntax</a>
<a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="175" class="Keyword">open</a> <a id="180" class="Keyword">import</a> <a id="187" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>

<a id="205" class="Keyword">open</a> <a id="210" class="Keyword">import</a> <a id="217" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="231" class="Keyword">open</a> <a id="236" class="Keyword">import</a> <a id="243" href="Class.Monad.html" class="Module">Class.Monad</a>

<a id="mkExistential"></a><a id="256" href="Tactics.Existentials.html#256" class="Function">mkExistential</a> <a id="270" class="Symbol">:</a> <a id="272" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="274" class="Symbol">→</a> <a id="276" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="281" class="Symbol">→</a> <a id="283" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="286" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="291" href="Tactics.Existentials.html#256" class="Function">mkExistential</a> <a id="305" href="Tactics.Existentials.html#305" class="Bound">lvl</a> <a id="309" href="Tactics.Existentials.html#309" class="Bound">t</a> <a id="311" class="Symbol">=</a> <a id="313" class="Keyword">do</a>
  <a id="318" href="Tactics.Existentials.html#318" class="Bound">ty</a> <a id="321" href="Class.Monad.Core.html#335" class="Field Operator">←</a> <a id="323" href="Agda.Builtin.Reflection.html#9373" class="Postulate">getType</a> <a id="331" href="Tactics.Existentials.html#309" class="Bound">t</a>
  <a id="335" class="Keyword">let</a> <a id="339" href="Tactics.Existentials.html#339" class="Bound">n</a> <a id="341" class="Symbol">=</a> <a id="343" href="Data.List.Base.html#4873" class="Function">length</a> <a id="350" class="Symbol">(</a><a id="351" href="Reflection.Utils.html#2917" class="Function">argTys</a> <a id="358" href="Tactics.Existentials.html#318" class="Bound">ty</a><a id="360" class="Symbol">)</a> <a id="362" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="364" href="Tactics.Existentials.html#305" class="Bound">lvl</a>
  <a id="370" href="Class.Monad.Core.html#314" class="Field">return</a> <a id="377" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="379" href="Tactics.Existentials.html#398" class="Function">go</a> <a id="382" href="Tactics.Existentials.html#339" class="Bound">n</a> <a id="384" href="Tactics.Existentials.html#339" class="Bound">n</a>
  <a id="388" class="Keyword">where</a>
    <a id="398" href="Tactics.Existentials.html#398" class="Function">go</a> <a id="401" class="Symbol">:</a> <a id="403" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="405" class="Symbol">→</a> <a id="407" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="409" class="Symbol">→</a> <a id="411" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
    <a id="420" href="Tactics.Existentials.html#398" class="Function">go</a> <a id="423" href="Tactics.Existentials.html#423" class="Bound">n₀</a> <a id="426" class="Number">0</a>       <a id="434" class="Symbol">=</a> <a id="436" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="440" href="Tactics.Existentials.html#309" class="Bound">t</a> <a id="442" class="Symbol">(</a><a id="443" href="Class.Functor.Core.html#737" class="Function">fmap</a> <a id="448" class="Symbol">(λ</a> <a id="451" href="Tactics.Existentials.html#451" class="Bound">n</a> <a id="453" class="Symbol">→</a> <a id="455" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="460" class="Symbol">(</a><a id="461" href="Reflection.Syntax.html#1131" class="InductiveConstructor">♯</a> <a id="463" href="Tactics.Existentials.html#451" class="Bound">n</a><a id="464" class="Symbol">))</a> <a id="467" class="Symbol">(</a><a id="468" href="Data.List.Base.html#9826" class="Function">reverse</a> <a id="476" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="478" href="Data.List.Base.html#6243" class="Function">upTo</a> <a id="483" href="Tactics.Existentials.html#423" class="Bound">n₀</a><a id="485" class="Symbol">))</a>
    <a id="492" href="Tactics.Existentials.html#398" class="Function">go</a> <a id="495" href="Tactics.Existentials.html#495" class="Bound">n₀</a> <a id="498" class="Symbol">(</a><a id="499" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="503" href="Tactics.Existentials.html#503" class="Bound">n</a><a id="504" class="Symbol">)</a> <a id="506" class="Symbol">=</a> <a id="508" class="Keyword">quote</a> <a id="514" href="Data.Product.html#1378" class="Function">∃</a> <a id="516" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">∙⟦</a> <a id="519" class="Symbol">(</a><a id="520" href="Reflection.Syntax.html#1913" class="InductiveConstructor Operator">`λ</a> <a id="523" class="String">&quot;_&quot;</a> <a id="527" href="Reflection.Syntax.html#1913" class="InductiveConstructor Operator">⇒</a> <a id="529" href="Tactics.Existentials.html#398" class="Function">go</a> <a id="532" href="Tactics.Existentials.html#495" class="Bound">n₀</a> <a id="535" href="Tactics.Existentials.html#503" class="Bound">n</a><a id="536" class="Symbol">)</a> <a id="538" href="Reflection.Syntax.html#2602" class="InductiveConstructor Operator">⟧</a>

<a id="541" class="Keyword">macro</a>
  <a id="mk∃"></a><a id="549" href="Tactics.Existentials.html#549" class="Function">mk∃</a> <a id="553" class="Symbol">:</a> <a id="555" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="560" class="Symbol">→</a> <a id="562" href="Reflection.Tactic.html#485" class="Function">Tactic</a>
  <a id="571" href="Tactics.Existentials.html#549" class="Function">mk∃</a> <a id="575" href="Tactics.Existentials.html#575" class="Bound">t</a> <a id="577" href="Tactics.Existentials.html#577" class="Bound">hole</a> <a id="582" class="Symbol">=</a> <a id="584" href="Tactics.Existentials.html#256" class="Function">mkExistential</a> <a id="598" class="Number">0</a> <a id="600" href="Tactics.Existentials.html#575" class="Bound">t</a> <a id="602" href="Class.Monad.Core.html#335" class="Field Operator">&gt;&gt;=</a> <a id="606" href="Agda.Builtin.Reflection.html#8452" class="Postulate">unify</a> <a id="612" href="Tactics.Existentials.html#577" class="Bound">hole</a>

<a id="618" class="Keyword">private</a>
  <a id="628" class="Keyword">data</a> <a id="X"></a><a id="633" href="Tactics.Existentials.html#633" class="Datatype">X</a> <a id="635" class="Symbol">:</a> <a id="637" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="639" class="Symbol">→</a> <a id="641" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="648" class="Symbol">→</a> <a id="650" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="652" class="Symbol">→</a> <a id="654" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="658" class="Keyword">where</a>
    <a id="X.mkX"></a><a id="668" href="Tactics.Existentials.html#668" class="InductiveConstructor">mkX</a> <a id="672" class="Symbol">:</a> <a id="674" href="Tactics.Existentials.html#633" class="Datatype">X</a> <a id="676" class="Number">0</a> <a id="678" class="String">&quot;&quot;</a> <a id="681" class="Number">1</a>

  <a id="686" href="Tactics.Existentials.html#686" class="Function">_</a> <a id="688" class="Symbol">:</a> <a id="690" href="Tactics.Existentials.html#549" class="Macro">mk∃</a> <a id="694" href="Tactics.Existentials.html#633" class="Datatype">X</a>
  <a id="698" class="Symbol">_</a> <a id="700" class="Symbol">=</a> <a id="702" class="Number">0</a> <a id="704" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="706" class="String">&quot;&quot;</a> <a id="709" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="711" class="Number">1</a> <a id="713" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="715" href="Tactics.Existentials.html#668" class="InductiveConstructor">mkX</a>

  <a id="722" class="Keyword">module</a> <a id="729" href="Tactics.Existentials.html#729" class="Module">_</a> <a id="731" class="Symbol">(</a><a id="732" href="Tactics.Existentials.html#732" class="Bound">n</a> <a id="734" class="Symbol">:</a> <a id="736" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="737" class="Symbol">)</a> <a id="739" class="Keyword">where</a>
    <a id="749" class="Keyword">data</a> <a id="754" href="Tactics.Existentials.html#754" class="Datatype">Y</a> <a id="756" class="Symbol">:</a> <a id="758" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="765" class="Symbol">→</a> <a id="767" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="769" class="Symbol">→</a> <a id="771" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="775" class="Keyword">where</a>
      <a id="787" href="Tactics.Existentials.html#787" class="InductiveConstructor">mkY</a> <a id="791" class="Symbol">:</a> <a id="793" href="Tactics.Existentials.html#754" class="Datatype">Y</a> <a id="795" class="String">&quot;&quot;</a> <a id="798" class="Number">1</a>

    <a id="805" href="Tactics.Existentials.html#805" class="Function">_</a> <a id="807" class="Symbol">:</a> <a id="809" href="Tactics.Existentials.html#549" class="Macro">mk∃</a> <a id="813" href="Tactics.Existentials.html#754" class="Datatype">Y</a>
    <a id="819" class="Symbol">_</a> <a id="821" class="Symbol">=</a> <a id="823" class="String">&quot;&quot;</a> <a id="826" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="828" class="Number">1</a> <a id="830" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="832" href="Tactics.Existentials.html#787" class="InductiveConstructor">mkY</a>

    <a id="841" class="Keyword">module</a> <a id="848" href="Tactics.Existentials.html#848" class="Module">_</a> <a id="850" class="Symbol">(</a><a id="851" href="Tactics.Existentials.html#851" class="Bound">s</a> <a id="853" class="Symbol">:</a> <a id="855" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="861" class="Symbol">)</a> <a id="863" class="Keyword">where</a>

      <a id="876" class="Keyword">data</a> <a id="881" href="Tactics.Existentials.html#881" class="Datatype">Z</a> <a id="883" class="Symbol">:</a> <a id="885" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="887" class="Symbol">→</a> <a id="889" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="893" class="Keyword">where</a>
        <a id="907" href="Tactics.Existentials.html#907" class="InductiveConstructor">mkZ</a> <a id="911" class="Symbol">:</a> <a id="913" href="Tactics.Existentials.html#881" class="Datatype">Z</a> <a id="915" class="Number">1</a>

      <a id="924" href="Tactics.Existentials.html#924" class="Function">_</a> <a id="926" class="Symbol">:</a> <a id="928" href="Tactics.Existentials.html#549" class="Macro">mk∃</a> <a id="932" href="Tactics.Existentials.html#881" class="Datatype">Z</a>
      <a id="940" class="Symbol">_</a> <a id="942" class="Symbol">=</a> <a id="944" class="Number">1</a> <a id="946" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="948" href="Tactics.Existentials.html#907" class="InductiveConstructor">mkZ</a>

    <a id="957" href="Tactics.Existentials.html#957" class="Function">_</a> <a id="959" class="Symbol">:</a> <a id="961" href="Tactics.Existentials.html#549" class="Macro">mk∃</a> <a id="965" href="Tactics.Existentials.html#881" class="Datatype">Z</a>
    <a id="971" class="Symbol">_</a> <a id="973" class="Symbol">=</a> <a id="975" class="String">&quot;sth&quot;</a> <a id="981" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="983" class="Number">1</a> <a id="985" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="987" href="Tactics.Existentials.html#907" class="InductiveConstructor">mkZ</a>

  <a id="994" href="Tactics.Existentials.html#994" class="Function">_</a> <a id="996" class="Symbol">:</a> <a id="998" href="Tactics.Existentials.html#549" class="Macro">mk∃</a> <a id="1002" href="Tactics.Existentials.html#754" class="Datatype">Y</a>
  <a id="1006" class="Symbol">_</a> <a id="1008" class="Symbol">=</a> <a id="1010" class="Number">42</a> <a id="1013" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1015" class="String">&quot;&quot;</a> <a id="1018" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1020" class="Number">1</a> <a id="1022" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1024" href="Tactics.Existentials.html#787" class="InductiveConstructor">mkY</a>

  <a id="1031" href="Tactics.Existentials.html#1031" class="Function">_</a> <a id="1033" class="Symbol">:</a> <a id="1035" href="Tactics.Existentials.html#549" class="Macro">mk∃</a> <a id="1039" href="Tactics.Existentials.html#881" class="Datatype">Z</a>
  <a id="1043" class="Symbol">_</a> <a id="1045" class="Symbol">=</a> <a id="1047" class="Number">0</a> <a id="1049" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1051" class="String">&quot;sth&quot;</a> <a id="1057" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1059" class="Number">1</a> <a id="1061" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1063" href="Tactics.Existentials.html#907" class="InductiveConstructor">mkZ</a>
</pre></body></html>